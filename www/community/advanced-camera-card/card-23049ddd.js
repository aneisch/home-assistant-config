function e(e,t,n,i){var a,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(r<3?a(s):r>3?a(t,n,s):a(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}"function"==typeof SuppressedError&&SuppressedError;
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t=globalThis,n=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),a=new WeakMap;let r=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(n&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=a.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&a.set(t,e))}return e}toString(){return this.cssText}};const s=e=>new r("string"==typeof e?e:e+"",void 0,i),o=(e,...t)=>{const n=1===e.length?e[0]:t.reduce(((t,n,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[i+1]),e[0]);return new r(n,e,i)},c=(e,i)=>{if(n)e.adoptedStyleSheets=i.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const n of i){const i=document.createElement("style"),a=t.litNonce;void 0!==a&&i.setAttribute("nonce",a),i.textContent=n.cssText,e.appendChild(i)}},l=n?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return s(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,{is:u,defineProperty:d,getOwnPropertyDescriptor:h,getOwnPropertyNames:p,getOwnPropertySymbols:m,getPrototypeOf:f}=Object,g=globalThis,_=g.trustedTypes,v=_?_.emptyScript:"",y=g.reactiveElementPolyfillSupport,b=(e,t)=>e,w={toAttribute(e,t){switch(t){case Boolean:e=e?v:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},x=(e,t)=>!u(e,t),M={attribute:!0,type:String,converter:w,reflect:!1,hasChanged:x};Symbol.metadata??=Symbol("metadata"),g.litPropertyMetadata??=new WeakMap;class k extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=M){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);void 0!==i&&d(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:a}=h(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get(){return i?.call(this)},set(t){const r=i?.call(this);a.call(this,t),this.requestUpdate(e,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??M}static _$Ei(){if(this.hasOwnProperty(b("elementProperties")))return;const e=f(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(b("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(b("properties"))){const e=this.properties,t=[...p(e),...m(e)];for(const n of t)this.createProperty(n,e[n])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,n]of t)this.elementProperties.set(e,n)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const n=this._$Eu(e,t);void 0!==n&&this._$Eh.set(n,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(l(e))}else void 0!==e&&t.push(l(e));return t}static _$Eu(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return c(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EC(e,t){const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(void 0!==i&&!0===n.reflect){const a=(void 0!==n.converter?.toAttribute?n.converter:w).toAttribute(t,n.type);this._$Em=e,null==a?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){const n=this.constructor,i=n._$Eh.get(e);if(void 0!==i&&this._$Em!==i){const e=n.getPropertyOptions(i),a="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:w;this._$Em=i,this[i]=a.fromAttribute(t,e.type),this._$Em=null}}requestUpdate(e,t,n){if(void 0!==e){if(n??=this.constructor.getPropertyOptions(e),!(n.hasChanged??x)(this[e],t))return;this.P(e,t,n)}!1===this.isUpdatePending&&(this._$ES=this._$ET())}P(e,t,n){this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,n]of e)!0!==n.wrapped||this._$AL.has(t)||void 0===this[t]||this.P(t,this[t],n)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach((e=>e.hostUpdate?.())),this.update(t)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach((e=>e.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach((e=>this._$EC(e,this[e]))),this._$EU()}updated(e){}firstUpdated(e){}}k.elementStyles=[],k.shadowRootOptions={mode:"open"},k[b("elementProperties")]=new Map,k[b("finalized")]=new Map,y?.({ReactiveElement:k}),(g.reactiveElementVersions??=[]).push("2.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const C=globalThis,S=C.trustedTypes,E=S?S.createPolicy("lit-html",{createHTML:e=>e}):void 0,A="$lit$",T=`lit$${(Math.random()+"").slice(9)}$`,$="?"+T,I=`<${$}>`,O=document,L=()=>O.createComment(""),D=e=>null===e||"object"!=typeof e&&"function"!=typeof e,j=Array.isArray,z="[ \t\n\f\r]",R=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,P=/-->/g,N=/>/g,F=RegExp(`>|${z}(?:([^\\s"'>=/]+)(${z}*=${z}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),V=/'/g,B=/"/g,H=/^(?:script|style|textarea|title)$/i,U=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),q=Symbol.for("lit-noChange"),W=Symbol.for("lit-nothing"),Z=new WeakMap,K=O.createTreeWalker(O,129);function Q(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==E?E.createHTML(t):t}const Y=(e,t)=>{const n=e.length-1,i=[];let a,r=2===t?"<svg>":"",s=R;for(let t=0;t<n;t++){const n=e[t];let o,c,l=-1,u=0;for(;u<n.length&&(s.lastIndex=u,c=s.exec(n),null!==c);)u=s.lastIndex,s===R?"!--"===c[1]?s=P:void 0!==c[1]?s=N:void 0!==c[2]?(H.test(c[2])&&(a=RegExp("</"+c[2],"g")),s=F):void 0!==c[3]&&(s=F):s===F?">"===c[0]?(s=a??R,l=-1):void 0===c[1]?l=-2:(l=s.lastIndex-c[2].length,o=c[1],s=void 0===c[3]?F:'"'===c[3]?B:V):s===B||s===V?s=F:s===P||s===N?s=R:(s=F,a=void 0);const d=s===F&&e[t+1].startsWith("/>")?" ":"";r+=s===R?n+I:l>=0?(i.push(o),n.slice(0,l)+A+n.slice(l)+T+d):n+T+(-2===l?t:d)}return[Q(e,r+(e[n]||"<?>")+(2===t?"</svg>":"")),i]};class G{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let a=0,r=0;const s=e.length-1,o=this.parts,[c,l]=Y(e,t);if(this.el=G.createElement(c,n),K.currentNode=this.el.content,2===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(i=K.nextNode())&&o.length<s;){if(1===i.nodeType){if(i.hasAttributes())for(const e of i.getAttributeNames())if(e.endsWith(A)){const t=l[r++],n=i.getAttribute(e).split(T),s=/([.?@])?(.*)/.exec(t);o.push({type:1,index:a,name:s[2],strings:n,ctor:"."===s[1]?ne:"?"===s[1]?ie:"@"===s[1]?ae:te}),i.removeAttribute(e)}else e.startsWith(T)&&(o.push({type:6,index:a}),i.removeAttribute(e));if(H.test(i.tagName)){const e=i.textContent.split(T),t=e.length-1;if(t>0){i.textContent=S?S.emptyScript:"";for(let n=0;n<t;n++)i.append(e[n],L()),K.nextNode(),o.push({type:2,index:++a});i.append(e[t],L())}}}else if(8===i.nodeType)if(i.data===$)o.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(T,e+1));)o.push({type:7,index:a}),e+=T.length-1}a++}}static createElement(e,t){const n=O.createElement("template");return n.innerHTML=e,n}}function X(e,t,n=e,i){if(t===q)return t;let a=void 0!==i?n._$Co?.[i]:n._$Cl;const r=D(t)?void 0:t._$litDirective$;return a?.constructor!==r&&(a?._$AO?.(!1),void 0===r?a=void 0:(a=new r(e),a._$AT(e,n,i)),void 0!==i?(n._$Co??=[])[i]=a:n._$Cl=a),void 0!==a&&(t=X(e,a._$AS(e,t.values),a,i)),t}let J=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=(e?.creationScope??O).importNode(t,!0);K.currentNode=i;let a=K.nextNode(),r=0,s=0,o=n[0];for(;void 0!==o;){if(r===o.index){let t;2===o.type?t=new ee(a,a.nextSibling,this,e):1===o.type?t=new o.ctor(a,o.name,o.strings,this,e):6===o.type&&(t=new re(a,this,e)),this._$AV.push(t),o=n[++s]}r!==o?.index&&(a=K.nextNode(),r++)}return K.currentNode=O,i}p(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}};class ee{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=W,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=X(this,e,t),D(e)?e===W||null==e||""===e?(this._$AH!==W&&this._$AR(),this._$AH=W):e!==this._$AH&&e!==q&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>j(e)||"function"==typeof e?.[Symbol.iterator])(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==W&&D(this._$AH)?this._$AA.nextSibling.data=e:this.T(O.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=G.createElement(Q(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(t);else{const e=new J(i,this),n=e.u(this.options);e.p(t),this.T(n),this._$AH=e}}_$AC(e){let t=Z.get(e.strings);return void 0===t&&Z.set(e.strings,t=new G(e)),t}k(e){j(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const a of e)i===t.length?t.push(n=new ee(this.S(L()),this.S(L()),this,this.options)):n=t[i],n._$AI(a),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class te{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,a){this.type=1,this._$AH=W,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=W}_$AI(e,t=this,n,i){const a=this.strings;let r=!1;if(void 0===a)e=X(this,e,t,0),r=!D(e)||e!==this._$AH&&e!==q,r&&(this._$AH=e);else{const i=e;let s,o;for(e=a[0],s=0;s<a.length-1;s++)o=X(this,i[n+s],t,s),o===q&&(o=this._$AH[s]),r||=!D(o)||o!==this._$AH[s],o===W?e=W:e!==W&&(e+=(o??"")+a[s+1]),this._$AH[s]=o}r&&!i&&this.j(e)}j(e){e===W?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class ne extends te{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===W?void 0:e}}class ie extends te{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==W)}}class ae extends te{constructor(e,t,n,i,a){super(e,t,n,i,a),this.type=5}_$AI(e,t=this){if((e=X(this,e,t,0)??W)===q)return;const n=this._$AH,i=e===W&&n!==W||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,a=e!==W&&(n===W||i);i&&this.element.removeEventListener(this.name,this,n),a&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class re{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){X(this,e)}}const se=C.litHtmlPolyfillSupport;se?.(G,ee),(C.litHtmlVersions??=[]).push("3.1.2");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
let oe=class extends k{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{const i=n?.renderBefore??t;let a=i._$litPart$;if(void 0===a){const e=n?.renderBefore??null;i._$litPart$=a=new ee(t.insertBefore(L(),e),e,void 0,n??{})}return a._$AI(e),a})(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return q}};oe._$litElement$=!0,oe.finalized=!0,globalThis.litElementHydrateSupport?.({LitElement:oe});const ce=globalThis.litElementPolyfillSupport;ce?.({LitElement:oe}),(globalThis.litElementVersions??=[]).push("4.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const le=e=>(t,n)=>{void 0!==n?n.addInitializer((()=>{customElements.define(e,t)})):customElements.define(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,ue={attribute:!0,type:String,converter:w,reflect:!1,hasChanged:x},de=(e=ue,t,n)=>{const{kind:i,metadata:a}=n;let r=globalThis.litPropertyMetadata.get(a);if(void 0===r&&globalThis.litPropertyMetadata.set(a,r=new Map),r.set(n.name,e),"accessor"===i){const{name:i}=n;return{set(n){const a=t.get.call(this);t.set.call(this,n),this.requestUpdate(i,a,e)},init(t){return void 0!==t&&this.P(i,void 0,e),t}}}if("setter"===i){const{name:i}=n;return function(n){const a=this[i];t.call(this,n),this.requestUpdate(i,a,e)}}throw Error("Unsupported decorator location: "+i)};function he(e){return(t,n)=>"object"==typeof n?de(e,t,n):((e,t,n)=>{const i=t.hasOwnProperty(n);return t.constructor.createProperty(n,i?{...e,wrapped:!0}:e),i?Object.getOwnPropertyDescriptor(t,n):void 0})(e,t,n)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}function pe(e){return he({...e,state:!0,attribute:!1})}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const me={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},fe=e=>(...t)=>({_$litDirective$:e,values:t});let ge=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const _e=fe(class extends ge{constructor(e){if(super(e),e.type!==me.ATTRIBUTE||"class"!==e.name||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){if(void 0===this.st){this.st=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!this.nt?.has(e)&&this.st.add(e);return this.render(t)}const n=e.element.classList;for(const e of this.st)e in t||(n.remove(e),this.st.delete(e));for(const e in t){const i=!!t[e];i===this.st.has(e)||this.nt?.has(e)||(i?(n.add(e),this.st.add(e)):(n.remove(e),this.st.delete(e)))}return q}}),ve=e=>e??W
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,ye=e=>void 0===e.strings,be={},we=(e,t=be)=>e._$AH=t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,xe=(e,t)=>{const n=e._$AN;if(void 0===n)return!1;for(const e of n)e._$AO?.(t,!1),xe(e,t);return!0},Me=e=>{let t,n;do{if(void 0===(t=e._$AM))break;n=t._$AN,n.delete(e),e=t}while(0===n?.size)},ke=e=>{for(let t;t=e._$AM;e=t){let n=t._$AN;if(void 0===n)t._$AN=n=new Set;else if(n.has(e))break;n.add(e),Ee(t)}};
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Ce(e){void 0!==this._$AN?(Me(this),this._$AM=e,ke(this)):this._$AM=e}function Se(e,t=!1,n=0){const i=this._$AH,a=this._$AN;if(void 0!==a&&0!==a.size)if(t)if(Array.isArray(i))for(let e=n;e<i.length;e++)xe(i[e],!1),Me(i[e]);else null!=i&&(xe(i,!1),Me(i));else xe(this,e)}const Ee=e=>{e.type==me.CHILD&&(e._$AP??=Se,e._$AQ??=Ce)};class Ae extends ge{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,n){super._$AT(e,t,n),ke(this),this.isConnected=e._$AU}_$AO(e,t=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),t&&(xe(this,e),Me(this))}setValue(e){if(ye(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Te=()=>new $e;let $e=class{};const Ie=new WeakMap,Oe=fe(class extends Ae{render(e){return W}update(e,[t]){const n=t!==this.Y;return n&&void 0!==this.Y&&this.rt(void 0),(n||this.lt!==this.ct)&&(this.Y=t,this.ht=e.options?.host,this.rt(this.ct=e.element)),W}rt(e){if("function"==typeof this.Y){const t=this.ht??globalThis;let n=Ie.get(t);void 0===n&&(n=new WeakMap,Ie.set(t,n)),void 0!==n.get(this.Y)&&this.Y.call(this.ht,void 0),n.set(this.Y,e),void 0!==e&&this.Y.call(this.ht,e)}else this.Y.value=e}get lt(){return"function"==typeof this.Y?Ie.get(this.ht??globalThis)?.get(this.Y):this.Y?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),Le="important",De=" !"+Le,je=fe(class extends ge{constructor(e){if(super(e),e.type!==me.ATTRIBUTE||"style"!==e.name||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,n)=>{const i=e[n];return null==i?t:t+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`}),"")}update(e,[t]){const{style:n}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(t)),this.render(t);for(const e of this.ft)null==t[e]&&(this.ft.delete(e),e.includes("-")?n.removeProperty(e):n[e]=null);for(const e in t){const i=t[e];if(null!=i){this.ft.add(e);const t="string"==typeof i&&i.endsWith(De);e.includes("-")||t?n.setProperty(e,t?i.slice(0,-11):i,t?Le:""):n[e]=i}}return q}});
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function ze(e,t,n,i=20,a=0){let r=[];if(a>=i)return r;const s=e=>{const r=e.assignedNodes().filter((e=>1===e.nodeType));return r.length>0?ze(r[0].parentElement,t,n,i,a+1):[]},o=Array.from(e.children||[]);for(const e of o)t(e)||(n(e)&&r.push(e),null!=e.shadowRoot?r.push(...ze(e.shadowRoot,t,n,i,a+1)):"SLOT"===e.tagName?r.push(...s(e)):r.push(...ze(e,t,n,i,a+1)));return r}function Re(e){return e.hasAttribute("hidden")||e.hasAttribute("aria-hidden")&&"false"!==e.getAttribute("aria-hidden")||"none"===e.style.display||"0"===e.style.opacity||"hidden"===e.style.visibility||"collapse"===e.style.visibility}function Pe(e){return"-1"!==e.getAttribute("tabindex")&&!Re(e)&&!function(e){return e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"false"!==e.getAttribute("aria-disabled")}(e)&&(e.hasAttribute("tabindex")||(e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement)&&e.hasAttribute("href")||e instanceof HTMLButtonElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement||e instanceof HTMLIFrameElement)}const Ne=new Map;const Fe=document.createElement("template");Fe.innerHTML='\n\t<div id="start"></div>\n\t<div id="backup"></div>\n\t<slot></slot>\n\t<div id="end"></div>\n';class Ve extends HTMLElement{constructor(){super(),this.debounceId=Math.random().toString(),this._focused=!1;const e=this.attachShadow({mode:"open"});e.appendChild(Fe.content.cloneNode(!0)),this.$backup=e.querySelector("#backup"),this.$start=e.querySelector("#start"),this.$end=e.querySelector("#end"),this.focusLastElement=this.focusLastElement.bind(this),this.focusFirstElement=this.focusFirstElement.bind(this),this.onFocusIn=this.onFocusIn.bind(this),this.onFocusOut=this.onFocusOut.bind(this)}static get observedAttributes(){return["inactive"]}get inactive(){return this.hasAttribute("inactive")}set inactive(e){e?this.setAttribute("inactive",""):this.removeAttribute("inactive")}get focused(){return this._focused}connectedCallback(){this.$start.addEventListener("focus",this.focusLastElement),this.$end.addEventListener("focus",this.focusFirstElement),this.addEventListener("focusin",this.onFocusIn),this.addEventListener("focusout",this.onFocusOut),this.render()}disconnectedCallback(){this.$start.removeEventListener("focus",this.focusLastElement),this.$end.removeEventListener("focus",this.focusFirstElement),this.removeEventListener("focusin",this.onFocusIn),this.removeEventListener("focusout",this.onFocusOut)}attributeChangedCallback(){this.render()}focusFirstElement(){this.trapFocus()}focusLastElement(){this.trapFocus(!0)}getFocusableElements(){return ze(this,Re,Pe)}trapFocus(e){if(this.inactive)return;let t=this.getFocusableElements();t.length>0?(e?t[t.length-1].focus():t[0].focus(),this.$backup.setAttribute("tabindex","-1")):(this.$backup.setAttribute("tabindex","0"),this.$backup.focus())}onFocusIn(){this.updateFocused(!0)}onFocusOut(){this.updateFocused(!1)}updateFocused(e){!function(e,t,n){const i=Ne.get(n);null!=i&&window.clearTimeout(i),Ne.set(n,window.setTimeout((()=>{e(),Ne.delete(n)}),t))}((()=>{this.focused!==e&&(this._focused=e,this.render())}),0,this.debounceId)}render(){this.$start.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.$end.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.focused?this.setAttribute("focused",""):this.removeAttribute("focused")}}function Be(e){return Number(e.getAttribute("data-dialog-count"))||0}function He(e,t){e.setAttribute("data-dialog-count",t.toString())}function Ue(e=document.activeElement){return null!=e&&null!=e.shadowRoot&&null!=e.shadowRoot.activeElement?Ue(e.shadowRoot.activeElement):e}window.customElements.define("focus-trap",Ve);const qe=document.createElement("template");qe.innerHTML='\n  <style>*{box-sizing:border-box}:host{padding:var(--dialog-container-padding,5vw 24px);z-index:var(--dialog-z-index,12345678);outline:none}#backdrop,:host{position:fixed;top:0;left:0;bottom:0;right:0}:host,:host([center]) #dialog{overflow-x:var(--dialog-overflow-x,hidden);overflow-y:var(--dialog-overflow-y,auto);overscroll-behavior:contain;-webkit-overflow-scrolling:touch}:host([center]){display:flex;align-items:center;justify-content:center;overflow:hidden}:host([center]) #dialog{max-height:var(--dialog-max-height,100%)}:host(:not(:defined)),:host(:not([open])){display:none}#backdrop{background:var(--dialog-backdrop-bg,rgba(0,0,0,.6));animation:fadeIn var(--dialog-animation-duration,.1s) var(--dialog-animation-easing,ease-out);z-index:-1}#dialog{animation:scaleIn var(--dialog-animation-duration,.1s) var(--dialog-animation-easing,ease-out);border-radius:var(--dialog-border-radius,12px);box-shadow:var(--dialog-box-shadow,0 2px 10px -5px rgba(0,0,0,.6));max-width:var(--dialog-max-width,700px);width:var(--dialog-width,100%);padding:var(--dialog-padding,24px);max-height:var(--dialog-max-height,unset);height:var(--dialog-height,auto);color:var(--dialog-color,currentColor);background:var(--dialog-bg,#fff);z-index:1;position:relative;display:flex;flex-direction:column;margin:0 auto;border:none}::slotted(article),article{flex-grow:1;overflow-y:auto;-webkit-overflow-scrolling:touch}::slotted(footer),::slotted(header),footer,header{flex-shrink:0}@keyframes scaleIn{0%{transform:scale(.9) translateY(30px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}</style>\n  <div id="backdrop" part="backdrop"></div>\n  <focus-trap id="dialog" part="dialog">\n    <slot></slot>\n  </focus-trap>\n';class We extends HTMLElement{constructor(){super(),this.$scrollContainer=document.documentElement,this.$previousActiveElement=null;const e=this.attachShadow({mode:"open"});e.appendChild(qe.content.cloneNode(!0)),this.$dialog=e.querySelector("#dialog"),this.$backdrop=e.querySelector("#backdrop"),this.onBackdropClick=this.onBackdropClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.setAttribute("aria-modal","true"),this.$dialog.setAttribute("role","alertdialog")}static get observedAttributes(){return["open","center"]}get open(){return this.hasAttribute("open")}set open(e){e?this.setAttribute("open",""):this.removeAttribute("open")}get center(){return this.hasAttribute("center")}set center(e){e?this.setAttribute("center",""):this.removeAttribute("center")}connectedCallback(){this.$backdrop.addEventListener("click",this.onBackdropClick)}disconnectedCallback(){this.$backdrop.removeEventListener("click",this.onBackdropClick),this.open&&this.didClose()}show(){this.open=!0}close(e){this.result=e,this.open=!1}onBackdropClick(){this.assertClosing()&&this.close()}onKeyDown(e){if("Escape"===e.code)this.assertClosing()&&(this.close(),e.stopImmediatePropagation())}assertClosing(){return this.dispatchEvent(new CustomEvent("closing",{cancelable:!0}))}didOpen(){this.$previousActiveElement=Ue(document.activeElement),requestAnimationFrame((()=>{this.$dialog.focusFirstElement()})),this.tabIndex=0,this.$scrollContainer.style.overflow="hidden",this.addEventListener("keydown",this.onKeyDown,{capture:!0,passive:!0}),He(this.$scrollContainer,Be(this.$scrollContainer)+1),this.dispatchEvent(new CustomEvent("open"))}didClose(){this.removeEventListener("keydown",this.onKeyDown,{capture:!0}),He(this.$scrollContainer,Math.max(0,Be(this.$scrollContainer)-1)),Be(this.$scrollContainer)<=0&&(this.$scrollContainer.style.overflow=""),this.tabIndex=-1,null!=this.$previousActiveElement&&(this.$previousActiveElement.focus(),this.$previousActiveElement=null),this.dispatchEvent(new CustomEvent("close",{detail:this.result}))}attributeChangedCallback(e,t,n){if("open"===e)this.open?this.didOpen():this.didClose()}}customElements.define("web-dialog",We);const Ze=(e,t,n,i)=>{e.dispatchEvent(new CustomEvent(t,{bubbles:i?.bubbles??!0,composed:i?.composed??!0,cancelable:i?.cancelable??!1,detail:n}))};var Ke,Qe;!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),i={};for(const e of n)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(Ke||(Ke={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(Qe||(Qe={}));const Ye=Ke.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ge=e=>{switch(typeof e){case"undefined":return Ye.undefined;case"string":return Ye.string;case"number":return isNaN(e)?Ye.nan:Ye.number;case"boolean":return Ye.boolean;case"function":return Ye.function;case"bigint":return Ye.bigint;case"symbol":return Ye.symbol;case"object":return Array.isArray(e)?Ye.array:null===e?Ye.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Ye.promise:"undefined"!=typeof Map&&e instanceof Map?Ye.map:"undefined"!=typeof Set&&e instanceof Set?Ye.set:"undefined"!=typeof Date&&e instanceof Date?Ye.date:Ye.object;default:return Ye.unknown}},Xe=Ke.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Je extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},i=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(i);else if("invalid_return_type"===a.code)i(a.returnTypeError);else if("invalid_arguments"===a.code)i(a.argumentsError);else if(0===a.path.length)n._errors.push(t(a));else{let e=n,i=0;for(;i<a.path.length;){const n=a.path[i];i===a.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(a))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(this),n}static assert(e){if(!(e instanceof Je))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ke.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}Je.create=e=>new Je(e);const et=(e,t)=>{let n;switch(e.code){case Xe.invalid_type:n=e.received===Ye.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Xe.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Ke.jsonStringifyReplacer)}`;break;case Xe.unrecognized_keys:n=`Unrecognized key(s) in object: ${Ke.joinValues(e.keys,", ")}`;break;case Xe.invalid_union:n="Invalid input";break;case Xe.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Ke.joinValues(e.options)}`;break;case Xe.invalid_enum_value:n=`Invalid enum value. Expected ${Ke.joinValues(e.options)}, received '${e.received}'`;break;case Xe.invalid_arguments:n="Invalid function arguments";break;case Xe.invalid_return_type:n="Invalid function return type";break;case Xe.invalid_date:n="Invalid date";break;case Xe.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Ke.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Xe.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Xe.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Xe.custom:n="Invalid input";break;case Xe.invalid_intersection_types:n="Intersection results could not be merged";break;case Xe.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Xe.not_finite:n="Number must be finite";break;default:n=t.defaultError,Ke.assertNever(e)}return{message:n}};let tt=et;function nt(){return tt}const it=e=>{const{data:t,path:n,errorMaps:i,issueData:a}=e,r=[...n,...a.path||[]],s={...a,path:r};if(void 0!==a.message)return{...a,path:r,message:a.message};let o="";const c=i.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(s,{data:t,defaultError:o}).message;return{...a,path:r,message:o}};function at(e,t){const n=nt(),i=it({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===et?void 0:et].filter((e=>!!e))});e.common.issues.push(i)}class rt{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if("aborted"===i.status)return st;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,i=await e.value;n.push({key:t,value:i})}return rt.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:t,value:a}=i;if("aborted"===t.status)return st;if("aborted"===a.status)return st;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!i.alwaysSet||(n[t.value]=a.value)}return{status:e.value,value:n}}}const st=Object.freeze({status:"aborted"}),ot=e=>({status:"dirty",value:e}),ct=e=>({status:"valid",value:e}),lt=e=>"aborted"===e.status,ut=e=>"dirty"===e.status,dt=e=>"valid"===e.status,ht=e=>"undefined"!=typeof Promise&&e instanceof Promise;function pt(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function mt(e,t,n,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,n):a?a.value=n:t.set(e,n),n}var ft,gt,_t;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(ft||(ft={}));class vt{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const yt=(e,t)=>{if(dt(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Je(e.common.issues);return this._error=t,this._error}}};function bt(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:a}=e;if(t&&(n||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{var r,s;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:a.defaultError}:void 0===a.data?{message:null!==(r=null!=o?o:i)&&void 0!==r?r:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(s=null!=o?o:n)&&void 0!==s?s:a.defaultError}},description:a}}class wt{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Ge(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ge(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new rt,ctx:{common:e.parent.common,data:e.data,parsedType:Ge(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(ht(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ge(e)},a=this._parseSync({data:e,path:i.path,parent:i});return yt(i,a)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ge(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(ht(i)?i:Promise.resolve(i));return yt(n,a)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,i)=>{const a=e(t),r=()=>i.addIssue({code:Xe.custom,...n(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(r(),!1))):!!a||(r(),!1)}))}refinement(e,t){return this._refinement(((n,i)=>!!e(n)||(i.addIssue("function"==typeof t?t(n,i):t),!1)))}_refinement(e){return new _n({schema:this,typeName:Tn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return vn.create(this,this._def)}nullable(){return yn.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Gt.create(this,this._def)}promise(){return gn.create(this,this._def)}or(e){return en.create([this,e],this._def)}and(e){return rn.create(this,e,this._def)}transform(e){return new _n({...bt(this._def),schema:this,typeName:Tn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new bn({...bt(this._def),innerType:this,defaultValue:t,typeName:Tn.ZodDefault})}brand(){return new kn({typeName:Tn.ZodBranded,type:this,...bt(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new wn({...bt(this._def),innerType:this,catchValue:t,typeName:Tn.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return Cn.create(this,e)}readonly(){return Sn.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const xt=/^c[^\s-]{8,}$/i,Mt=/^[0-9a-z]+$/,kt=/^[0-9A-HJKMNP-TV-Z]{26}$/,Ct=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,St=/^[a-z0-9_-]{21}$/i,Et=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,At=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Tt;const $t=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,It=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Ot=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Lt="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Dt=new RegExp(`^${Lt}$`);function jt(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function zt(e){let t=`${Lt}T${jt(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Rt(e,t){return!("v4"!==t&&t||!$t.test(e))||!("v6"!==t&&t||!It.test(e))}class Pt extends wt{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==Ye.string){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.string,received:t.parsedType}),st}const t=new rt;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const a=e.data.length>i.value,r=e.data.length<i.value;(a||r)&&(n=this._getOrReturnCtx(e,n),a?at(n,{code:Xe.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):r&&at(n,{code:Xe.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)At.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"email",code:Xe.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)Tt||(Tt=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Tt.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"emoji",code:Xe.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)Ct.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"uuid",code:Xe.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)St.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"nanoid",code:Xe.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)xt.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"cuid",code:Xe.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)Mt.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"cuid2",code:Xe.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)kt.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"ulid",code:Xe.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(a){n=this._getOrReturnCtx(e,n),at(n,{validation:"url",code:Xe.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"regex",code:Xe.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){zt(i).test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){Dt.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${jt(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?Et.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"duration",code:Xe.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?Rt(e.data,i.version)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"ip",code:Xe.invalid_string,message:i.message}),t.dirty()):"base64"===i.kind?Ot.test(e.data)||(n=this._getOrReturnCtx(e,n),at(n,{validation:"base64",code:Xe.invalid_string,message:i.message}),t.dirty()):Ke.assertNever(i);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:Xe.invalid_string,...ft.errToObj(n)})}_addCheck(e){return new Pt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ft.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ft.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ft.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ft.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ft.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ft.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ft.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ft.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ft.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ft.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...ft.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...ft.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ft.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...ft.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...ft.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...ft.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...ft.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...ft.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...ft.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...ft.errToObj(t)})}nonempty(e){return this.min(1,ft.errToObj(e))}trim(){return new Pt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Pt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Pt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Nt(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,a=n>i?n:i;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}Pt.create=e=>{var t;return new Pt({checks:[],typeName:Tn.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...bt(e)})};class Ft extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==Ye.number){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.number,received:t.parsedType}),st}let t;const n=new rt;for(const i of this._def.checks)if("int"===i.kind)Ke.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty());else if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else"multipleOf"===i.kind?0!==Nt(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.not_finite,message:i.message}),n.dirty()):Ke.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ft.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ft.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ft.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ft.toString(t))}setLimit(e,t,n,i){return new Ft({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ft.toString(i)}]})}_addCheck(e){return new Ft({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ft.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ft.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ft.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ft.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ft.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ft.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:ft.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ft.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ft.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&Ke.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Ft.create=e=>new Ft({checks:[],typeName:Tn.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...bt(e)});class Vt extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==Ye.bigint){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.bigint,received:t.parsedType}),st}let t;const n=new rt;for(const i of this._def.checks)if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),at(t,{code:Xe.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Ke.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,ft.toString(t))}gt(e,t){return this.setLimit("min",e,!1,ft.toString(t))}lte(e,t){return this.setLimit("max",e,!0,ft.toString(t))}lt(e,t){return this.setLimit("max",e,!1,ft.toString(t))}setLimit(e,t,n,i){return new Vt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:ft.toString(i)}]})}_addCheck(e){return new Vt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ft.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ft.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ft.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ft.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:ft.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Vt.create=e=>{var t;return new Vt({checks:[],typeName:Tn.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...bt(e)})};class Bt extends wt{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==Ye.boolean){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.boolean,received:t.parsedType}),st}return ct(e.data)}}Bt.create=e=>new Bt({typeName:Tn.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...bt(e)});class Ht extends wt{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==Ye.date){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.date,received:t.parsedType}),st}if(isNaN(e.data.getTime())){return at(this._getOrReturnCtx(e),{code:Xe.invalid_date}),st}const t=new rt;let n;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),at(n,{code:Xe.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):Ke.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ht({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:ft.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:ft.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Ht.create=e=>new Ht({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Tn.ZodDate,...bt(e)});class Ut extends wt{_parse(e){if(this._getType(e)!==Ye.symbol){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.symbol,received:t.parsedType}),st}return ct(e.data)}}Ut.create=e=>new Ut({typeName:Tn.ZodSymbol,...bt(e)});class qt extends wt{_parse(e){if(this._getType(e)!==Ye.undefined){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.undefined,received:t.parsedType}),st}return ct(e.data)}}qt.create=e=>new qt({typeName:Tn.ZodUndefined,...bt(e)});class Wt extends wt{_parse(e){if(this._getType(e)!==Ye.null){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.null,received:t.parsedType}),st}return ct(e.data)}}Wt.create=e=>new Wt({typeName:Tn.ZodNull,...bt(e)});class Zt extends wt{constructor(){super(...arguments),this._any=!0}_parse(e){return ct(e.data)}}Zt.create=e=>new Zt({typeName:Tn.ZodAny,...bt(e)});class Kt extends wt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ct(e.data)}}Kt.create=e=>new Kt({typeName:Tn.ZodUnknown,...bt(e)});class Qt extends wt{_parse(e){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.never,received:t.parsedType}),st}}Qt.create=e=>new Qt({typeName:Tn.ZodNever,...bt(e)});class Yt extends wt{_parse(e){if(this._getType(e)!==Ye.undefined){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.void,received:t.parsedType}),st}return ct(e.data)}}Yt.create=e=>new Yt({typeName:Tn.ZodVoid,...bt(e)});class Gt extends wt{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==Ye.array)return at(t,{code:Xe.invalid_type,expected:Ye.array,received:t.parsedType}),st;if(null!==i.exactLength){const e=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(e||a)&&(at(t,{code:e?Xe.too_big:Xe.too_small,minimum:a?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(at(t,{code:Xe.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(at(t,{code:Xe.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>i.type._parseAsync(new vt(t,e,t.path,n))))).then((e=>rt.mergeArray(n,e)));const a=[...t.data].map(((e,n)=>i.type._parseSync(new vt(t,e,t.path,n))));return rt.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new Gt({...this._def,minLength:{value:e,message:ft.toString(t)}})}max(e,t){return new Gt({...this._def,maxLength:{value:e,message:ft.toString(t)}})}length(e,t){return new Gt({...this._def,exactLength:{value:e,message:ft.toString(t)}})}nonempty(e){return this.min(1,e)}}function Xt(e){if(e instanceof Jt){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=vn.create(Xt(i))}return new Jt({...e._def,shape:()=>t})}return e instanceof Gt?new Gt({...e._def,type:Xt(e.element)}):e instanceof vn?vn.create(Xt(e.unwrap())):e instanceof yn?yn.create(Xt(e.unwrap())):e instanceof sn?sn.create(e.items.map((e=>Xt(e)))):e}Gt.create=(e,t)=>new Gt({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Tn.ZodArray,...bt(t)});class Jt extends wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=Ke.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Ye.object){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.object,received:t.parsedType}),st}const{status:t,ctx:n}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),r=[];if(!(this._def.catchall instanceof Qt&&"strip"===this._def.unknownKeys))for(const e in n.data)a.includes(e)||r.push(e);const s=[];for(const e of a){const t=i[e],a=n.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new vt(n,a,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof Qt){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of r)s.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)r.length>0&&(at(n,{code:Xe.unrecognized_keys,keys:r}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of r){const i=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new vt(n,i,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const n=await t.key,i=await t.value;e.push({key:n,value:i,alwaysSet:t.alwaysSet})}return e})).then((e=>rt.mergeObjectSync(t,e))):rt.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return ft.errToObj,new Jt({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var i,a,r,s;const o=null!==(r=null===(a=(i=this._def).errorMap)||void 0===a?void 0:a.call(i,t,n).message)&&void 0!==r?r:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=ft.errToObj(e).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new Jt({...this._def,unknownKeys:"strip"})}passthrough(){return new Jt({...this._def,unknownKeys:"passthrough"})}extend(e){return new Jt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Jt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Tn.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Jt({...this._def,catchall:e})}pick(e){const t={};return Ke.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new Jt({...this._def,shape:()=>t})}omit(e){const t={};return Ke.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new Jt({...this._def,shape:()=>t})}deepPartial(){return Xt(this)}partial(e){const t={};return Ke.objectKeys(this.shape).forEach((n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()})),new Jt({...this._def,shape:()=>t})}required(e){const t={};return Ke.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof vn;)e=e._def.innerType;t[n]=e}})),new Jt({...this._def,shape:()=>t})}keyof(){return pn(Ke.objectKeys(this.shape))}}Jt.create=(e,t)=>new Jt({shape:()=>e,unknownKeys:"strip",catchall:Qt.create(),typeName:Tn.ZodObject,...bt(t)}),Jt.strictCreate=(e,t)=>new Jt({shape:()=>e,unknownKeys:"strict",catchall:Qt.create(),typeName:Tn.ZodObject,...bt(t)}),Jt.lazycreate=(e,t)=>new Jt({shape:e,unknownKeys:"strip",catchall:Qt.create(),typeName:Tn.ZodObject,...bt(t)});class en extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new Je(e.ctx.common.issues)));return at(t,{code:Xe.invalid_union,unionErrors:n}),st}));{let e;const i=[];for(const a of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&i.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=i.map((e=>new Je(e)));return at(t,{code:Xe.invalid_union,unionErrors:a}),st}}get options(){return this._def.options}}en.create=(e,t)=>new en({options:e,typeName:Tn.ZodUnion,...bt(t)});const tn=e=>e instanceof dn?tn(e.schema):e instanceof _n?tn(e.innerType()):e instanceof hn?[e.value]:e instanceof mn?e.options:e instanceof fn?Ke.objectValues(e.enum):e instanceof bn?tn(e._def.innerType):e instanceof qt?[void 0]:e instanceof Wt?[null]:e instanceof vn?[void 0,...tn(e.unwrap())]:e instanceof yn?[null,...tn(e.unwrap())]:e instanceof kn||e instanceof Sn?tn(e.unwrap()):e instanceof wn?tn(e._def.innerType):[];class nn extends wt{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ye.object)return at(t,{code:Xe.invalid_type,expected:Ye.object,received:t.parsedType}),st;const n=this.discriminator,i=t.data[n],a=this.optionsMap.get(i);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(at(t,{code:Xe.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),st)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const n of t){const t=tn(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,n)}}return new nn({typeName:Tn.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...bt(n)})}}function an(e,t){const n=Ge(e),i=Ge(t);if(e===t)return{valid:!0,data:e};if(n===Ye.object&&i===Ye.object){const n=Ke.objectKeys(t),i=Ke.objectKeys(e).filter((e=>-1!==n.indexOf(e))),a={...e,...t};for(const n of i){const i=an(e[n],t[n]);if(!i.valid)return{valid:!1};a[n]=i.data}return{valid:!0,data:a}}if(n===Ye.array&&i===Ye.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const a=an(e[i],t[i]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}return n===Ye.date&&i===Ye.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class rn extends wt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(e,i)=>{if(lt(e)||lt(i))return st;const a=an(e.value,i.value);return a.valid?((ut(e)||ut(i))&&t.dirty(),{status:t.value,value:a.data}):(at(n,{code:Xe.invalid_intersection_types}),st)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>i(e,t))):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}rn.create=(e,t,n)=>new rn({left:e,right:t,typeName:Tn.ZodIntersection,...bt(n)});class sn extends wt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.array)return at(n,{code:Xe.invalid_type,expected:Ye.array,received:n.parsedType}),st;if(n.data.length<this._def.items.length)return at(n,{code:Xe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),st;!this._def.rest&&n.data.length>this._def.items.length&&(at(n,{code:Xe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map(((e,t)=>{const i=this._def.items[t]||this._def.rest;return i?i._parse(new vt(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(i).then((e=>rt.mergeArray(t,e))):rt.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new sn({...this._def,rest:e})}}sn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new sn({items:e,typeName:Tn.ZodTuple,rest:null,...bt(t)})};class on extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.object)return at(n,{code:Xe.invalid_type,expected:Ye.object,received:n.parsedType}),st;const i=[],a=this._def.keyType,r=this._def.valueType;for(const e in n.data)i.push({key:a._parse(new vt(n,e,n.path,e)),value:r._parse(new vt(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?rt.mergeObjectAsync(t,i):rt.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return new on(t instanceof wt?{keyType:e,valueType:t,typeName:Tn.ZodRecord,...bt(n)}:{keyType:Pt.create(),valueType:e,typeName:Tn.ZodRecord,...bt(t)})}}class cn extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.map)return at(n,{code:Xe.invalid_type,expected:Ye.map,received:n.parsedType}),st;const i=this._def.keyType,a=this._def.valueType,r=[...n.data.entries()].map((([e,t],r)=>({key:i._parse(new vt(n,e,n.path,[r,"key"])),value:a._parse(new vt(n,t,n.path,[r,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of r){const i=await n.key,a=await n.value;if("aborted"===i.status||"aborted"===a.status)return st;"dirty"!==i.status&&"dirty"!==a.status||t.dirty(),e.set(i.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of r){const i=n.key,a=n.value;if("aborted"===i.status||"aborted"===a.status)return st;"dirty"!==i.status&&"dirty"!==a.status||t.dirty(),e.set(i.value,a.value)}return{status:t.value,value:e}}}}cn.create=(e,t,n)=>new cn({valueType:t,keyType:e,typeName:Tn.ZodMap,...bt(n)});class ln extends wt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==Ye.set)return at(n,{code:Xe.invalid_type,expected:Ye.set,received:n.parsedType}),st;const i=this._def;null!==i.minSize&&n.data.size<i.minSize.value&&(at(n,{code:Xe.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&n.data.size>i.maxSize.value&&(at(n,{code:Xe.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const a=this._def.valueType;function r(e){const n=new Set;for(const i of e){if("aborted"===i.status)return st;"dirty"===i.status&&t.dirty(),n.add(i.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map(((e,t)=>a._parse(new vt(n,e,n.path,t))));return n.common.async?Promise.all(s).then((e=>r(e))):r(s)}min(e,t){return new ln({...this._def,minSize:{value:e,message:ft.toString(t)}})}max(e,t){return new ln({...this._def,maxSize:{value:e,message:ft.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ln.create=(e,t)=>new ln({valueType:e,minSize:null,maxSize:null,typeName:Tn.ZodSet,...bt(t)});class un extends wt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ye.function)return at(t,{code:Xe.invalid_type,expected:Ye.function,received:t.parsedType}),st;function n(e,n){return it({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,nt(),et].filter((e=>!!e)),issueData:{code:Xe.invalid_arguments,argumentsError:n}})}function i(e,n){return it({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,nt(),et].filter((e=>!!e)),issueData:{code:Xe.invalid_return_type,returnTypeError:n}})}const a={errorMap:t.common.contextualErrorMap},r=t.data;if(this._def.returns instanceof gn){const e=this;return ct((async function(...t){const s=new Je([]),o=await e._def.args.parseAsync(t,a).catch((e=>{throw s.addIssue(n(t,e)),s})),c=await Reflect.apply(r,this,o),l=await e._def.returns._def.type.parseAsync(c,a).catch((e=>{throw s.addIssue(i(c,e)),s}));return l}))}{const e=this;return ct((function(...t){const s=e._def.args.safeParse(t,a);if(!s.success)throw new Je([n(t,s.error)]);const o=Reflect.apply(r,this,s.data),c=e._def.returns.safeParse(o,a);if(!c.success)throw new Je([i(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new un({...this._def,args:sn.create(e).rest(Kt.create())})}returns(e){return new un({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new un({args:e||sn.create([]).rest(Kt.create()),returns:t||Kt.create(),typeName:Tn.ZodFunction,...bt(n)})}}class dn extends wt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}dn.create=(e,t)=>new dn({getter:e,typeName:Tn.ZodLazy,...bt(t)});class hn extends wt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return at(t,{received:t.data,code:Xe.invalid_literal,expected:this._def.value}),st}return{status:"valid",value:e.data}}get value(){return this._def.value}}function pn(e,t){return new mn({values:e,typeName:Tn.ZodEnum,...bt(t)})}hn.create=(e,t)=>new hn({value:e,typeName:Tn.ZodLiteral,...bt(t)});class mn extends wt{constructor(){super(...arguments),gt.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return at(t,{expected:Ke.joinValues(n),received:t.parsedType,code:Xe.invalid_type}),st}if(pt(this,gt,"f")||mt(this,gt,new Set(this._def.values),"f"),!pt(this,gt,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return at(t,{received:t.data,code:Xe.invalid_enum_value,options:n}),st}return ct(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return mn.create(e,{...this._def,...t})}exclude(e,t=this._def){return mn.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}gt=new WeakMap,mn.create=pn;class fn extends wt{constructor(){super(...arguments),_t.set(this,void 0)}_parse(e){const t=Ke.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==Ye.string&&n.parsedType!==Ye.number){const e=Ke.objectValues(t);return at(n,{expected:Ke.joinValues(e),received:n.parsedType,code:Xe.invalid_type}),st}if(pt(this,_t,"f")||mt(this,_t,new Set(Ke.getValidEnumValues(this._def.values)),"f"),!pt(this,_t,"f").has(e.data)){const e=Ke.objectValues(t);return at(n,{received:n.data,code:Xe.invalid_enum_value,options:e}),st}return ct(e.data)}get enum(){return this._def.values}}_t=new WeakMap,fn.create=(e,t)=>new fn({values:e,typeName:Tn.ZodNativeEnum,...bt(t)});class gn extends wt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Ye.promise&&!1===t.common.async)return at(t,{code:Xe.invalid_type,expected:Ye.promise,received:t.parsedType}),st;const n=t.parsedType===Ye.promise?t.data:Promise.resolve(t.data);return ct(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}gn.create=(e,t)=>new gn({type:e,typeName:Tn.ZodPromise,...bt(t)});class _n extends wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Tn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:e=>{at(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===i.type){const e=i.transform(n.data,a);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return st;const i=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===i.status?st:"dirty"===i.status||"dirty"===t.value?ot(i.value):i}));{if("aborted"===t.value)return st;const i=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===i.status?st:"dirty"===i.status||"dirty"===t.value?ot(i.value):i}}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,a);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===i.status?st:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?st:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===i.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!dt(e))return e;const r=i.transform(e.value,a);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:r}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>dt(e)?Promise.resolve(i.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}Ke.assertNever(i)}}_n.create=(e,t,n)=>new _n({schema:e,typeName:Tn.ZodEffects,effect:t,...bt(n)}),_n.createWithPreprocess=(e,t,n)=>new _n({schema:t,effect:{type:"preprocess",transform:e},typeName:Tn.ZodEffects,...bt(n)});class vn extends wt{_parse(e){return this._getType(e)===Ye.undefined?ct(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}vn.create=(e,t)=>new vn({innerType:e,typeName:Tn.ZodOptional,...bt(t)});class yn extends wt{_parse(e){return this._getType(e)===Ye.null?ct(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}yn.create=(e,t)=>new yn({innerType:e,typeName:Tn.ZodNullable,...bt(t)});class bn extends wt{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===Ye.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}bn.create=(e,t)=>new bn({innerType:e,typeName:Tn.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...bt(t)});class wn extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return ht(i)?i.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new Je(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}wn.create=(e,t)=>new wn({innerType:e,typeName:Tn.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...bt(t)});class xn extends wt{_parse(e){if(this._getType(e)!==Ye.nan){const t=this._getOrReturnCtx(e);return at(t,{code:Xe.invalid_type,expected:Ye.nan,received:t.parsedType}),st}return{status:"valid",value:e.data}}}xn.create=e=>new xn({typeName:Tn.ZodNaN,...bt(e)});const Mn=Symbol("zod_brand");class kn extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class Cn extends wt{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?st:"dirty"===e.status?(t.dirty(),ot(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?st:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new Cn({in:e,out:t,typeName:Tn.ZodPipeline})}}class Sn extends wt{_parse(e){const t=this._def.innerType._parse(e),n=e=>(dt(e)&&(e.value=Object.freeze(e.value)),e);return ht(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function En(e,t={},n){return e?Zt.create().superRefine(((i,a)=>{var r,s;if(!e(i)){const e="function"==typeof t?t(i):"string"==typeof t?{message:t}:t,o=null===(s=null!==(r=e.fatal)&&void 0!==r?r:n)||void 0===s||s,c="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...c,fatal:o})}})):Zt.create()}Sn.create=(e,t)=>new Sn({innerType:e,typeName:Tn.ZodReadonly,...bt(t)});const An={object:Jt.lazycreate};var Tn;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Tn||(Tn={}));const $n=Pt.create,In=Ft.create,On=xn.create,Ln=Vt.create,Dn=Bt.create,jn=Ht.create,zn=Ut.create,Rn=qt.create,Pn=Wt.create,Nn=Zt.create,Fn=Kt.create,Vn=Qt.create,Bn=Yt.create,Hn=Gt.create,Un=Jt.create,qn=Jt.strictCreate,Wn=en.create,Zn=nn.create,Kn=rn.create,Qn=sn.create,Yn=on.create,Gn=cn.create,Xn=ln.create,Jn=un.create,ei=dn.create,ti=hn.create,ni=mn.create,ii=fn.create,ai=gn.create,ri=_n.create,si=vn.create,oi=yn.create,ci=_n.createWithPreprocess,li=Cn.create,ui={string:e=>Pt.create({...e,coerce:!0}),number:e=>Ft.create({...e,coerce:!0}),boolean:e=>Bt.create({...e,coerce:!0}),bigint:e=>Vt.create({...e,coerce:!0}),date:e=>Ht.create({...e,coerce:!0})},di=st;var hi=Object.freeze({__proto__:null,defaultErrorMap:et,setErrorMap:function(e){tt=e},getErrorMap:nt,makeIssue:it,EMPTY_PATH:[],addIssueToContext:at,ParseStatus:rt,INVALID:st,DIRTY:ot,OK:ct,isAborted:lt,isDirty:ut,isValid:dt,isAsync:ht,get util(){return Ke},get objectUtil(){return Qe},ZodParsedType:Ye,getParsedType:Ge,ZodType:wt,datetimeRegex:zt,ZodString:Pt,ZodNumber:Ft,ZodBigInt:Vt,ZodBoolean:Bt,ZodDate:Ht,ZodSymbol:Ut,ZodUndefined:qt,ZodNull:Wt,ZodAny:Zt,ZodUnknown:Kt,ZodNever:Qt,ZodVoid:Yt,ZodArray:Gt,ZodObject:Jt,ZodUnion:en,ZodDiscriminatedUnion:nn,ZodIntersection:rn,ZodTuple:sn,ZodRecord:on,ZodMap:cn,ZodSet:ln,ZodFunction:un,ZodLazy:dn,ZodLiteral:hn,ZodEnum:mn,ZodNativeEnum:fn,ZodPromise:gn,ZodEffects:_n,ZodTransformer:_n,ZodOptional:vn,ZodNullable:yn,ZodDefault:bn,ZodCatch:wn,ZodNaN:xn,BRAND:Mn,ZodBranded:kn,ZodPipeline:Cn,ZodReadonly:Sn,custom:En,Schema:wt,ZodSchema:wt,late:An,get ZodFirstPartyTypeKind(){return Tn},coerce:ui,any:Nn,array:Hn,bigint:Ln,boolean:Dn,date:jn,discriminatedUnion:Zn,effect:ri,enum:ni,function:Jn,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>En((t=>t instanceof e),t),intersection:Kn,lazy:ei,literal:ti,map:Gn,nan:On,nativeEnum:ii,never:Vn,null:Pn,nullable:oi,number:In,object:Un,oboolean:()=>Dn().optional(),onumber:()=>In().optional(),optional:si,ostring:()=>$n().optional(),pipeline:li,preprocess:ci,promise:ai,record:Yn,set:Xn,strictObject:qn,string:$n,symbol:zn,transformer:ri,tuple:Qn,undefined:Rn,union:Wn,unknown:Fn,void:Bn,NEVER:di,ZodIssueCode:Xe,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Je});const pi=/^[-\w]+$/,mi=100,fi=100,gi=20,_i="live",vi=["diagnostics","live","clip","clips","folder","folders","snapshot","snapshots","recording","recordings","image","timeline"],yi=hi.object({confirmation:hi.boolean().or(hi.object({text:hi.string().optional(),exemptions:hi.object({user:hi.string()}).array().optional()})).optional(),card_id:hi.string().regex(pi,"card_id parameter can only contain [a-z][A-Z][0-9_]-").optional()}),bi=yi.extend({action:hi.literal("fire-dom-event").or(hi.literal("custom:advanced-camera-card-action").transform((()=>"fire-dom-event")))}),wi="__INTERNAL_CALLBACK_ACTION__",xi=bi.extend({advanced_camera_card_action:hi.literal(wi),callback:hi.function().args(hi.any()).returns(hi.promise(hi.void()))});function Mi(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}function ki(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Ci(e,t){const n=Mi(e);return isNaN(t)?ki(e,NaN):t?(n.setDate(n.getDate()+t),n):n}function Si(e,t){const n=Mi(e);if(isNaN(t))return ki(e,NaN);if(!t)return n;const i=n.getDate(),a=ki(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);return i>=a.getDate()?a:(n.setFullYear(a.getFullYear(),a.getMonth(),i),n)}function Ei(e,t){const{years:n=0,months:i=0,weeks:a=0,days:r=0,hours:s=0,minutes:o=0,seconds:c=0}=t,l=Mi(e),u=i||n?Si(l,i+12*n):l,d=1e3*(c+60*(o+60*s));return ki(e,(r||a?Ci(u,r+7*a):u).getTime()+d)}const Ai=6048e5,Ti=864e5,$i=6e4,Ii=36e5;let Oi={};function Li(){return Oi}function Di(e,t){const n=Li(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Mi(e),r=a.getDay(),s=(r<i?7:0)+r-i;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function ji(e){return Di(e,{weekStartsOn:1})}function zi(e){const t=Mi(e),n=t.getFullYear(),i=ki(e,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=ji(i),r=ki(e,0);r.setFullYear(n,0,4),r.setHours(0,0,0,0);const s=ji(r);return t.getTime()>=a.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function Ri(e){const t=Mi(e);return t.setHours(0,0,0,0),t}function Pi(e){const t=Mi(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Ni(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const n=Mi(e);return!isNaN(Number(n))}function Fi(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return 0===n?0:n}}function Vi(e,t){return+Mi(e)-+Mi(t)}function Bi(e,t,n){const i=Vi(e,t)/1e3;return Fi(n?.roundingMethod)(i)}const Hi={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function Ui(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const qi={date:Ui({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:Ui({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:Ui({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},Wi={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Zi(e){return(t,n)=>{let i;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=n?.width?String(n.width):t;i=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=n?.width?String(n.width):e.defaultWidth;i=e.values[a]||e.values[t]}return i[e.argumentCallback?e.argumentCallback(t):t]}}function Ki(e){return(t,n={})=>{const i=n.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],r=t.match(a);if(!r)return null;const s=r[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,(e=>e.test(s))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,(e=>e.test(s)));let l;l=e.valueCallback?e.valueCallback(c):c,l=n.valueCallback?n.valueCallback(l):l;return{value:l,rest:t.slice(s.length)}}}var Qi;const Yi={code:"en-US",formatDistance:(e,t,n)=>{let i;const a=Hi[e];return i="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:qi,formatRelative:(e,t,n,i)=>Wi[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Zi({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Zi({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Zi({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Zi({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Zi({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(Qi={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(Qi.matchPattern);if(!n)return null;const i=n[0],a=e.match(Qi.parsePattern);if(!a)return null;let r=Qi.valueCallback?Qi.valueCallback(a[0]):a[0];return r=t.valueCallback?t.valueCallback(r):r,{value:r,rest:e.slice(i.length)}}),era:Ki({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Ki({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ki({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Ki({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Ki({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function Gi(e){const t=Mi(e),n=function(e,t){const n=Ri(e),i=Ri(t),a=+n-Pi(n),r=+i-Pi(i);return Math.round((a-r)/Ti)}(t,function(e){const t=Mi(e),n=ki(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(t));return n+1}function Xi(e){const t=Mi(e),n=+ji(t)-+function(e){const t=zi(e),n=ki(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),ji(n)}(t);return Math.round(n/Ai)+1}function Ji(e,t){const n=Mi(e),i=n.getFullYear(),a=Li(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=ki(e,0);s.setFullYear(i+1,0,r),s.setHours(0,0,0,0);const o=Di(s,t),c=ki(e,0);c.setFullYear(i,0,r),c.setHours(0,0,0,0);const l=Di(c,t);return n.getTime()>=o.getTime()?i+1:n.getTime()>=l.getTime()?i:i-1}function ea(e,t){const n=Mi(e),i=+Di(n,t)-+function(e,t){const n=Li(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=Ji(e,t),r=ki(e,0);return r.setFullYear(a,0,i),r.setHours(0,0,0,0),Di(r,t)}(n,t);return Math.round(i/Ai)+1}function ta(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const na={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return ta("yy"===t?i%100:i,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):ta(n+1,2)},d:(e,t)=>ta(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>ta(e.getHours()%12||12,t.length),H:(e,t)=>ta(e.getHours(),t.length),m:(e,t)=>ta(e.getMinutes(),t.length),s:(e,t)=>ta(e.getSeconds(),t.length),S(e,t){const n=t.length,i=e.getMilliseconds();return ta(Math.trunc(i*Math.pow(10,n-3)),t.length)}},ia="midnight",aa="noon",ra="morning",sa="afternoon",oa="evening",ca="night",la={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),i=t>0?t:1-t;return n.ordinalNumber(i,{unit:"year"})}return na.y(e,t)},Y:function(e,t,n,i){const a=Ji(e,i),r=a>0?a:1-a;if("YY"===t){return ta(r%100,2)}return"Yo"===t?n.ordinalNumber(r,{unit:"year"}):ta(r,t.length)},R:function(e,t){return ta(zi(e),t.length)},u:function(e,t){return ta(e.getFullYear(),t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return ta(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return ta(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return na.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return ta(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const a=ea(e,i);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):ta(a,t.length)},I:function(e,t,n){const i=Xi(e);return"Io"===t?n.ordinalNumber(i,{unit:"week"}):ta(i,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):na.d(e,t)},D:function(e,t,n){const i=Gi(e);return"Do"===t?n.ordinalNumber(i,{unit:"dayOfYear"}):ta(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const a=e.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return ta(r,2);case"eo":return n.ordinalNumber(r,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const a=e.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return ta(r,t.length);case"co":return n.ordinalNumber(r,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),a=0===i?7:i;switch(t){case"i":return String(a);case"ii":return ta(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let a;switch(a=12===i?aa:0===i?ia:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let a;switch(a=i>=17?oa:i>=12?sa:i>=4?ra:ca,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return na.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):na.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return"Ko"===t?n.ordinalNumber(i,{unit:"hour"}):ta(i,t.length)},k:function(e,t,n){let i=e.getHours();return 0===i&&(i=24),"ko"===t?n.ordinalNumber(i,{unit:"hour"}):ta(i,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):na.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):na.s(e,t)},S:function(e,t){return na.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return da(i);case"XXXX":case"XX":return ha(i);default:return ha(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return da(i);case"xxxx":case"xx":return ha(i);default:return ha(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+ua(i,":");default:return"GMT"+ha(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+ua(i,":");default:return"GMT"+ha(i,":")}},t:function(e,t,n){return ta(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return ta(e.getTime(),t.length)}};function ua(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),r=i%60;return 0===r?n+String(a):n+String(a)+t+ta(r,2)}function da(e,t){if(e%60==0){return(e>0?"-":"+")+ta(Math.abs(e)/60,2)}return ha(e,t)}function ha(e,t=""){const n=e>0?"-":"+",i=Math.abs(e);return n+ta(Math.trunc(i/60),2)+t+ta(i%60,2)}const pa=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},ma=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},fa={p:ma,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return pa(e,t);let r;switch(i){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",pa(i,t)).replace("{{time}}",ma(a,t))}},ga=/^D+$/,_a=/^Y+$/,va=["D","DD","YY","YYYY"];function ya(e){return ga.test(e)}function ba(e){return _a.test(e)}function wa(e,t,n){const i=function(e,t,n){const i="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(i),va.includes(e))throw new RangeError(i)}const xa=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ma=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,ka=/^'([^]*?)'?$/,Ca=/''/g,Sa=/[a-zA-Z]/;function Ea(e,t,n){const i=Li(),a=n?.locale??i.locale??Yi,r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,o=Mi(e);if(!Ni(o))throw new RangeError("Invalid time value");let c=t.match(Ma).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,fa[t])(e,a.formatLong)}return e})).join("").match(xa).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:Aa(e)};if(la[t])return{isToken:!0,value:e};if(t.match(Sa))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const l={firstWeekContainsDate:r,weekStartsOn:s,locale:a};return c.map((i=>{if(!i.isToken)return i.value;const r=i.value;(!n?.useAdditionalWeekYearTokens&&ba(r)||!n?.useAdditionalDayOfYearTokens&&ya(r))&&wa(r,t,String(e));return(0,la[r[0]])(o,r,a.localize,l)})).join("")}function Aa(e){const t=e.match(ka);return t?t[1].replace(Ca,"'"):e}class Ta{subPriority=0;validate(e,t){return!0}}class $a extends Ta{constructor(e,t,n,i,a){super(),this.value=e,this.validateValue=t,this.setValue=n,this.priority=i,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,n){return this.setValue(e,t,this.value,n)}}class Ia extends Ta{priority=10;subPriority=-1;set(e,t){return t.timestampIsSet?e:ki(e,function(e,t){const n=t instanceof Date?ki(t,0):new t(0);return n.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),n.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),n}(e,Date))}}class Oa{run(e,t,n,i){const a=this.parse(e,t,n,i);return a?{setter:new $a(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,n){return!0}}const La=/^(1[0-2]|0?\d)/,Da=/^(3[0-1]|[0-2]?\d)/,ja=/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,za=/^(5[0-3]|[0-4]?\d)/,Ra=/^(2[0-3]|[0-1]?\d)/,Pa=/^(2[0-4]|[0-1]?\d)/,Na=/^(1[0-1]|0?\d)/,Fa=/^(1[0-2]|0?\d)/,Va=/^[0-5]?\d/,Ba=/^[0-5]?\d/,Ha=/^\d/,Ua=/^\d{1,2}/,qa=/^\d{1,3}/,Wa=/^\d{1,4}/,Za=/^-?\d+/,Ka=/^-?\d/,Qa=/^-?\d{1,2}/,Ya=/^-?\d{1,3}/,Ga=/^-?\d{1,4}/,Xa=/^([+-])(\d{2})(\d{2})?|Z/,Ja=/^([+-])(\d{2})(\d{2})|Z/,er=/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,tr=/^([+-])(\d{2}):(\d{2})|Z/,nr=/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/;function ir(e,t){return e?{value:t(e.value),rest:e.rest}:e}function ar(e,t){const n=t.match(e);return n?{value:parseInt(n[0],10),rest:t.slice(n[0].length)}:null}function rr(e,t){const n=t.match(e);if(!n)return null;if("Z"===n[0])return{value:0,rest:t.slice(1)};const i="+"===n[1]?1:-1,a=n[2]?parseInt(n[2],10):0,r=n[3]?parseInt(n[3],10):0,s=n[5]?parseInt(n[5],10):0;return{value:i*(a*Ii+r*$i+1e3*s),rest:t.slice(n[0].length)}}function sr(e){return ar(Za,e)}function or(e,t){switch(e){case 1:return ar(Ha,t);case 2:return ar(Ua,t);case 3:return ar(qa,t);case 4:return ar(Wa,t);default:return ar(new RegExp("^\\d{1,"+e+"}"),t)}}function cr(e,t){switch(e){case 1:return ar(Ka,t);case 2:return ar(Qa,t);case 3:return ar(Ya,t);case 4:return ar(Ga,t);default:return ar(new RegExp("^-?\\d{1,"+e+"}"),t)}}function lr(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function ur(e,t){const n=t>0,i=n?t:1-t;let a;if(i<=50)a=e||100;else{const t=i+50;a=e+100*Math.trunc(t/100)-(e>=t%100?100:0)}return n?a:1-a}function dr(e){return e%400==0||e%4==0&&e%100!=0}const hr=[31,28,31,30,31,30,31,31,30,31,30,31],pr=[31,29,31,30,31,30,31,31,30,31,30,31];function mr(e,t,n){const i=Li(),a=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,r=Mi(e),s=r.getDay(),o=7-a;return Ci(r,t<0||t>6?t-(s+o)%7:((t%7+7)%7+o)%7-(s+o)%7)}function fr(e,t){const n=Mi(e),i=function(e){let t=Mi(e).getDay();return 0===t&&(t=7),t}(n);return Ci(n,t-i)}const gr={G:new class extends Oa{priority=140;parse(e,t,n){switch(t){case"G":case"GG":case"GGG":return n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"});case"GGGGG":return n.era(e,{width:"narrow"});default:return n.era(e,{width:"wide"})||n.era(e,{width:"abbreviated"})||n.era(e,{width:"narrow"})}}set(e,t,n){return t.era=n,e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]},y:new class extends Oa{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,n){const i=e=>({year:e,isTwoDigitYear:"yy"===t});switch(t){case"y":return ir(or(4,e),i);case"yo":return ir(n.ordinalNumber(e,{unit:"year"}),i);default:return ir(or(t.length,e),i)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n){const i=e.getFullYear();if(n.isTwoDigitYear){const t=ur(n.year,i);return e.setFullYear(t,0,1),e.setHours(0,0,0,0),e}const a="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},Y:new class extends Oa{priority=130;parse(e,t,n){const i=e=>({year:e,isTwoDigitYear:"YY"===t});switch(t){case"Y":return ir(or(4,e),i);case"Yo":return ir(n.ordinalNumber(e,{unit:"year"}),i);default:return ir(or(t.length,e),i)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,n,i){const a=Ji(e,i);if(n.isTwoDigitYear){const t=ur(n.year,a);return e.setFullYear(t,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Di(e,i)}const r="era"in t&&1!==t.era?1-n.year:n.year;return e.setFullYear(r,0,i.firstWeekContainsDate),e.setHours(0,0,0,0),Di(e,i)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},R:new class extends Oa{priority=130;parse(e,t){return cr("R"===t?4:t.length,e)}set(e,t,n){const i=ki(e,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),ji(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},u:new class extends Oa{priority=130;parse(e,t){return cr("u"===t?4:t.length,e)}set(e,t,n){return e.setFullYear(n,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},Q:new class extends Oa{priority=120;parse(e,t,n){switch(t){case"Q":case"QQ":return or(t.length,e);case"Qo":return n.ordinalNumber(e,{unit:"quarter"});case"QQQ":return n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(e,{width:"narrow",context:"formatting"});default:return n.quarter(e,{width:"wide",context:"formatting"})||n.quarter(e,{width:"abbreviated",context:"formatting"})||n.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},q:new class extends Oa{priority=120;parse(e,t,n){switch(t){case"q":case"qq":return or(t.length,e);case"qo":return n.ordinalNumber(e,{unit:"quarter"});case"qqq":return n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(e,{width:"narrow",context:"standalone"});default:return n.quarter(e,{width:"wide",context:"standalone"})||n.quarter(e,{width:"abbreviated",context:"standalone"})||n.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,n){return e.setMonth(3*(n-1),1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},M:new class extends Oa{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,n){const i=e=>e-1;switch(t){case"M":return ir(ar(La,e),i);case"MM":return ir(or(2,e),i);case"Mo":return ir(n.ordinalNumber(e,{unit:"month"}),i);case"MMM":return n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(e,{width:"narrow",context:"formatting"});default:return n.month(e,{width:"wide",context:"formatting"})||n.month(e,{width:"abbreviated",context:"formatting"})||n.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}},L:new class extends Oa{priority=110;parse(e,t,n){const i=e=>e-1;switch(t){case"L":return ir(ar(La,e),i);case"LL":return ir(or(2,e),i);case"Lo":return ir(n.ordinalNumber(e,{unit:"month"}),i);case"LLL":return n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(e,{width:"narrow",context:"standalone"});default:return n.month(e,{width:"wide",context:"standalone"})||n.month(e,{width:"abbreviated",context:"standalone"})||n.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.setMonth(n,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]},w:new class extends Oa{priority=100;parse(e,t,n){switch(t){case"w":return ar(za,e);case"wo":return n.ordinalNumber(e,{unit:"week"});default:return or(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n,i){return Di(function(e,t,n){const i=Mi(e),a=ea(i,n)-t;return i.setDate(i.getDate()-7*a),i}(e,n,i),i)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]},I:new class extends Oa{priority=100;parse(e,t,n){switch(t){case"I":return ar(za,e);case"Io":return n.ordinalNumber(e,{unit:"week"});default:return or(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,n){return ji(function(e,t){const n=Mi(e),i=Xi(n)-t;return n.setDate(n.getDate()-7*i),n}(e,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]},d:new class extends Oa{priority=90;subPriority=1;parse(e,t,n){switch(t){case"d":return ar(Da,e);case"do":return n.ordinalNumber(e,{unit:"date"});default:return or(t.length,e)}}validate(e,t){const n=dr(e.getFullYear()),i=e.getMonth();return n?t>=1&&t<=pr[i]:t>=1&&t<=hr[i]}set(e,t,n){return e.setDate(n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},D:new class extends Oa{priority=90;subpriority=1;parse(e,t,n){switch(t){case"D":case"DD":return ar(ja,e);case"Do":return n.ordinalNumber(e,{unit:"date"});default:return or(t.length,e)}}validate(e,t){return dr(e.getFullYear())?t>=1&&t<=366:t>=1&&t<=365}set(e,t,n){return e.setMonth(0,n),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]},E:new class extends Oa{priority=90;parse(e,t,n){switch(t){case"E":case"EE":case"EEE":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=mr(e,n,i)).setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},e:new class extends Oa{priority=90;parse(e,t,n,i){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"e":case"ee":return ir(or(t.length,e),a);case"eo":return ir(n.ordinalNumber(e,{unit:"day"}),a);case"eee":return n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});case"eeeee":return n.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"});default:return n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=mr(e,n,i)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},c:new class extends Oa{priority=90;parse(e,t,n,i){const a=e=>{const t=7*Math.floor((e-1)/7);return(e+i.weekStartsOn+6)%7+t};switch(t){case"c":case"cc":return ir(or(t.length,e),a);case"co":return ir(n.ordinalNumber(e,{unit:"day"}),a);case"ccc":return n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});case"ccccc":return n.day(e,{width:"narrow",context:"standalone"});case"cccccc":return n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"});default:return n.day(e,{width:"wide",context:"standalone"})||n.day(e,{width:"abbreviated",context:"standalone"})||n.day(e,{width:"short",context:"standalone"})||n.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,n,i){return(e=mr(e,n,i)).setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]},i:new class extends Oa{priority=90;parse(e,t,n){const i=e=>0===e?7:e;switch(t){case"i":case"ii":return or(t.length,e);case"io":return n.ordinalNumber(e,{unit:"day"});case"iii":return ir(n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiii":return ir(n.day(e,{width:"narrow",context:"formatting"}),i);case"iiiiii":return ir(n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i);default:return ir(n.day(e,{width:"wide",context:"formatting"})||n.day(e,{width:"abbreviated",context:"formatting"})||n.day(e,{width:"short",context:"formatting"})||n.day(e,{width:"narrow",context:"formatting"}),i)}}validate(e,t){return t>=1&&t<=7}set(e,t,n){return(e=fr(e,n)).setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},a:new class extends Oa{priority=80;parse(e,t,n){switch(t){case"a":case"aa":case"aaa":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(lr(n),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},b:new class extends Oa{priority=80;parse(e,t,n){switch(t){case"b":case"bb":case"bbb":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(lr(n),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},B:new class extends Oa{priority=80;parse(e,t,n){switch(t){case"B":case"BB":case"BBB":return n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(e,{width:"narrow",context:"formatting"});default:return n.dayPeriod(e,{width:"wide",context:"formatting"})||n.dayPeriod(e,{width:"abbreviated",context:"formatting"})||n.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,n){return e.setHours(lr(n),0,0,0),e}incompatibleTokens=["a","b","t","T"]},h:new class extends Oa{priority=70;parse(e,t,n){switch(t){case"h":return ar(Fa,e);case"ho":return n.ordinalNumber(e,{unit:"hour"});default:return or(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,n){const i=e.getHours()>=12;return i&&n<12?e.setHours(n+12,0,0,0):i||12!==n?e.setHours(n,0,0,0):e.setHours(0,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},H:new class extends Oa{priority=70;parse(e,t,n){switch(t){case"H":return ar(Ra,e);case"Ho":return n.ordinalNumber(e,{unit:"hour"});default:return or(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,n){return e.setHours(n,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},K:new class extends Oa{priority=70;parse(e,t,n){switch(t){case"K":return ar(Na,e);case"Ko":return n.ordinalNumber(e,{unit:"hour"});default:return or(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,n){return e.getHours()>=12&&n<12?e.setHours(n+12,0,0,0):e.setHours(n,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},k:new class extends Oa{priority=70;parse(e,t,n){switch(t){case"k":return ar(Pa,e);case"ko":return n.ordinalNumber(e,{unit:"hour"});default:return or(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,n){const i=n<=24?n%24:n;return e.setHours(i,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},m:new class extends Oa{priority=60;parse(e,t,n){switch(t){case"m":return ar(Va,e);case"mo":return n.ordinalNumber(e,{unit:"minute"});default:return or(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setMinutes(n,0,0),e}incompatibleTokens=["t","T"]},s:new class extends Oa{priority=50;parse(e,t,n){switch(t){case"s":return ar(Ba,e);case"so":return n.ordinalNumber(e,{unit:"second"});default:return or(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,n){return e.setSeconds(n,0),e}incompatibleTokens=["t","T"]},S:new class extends Oa{priority=30;parse(e,t){return ir(or(t.length,e),(e=>Math.trunc(e*Math.pow(10,3-t.length))))}set(e,t,n){return e.setMilliseconds(n),e}incompatibleTokens=["t","T"]},X:new class extends Oa{priority=10;parse(e,t){switch(t){case"X":return rr(Xa,e);case"XX":return rr(Ja,e);case"XXXX":return rr(er,e);case"XXXXX":return rr(nr,e);default:return rr(tr,e)}}set(e,t,n){return t.timestampIsSet?e:ki(e,e.getTime()-Pi(e)-n)}incompatibleTokens=["t","T","x"]},x:new class extends Oa{priority=10;parse(e,t){switch(t){case"x":return rr(Xa,e);case"xx":return rr(Ja,e);case"xxxx":return rr(er,e);case"xxxxx":return rr(nr,e);default:return rr(tr,e)}}set(e,t,n){return t.timestampIsSet?e:ki(e,e.getTime()-Pi(e)-n)}incompatibleTokens=["t","T","X"]},t:new class extends Oa{priority=40;parse(e){return sr(e)}set(e,t,n){return[ki(e,1e3*n),{timestampIsSet:!0}]}incompatibleTokens="*"},T:new class extends Oa{priority=20;parse(e){return sr(e)}set(e,t,n){return[ki(e,n),{timestampIsSet:!0}]}incompatibleTokens="*"}},_r=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,vr=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,yr=/^'([^]*?)'?$/,br=/''/g,wr=/\S/,xr=/[a-zA-Z]/;function Mr(e,t,n,i){const a=Object.assign({},Li()),r=i?.locale??a.locale??Yi,s=i?.firstWeekContainsDate??i?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,o=i?.weekStartsOn??i?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0;if(""===t)return""===e?Mi(n):ki(n,NaN);const c={firstWeekContainsDate:s,weekStartsOn:o,locale:r},l=[new Ia],u=t.match(vr).map((e=>{const t=e[0];if(t in fa){return(0,fa[t])(e,r.formatLong)}return e})).join("").match(_r),d=[];for(let a of u){!i?.useAdditionalWeekYearTokens&&ba(a)&&wa(a,t,e),!i?.useAdditionalDayOfYearTokens&&ya(a)&&wa(a,t,e);const s=a[0],o=gr[s];if(o){const{incompatibleTokens:t}=o;if(Array.isArray(t)){const e=d.find((e=>t.includes(e.token)||e.token===s));if(e)throw new RangeError(`The format string mustn't contain \`${e.fullToken}\` and \`${a}\` at the same time`)}else if("*"===o.incompatibleTokens&&d.length>0)throw new RangeError(`The format string mustn't contain \`${a}\` and any other token at the same time`);d.push({token:s,fullToken:a});const i=o.run(e,a,r.match,c);if(!i)return ki(n,NaN);l.push(i.setter),e=i.rest}else{if(s.match(xr))throw new RangeError("Format string contains an unescaped latin alphabet character `"+s+"`");if("''"===a?a="'":"'"===s&&(a=a.match(yr)[1].replace(br,"'")),0!==e.indexOf(a))return ki(n,NaN);e=e.slice(a.length)}}if(e.length>0&&wr.test(e))return ki(n,NaN);const h=l.map((e=>e.priority)).sort(((e,t)=>t-e)).filter(((e,t,n)=>n.indexOf(e)===t)).map((e=>l.filter((t=>t.priority===e)).sort(((e,t)=>t.subPriority-e.subPriority)))).map((e=>e[0]));let p=Mi(n);if(isNaN(p.getTime()))return ki(n,NaN);const m={};for(const e of h){if(!e.validate(p,c))return ki(n,NaN);const t=e.set(p,m,c);Array.isArray(t)?(p=t[0],Object.assign(m,t[1])):p=t}return ki(n,p)}function kr(e,t){const{years:n=0,months:i=0,weeks:a=0,days:r=0,hours:s=0,minutes:o=0,seconds:c=0}=t,l=function(e,t){return Si(e,-t)}(e,i+12*n),u=function(e,t){return Ci(e,-t)}(l,r+7*a),d=1e3*(c+60*(o+60*s));return ki(e,u.getTime()-d)}var Cr="object"==typeof global&&global&&global.Object===Object&&global,Sr="object"==typeof self&&self&&self.Object===Object&&self,Er=Cr||Sr||Function("return this")(),Ar=Er.Symbol,Tr=Object.prototype,$r=Tr.hasOwnProperty,Ir=Tr.toString,Or=Ar?Ar.toStringTag:void 0;var Lr=Object.prototype.toString;var Dr="[object Null]",jr="[object Undefined]",zr=Ar?Ar.toStringTag:void 0;function Rr(e){return null==e?void 0===e?jr:Dr:zr&&zr in Object(e)?function(e){var t=$r.call(e,Or),n=e[Or];try{e[Or]=void 0;var i=!0}catch(e){}var a=Ir.call(e);return i&&(t?e[Or]=n:delete e[Or]),a}(e):function(e){return Lr.call(e)}(e)}function Pr(e){return null!=e&&"object"==typeof e}var Nr="[object Symbol]";function Fr(e){return"symbol"==typeof e||Pr(e)&&Rr(e)==Nr}function Vr(e,t){for(var n=-1,i=null==e?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a}var Br=Array.isArray,Hr=1/0,Ur=Ar?Ar.prototype:void 0,qr=Ur?Ur.toString:void 0;function Wr(e){if("string"==typeof e)return e;if(Br(e))return Vr(e,Wr)+"";if(Fr(e))return qr?qr.call(e):"";var t=e+"";return"0"==t&&1/e==-Hr?"-0":t}var Zr=/\s/;var Kr=/^\s+/;function Qr(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Zr.test(e.charAt(t)););return t}(e)+1).replace(Kr,""):e}function Yr(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var Gr=NaN,Xr=/^[-+]0x[0-9a-f]+$/i,Jr=/^0b[01]+$/i,es=/^0o[0-7]+$/i,ts=parseInt;function ns(e){if("number"==typeof e)return e;if(Fr(e))return Gr;if(Yr(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Yr(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=Qr(e);var n=Jr.test(e);return n||es.test(e)?ts(e.slice(2),n?2:8):Xr.test(e)?Gr:+e}var is=1/0,as=17976931348623157e292;function rs(e){var t=function(e){return e?(e=ns(e))===is||e===-is?(e<0?-1:1)*as:e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}function ss(e){return e}var os="[object AsyncFunction]",cs="[object Function]",ls="[object GeneratorFunction]",us="[object Proxy]";function ds(e){if(!Yr(e))return!1;var t=Rr(e);return t==cs||t==ls||t==os||t==us}var hs,ps=Er["__core-js_shared__"],ms=(hs=/[^.]+$/.exec(ps&&ps.keys&&ps.keys.IE_PROTO||""))?"Symbol(src)_1."+hs:"";var fs=Function.prototype.toString;function gs(e){if(null!=e){try{return fs.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var _s=/^\[object .+?Constructor\]$/,vs=Function.prototype,ys=Object.prototype,bs=vs.toString,ws=ys.hasOwnProperty,xs=RegExp("^"+bs.call(ws).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Ms(e){return!(!Yr(e)||(t=e,ms&&ms in t))&&(ds(e)?xs:_s).test(gs(e));var t}function ks(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Ms(n)?n:void 0}var Cs=ks(Er,"WeakMap"),Ss=Object.create,Es=function(){function e(){}return function(t){if(!Yr(t))return{};if(Ss)return Ss(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function As(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}var Ts=Date.now;var $s,Is,Os,Ls=function(){try{var e=ks(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Ds=Ls,js=Ds?function(e,t){return Ds(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:ss,zs=($s=js,Is=0,Os=0,function(){var e=Ts(),t=16-(e-Os);if(Os=e,t>0){if(++Is>=800)return arguments[0]}else Is=0;return $s.apply(void 0,arguments)});function Rs(e){return e!=e}function Ps(e,t){return!!(null==e?0:e.length)&&function(e,t,n){return t==t?function(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}(e,t,n):function(e,t,n,i){for(var a=e.length,r=n+(i?1:-1);i?r--:++r<a;)if(t(e[r],r,e))return r;return-1}(e,Rs,n)}(e,t,0)>-1}var Ns=9007199254740991,Fs=/^(?:0|[1-9]\d*)$/;function Vs(e,t){var n=typeof e;return!!(t=null==t?Ns:t)&&("number"==n||"symbol"!=n&&Fs.test(e))&&e>-1&&e%1==0&&e<t}function Bs(e,t,n){"__proto__"==t&&Ds?Ds(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Hs(e,t){return e===t||e!=e&&t!=t}var Us=Object.prototype.hasOwnProperty;function qs(e,t,n){var i=e[t];Us.call(e,t)&&Hs(i,n)&&(void 0!==n||t in e)||Bs(e,t,n)}function Ws(e,t,n,i){var a=!n;n||(n={});for(var r=-1,s=t.length;++r<s;){var o=t[r],c=i?i(n[o],e[o],o,n,e):void 0;void 0===c&&(c=e[o]),a?Bs(n,o,c):qs(n,o,c)}return n}var Zs=Math.max;function Ks(e,t){return zs(function(e,t,n){return t=Zs(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,r=Zs(i.length-t,0),s=Array(r);++a<r;)s[a]=i[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=i[a];return o[t]=n(s),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}(e,t,ss),e+"")}var Qs=9007199254740991;function Ys(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Qs}function Gs(e){return null!=e&&Ys(e.length)&&!ds(e)}function Xs(e,t,n){if(!Yr(n))return!1;var i=typeof t;return!!("number"==i?Gs(n)&&Vs(t,n.length):"string"==i&&t in n)&&Hs(n[t],e)}function Js(e){return Ks((function(t,n){var i=-1,a=n.length,r=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(a--,r):void 0,s&&Xs(n[0],n[1],s)&&(r=a<3?void 0:r,a=1),t=Object(t);++i<a;){var o=n[i];o&&e(t,o,i,r)}return t}))}var eo=Object.prototype;function to(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||eo)}function no(e){return Pr(e)&&"[object Arguments]"==Rr(e)}var io=Object.prototype,ao=io.hasOwnProperty,ro=io.propertyIsEnumerable,so=no(function(){return arguments}())?no:function(e){return Pr(e)&&ao.call(e,"callee")&&!ro.call(e,"callee")};var oo="object"==typeof exports&&exports&&!exports.nodeType&&exports,co=oo&&"object"==typeof module&&module&&!module.nodeType&&module,lo=co&&co.exports===oo?Er.Buffer:void 0,uo=(lo?lo.isBuffer:void 0)||function(){return!1},ho={};function po(e){return function(t){return e(t)}}ho["[object Float32Array]"]=ho["[object Float64Array]"]=ho["[object Int8Array]"]=ho["[object Int16Array]"]=ho["[object Int32Array]"]=ho["[object Uint8Array]"]=ho["[object Uint8ClampedArray]"]=ho["[object Uint16Array]"]=ho["[object Uint32Array]"]=!0,ho["[object Arguments]"]=ho["[object Array]"]=ho["[object ArrayBuffer]"]=ho["[object Boolean]"]=ho["[object DataView]"]=ho["[object Date]"]=ho["[object Error]"]=ho["[object Function]"]=ho["[object Map]"]=ho["[object Number]"]=ho["[object Object]"]=ho["[object RegExp]"]=ho["[object Set]"]=ho["[object String]"]=ho["[object WeakMap]"]=!1;var mo="object"==typeof exports&&exports&&!exports.nodeType&&exports,fo=mo&&"object"==typeof module&&module&&!module.nodeType&&module,go=fo&&fo.exports===mo&&Cr.process,_o=function(){try{var e=fo&&fo.require&&fo.require("util").types;return e||go&&go.binding&&go.binding("util")}catch(e){}}(),vo=_o,yo=vo&&vo.isTypedArray,bo=yo?po(yo):function(e){return Pr(e)&&Ys(e.length)&&!!ho[Rr(e)]},wo=Object.prototype.hasOwnProperty;function xo(e,t){var n=Br(e),i=!n&&so(e),a=!n&&!i&&uo(e),r=!n&&!i&&!a&&bo(e),s=n||i||a||r,o=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],c=o.length;for(var l in e)!t&&!wo.call(e,l)||s&&("length"==l||a&&("offset"==l||"parent"==l)||r&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Vs(l,c))||o.push(l);return o}function Mo(e,t){return function(n){return e(t(n))}}var ko=Mo(Object.keys,Object),Co=Object.prototype.hasOwnProperty;function So(e){return Gs(e)?xo(e):function(e){if(!to(e))return ko(e);var t=[];for(var n in Object(e))Co.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}var Eo=Object.prototype.hasOwnProperty;function Ao(e){if(!Yr(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=to(e),n=[];for(var i in e)("constructor"!=i||!t&&Eo.call(e,i))&&n.push(i);return n}function To(e){return Gs(e)?xo(e,!0):Ao(e)}var $o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Io=/^\w*$/;function Oo(e,t){if(Br(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Fr(e))||(Io.test(e)||!$o.test(e)||null!=t&&e in Object(t))}var Lo=ks(Object,"create");var Do=Object.prototype.hasOwnProperty;var jo=Object.prototype.hasOwnProperty;function zo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Ro(e,t){for(var n=e.length;n--;)if(Hs(e[n][0],t))return n;return-1}zo.prototype.clear=function(){this.__data__=Lo?Lo(null):{},this.size=0},zo.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},zo.prototype.get=function(e){var t=this.__data__;if(Lo){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Do.call(t,e)?t[e]:void 0},zo.prototype.has=function(e){var t=this.__data__;return Lo?void 0!==t[e]:jo.call(t,e)},zo.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Lo&&void 0===t?"__lodash_hash_undefined__":t,this};var Po=Array.prototype.splice;function No(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}No.prototype.clear=function(){this.__data__=[],this.size=0},No.prototype.delete=function(e){var t=this.__data__,n=Ro(t,e);return!(n<0)&&(n==t.length-1?t.pop():Po.call(t,n,1),--this.size,!0)},No.prototype.get=function(e){var t=this.__data__,n=Ro(t,e);return n<0?void 0:t[n][1]},No.prototype.has=function(e){return Ro(this.__data__,e)>-1},No.prototype.set=function(e,t){var n=this.__data__,i=Ro(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};var Fo=ks(Er,"Map");function Vo(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Bo(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Bo.prototype.clear=function(){this.size=0,this.__data__={hash:new zo,map:new(Fo||No),string:new zo}},Bo.prototype.delete=function(e){var t=Vo(this,e).delete(e);return this.size-=t?1:0,t},Bo.prototype.get=function(e){return Vo(this,e).get(e)},Bo.prototype.has=function(e){return Vo(this,e).has(e)},Bo.prototype.set=function(e,t){var n=Vo(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};var Ho="Expected a function";function Uo(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Ho);var n=function(){var i=arguments,a=t?t.apply(this,i):i[0],r=n.cache;if(r.has(a))return r.get(a);var s=e.apply(this,i);return n.cache=r.set(a,s)||r,s};return n.cache=new(Uo.Cache||Bo),n}Uo.Cache=Bo;var qo=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Wo=/\\(\\)?/g,Zo=function(e){var t=Uo(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(qo,(function(e,n,i,a){t.push(i?a.replace(Wo,"$1"):n||e)})),t})),Ko=Zo;function Qo(e){return null==e?"":Wr(e)}function Yo(e,t){return Br(e)?e:Oo(e,t)?[e]:Ko(Qo(e))}var Go=1/0;function Xo(e){if("string"==typeof e||Fr(e))return e;var t=e+"";return"0"==t&&1/e==-Go?"-0":t}function Jo(e,t){for(var n=0,i=(t=Yo(t,e)).length;null!=e&&n<i;)e=e[Xo(t[n++])];return n&&n==i?e:void 0}function ec(e,t,n){var i=null==e?void 0:Jo(e,t);return void 0===i?n:i}function tc(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}var nc=Mo(Object.getPrototypeOf,Object),ic="[object Object]",ac=Function.prototype,rc=Object.prototype,sc=ac.toString,oc=rc.hasOwnProperty,cc=sc.call(Object);function lc(e,t,n){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(a);++i<a;)r[i]=e[i+t];return r}var uc=Er.isFinite,dc=Math.min;var hc=Math.ceil,pc=Math.max;function mc(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=ns(n))==n?n:0),void 0!==t&&(t=(t=ns(t))==t?t:0),function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}(ns(e),t,n)}function fc(e){var t=this.__data__=new No(e);this.size=t.size}fc.prototype.clear=function(){this.__data__=new No,this.size=0},fc.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},fc.prototype.get=function(e){return this.__data__.get(e)},fc.prototype.has=function(e){return this.__data__.has(e)},fc.prototype.set=function(e,t){var n=this.__data__;if(n instanceof No){var i=n.__data__;if(!Fo||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Bo(i)}return n.set(e,t),this.size=n.size,this};var gc="object"==typeof exports&&exports&&!exports.nodeType&&exports,_c=gc&&"object"==typeof module&&module&&!module.nodeType&&module,vc=_c&&_c.exports===gc?Er.Buffer:void 0,yc=vc?vc.allocUnsafe:void 0;function bc(e,t){if(t)return e.slice();var n=e.length,i=yc?yc(n):new e.constructor(n);return e.copy(i),i}function wc(){return[]}var xc=Object.prototype.propertyIsEnumerable,Mc=Object.getOwnPropertySymbols,kc=Mc?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,a=0,r=[];++n<i;){var s=e[n];t(s,n,e)&&(r[a++]=s)}return r}(Mc(e),(function(t){return xc.call(e,t)})))}:wc;var Cc=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)tc(t,kc(e)),e=nc(e);return t}:wc;function Sc(e,t,n){var i=t(e);return Br(e)?i:tc(i,n(e))}function Ec(e){return Sc(e,So,kc)}function Ac(e){return Sc(e,To,Cc)}var Tc=ks(Er,"DataView"),$c=ks(Er,"Promise"),Ic=ks(Er,"Set"),Oc="[object Map]",Lc="[object Promise]",Dc="[object Set]",jc="[object WeakMap]",zc="[object DataView]",Rc=gs(Tc),Pc=gs(Fo),Nc=gs($c),Fc=gs(Ic),Vc=gs(Cs),Bc=Rr;(Tc&&Bc(new Tc(new ArrayBuffer(1)))!=zc||Fo&&Bc(new Fo)!=Oc||$c&&Bc($c.resolve())!=Lc||Ic&&Bc(new Ic)!=Dc||Cs&&Bc(new Cs)!=jc)&&(Bc=function(e){var t=Rr(e),n="[object Object]"==t?e.constructor:void 0,i=n?gs(n):"";if(i)switch(i){case Rc:return zc;case Pc:return Oc;case Nc:return Lc;case Fc:return Dc;case Vc:return jc}return t});var Hc=Bc,Uc=Object.prototype.hasOwnProperty;var qc=Er.Uint8Array;function Wc(e){var t=new e.constructor(e.byteLength);return new qc(t).set(new qc(e)),t}var Zc=/\w*$/;var Kc=Ar?Ar.prototype:void 0,Qc=Kc?Kc.valueOf:void 0;function Yc(e,t){var n=t?Wc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Gc="[object Boolean]",Xc="[object Date]",Jc="[object Map]",el="[object Number]",tl="[object RegExp]",nl="[object Set]",il="[object String]",al="[object Symbol]",rl="[object ArrayBuffer]",sl="[object DataView]",ol="[object Float32Array]",cl="[object Float64Array]",ll="[object Int8Array]",ul="[object Int16Array]",dl="[object Int32Array]",hl="[object Uint8Array]",pl="[object Uint8ClampedArray]",ml="[object Uint16Array]",fl="[object Uint32Array]";function gl(e,t,n){var i,a,r,s=e.constructor;switch(t){case rl:return Wc(e);case Gc:case Xc:return new s(+e);case sl:return function(e,t){var n=t?Wc(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case ol:case cl:case ll:case ul:case dl:case hl:case pl:case ml:case fl:return Yc(e,n);case Jc:return new s;case el:case il:return new s(e);case tl:return(r=new(a=e).constructor(a.source,Zc.exec(a))).lastIndex=a.lastIndex,r;case nl:return new s;case al:return i=e,Qc?Object(Qc.call(i)):{}}}function _l(e){return"function"!=typeof e.constructor||to(e)?{}:Es(nc(e))}var vl=vo&&vo.isMap,yl=vl?po(vl):function(e){return Pr(e)&&"[object Map]"==Hc(e)};var bl=vo&&vo.isSet,wl=bl?po(bl):function(e){return Pr(e)&&"[object Set]"==Hc(e)},xl=1,Ml=2,kl=4,Cl="[object Arguments]",Sl="[object Function]",El="[object GeneratorFunction]",Al="[object Object]",Tl={};function $l(e,t,n,i,a,r){var s,o=t&xl,c=t&Ml,l=t&kl;if(n&&(s=a?n(e,i,a,r):n(e)),void 0!==s)return s;if(!Yr(e))return e;var u=Br(e);if(u){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Uc.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!o)return As(e,s)}else{var d=Hc(e),h=d==Sl||d==El;if(uo(e))return bc(e,o);if(d==Al||d==Cl||h&&!a){if(s=c||h?{}:_l(e),!o)return c?function(e,t){return Ws(e,Cc(e),t)}(e,function(e,t){return e&&Ws(t,To(t),e)}(s,e)):function(e,t){return Ws(e,kc(e),t)}(e,function(e,t){return e&&Ws(t,So(t),e)}(s,e))}else{if(!Tl[d])return a?e:{};s=gl(e,d,o)}}r||(r=new fc);var p=r.get(e);if(p)return p;r.set(e,s),wl(e)?e.forEach((function(i){s.add($l(i,t,n,i,e,r))})):yl(e)&&e.forEach((function(i,a){s.set(a,$l(i,t,n,a,e,r))}));var m=u?void 0:(l?c?Ac:Ec:c?To:So)(e);return function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););}(m||e,(function(i,a){m&&(i=e[a=i]),qs(s,a,$l(i,t,n,a,e,r))})),s}Tl[Cl]=Tl["[object Array]"]=Tl["[object ArrayBuffer]"]=Tl["[object DataView]"]=Tl["[object Boolean]"]=Tl["[object Date]"]=Tl["[object Float32Array]"]=Tl["[object Float64Array]"]=Tl["[object Int8Array]"]=Tl["[object Int16Array]"]=Tl["[object Int32Array]"]=Tl["[object Map]"]=Tl["[object Number]"]=Tl[Al]=Tl["[object RegExp]"]=Tl["[object Set]"]=Tl["[object String]"]=Tl["[object Symbol]"]=Tl["[object Uint8Array]"]=Tl["[object Uint8ClampedArray]"]=Tl["[object Uint16Array]"]=Tl["[object Uint32Array]"]=!0,Tl["[object Error]"]=Tl[Sl]=Tl["[object WeakMap]"]=!1;function Il(e){return $l(e,5)}function Ol(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Bo;++t<n;)this.add(e[t])}function Ll(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function Dl(e,t){return e.has(t)}Ol.prototype.add=Ol.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Ol.prototype.has=function(e){return this.__data__.has(e)};var jl=1,zl=2;function Rl(e,t,n,i,a,r){var s=n&jl,o=e.length,c=t.length;if(o!=c&&!(s&&c>o))return!1;var l=r.get(e),u=r.get(t);if(l&&u)return l==t&&u==e;var d=-1,h=!0,p=n&zl?new Ol:void 0;for(r.set(e,t),r.set(t,e);++d<o;){var m=e[d],f=t[d];if(i)var g=s?i(f,m,d,t,e,r):i(m,f,d,e,t,r);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!Ll(t,(function(e,t){if(!Dl(p,t)&&(m===e||a(m,e,n,i,r)))return p.push(t)}))){h=!1;break}}else if(m!==f&&!a(m,f,n,i,r)){h=!1;break}}return r.delete(e),r.delete(t),h}function Pl(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function Nl(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var Fl=1,Vl=2,Bl="[object Boolean]",Hl="[object Date]",Ul="[object Error]",ql="[object Map]",Wl="[object Number]",Zl="[object RegExp]",Kl="[object Set]",Ql="[object String]",Yl="[object Symbol]",Gl="[object ArrayBuffer]",Xl="[object DataView]",Jl=Ar?Ar.prototype:void 0,eu=Jl?Jl.valueOf:void 0;var tu=1,nu=Object.prototype.hasOwnProperty;var iu=1,au="[object Arguments]",ru="[object Array]",su="[object Object]",ou=Object.prototype.hasOwnProperty;function cu(e,t,n,i,a,r){var s=Br(e),o=Br(t),c=s?ru:Hc(e),l=o?ru:Hc(t),u=(c=c==au?su:c)==su,d=(l=l==au?su:l)==su,h=c==l;if(h&&uo(e)){if(!uo(t))return!1;s=!0,u=!1}if(h&&!u)return r||(r=new fc),s||bo(e)?Rl(e,t,n,i,a,r):function(e,t,n,i,a,r,s){switch(n){case Xl:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Gl:return!(e.byteLength!=t.byteLength||!r(new qc(e),new qc(t)));case Bl:case Hl:case Wl:return Hs(+e,+t);case Ul:return e.name==t.name&&e.message==t.message;case Zl:case Ql:return e==t+"";case ql:var o=Pl;case Kl:var c=i&Fl;if(o||(o=Nl),e.size!=t.size&&!c)return!1;var l=s.get(e);if(l)return l==t;i|=Vl,s.set(e,t);var u=Rl(o(e),o(t),i,a,r,s);return s.delete(e),u;case Yl:if(eu)return eu.call(e)==eu.call(t)}return!1}(e,t,c,n,i,a,r);if(!(n&iu)){var p=u&&ou.call(e,"__wrapped__"),m=d&&ou.call(t,"__wrapped__");if(p||m){var f=p?e.value():e,g=m?t.value():t;return r||(r=new fc),a(f,g,n,i,r)}}return!!h&&(r||(r=new fc),function(e,t,n,i,a,r){var s=n&tu,o=Ec(e),c=o.length;if(c!=Ec(t).length&&!s)return!1;for(var l=c;l--;){var u=o[l];if(!(s?u in t:nu.call(t,u)))return!1}var d=r.get(e),h=r.get(t);if(d&&h)return d==t&&h==e;var p=!0;r.set(e,t),r.set(t,e);for(var m=s;++l<c;){var f=e[u=o[l]],g=t[u];if(i)var _=s?i(g,f,u,t,e,r):i(f,g,u,e,t,r);if(!(void 0===_?f===g||a(f,g,n,i,r):_)){p=!1;break}m||(m="constructor"==u)}if(p&&!m){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(e),r.delete(t),p}(e,t,n,i,a,r))}function lu(e,t,n,i,a){return e===t||(null==e||null==t||!Pr(e)&&!Pr(t)?e!=e&&t!=t:cu(e,t,n,i,lu,a))}var uu=1,du=2;function hu(e){return e==e&&!Yr(e)}function pu(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function mu(e){var t=function(e){for(var t=So(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,hu(a)]}return t}(e);return 1==t.length&&t[0][2]?pu(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,i){var a=n.length,r=a,s=!i;if(null==e)return!r;for(e=Object(e);a--;){var o=n[a];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<r;){var c=(o=n[a])[0],l=e[c],u=o[1];if(s&&o[2]){if(void 0===l&&!(c in e))return!1}else{var d=new fc;if(i)var h=i(l,u,c,e,t,d);if(!(void 0===h?lu(u,l,uu|du,i,d):h))return!1}}return!0}(n,e,t)}}function fu(e,t){return null!=e&&t in Object(e)}function gu(e,t){return null!=e&&function(e,t,n){for(var i=-1,a=(t=Yo(t,e)).length,r=!1;++i<a;){var s=Xo(t[i]);if(!(r=null!=e&&n(e,s)))break;e=e[s]}return r||++i!=a?r:!!(a=null==e?0:e.length)&&Ys(a)&&Vs(s,a)&&(Br(e)||so(e))}(e,t,fu)}var _u=1,vu=2;function yu(e){return Oo(e)?(t=Xo(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return Jo(t,e)}}(e);var t}function bu(e){return"function"==typeof e?e:null==e?ss:"object"==typeof e?Br(e)?(t=e[0],n=e[1],Oo(t)&&hu(n)?pu(Xo(t),n):function(e){var i=ec(e,t);return void 0===i&&i===n?gu(e,t):lu(n,i,_u|vu)}):mu(e):yu(e);var t,n}var wu,xu=function(e,t,n){for(var i=-1,a=Object(e),r=n(e),s=r.length;s--;){var o=r[wu?s:++i];if(!1===t(a[o],o,a))break}return e};var Mu=function(e,t){return function(n,i){if(null==n)return n;if(!Gs(n))return e(n,i);for(var a=n.length,r=t?a:-1,s=Object(n);(t?r--:++r<a)&&!1!==i(s[r],r,s););return n}}((function(e,t){return e&&xu(e,t,So)})),ku=Mu,Cu=function(){return Er.Date.now()},Su="Expected a function",Eu=Math.max,Au=Math.min;function Tu(e,t,n){var i,a,r,s,o,c,l=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(Su);function p(t){var n=i,r=a;return i=a=void 0,l=t,s=e.apply(r,n)}function m(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-l>=r}function f(){var e=Cu();if(m(e))return g(e);o=setTimeout(f,function(e){var n=t-(e-c);return d?Au(n,r-(e-l)):n}(e))}function g(e){return o=void 0,h&&i?p(e):(i=a=void 0,s)}function _(){var e=Cu(),n=m(e);if(i=arguments,a=this,c=e,n){if(void 0===o)return function(e){return l=e,o=setTimeout(f,t),u?p(e):s}(c);if(d)return clearTimeout(o),o=setTimeout(f,t),p(c)}return void 0===o&&(o=setTimeout(f,t)),s}return t=ns(t)||0,Yr(n)&&(u=!!n.leading,r=(d="maxWait"in n)?Eu(ns(n.maxWait)||0,t):r,h="trailing"in n?!!n.trailing:h),_.cancel=function(){void 0!==o&&clearTimeout(o),l=0,i=c=a=o=void 0},_.flush=function(){return void 0===o?s:g(Cu())},_}function $u(e,t,n){(void 0!==n&&!Hs(e[t],n)||void 0===n&&!(t in e))&&Bs(e,t,n)}function Iu(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ou(e,t,n,i,a,r,s){var o=Iu(e,n),c=Iu(t,n),l=s.get(c);if(l)$u(e,n,l);else{var u,d=r?r(o,c,n+"",e,t,s):void 0,h=void 0===d;if(h){var p=Br(c),m=!p&&uo(c),f=!p&&!m&&bo(c);d=c,p||m||f?Br(o)?d=o:Pr(u=o)&&Gs(u)?d=As(o):m?(h=!1,d=bc(c,!0)):f?(h=!1,d=Yc(c,!0)):d=[]:function(e){if(!Pr(e)||Rr(e)!=ic)return!1;var t=nc(e);if(null===t)return!0;var n=oc.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&sc.call(n)==cc}(c)||so(c)?(d=o,so(o)?d=function(e){return Ws(e,To(e))}(o):Yr(o)&&!ds(o)||(d=_l(c))):h=!1}h&&(s.set(c,d),a(d,c,i,r,s),s.delete(c)),$u(e,n,d)}}function Lu(e,t,n,i,a){e!==t&&xu(t,(function(r,s){if(a||(a=new fc),Yr(r))Ou(e,t,s,n,Lu,i,a);else{var o=i?i(Iu(e,s),r,s+"",e,t,a):void 0;void 0===o&&(o=r),$u(e,s,o)}}),To)}var Du=Js((function(e,t,n,i){Lu(e,t,n,i)}));function ju(e,t,n){for(var i=-1,a=null==e?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}function zu(e,t){return lu(e,t)}var Ru=Js((function(e,t,n){Lu(e,t,n)}));function Pu(e,t){return null==(e=function(e,t){return t.length<2?e:Jo(e,lc(t,0,-1))}(e,t=Yo(t,e)))||delete e[Xo((n=t,i=null==n?0:n.length,i?n[i-1]:void 0))];var n,i}function Nu(e,t){if(e!==t){var n=void 0!==e,i=null===e,a=e==e,r=Fr(e),s=void 0!==t,o=null===t,c=t==t,l=Fr(t);if(!o&&!l&&!r&&e>t||r&&s&&c&&!o&&!l||i&&s&&c||!n&&c||!a)return 1;if(!i&&!r&&!l&&e<t||l&&n&&a&&!i&&!r||o&&n&&a||!s&&a||!c)return-1}return 0}function Fu(e,t,n){t=t.length?Vr(t,(function(e){return Br(e)?function(t){return Jo(t,1===e.length?e[0]:e)}:e})):[ss];var i=-1;t=Vr(t,po(bu));var a=function(e,t){var n=-1,i=Gs(e)?Array(e.length):[];return ku(e,(function(e,a,r){i[++n]=t(e,a,r)})),i}(e,(function(e,n,a){return{criteria:Vr(t,(function(t){return t(e)})),index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(a,(function(e,t){return function(e,t,n){for(var i=-1,a=e.criteria,r=t.criteria,s=a.length,o=n.length;++i<s;){var c=Nu(a[i],r[i]);if(c)return i>=o?c:c*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function Vu(e,t,n,i){return null==e?[]:(Br(t)||(t=null==t?[]:[t]),Br(n=i?void 0:n)||(n=null==n?[]:[n]),Fu(e,t,n))}var Bu=function(e){var t=Math[e];return function(e,n){if(e=ns(e),(n=null==n?0:dc(rs(n),292))&&uc(e)){var i=(Qo(e)+"e").split("e");return+((i=(Qo(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}("round"),Hu=Bu;function Uu(e,t,n){return null==e?e:function(e,t,n,i){if(!Yr(e))return e;for(var a=-1,r=(t=Yo(t,e)).length,s=r-1,o=e;null!=o&&++a<r;){var c=Xo(t[a]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(a!=s){var u=o[c];void 0===(l=i?i(u,c,o):void 0)&&(l=Yr(u)?u:Vs(t[a+1])?[]:{})}qs(o,c,l),o=o[c]}return e}(e,t,n)}function qu(e,t){return e&&e.length?function(e,t){for(var n=-1,i=e.length,a=0,r=[];++n<i;){var s=e[n],o=t?t(s):s;if(!n||!Hs(o,c)){var c=o;r[a++]=0===s?0:s}}return r}(e,bu(t)):[]}function Wu(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return Yr(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),Tu(e,t,{leading:i,maxWait:t,trailing:a})}var Zu,Ku=Ic&&1/Nl(new Ic([,-0]))[1]==1/0?function(e){return new Ic(e)}:function(){},Qu=200;function Yu(e,t,n){var i=-1,a=Ps,r=e.length,s=!0,o=[],c=o;if(n)s=!1,a=ju;else if(r>=Qu){var l=t?null:Ku(e);if(l)return Nl(l);s=!1,a=Dl,c=new Ol}else c=t?[]:o;e:for(;++i<r;){var u=e[i],d=t?t(u):u;if(u=n||0!==u?u:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(u)}else a(c,d,n)||(c!==o&&c.push(d),o.push(u))}return o}function Gu(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Yu(e,void 0,t):[]}class Xu extends Error{constructor(e,t){super(e),this.context=t}}!function(e){e.Relative="relative",e.Continuous="continuous"}(Zu||(Zu={}));const Ju=["clips","remote-control-entity","favorite-events","favorite-recordings","live","menu","ptz","recordings","seek","snapshots","substream","trigger"],ed=hi.object({path:hi.string()});function td(e){if(!e)return;return e.trim().split(/[_\s]+/).map((e=>e[0].toUpperCase()+e.substring(1))).join(" ")}function nd(e,t,n){const i=e[t];return e.splice(t,1),e.splice(n,0,i),e}const id=e=>e?Array.isArray(e)?e:[e]:[],ad=e=>e instanceof Set?e:new Set(id(e));function rd(e,t,n){return!function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?lu(e,t,void 0,n):!!i}(e,t,n)}function sd(e,t=console.warn){e instanceof Xu&&e.context?t(e,e.context):t("object"==typeof e&&"message"in e?e.message:e)}const od=()=>window.matchMedia("(hover: hover) and (pointer: fine)").matches,cd=(e,t)=>Ea(e,"yyyy-MM-dd HH:mm"+(t?":ss":"")),ld=e=>Ea(e,"yyyy-MM-dd"),ud=(e,t)=>{window.requestIdleCallback?window.requestIdleCallback(e,{...t&&{timeout:t}}):e()};function dd(e,t){const n=function(e,t,n){const i=Vi(e,t)/Ii;return Fi(n?.roundingMethod)(i)}(t,e),i=function(e,t,n){const i=Vi(e,t)/$i;return Fi(n?.roundingMethod)(i)}(t,e)-60*n;let a="";return n&&(a+=`${n}h `),i&&(a+=`${i}m `),a+=`${Bi(t,e)-60*n*60-60*i}s`,a}const hd=async(e,t)=>await Promise.all(Array.from(e).map((e=>t(e)))),pd=e=>new Date(`${e}T00:00:00`),md=e=>!isNaN(e.getTime()),fd=(e,t,n,i)=>{t?e.setAttribute(n,i??""):e.removeAttribute(n)},gd=e=>!!e,_d=e=>e instanceof HTMLElement,vd=e=>(e instanceof HTMLSlotElement?e.assignedElements({flatten:!0}):[...e.children]).filter(_d),yd=e=>e?.ratio&&2===e.ratio.length?`${e.ratio[0]} / ${e.ratio[1]}`:e?.defaultStatic?"16 / 9":"auto",bd=e=>({"aspect-ratio":yd(e)}),wd=e=>{if(Array.isArray(e))return e.filter((e=>void 0!==e)).map((e=>wd(e)));if("object"==typeof e&&null!==e){const t={};for(const n in e)t[n]=wd(e[n]);return t}return e},xd=(e,t,n)=>Hu(e,n)===Hu(t,n);function Md(e,t){return{action:"fire-dom-event",advanced_camera_card_action:e,...t?.cardID&&{card_id:t.cardID}}}function kd(e,t){return{action:"fire-dom-event",advanced_camera_card_action:e,...t?.cardID&&{card_id:t.cardID}}}function Cd(e,t,n){return{action:"fire-dom-event",advanced_camera_card_action:e,camera:t,...n?.cardID&&{card_id:n.cardID}}}function Sd(e,t){return{action:"fire-dom-event",advanced_camera_card_action:e,...t?.folderID&&{folder:t.folderID},...t?.cardID&&{card_id:t.cardID}}}function Ed(e,t,n){return{action:"fire-dom-event",advanced_camera_card_action:"media_player",media_player:e,media_player_action:t,...n?.cardID&&{card_id:n.cardID}}}function Ad(e){return{action:"fire-dom-event",advanced_camera_card_action:"ptz_multi",...e?.cardID&&{card_id:e.cardID},...e?.ptzAction&&{ptz_action:e.ptzAction},...e?.ptzPhase&&{ptz_phase:e.ptzPhase},...e?.ptzPreset&&{ptz_preset:e.ptzPreset},...e?.targetID&&{target_id:e.targetID}}}function Td(e,t,n,i){return function(e,t){return{action:"perform-action",perform_action:e,...t?.target&&{target:t.target},...t?.data&&{data:t.data},...t?.cardID&&{card_id:t.cardID}}}(`${e}.select_option`,{...i,target:{entity_id:t},data:{option:n}})}function $d(e,t){return e&&t?"tap"===e&&t.tap_action?t.tap_action:"tap"===e&&t.entity?{action:"more-info"}:"hold"===e&&t.hold_action?t.hold_action:"double_tap"===e&&t.double_tap_action?t.double_tap_action:"end_tap"===e&&t.end_tap_action?t.end_tap_action:"start_tap"===e&&t.start_tap_action?t.start_tap_action:null:null}const Id=e=>id(e).some((e=>"none"!==e.action)),Od=e=>"fire-dom-event"===e.action&&"advanced_camera_card_action"in e&&"string"==typeof e.advanced_camera_card_action,Ld=e=>{e.stopPropagation()};class Dd{constructor(){this._timer=null,this._repeated=!1}stop(){this._timer&&(this._repeated?window.clearInterval(this._timer):window.clearTimeout(this._timer),this._timer=null)}isRunning(){return null!==this._timer}start(e,t){this.stop(),this._timer=window.setTimeout((()=>{this._timer=null,t()}),1e3*e),this._repeated=!1}startRepeated(e,t){this.stop(),this._timer=window.setInterval((()=>{t()}),1e3*e),this._repeated=!0}}class jd extends HTMLElement{constructor(){super(...arguments),this.holdTime=.4,this.holdTimer=new Dd,this.doubleClickTimer=new Dd,this.held=!1,this.started=!1}connectedCallback(){["touchcancel","mouseout","mouseup","touchmove","mousewheel","wheel","scroll"].forEach((e=>{document.addEventListener(e,(()=>{this.holdTimer.stop()}),{passive:!0})}))}bind(e,t){if(e.actionHandlerOptions)return void(e.actionHandlerOptions=t);e.actionHandlerOptions=t,e.addEventListener("contextmenu",(e=>{const t=e||window.event;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}));const n=()=>{this.held=!1,this.holdTimer.start(this.holdTime,(()=>{this.held=!0})),this.started||(this.started=!0,Ze(e,"action",{action:"start_tap"}))},i=t=>{this.holdTimer.stop(),this.started&&(this.started=!1,Ze(e,"action",{action:"end_tap"}))},a=t=>{const n=e.actionHandlerOptions;n?.allowPropagation||Ld(t),["touchend","touchcancel"].includes(t.type)&&!this.held||(i(),n?.hasHold&&this.held?Ze(e,"action",{action:"hold"}):n?.hasDoubleClick?"click"===t.type&&t.detail<2||!this.doubleClickTimer.isRunning()?this.doubleClickTimer.start(.25,(()=>Ze(e,"action",{action:"tap"}))):(this.doubleClickTimer.stop(),Ze(e,"action",{action:"double_tap"})):Ze(e,"action",{action:"tap"}))};e.addEventListener("touchstart",n,{passive:!0}),e.addEventListener("touchend",a),e.addEventListener("touchcancel",a),e.addEventListener("mousedown",n,{passive:!0}),e.addEventListener("click",a),e.addEventListener("keyup",(e=>{"Enter"===e.key&&a(e)})),e.addEventListener("mouseleave",i)}}customElements.define("action-handler-advanced-camera-card",jd);const zd=(e,t)=>{const n=(()=>{const e=document.body;if(e.querySelector("action-handler-advanced-camera-card"))return e.querySelector("action-handler-advanced-camera-card");const t=document.createElement("action-handler-advanced-camera-card");return e.appendChild(t),t})();n&&n.bind(e,t)},Rd=fe(class extends ge{update(e,[t]){return zd(e.element,t),q}render(e){}});var Pd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Nd(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Fd={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new a(i,r||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,a=[];if(0===this._eventsCount)return a;for(i in e=this._events)t.call(e,i)&&a.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,r=i.length,s=new Array(r);a<r;a++)s[a]=i[a].fn;return s},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,a,r,s){var o=n?n+e:e;if(!this._events[o])return!1;var c,l,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,a),!0;case 5:return u.fn.call(u.context,t,i,a,r),!0;case 6:return u.fn.call(u.context,t,i,a,r,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,i);break;case 4:u[l].fn.call(u[l].context,t,i,a);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},o.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,a){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var o=this._events[r];if(o.fn)o.fn!==t||a&&!o.once||i&&o.context!==i||s(this,r);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||a&&!o[c].once||i&&o[c].context!==i)&&l.push(o[c]);l.length?this._events[r]=1===l.length?l[0]:l:s(this,r)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(Fd);var Vd=Nd(Fd.exports);class Bd extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Hd extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Ud=e=>void 0===globalThis.DOMException?new Hd(e):new DOMException(e),qd=e=>{const t=void 0===e.reason?Ud("This operation was aborted."):e.reason;return t instanceof Error?t:Ud(t)};class Wd{#e=[];enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&this.#e[this.size-1].priority>=t.priority)return void this.#e.push(n);const i=function(e,t,n){let i=0,a=e.length;for(;a>0;){const r=Math.trunc(a/2);let s=i+r;n(e[s],t)<=0?(i=++s,a-=r+1):a=r}return i}(this.#e,n,((e,t)=>t.priority-e.priority));this.#e.splice(i,0,n)}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}class Zd extends Vd{#t;#n;#i=0;#a;#r;#s=0;#o;#c;#e;#l;#u=0;#d;#h;#p;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Wd,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#t=e.carryoverConcurrencyCount,this.#n=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#a=e.intervalCap,this.#r=e.interval,this.#e=new e.queueClass,this.#l=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#p=!0===e.throwOnTimeout,this.#h=!1===e.autoStart}get#m(){return this.#n||this.#i<this.#a}get#f(){return this.#u<this.#d}#g(){this.#u--,this.#_(),this.emit("next")}#v(){this.#y(),this.#b(),this.#c=void 0}get#w(){const e=Date.now();if(void 0===this.#o){const t=this.#s-e;if(!(t<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#v()}),t)),!0;this.#i=this.#t?this.#u:0}return!1}#_(){if(0===this.#e.size)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),0===this.#u&&this.emit("idle"),!1;if(!this.#h){const e=!this.#w;if(this.#m&&this.#f){const t=this.#e.dequeue();return!!t&&(this.emit("active"),t(),e&&this.#b(),!0)}}return!1}#b(){this.#n||void 0!==this.#o||(this.#o=setInterval((()=>{this.#y()}),this.#r),this.#s=Date.now()+this.#r)}#y(){0===this.#i&&0===this.#u&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#i=this.#t?this.#u:0,this.#x()}#x(){for(;this.#_(););}get concurrency(){return this.#d}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#d=e,this.#x()}async#M(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(e.reason)}),{once:!0})}))}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:this.#p,...t},new Promise(((n,i)=>{this.#e.enqueue((async()=>{this.#u++,this.#i++;try{t.signal?.throwIfAborted();let i=e({signal:t.signal});t.timeout&&(i=function(e,t){const{milliseconds:n,fallback:i,message:a,customTimers:r={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s;const o=new Promise(((o,c)=>{if("number"!=typeof n||1!==Math.sign(n))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(t.signal){const{signal:e}=t;e.aborted&&c(qd(e)),e.addEventListener("abort",(()=>{c(qd(e))}))}if(n===Number.POSITIVE_INFINITY)return void e.then(o,c);const l=new Bd;s=r.setTimeout.call(void 0,(()=>{if(i)try{o(i())}catch(e){c(e)}else"function"==typeof e.cancel&&e.cancel(),!1===a?o():a instanceof Error?c(a):(l.message=a??`Promise timed out after ${n} milliseconds`,c(l))}),n),(async()=>{try{o(await e)}catch(e){c(e)}})()})),c=o.finally((()=>{c.clear()}));return c.clear=()=>{r.clearTimeout.call(void 0,s),s=void 0},c}(Promise.resolve(i),{milliseconds:t.timeout})),t.signal&&(i=Promise.race([i,this.#M(t.signal)]));const a=await i;n(a),this.emit("completed",a)}catch(e){if(e instanceof Bd&&!t.throwOnTimeout)return void n();i(e),this.emit("error",e)}finally{this.#g()}}),t),this.emit("add"),this.#_()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#h?(this.#h=!1,this.#x(),this):this}pause(){this.#h=!0}clear(){this.#e=new this.#l}async onEmpty(){0!==this.#e.size&&await this.#k("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#k("next",(()=>this.#e.size<e))}async onIdle(){0===this.#u&&0===this.#e.size||await this.#k("idle")}async#k(e,t){return new Promise((n=>{const i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#u}get isPaused(){return this.#h}}var Kd,Qd;!function(e){e.Clip="clip",e.Snapshot="snapshot",e.Recording="recording"}(Kd||(Kd={})),function(e){e.MP4="mp4",e.HLS="hls"}(Qd||(Qd={}));class Yd{constructor(e,t){this._mediaType=e,this._cameraID=t?.cameraID??null,this._folder=t?.folder??null}getCameraID(){return this._cameraID}getFolder(){return this._folder}getMediaType(){return this._mediaType}getVideoContentType(){return null}getID(){return null}getStartTime(){return null}getEndTime(){return null}getUsableEndTime(){return this.getEndTime()??(this.inProgress()?new Date:this.getStartTime())}inProgress(){return null}getContentID(){return null}getTitle(){return null}getThumbnail(){return null}getIcon(){return null}isFavorite(){return null}includesTime(e){const t=this.getStartTime(),n=this.getUsableEndTime();return!!t&&!!n&&e>=t&&e<=n}setFavorite(e){}getWhere(){return null}}class Gd{constructor(e,t){this._folder=e,this._icon=t?.icon??null,this._id=t?.id??null,this._title=t?.title??null,this._thumbnail=t?.thumbnail??null}getFolder(){return this._folder}getID(){return this._id}getTitle(){return this._title}getThumbnail(){return this._thumbnail}getIcon(){return this._icon}isFavorite(){return null}}class Xd{static isMedia(e){return e instanceof Yd}static isFolder(e){return e instanceof Gd}static isEvent(e){return this.isMedia(e)&&(this.isClip(e)||this.isSnapshot(e))}static isRecording(e){return this.isMedia(e)&&"recording"===e.getMediaType()}static isClip(e){return this.isMedia(e)&&"clip"===e.getMediaType()}static isSnapshot(e){return this.isMedia(e)&&"snapshot"===e.getMediaType()}static isVideo(e){return this.isMedia(e)&&(this.isClip(e)||this.isRecording(e))}}const Jd=e=>{return Vu((n=e=>e.getID()??e,(t=e)&&t.length?Yu(t,bu(n)):[]),[e=>!Xd.isFolder(e),e=>Xd.isMedia(e)?e.getStartTime()??e.getID():e.getID()],["asc","asc"]);var t,n},eh="https://card.camera",th=`${eh}/#/troubleshooting`,nh=`${th}?id=stream-does-not-load`,ih=`${eh}/#/configuration`,ah=`${ih}/folders`,rh="cameras",sh=`${rh}.#.always_error_if_entity_unavailable`,oh=`${rh}.#.camera_entity`,ch=`${rh}.#.frigate.camera_name`,lh=`${rh}.#.capabilities.disable`,uh=`${rh}.#.capabilities.disable_except`,dh=`${rh}.#.cast.method`,hh=`${rh}.#.cast.dashboard.dashboard_path`,ph=`${rh}.#.cast.dashboard.view_path`,mh=`${rh}.#.dimensions.aspect_ratio`,fh=`${rh}.#.frigate.client_id`,gh=`${rh}.#.frigate.labels`,_h=`${rh}.#.frigate.url`,vh=`${rh}.#.frigate.zones`,yh=`${rh}.#.go2rtc.modes`,bh=`${rh}.#.go2rtc.stream`,wh=`${rh}.#.go2rtc.url`,xh=`${rh}.#.icon`,Mh=`${rh}.#.id`,kh=`${rh}.#.image.entity`,Ch=`${rh}.#.image.entity_parameters`,Sh=`${rh}.#.image.mode`,Eh=`${rh}.#.image.refresh_seconds`,Ah=`${rh}.#.image.url`,Th=`${rh}.#.motioneye.images.directory_pattern`,$h=`${rh}.#.motioneye.images.file_pattern`,Ih=`${rh}.#.motioneye.movies.directory_pattern`,Oh=`${rh}.#.motioneye.movies.file_pattern`,Lh=`${rh}.#.motioneye.url`,Dh=`${rh}.#.title`,jh=`${rh}.#.webrtc_card.entity`,zh=`${rh}.#.webrtc_card.url`,Rh=`${rh}.#.live_provider`,Ph=`${rh}.#.dependencies.cameras`,Nh=`${rh}.#.dependencies.all_cameras`,Fh=`${rh}.#.dimensions.layout.fit`,Vh=`${rh}.#.dimensions.layout.pan.x`,Bh=`${rh}.#.dimensions.layout.pan.y`,Hh=`${rh}.#.dimensions.layout.position.x`,Uh=`${rh}.#.dimensions.layout.position.y`,qh=`${rh}.#.dimensions.layout.view_box.top`,Wh=`${rh}.#.dimensions.layout.view_box.bottom`,Zh=`${rh}.#.dimensions.layout.view_box.left`,Kh=`${rh}.#.dimensions.layout.view_box.right`,Qh=`${rh}.#.dimensions.layout.zoom`,Yh=`${rh}.#.proxy.dynamic`,Gh=`${rh}.#.proxy.media`,Xh=`${rh}.#.proxy.ssl_ciphers`,Jh=`${rh}.#.proxy.ssl_verification`,ep=`${rh}.#.reolink.media_resolution`,tp=`${rh}.#.reolink.url`,np=`${rh}.#.triggers.motion`,ip=`${rh}.#.triggers.occupancy`,ap=`${rh}.#.triggers.entities`,rp=`${rh}.#.triggers.events`,sp="cameras_global",op=`${sp}.live_provider`,cp=`${sp}.triggers.occupancy`,lp=`${sp}.image.refresh_seconds`,up=`${sp}.dimensions.layout`,dp=`${sp}.ptz`,hp="elements",pp="folders",mp=`${pp}.#.ha.url`,fp=`${pp}.#.icon`,gp=`${pp}.#.id`,_p=`${pp}.#.title`,vp=`${pp}.#.type`,yp="view",bp=`${yp}.camera_select`,wp=`${yp}.default`,xp=`${yp}.dim`,Mp=`${yp}.interaction_seconds`,kp=`${yp}.keyboard_shortcuts`,Cp=`${yp}.keyboard_shortcuts.enabled`,Sp=`${kp}.ptz_left`,Ep=`${kp}.ptz_right`,Ap=`${kp}.ptz_up`,Tp=`${kp}.ptz_down`,$p=`${kp}.ptz_zoom_in`,Ip=`${kp}.ptz_zoom_out`,Op=`${kp}.ptz_home`,Lp=`${yp}.default_cycle_camera`,Dp=`${yp}.default_reset`,jp=`${Dp}.interaction_mode`,zp=`${Dp}.every_seconds`,Rp=`${Dp}.entities`,Pp=`${Dp}.after_interaction`,Np=`${yp}.theme.themes`,Fp=`${yp}.triggers`,Vp=`${Fp}.show_trigger_status`,Bp=`${Fp}.filter_selected_camera`,Hp=`${Fp}.untrigger_seconds`,Up=`${Fp}.actions`,qp=`${Up}.trigger`,Wp=`${Up}.untrigger`,Zp=`${Up}.interaction_mode`,Kp="media_gallery",Qp=`${Kp}.controls.filter.mode`,Yp=`${Kp}.controls.thumbnails.show_details`,Gp=`${Kp}.controls.thumbnails.show_download_control`,Xp=`${Kp}.controls.thumbnails.show_favorite_control`,Jp=`${Kp}.controls.thumbnails.show_timeline_control`,em=`${Kp}.controls.thumbnails.size`,tm="media_viewer",nm=`${tm}.auto_play`,im=`${tm}.auto_pause`,am=`${tm}.auto_mute`,rm=`${tm}.auto_unmute`,sm=`${tm}.display.mode`,om=`${tm}.display.grid_columns`,cm=`${tm}.display.grid_max_columns`,lm=`${tm}.display.grid_selected_position`,um=`${tm}.display.grid_selected_width_factor`,dm=`${tm}.draggable`,hm=`${tm}.lazy_load`,pm=`${tm}.snapshot_click_plays_clip`,mm=`${tm}.transition_effect`,fm=`${tm}.controls.builtin`,gm=`${tm}.controls.next_previous.style`,_m=`${tm}.controls.next_previous.size`,vm=`${tm}.controls.thumbnails.mode`,ym=`${tm}.controls.thumbnails.show_details`,bm=`${tm}.controls.thumbnails.show_download_control`,wm=`${tm}.controls.thumbnails.show_favorite_control`,xm=`${tm}.controls.thumbnails.show_timeline_control`,Mm=`${tm}.controls.thumbnails.size`,km=`${tm}.controls.timeline.clustering_threshold`,Cm=`${tm}.controls.timeline.events_media_type`,Sm=`${tm}.controls.timeline.format.24h`,Em=`${tm}.controls.timeline.mode`,Am=`${tm}.controls.timeline.pan_mode`,Tm=`${tm}.controls.timeline.show_recordings`,$m=`${tm}.controls.timeline.style`,Im=`${tm}.controls.timeline.window_seconds`,Om=`${tm}.zoomable`,Lm="live",Dm=`${Lm}.auto_play`,jm=`${Lm}.auto_pause`,zm=`${Lm}.auto_mute`,Rm=`${Lm}.auto_unmute`,Pm=`${Lm}.controls.builtin`,Nm=`${Lm}.controls.next_previous.style`,Fm=`${Lm}.controls.next_previous.size`,Vm=`${Lm}.controls.ptz.hide_home`,Bm=`${Lm}.controls.ptz.hide_pan_tilt`,Hm=`${Lm}.controls.ptz.hide_zoom`,Um=`${Lm}.controls.ptz.mode`,qm=`${Lm}.controls.ptz.orientation`,Wm=`${Lm}.controls.ptz.position`,Zm=`${Lm}.controls.thumbnails.media_type`,Km=`${Lm}.controls.thumbnails.events_media_type`,Qm=`${Lm}.controls.thumbnails.mode`,Ym=`${Lm}.controls.thumbnails.size`,Gm=`${Lm}.controls.thumbnails.show_details`,Xm=`${Lm}.controls.thumbnails.show_download_control`,Jm=`${Lm}.controls.thumbnails.show_favorite_control`,ef=`${Lm}.controls.thumbnails.show_timeline_control`,tf=`${Lm}.controls.timeline.clustering_threshold`,nf=`${Lm}.controls.timeline.events_media_type`,af=`${Lm}.controls.timeline.format.24h`,rf=`${Lm}.controls.timeline.mode`,sf=`${Lm}.controls.timeline.pan_mode`,of=`${Lm}.controls.timeline.show_recordings`,cf=`${Lm}.controls.timeline.style`,lf=`${Lm}.controls.timeline.window_seconds`,uf=`${Lm}.display.mode`,df=`${Lm}.display.grid_columns`,hf=`${Lm}.display.grid_max_columns`,pf=`${Lm}.display.grid_selected_position`,mf=`${Lm}.display.grid_selected_width_factor`,ff=`${Lm}.draggable`,gf=`${Lm}.lazy_load`,_f=`${Lm}.lazy_unload`,vf=`${Lm}.preload`,yf=`${Lm}.transition_effect`,bf=`${Lm}.show_image_during_load`,wf=`${Lm}.microphone.disconnect_seconds`,xf=`${Lm}.microphone.mute_after_microphone_mute_seconds`,Mf=`${Lm}.microphone.always_connected`,kf=`${Lm}.zoomable`,Cf="image",Sf=`${Cf}.entity`,Ef=`${Cf}.entity_parameters`,Af=`${Cf}.mode`,Tf=`${Cf}.refresh_seconds`,$f=`${Cf}.url`,If="timeline",Of=`${If}.window_seconds`,Lf=`${If}.clustering_threshold`,Df=`${If}.events_media_type`,jf=`${If}.format.24h`,zf=`${If}.show_recordings`,Rf=`${If}.style`,Pf=`${If}.controls.thumbnails.mode`,Nf=`${If}.controls.thumbnails.size`,Ff=`${If}.controls.thumbnails.show_details`,Vf=`${If}.controls.thumbnails.show_download_control`,Bf=`${If}.controls.thumbnails.show_favorite_control`,Hf=`${If}.controls.thumbnails.show_timeline_control`,Uf="menu",qf=`${Uf}.alignment`,Wf=`${Uf}.position`,Zf=`${Uf}.style`,Kf=`${Uf}.button_size`,Qf=`${Uf}.buttons`,Yf=`${Qf}.fullscreen`,Gf=`${Qf}.iris`,Xf=`${Qf}.play`,Jf=`${Qf}.mute`,eg=`${Qf}.media_player`,tg=`${Qf}.timeline`,ng="status_bar",ig=`${ng}.position`,ag=`${ng}.style`,rg=`${ng}.popup_seconds`,sg=`${ng}.height`,og=`${ng}.items`,cg="dimensions",lg=`${cg}.aspect_ratio`,ug=`${cg}.aspect_ratio_mode`,dg=`${cg}.height`,hg="overrides",pg="performance",mg=`${pg}.features.animated_progress_indicator`,fg=`${pg}.features.card_loading_indicator`,gg=`${pg}.features.media_chunk_size`,_g=`${pg}.features.max_simultaneous_engine_requests`,vg=`${pg}.profile`,yg=`${pg}.style.box_shadow`,bg=`${pg}.style.border_radius`,wg="profiles",xg="remote_control.entities.camera",Mg=1e3,kg="__IMAGE_VIEW_ZOOM__";var Cg={abort:"Aborted action",confirmation:"Are you sure you want to perform this action"},Sg={advanced_camera_card:"Advanced Camera Card",advanced_camera_card_description:"An Advanced Camera Card",folder:"Folder",live:"Live",no_folder:"No folder to display",no_media:"No media to display",recordings:"Recordings",version:"Version"},Eg={cameras:{always_error_if_entity_unavailable:"Always treat entity unavailability as error",camera_entity:"Camera Entity",capabilities:{capabilities:{clips:"Clips","favorite-events":"Favorite Events","favorite-recordings":"Favorite Recordings",live:"Live",menu:"Menu",ptz:"PTZ",recordings:"Recordings",seek:"Seeking",snapshots:"Snapshots",substream:"Substream"},disable:"Disable",disable_except:"Disable except",editor_label:"Camera capabilities"},cast:{dashboard:{dashboard_path:"Dashboard path",view_path:"View path"},editor_label:"Cast options",method:"Cast method",methods:{dashboard:"Dashboard",standard:"Standard"}},dependencies:{all_cameras:"Show events for all cameras with this camera",cameras:"Show events for specific cameras with this camera",editor_label:"Dependency options"},dimensions:{aspect_ratio:"Static aspect ratio",editor_label:"Camera dimensions",layout:{editor_label:"Camera Layout",fit:"Layout fit",fits:{contain:"Media is contained/letterboxed",cover:"Media expands proportionally to cover the card",fill:"Media is stretched to fill the card"},pan:{x:"Pan horizontal percentage",y:"Pan vertical percentage"},position:{editor_label:"Layout Cover Position",x:"Horizontal placement percentage",y:"Vertical placement percentage"},view_box:{bottom:"Bottom inset percentage",editor_label:"Layout View Box",left:"Left inset percentage",right:"Right inset percentage",top:"Top inset percentage"},zoom:"Zoom factor"}},engines:{editor_label:"Camera engine options"},frigate:{camera_name:"Frigate camera name (Autodetected from entity)",client_id:"Frigate client id (For >1 Frigate server)",editor_label:"Frigate options",labels:"Frigate labels/object filters",url:"Frigate server URL",zones:"Frigate zones"},go2rtc:{editor_label:"go2rtc Options",modes:{editor_label:"go2rtc Modes",mjpeg:"Motion JPEG (MJPEG)",mp4:"MPEG-4 (MP4)",mse:"Media Source Extensions (MSE)",webrtc:"Web Real-Time Communication (WebRTC)"},stream:"go2rtc stream name",url:"go2rtc URL"},icon:"Icon for this camera (Autodetected from entity)",id:"Unique ID for this camera in this card",image:{editor_label:"Image Options",refresh_seconds:"Number of seconds after which to refresh live image (0=never)",url:"Image URL to use instead of camera entity snapshot"},live_provider:"Live view provider for this camera",live_provider_options:{editor_label:"Live provider options"},live_providers:{auto:"Automatic",go2rtc:"go2rtc",ha:"Home Assistant video stream (i.e. HLS, LL-HLS, WebRTC via HA)",image:"Home Assistant images",jsmpeg:"JSMpeg","webrtc-card":"WebRTC Card (i.e. AlexxIT's WebRTC Card)"},motioneye:{editor_label:"MotionEye options",images:{directory_pattern:"Images directory pattern",file_pattern:"Images file pattern"},movies:{directory_pattern:"Movies directory pattern",file_pattern:"Movies file pattern"},url:"MotionEye UI URL"},proxy:{dynamic:"Dynamic proxying",editor_label:"Camera proxying",media:{auto:"Media proxying automatically configured",editor_label:"Media proxying",false:"Media proxying disabled",true:"Media proxying enabled"},ssl_ciphers:{auto:"SSL ciphers automatically configured",default:"Default SSL ciphers",editor_label:"SSL ciphers",insecure:"Insecure SSL ciphers",intermediate:"Intermediate SSL ciphers",modern:"Modern SSL ciphers"},ssl_verification:{auto:"SSL verification automatically configured",editor_label:"SSL verification",false:"SSL verification disabled",true:"SSL verification enabled"}},reolink:{editor_label:"Reolink options",media_resolution:{editor_label:"Media Resolution",high:"High Resolution",low:"Low Resolution"},url:"Reolink UI URL"},title:"Title for this camera (Autodetected from entity)",triggers:{editor_label:"Trigger options",entities:"Trigger from other entities",events:{clips:"Events with new clips",editor_label:"Trigger Events",events:"All events",snapshots:"Events with new snapshots"},motion:"Trigger by auto-detecting the motion sensor",occupancy:"Trigger by auto-detecting the occupancy sensor"},webrtc_card:{editor_label:"WebRTC Card Options",entity:"WebRTC Card Camera Entity",url:"WebRTC Card Camera URL"}},common:{controls:{builtin:"Built-in video controls",filter:{editor_label:"Media Filter",mode:"Filter mode",modes:{left:"Media filter in a drawer to the left",none:"No media filter",right:"Media filter in a drawer to the right"}},next_previous:{editor_label:"Next & Previous",size:"Next & previous control size in pixels",style:"Next & previous control style",styles:{chevrons:"Chevrons",icons:"Icons",none:"None",thumbnails:"Thumbnails"}},thumbnails:{editor_label:"Thumbnails",events_media_type:"Whether to show event thumbnails of clips or snapshots",events_media_types:{clips:"Clip thumbnails",snapshots:"Snapshot thumbnails"},media_type:"Whether to show thumnails of events or recordings",media_types:{events:"Events",recordings:"Recordings"},mode:"Thumbnails mode",modes:{above:"Thumbnails above",below:"Thumbnails below",left:"Thumbnails in a drawer to the left",none:"No thumbnails",right:"Thumbnails in a drawer to the right"},show_details:"Show details with thumbnails",show_download_control:"Show download control on thumbnails",show_favorite_control:"Show favorite control on thumbnails",show_timeline_control:"Show timeline control on thumbnails",size:"Thumbnails size in pixels"},timeline:{editor_label:"Mini Timeline",format:{"24h":"Use 24-hour clock",editor_label:"Time & date format"},mode:"Mode",modes:{above:"Above",below:"Below",none:"None"},pan_mode:"Default pan mode",pan_modes:{pan:"Pan",seek:"Pan seeks across all media","seek-in-camera":"Pan seeks within selected camera only","seek-in-media":"Pan seeks within selected media item only"}}},display:{editor_label:"Display",grid_columns:"Exact number of grid columns",grid_max_columns:"Maximum number of grid columns",grid_selected_position:"Position of selected media in grid",grid_selected_positions:{default:"Selected item in default position",first:"Selected item is first in grid",last:"Selected item is last in grid"},grid_selected_width_factor:"Increase selected media width by this factor",mode:"Mode"},image:{entity:"Entity for use with entity mode",entity_parameters:"Query parameters added to the entity-based picture URLs (e.g. width=1920&height=1080)",mode:"Image mode",modes:{camera:"Home Assistant camera snapshot of camera entity",entity:"Entity with entity_picture attribute",screensaver:"Embedded screensaver image",url:"Arbitrary image specified by URL"},refresh_seconds:"Number of seconds after which to refresh (0=never)",url:"Static image URL"},media_action_conditions:{all:"All opportunities",hidden:"On browser/tab hiding",microphone_mute:"On microphone mute",microphone_unmute:"On microphone unmute",never:"Never",selected:"On selection",unselected:"On unselection",visible:"On browser/tab visibility"},timeline:{clustering_threshold:"The count of events at which they are clustered (0=no clustering)",events_media_type:"The events media the timeline displays",events_media_types:{all:"All event media types",clips:"Clips",snapshots:"Snapshots"},show_recordings:"Show recordings",style:"Timeline style",styles:{ribbon:"Events on a single ribbon",stack:"Stacked & clustered events"},window_seconds:"The default length of the timeline view in seconds"}},dimensions:{aspect_ratio:"Default aspect ratio (e.g. '16:9')",aspect_ratio_mode:"Aspect ratio mode",aspect_ratio_modes:{dynamic:"Aspect ratio adjusts to media",static:"Static aspect ratio",unconstrained:"Unconstrained aspect ratio"},height:"Card height in CSS units (e.g. '500px')"},folders:{ha:{editor_label:"Home Assistant Media Folder Options",url:"URL of media folder",path_info:"Additional path matching functionality is available in the text editor"},icon:"Icon for this folder",id:"Unique ID for this folder in this card",title:"Title for this folder",type:"Folder type",types:{ha:"Home Assistant Media Folder"}},live:{auto_mute:"Automatically mute live cameras",auto_pause:"Automatically pause live cameras",auto_play:"Automatically play live cameras",auto_unmute:"Automatically unmute live cameras",controls:{editor_label:"Live Controls",ptz:{editor_label:"PTZ",hide_home:"Hide home & preset controls",hide_pan_tilt:"Hide pan & tilt control",hide_zoom:"Hide zoom control",mode:"Mode",modes:{off:"Off",on:"On"},orientation:"Orientation",orientations:{horizontal:"Horizontal",vertical:"Vertical"},position:"Position",positions:{"bottom-left":"Bottom left","bottom-right":"Bottom right","top-left":"Top left","top-right":"Top right"}}},draggable:"Live cameras view can be dragged/swiped",lazy_load:"Live cameras are lazily loaded",lazy_unload:"Live cameras are lazily unloaded",microphone:{always_connected:"Always keep the microphone connected",disconnect_seconds:"Seconds after which to disconnect microphone (0=never)",editor_label:"Microphone",enabled:"Microphone enabled",mute_after_microphone_mute_seconds:"Seconds after microphone mute to mute inbound audio"},preload:"Preload live view in the background",show_image_during_load:"Show still image while the live stream is loading",transition_effect:"Live camera transition effect",zoomable:"Live cameras can be zoomed/panned"},media_viewer:{auto_mute:"Automatically mute media",auto_pause:"Automatically pause media",auto_play:"Automatically play media",auto_unmute:"Automatically unmute media",controls:{editor_label:"Media Viewer Controls"},draggable:"Media Viewer can be dragged/swiped",lazy_load:"Media Viewer media is lazily loaded in carousel",snapshot_click_plays_clip:"Clicking on a snapshot plays a related clip",transition_effect:"Media Viewer transition effect",transition_effects:{none:"No transition",slide:"Slide transition"},zoomable:"Media Viewer can be zoomed/panned"},menu:{alignment:"Menu alignment",alignments:{bottom:"Aligned to the bottom",left:"Aligned to the left",right:"Aligned to the right",top:"Aligned to the top"},button_size:"Menu button size in pixels",buttons:{alignment:"Button alignment",alignments:{matching:"Matching the menu alignment",opposing:"Opposing the menu alignment"},camera_ui:"Camera user interface",cameras:"Cameras",clips:"Clips",display_mode:"Display mode",download:"Download",enabled:"Button enabled",expand:"Expand",folders:"Folders",fullscreen:"Fullscreen",icon:"Icon",image:"Image",iris:"Iris / Default View / Unhide menu",live:"Live",media_player:"Send to media player",microphone:"Microphone",mute:"Mute / Unmute",permanent:"Show when the menu is hidden",play:"Play / Pause",priority:"Priority",ptz_controls:"Show PTZ controls",ptz_home:"PTZ Home",recordings:"Recordings",screenshot:"Screenshot",snapshots:"Snapshots",substreams:"Substream(s)",timeline:"Timeline",type:"Button type",types:{momentary:"Momentary",toggle:"Toggle"}},position:"Menu position",positions:{bottom:"Positioned on the bottom",left:"Positioned on the left",right:"Positioned on the right",top:"Positioned on the top"},style:"Menu style",styles:{hidden:"Hidden menu",hover:"Hover menu","hover-card":"Hover menu (card-wide)",none:"No menu",outside:"Outside menu",overlay:"Overlay menu"}},overrides:{info:"This card configuration has manually specified overrides configured which may override values shown in the visual editor, please consult the code editor to view/modify these overrides"},performance:{features:{animated_progress_indicator:"Animated Progress Indicator",card_loading_indicator:"Card Loading Indicator",editor_label:"Feature Options",max_simultaneous_engine_requests:"Max simultaneous camera engine requests",media_chunk_size:"Media chunk size"},style:{border_radius:"Curves",box_shadow:"Shadows",editor_label:"Style Options"},warning:"This card is in low profile mode so defaults have changed to optimize performance"},profiles:{casting:"Casting",editor_label:"Configuration profiles","low-performance":"Low performance",scrubbing:"Video scrubbing"},remote_control:{entities:{camera:"Input Select entity to control camera",editor_label:"Remote Control Entities"}},status_bar:{height:"Status bar height in pixels",items:{enabled:"Item enabled",engine:"Camera engine",live_provider:"Live provider",priority:"Item priority",resolution:"Resolution",technology:"Technology",title:"Title"},popup_seconds:"Status bar popup seconds",position:"Status bar position",positions:{bottom:"Positioned on the bottom",top:"Positioned on the top"},style:"Status bar style",styles:{hover:"Hover status bar","hover-card":"Hover status bar (card-wide)",none:"No status bar",outside:"Outside status bar",overlay:"Overlay status bar",popup:"Popup status bar"}},view:{camera_select:"View for newly selected cameras",default:"Default view",default_cycle_camera:"Cycle through cameras when default view updates",default_reset:{after_interaction:"Reset to the default view after user interaction ends",editor_label:"Default view reset behavior",entities:"Reset to the default view on entity state change",every_seconds:"Reset to default view every X seconds (0=never)",interaction_mode:"How default reset behaves when the card has human interaction",interaction_modes:{active:"Only allow reset when card has active human interaction",all:"Reset regardless of human interaction",inactive:"Only reset when card has no human interaction"}},dim:"Dim when no interaction",interaction_seconds:"Seconds after user action to remain interacted with (0=never)",keyboard_shortcuts:{editor_label:"Keyboard shortcuts",enabled:"Keyboard shortcuts enabled",ptz_down:"PTZ Down",ptz_home:"PTZ Home",ptz_left:"PTZ Left",ptz_right:"PTZ Right",ptz_up:"PTZ Up",ptz_zoom_in:"PTZ Zoom In",ptz_zoom_out:"PTZ Zoom Out"},theme:{themes:{dark:"Dark",editor_label:"Themes",ha:"Home Assistant",light:"Light",traditional:"Traditional"}},triggers:{actions:{editor_label:"Trigger actions",interaction_mode:"How to handle actions when the card has human interaction",interaction_modes:{active:"Only trigger actions when card has human interaction",all:"Trigger actions regardless of human interaction",inactive:"Only trigger actions when card has no human interaction"},trigger:"Trigger action",triggers:{default:"Change to or update default view",live:"Change to or update live view",media:"Change to the relevant media view for new media",none:"No action"},untrigger:"Untrigger action",untriggers:{default:"Change to default view/camera",none:"No action"}},editor_label:"Trigger behavior",filter_selected_camera:"Only trigger on selected camera",show_trigger_status:"Show pulsing border when triggered",untrigger_seconds:"Seconds after inactive state change to untrigger"},views:{clip:"Most recent clip",clips:"Clips gallery",current:"Current view",folder:"Folder media",folders:"Folders gallery",image:"Static image",live:"Live view",recording:"Most recent recording",recordings:"Recordings gallery",snapshot:"Most recent snapshot",snapshots:"Snapshots gallery",timeline:"Timeline view"}}},Ag={grid:"Show media viewer for each camera in a grid",single:"Show single media viewer"},Tg={add_new_camera:"Add new camera",add_new_folder:"Add new folder",button:"Button",camera:"Camera",cameras:"Cameras",cameras_secondary:"What cameras to render on this card",delete:"Delete",dimensions:"Card dimensions",dimensions_secondary:"Card dimensions & shape options",folders:"Folders",folders_secondary:"What folders to render on this card",image:"Image",image_secondary:"Static image view options",live:"Live",live_secondary:"Live camera view options",media_gallery:"Media gallery",media_gallery_secondary:"Media gallery options",media_viewer:"Media viewer",media_viewer_secondary:"Viewer for static media (clips, snapshots or recordings)",menu:"Menu",menu_secondary:"Menu look & feel options",move_down:"Move down",move_up:"Move up",overrides:"Overrides are active",overrides_secondary:"Dynamic configuration overrides detected",performance:"Performance",performance_secondary:"Card performance options",profiles:"Configuration profiles",profiles_secondary:"Choose pre-configured sets of defaults",remote_control:"Remote Control",remote_control_secondary:"Options for remote controlling the card",status_bar:"Status bar",status_bar_secondary:"Status bar look & feel options",timeline:"Timeline",timeline_secondary:"Event timeline options",upgrade:"Upgrade",upgrade_available:"An automatic card configuration upgrade is available",view:"View",view_secondary:"What the card should show and how to show it"},$g={ptz:{down:"Down",home:"Home",left:"Left",presets:"Presets",right:"Right",up:"Up",zoom_in:"Zoom In",zoom_out:"Zoom Out"}},Ig={awaiting_live:"Waiting for live stream to load ...",awaiting_folder:"Waiting for folder to load",awaiting_media:"Waiting for media to load",camera_initialization:"Camera initialization failed",camera_initialization_reolink:"Could not initialize Reolink camera",configuration:"Check configuration",could_not_render_elements:"Could not render picture elements",could_not_resolve:"Could not resolve media URL",diagnostics:"Card diagnostics. Please review for confidential information prior to sharing",download_no_media:"No media to download",download_sign_failed:"Could not sign media URL for download",duplicate_camera_id:"Duplicate camera id for the following camera, use the 'id' parameter to uniquely identify cameras",duplicate_folder_id:"Duplicate folder id for the following folder, use the 'id' parameter to uniquely identify folders",empty_response:"Received empty response from Home Assistant for request",failed_response:"Failed to receive response from Home Assistant for request",failed_retain:"Could not retain event",failed_sign:"Could not sign Home Assistant URL",fetching_diagnostics:"Fetching diagnostics",image_load_error:"The image could not be loaded",invalid_configuration:"Invalid configuration",invalid_configuration_no_hint:"No location hint available (bad or missing type?)",invalid_configuration_override:"Invalid override configuration",invalid_elements_config:"Invalid picture elements configuration",invalid_response:"Received invalid response from Home Assistant for request",jsmpeg_no_player:"Could not start JSMPEG player",live_camera_no_endpoint:"Could not get camera endpoint for this live provider (incomplete configuration?)",live_camera_not_found:"The configured camera_entity was not found",live_camera_unavailable:"Camera unavailable",no_camera_engine:"Could not determine suitable engine for camera",no_camera_entity:"Could not find camera entity",no_camera_entity_for_triggers:"A camera entity is required in order to autodetect triggers",no_camera_id:"Could not determine camera id for the following camera, may need to set 'id' parameter manually",no_dashboard_or_view:"Both 'dashboard_path' and 'view_path' parameters are required for the 'dashboard' cast method",no_live_camera:"The camera_entity parameter must be set and valid for this live provider",no_supported_camera:"The selected camera does not support this view",no_supported_cameras:"No cameras support this view",reconnecting:"Reconnecting",stream_not_loading:"The video stream has not yet loaded. This is could for any number of reasons. If configured (and by default), there will be an image refreshing every second until the stream loads correctly",too_many_automations:"Too many nested automation calls, please check your configuration for loops",troubleshooting:"Check troubleshooting",unknown:"Unknown error",upgrade_available:"An automated card configuration upgrade is available, please visit the visual card editor",webrtc_card_reported_error:"WebRTC Card reported an error",webrtc_card_waiting:"Waiting for WebRTC Card to load ..."},Og={assign:"Assign",modifiers:{alt:"Alt",ctrl:"Ctrl",meta:"Meta",shift:"Shift"},unassign:"Unassign"},Lg={all:"All",camera:"Camera",favorite:"Favorite",media_type:"Media Type",media_types:{clips:"Clips",recordings:"Recordings",snapshots:"Snapshots"},not_favorite:"Not Favorite",select_camera:"Select camera...",select_favorite:"Select favorite...",select_media_type:"Select media type...",select_tag:"Select tag...",select_what:"Select what...",select_when:"Select when...",select_where:"Select where...",tag:"Tag",what:"What",when:"When",whens:{custom:"Custom",past_month:"Past Month",past_week:"Past Week",today:"Today",yesterday:"Yesterday"},where:"Where"},Dg={unseekable:"Seek time not found in media"},jg={camera:"Camera",download:"Download media",duration:"Duration",events:"Events",in_progress:"In Progress",no_thumbnail:"No thumbnail available",retain_indefinitely:"Media will be indefinitely retained",score:"Score",seek:"Seek",start:"Start",tag:"Tag",timeline:"See media in timeline",title:"Title",what:"What",where:"Where"},zg={select_date:"Choose date"},Rg={actions:Cg,common:Sg,config:Eg,display_modes:Ag,editor:Tg,elements:$g,error:Ig,key_assigner:Og,media_filter:Lg,media_viewer:Dg,thumbnail:jg,timeline:zg},Pg=Object.freeze({__proto__:null,actions:Cg,common:Sg,config:Eg,default:Rg,display_modes:Ag,editor:Tg,elements:$g,error:Ig,key_assigner:Og,media_filter:Lg,media_viewer:Dg,thumbnail:jg,timeline:zg});const Ng="en",Fg={[Ng]:Pg};let Vg;function Bg(e){const t=e=>e.replace("-","_"),n=e?.language??e?.selectedLanguage;if(n)return t(n);const i=localStorage.getItem("selectedLanguage");if(i){const e=JSON.parse(i);if(e)return t(e)}for(const e of navigator.languages){const n=t(e);if(n&&n in Fg)return n}return Ng}function Hg(e,t="",n=""){let i="";try{i=e.split(".").reduce(((e,t)=>e[t]),Fg[Vg??Ng])}catch(e){}return i||(i=e.split(".").reduce(((e,t)=>e[t]),Fg[Ng])),""!==t&&""!==n&&(i=i.replace(t,n)),i}function Ug(e){return"string"==typeof e?.id&&e.id||"string"==typeof e?.camera_entity&&e.camera_entity||"object"==typeof e?.webrtc_card&&e.webrtc_card&&("string"==typeof e.webrtc_card.entity&&e.webrtc_card.entity||"string"==typeof e.webrtc_card.url&&e.webrtc_card.url)||"object"==typeof e?.go2rtc&&e.go2rtc&&"string"==typeof e.go2rtc.url&&"string"==typeof e.go2rtc.stream&&`${e.go2rtc.url}#${e.go2rtc.stream}`||"object"==typeof e?.frigate&&e.frigate&&"string"==typeof e?.frigate.camera_name&&e.frigate.camera_name||""}const qg=(e,...t)=>{e?.debug?.logging&&console.debug(...t)};class Wg{constructor(e,t){this._capabilities=e;for(const e of t?.disable??[])this._disable(e);for(const e of Ju)t?.disableExcept?.length&&!t.disableExcept.includes(e)&&this._disable(e)}_disable(e){delete this._capabilities[e]}matches(e){let t=!0;return"string"==typeof e&&(t&&=this.has(e)),"object"==typeof e&&e.allCapabilities&&(t&&=e.allCapabilities.every((e=>this.has(e)))),"object"==typeof e&&e.anyCapabilities&&(t&&=e.anyCapabilities.some((e=>this.has(e)))),t}has(e){return!!this._capabilities[e]}getPTZCapabilities(){return this._capabilities.ptz??null}hasPTZCapability(){return!!(this._capabilities.ptz?.down?.length||this._capabilities.ptz?.up?.length||this._capabilities.ptz?.left?.length||this._capabilities.ptz?.right?.length||this._capabilities.ptz?.zoomIn?.length||this._capabilities.ptz?.zoomOut?.length||this._capabilities.ptz?.presets?.length)}getRawCapabilities(){return this._capabilities}}async function Zg(e,t,n,i=!1){let a;try{a=await e.callWS(n)}catch(e){throw new Xu(Hg("error.failed_response"),{request:n,response:e})}if(!a)throw new Xu(Hg("error.empty_response"),{request:n});try{return t.parse(i?JSON.parse(a):a)}catch(e){throw new Xu(Hg("error.invalid_response"),{request:n,response:a,error:e})}}class Kg{constructor(e){this._cache=e}has(e){return this._cache.has(e)}entries(){return this._cache.entries()}delete(e){return this._cache.delete(e)}clear(){this._cache.clear()}get(e){return this._cache.get(e)??null}getMatches(e){return[...this._cache.values()].filter(e)}set(e,t){this._cache.set(e,t)}}class Qg{constructor(){this._data=[]}get[Symbol.toStringTag](){return"EqualityMap"}has(e){return!!this.get(e)}get(e){for(const t of this._data)if(zu(t.key,e))return t.value}set(e,t){return this.delete(e),this._data.push({key:e,value:t}),this}delete(e){for(let t=0;t<this._data.length;t++)if(zu(this._data[t].key,e))return this._data.splice(t,1),!0;return!1}clear(){this._data=[]}*entries(){for(const e of this._data)yield[e.key,e.value]}forEach(e,t){for(const n of this._data)e.call(t,n.value,n.key,this)}get size(){return this._data.length}[Symbol.iterator](){return this.entries()}keys(){return this._data.map((e=>e.key)).values()}values(){return this._data.map((e=>e.value)).values()}}class Yg extends Kg{constructor(){super(new Qg)}}class Gg{constructor(){this._data=new Yg}get(e){const t=this._data.get(e),n=new Date;return t&&(!t.expires||n<=t.expires)?t.value:null}has(e){return!!this.get(e)}set(e,t,n){this._data.set(e,{value:t,expires:n}),this._expireOldValues()}delete(e){return this._data.delete(e)}clear(){this._data.clear()}*entries(){const e=new Date;for(const[t,n]of this._data.entries())(!n.expires||e<=n.expires)&&(yield[t,n.value])}getMatches(e){const t=[];for(const[n,i]of this.entries())e(i)&&t.push(i);return t}_expireOldValues(){const e=new Date;for(const[t,n]of this._data.entries())n.expires&&e>n.expires&&this._data.delete(t)}}const Xg=hi.lazy((()=>hi.object({title:hi.string(),media_class:hi.string(),media_content_type:hi.string(),media_content_id:hi.string(),can_play:hi.boolean(),can_expand:hi.boolean(),children_media_class:hi.string().nullable().optional(),thumbnail:hi.string().nullable(),children:hi.array(Xg).nullable().optional()})));class Jg extends Gg{}const e_="video",t_="image",n_=60;class i_{async walk(e,t,n){return t&&t.length?(await hd(t,(async t=>await this._walkBrowseMedia(e,t,n)))).flat():[]}async _walkBrowseMedia(e,t,n){let i=[];for(const a of function(e,t,n){t=(n?Xs(e,t,n):void 0===t)?1:pc(rs(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var a=0,r=0,s=Array(hc(i/t));a<i;)s[r++]=lc(e,a,a+=t);return s}(t.targets,t.concurrency??1/0)){const r=await hd(a,(async i=>await this._browseMedia(e,i,{cache:n?.cache,metadataGenerator:t.metadataGenerator})));for(const e of r)for(const n of e.children??[])t.matcher&&!t.matcher(n)||i.push(n);if(t.sorter&&(i=t.sorter(i)),t.earlyExit&&t.earlyExit(i))break}const a=t.advance?t.advance(i):null;return a?.length?await this.walk(e,a,n):i}async _browseMedia(e,t,n){const i="object"==typeof t?t.media_content_id:t,a=n?.cache?n.cache.get(i):null;if(a)return a;const r={type:"media_source/browse_media",media_content_id:i},s=await Zg(e,Xg,r);if(n?.metadataGenerator)for(const e of s.children??[])e._metadata=n.metadataGenerator(e,"object"==typeof t?t:void 0)??void 0;return n?.cache&&n.cache.set(i,s,Ei(new Date,{seconds:60})),s}}class a_{constructor(e){this._ranges=e??[]}hasCoverage(e){return this._ranges.some((t=>s_(t,e)))}add(e){this._ranges.push(e),this._ranges=c_(this._ranges)}clear(){this._ranges=[]}}class r_{constructor(e){this._ranges=e??[]}hasCoverage(e){const t=new Date;return this._ranges.some((n=>t<n.expires&&s_(n,e)))}add(e){this._ranges.push(e),this._expireOldRanges()}_expireOldRanges(){const e=new Date;this._ranges=this._ranges.filter((t=>e<t.expires))}clear(){this._ranges=[]}}const s_=(e,t)=>t.start>=e.start&&t.end<=e.end,o_=(e,t)=>e.start>=t.start&&e.start<=t.end||e.end>=t.start&&e.end<=t.end||e.start<=t.start&&e.end>=t.end,c_=(e,t=0)=>{const n=[];e=Vu(e,(e=>e.start),"asc");let i=null;for(const a of e){const e=a.start instanceof Date?a.start.getTime():a.start;if(!i){i={...a};continue}(i.end instanceof Date?i.end.getTime():i.end)+1e3*t>=e?a.end>i.end&&(i.end=a.end):(n.push(i),i={...a})}return i&&n.push(i),n};class l_{constructor(e,t){this._ranges=new a_,this._data=[],this._timeFunc=e,this._idFunc=t}add(e,t){this._ranges.add(e),this._data=qu(Vu(this._data.concat(t),this._timeFunc,"asc"),this._idFunc)}hasCoverage(e){return this._ranges.hasCoverage(e)}get(e){if(!this.hasCoverage(e))return null;const t=[];for(const n of this._data){const i=this._timeFunc(n);if(i>=e.start.getTime()){if(i>e.end.getTime())break;t.push(n)}}return t}getSize(){return this._data.length}expireMatches(e){this._data=this._data.filter((t=>!e(t)))}}class u_{constructor(){this._segments=new Map}add(e,t,n){let i=this._segments.get(e);i||(i=new l_((e=>1e3*e.start_time),(e=>e.id)),this._segments.set(e,i)),i.add(t,n)}clear(){this._segments.clear()}hasCoverage(e,t){return!!this._segments.get(e)?.hasCoverage(t)}get(e,t){return this._segments.get(e)?.get(t)??null}getSize(e){return this._segments.get(e)?.getSize()??null}getCameraIDs(){return[...this._segments.keys()]}expireMatches(e,t){this._segments.get(e)?.expireMatches(t)}}class d_ extends Xu{}class h_ extends Xu{}var p_,m_,f_;!function(e){e.Event="event-query",e.Recording="recording-query",e.RecordingSegments="recording-segments-query",e.MediaMetadata="media-metadata"}(p_||(p_={})),function(e){e.Event="event-results",e.Recording="recording-results",e.RecordingSegments="recording-segments-results",e.MediaMetadata="media-metadata-results"}(m_||(m_={})),function(e){e.Frigate="frigate",e.Generic="generic",e.MotionEye="motioneye",e.Reolink="reolink"}(f_||(f_={}));class g_ extends Gg{}const __=e=>e?.camera_entity??e?.webrtc_card?.entity??null;class v_{constructor(e){this._entityRegistryManager=e}async createEngine(e,t){let n;switch(e){case f_.Generic:const{GenericCameraManagerEngine:e}=await import("./engine-generic-bf49d7fb.js").then((function(e){return e.e}));n=new e(t.stateWatcher,t.eventCallback);break;case f_.Frigate:const{FrigateCameraManagerEngine:i}=await import("./engine-frigate-3350ec58.js");n=new i(this._entityRegistryManager,t.stateWatcher,new u_,new g_,t.eventCallback);break;case f_.MotionEye:const{MotionEyeCameraManagerEngine:a}=await import("./engine-motioneye-6c611e36.js");n=new a(this._entityRegistryManager,t.stateWatcher,new i_,t.resolvedMediaCache,new g_,t.eventCallback);break;case f_.Reolink:const{ReolinkCameraManagerEngine:r}=await import("./engine-reolink-b63bc0db.js");n=new r(this._entityRegistryManager,t.stateWatcher,new i_,t.resolvedMediaCache,new g_,t.eventCallback)}return n}async getEngineForCamera(e,t){let n=null;if("frigate"===t.engine)n=f_.Frigate;else if("motioneye"===t.engine)n=f_.MotionEye;else if("generic"===t.engine)n=f_.Generic;else if("reolink"===t.engine)n=f_.Reolink;else{const i=__(t);if(i){const a=await this._entityRegistryManager.getEntity(e,i);if(!a){if(e.states[i])return f_.Generic;throw new d_(Hg("error.no_camera_entity"),t)}switch(a?.platform){case"frigate":n=f_.Frigate;break;case"motioneye":n=f_.MotionEye;break;case"reolink":n=f_.Reolink;break;default:n=f_.Generic}}else t.frigate.camera_name?n=f_.Frigate:(t.webrtc_card?.url||t.go2rtc?.url&&t.go2rtc?.stream)&&(n=f_.Generic)}return n}}class y_{constructor(){this._cameras=new Map,this._enginesByType=new Map}addCamera(e){this._cameras.set(e.getID(),e),this._enginesByType.set(e.getEngine().getEngineType(),e.getEngine())}async setCameras(e){for(const t of e){const e=this._cameras.get(t.getID());e!==t&&(this.addCamera(t),await(e?.destroy()))}for(const t of this._cameras.values())e.includes(t)||(await t.destroy(),this._cameras.delete(t.getID()))}async reset(){await hd(this._cameras.values(),(e=>e.destroy())),this._cameras.clear(),this._enginesByType.clear()}getCamera(e){return this._cameras.get(e)??null}getCameras(){return this._cameras}getCameraConfig(e){return this._cameras.get(e)?.getConfig()??null}hasCameraID(e){return this._cameras.has(e)}getCameraCount(){return this._cameras.size}getDefaultCameraID(){return this._cameras.keys().next().value??null}*getCameraConfigs(e){for(const[t,n]of this.getCameraConfigEntries(e))yield n}*getCameraConfigEntries(e){for(const t of e??this._cameras.keys()){const e=this.getCameraConfig(t);e&&(yield[t,e])}}getCameraIDs(){return new Set(this._cameras.keys())}getCameraIDsWithCapability(e){const t=new Set;for(const n of this._cameras.values())n.getCapabilities()?.matches(e)&&t.add(n.getID());return t}getCameraConfigForMedia(e){const t=e.getCameraID();return t?this.getCameraConfig(t):null}getEngineOfType(e){return this._enginesByType.get(e)??null}getEngineForCameraID(e){return this._cameras.get(e)?.getEngine()??null}getEnginesForCameraIDs(e){const t=new Map;for(const n of e){const e=this.getEngineForCameraID(n);e&&(t.has(e)||t.set(e,new Set),t.get(e)?.add(n))}return t.size?t:null}getEngineForMedia(e){const t=e.getCameraID();return t?this.getEngineForCameraID(t):null}getAllDependentCameras(e,t){const n=new Set,i=new Set,a=e=>{n.add(e);const r=this.getCamera(e),s=r?.getConfig();if(r&&s){t&&!r.getCapabilities()?.matches(t)||i.add(e);const o=new Set;s.dependencies.cameras.forEach((e=>o.add(e))),s.dependencies.all_cameras&&this.getCameraIDs().forEach((e=>o.add(e)));for(const e of o)n.has(e)||a(e)}};return a(e),i}}class b_{static isEventQuery(e){return e.type===p_.Event}static isRecordingQuery(e){return e.type===p_.Recording}static isRecordingSegmentsQuery(e){return e.type===p_.RecordingSegments}static isMediaMetadataQuery(e){return e.type===p_.MediaMetadata}}class w_{static isEventQueryResult(e){return e.type===m_.Event}static isRecordingQueryResult(e){return e.type===m_.Recording}static isRecordingSegmentsQueryResult(e){return e.type===m_.RecordingSegments}static isMediaMetadataQueryResult(e){return e.type===m_.MediaMetadata}}class x_{constructor(e,t){this._requestLimit=new Zd,this._api=e,this._engineFactory=t?.factory??new v_(this._api.getEntityRegistryManager()),this._store=t?.store??new y_}async initializeCamerasFromConfig(){const e=this._api.getConfigManager().getConfig(),t=this._api.getHASSManager().getHASS();if(!e||!t)return!1;this._requestLimit.concurrency=e.performance.features.max_simultaneous_engine_requests??1/0;const n=e.cameras.map((t=>{return n={},i=Il(e?.cameras_global),Du(n,i,t,((e,t)=>Array.isArray(t)?t:void 0));var n,i}));try{await this._initializeCameras(n)}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e,Hg("error.camera_initialization")),!1}return!0}async destroy(){await this._store.reset()}async _getEnginesForCameras(e){const t=new Map,n=new Map,i=this._api.getHASSManager().getHASS();
/* istanbul ignore if: the if path cannot be reached -- @preserve */
if(!i)return t;const a=await(async e=>await hd(e,(e=>this._engineFactory.getEngineForCamera(i,e))))(e);for(const[i,r]of e.entries()){const e=a[i],s=e?n.get(e)??await this._engineFactory.createEngine(e,{eventCallback:e=>this._api.getTriggersManager().handleCameraEvent(e),stateWatcher:this._api.getHASSManager().getStateWatcher(),resolvedMediaCache:this._api.getResolvedMediaCache()}):null;if(!s||!e)throw new d_(Hg("error.no_camera_engine"),Il(r));n.set(e,s),t.set(r,s)}return t}async _initializeCameras(e){const t=new Date,n=this._api.getHASSManager().getHASS();
/* istanbul ignore if: the if path cannot be reached -- @preserve */
if(!n)return;e.some((e=>(e=>e.triggers.motion||e.triggers.occupancy)(e)))&&await this._api.getEntityRegistryManager().fetchEntityList(n);const i=await this._getEnginesForCameras(e),a=await hd(i.entries(),(async([e,t])=>await t.createCamera(n,e))),r=async()=>{a.forEach((e=>e.destroy()))},s=new Set;for(const e of a){const t=Ug(e.getConfig());if(!t)throw await r(),new d_(Hg("error.no_camera_id"),e.getConfig());if(s.has(t))throw await r(),new d_(Hg("error.duplicate_camera_id"),e.getConfig());e.setID(t),s.add(t)}await this._store.setCameras(a),qg(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager initialized (Cameras: ",this._store.getCameras(),`, Duration: ${((new Date).getTime()-t.getTime())/1e3}s,`,")")}isInitialized(){return this._store.getCameraCount()>0}getStore(){return this._store}generateDefaultEventQueries(e,t){return this._generateDefaultQueries(e,{type:p_.Event,...t})}generateDefaultRecordingQueries(e,t){return this._generateDefaultQueries(e,{type:p_.Recording,...t})}generateDefaultRecordingSegmentsQueries(e,t){return this._generateDefaultQueries(e,{type:p_.RecordingSegments,...t})}_generateDefaultQueries(e,t){const n=[],i=ad(e),a=this._store.getEnginesForCameraIDs(i);if(!a)return null;for(const[e,i]of a){let a=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */b_.isEventQuery(t)?a=e.generateDefaultEventQuery(this._store,i,t):b_.isRecordingQuery(t)?a=e.generateDefaultRecordingQuery(this._store,i,t):b_.isRecordingSegmentsQuery(t)&&(a=e.generateDefaultRecordingSegmentsQuery(this._store,i,t));for(const e of a??[])n.push(e)}return n.length?n:null}async getMediaMetadata(){const e=new Set,t=new Set,n=new Set,i=new Set,a={type:p_.MediaMetadata,cameraIDs:this._store.getCameraIDs()},r=await this._handleQuery(a);for(const a of r.values())a.metadata.tags&&a.metadata.tags.forEach(e.add,e),a.metadata.what&&a.metadata.what.forEach(t.add,t),a.metadata.where&&a.metadata.where.forEach(n.add,n),a.metadata.days&&a.metadata.days.forEach(i.add,i);return t.size||n.size||i.size||e.size?{...e.size&&{tags:e},...t.size&&{what:t},...n.size&&{where:n},...i.size&&{days:i}}:null}async getEvents(e,t){return await this._handleQuery(e,t)}async getRecordings(e,t){return await this._handleQuery(e,t)}async getRecordingSegments(e,t){return await this._handleQuery(e,t)}async executeMediaQueries(e,t){return this._convertQueryResultsToMedia(await this._handleQuery(e,t))}async extendMediaQueries(e,t,n,i){if(!this._api.getHASSManager().getHASS())return null;const a=e=>{let n=null;for(const i of t){if(!Xd.isMedia(i))continue;const t=i.getStartTime();t&&(!n||"earliest"===e&&t<n||"latest"===e&&t>n)&&(n=t)}return n},r=this._api.getConfigManager().getCardWideConfig()?.performance?.features.media_chunk_size??50,s=[],o=[];for(const t of e){const e={...t};
/* istanbul ignore else: the else path cannot be reached -- @preserve */if("later"===n){const t=a("latest");t&&(e.start=t,delete e.end)}else if("earlier"===n){const t=a("earliest");t&&(e.end=t,delete e.start)}e.limit=r,o.push({...t,limit:(t.limit??0)+r}),s.push(e)}const c=this._convertQueryResultsToMedia(await this._handleQuery(s,i));if(!c.length)return null;const l=Jd(t.concat(c));return l.length===t.length?null:{queries:o,results:l}}async getMediaDownloadPath(e){const t=this._store.getCameraConfigForMedia(e),n=this._store.getEngineForMedia(e),i=this._api.getHASSManager().getHASS();return t&&n&&i?await n.getMediaDownloadPath(i,t,e):null}getMediaCapabilities(e){const t=this._store.getEngineForMedia(e);return t?t.getMediaCapabilities(e):null}async favoriteMedia(e,t){const n=this._store.getCameraConfigForMedia(e),i=this._store.getEngineForMedia(e),a=this._api.getHASSManager().getHASS();if(!n||!i||!a)return;const r=new Date;await this._requestLimit.add((()=>i.favoriteMedia(a,n,e,t))),qg(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager favorite request (",`Duration: ${((new Date).getTime()-r.getTime())/1e3}s,`,"Media:",e.getID(),", Favorite:",t,")")}areMediaQueriesResultsFresh(e,t){const n=new Date;for(const i of e){const e=this._store.getEnginesForCameraIDs(i.cameraIDs);for(const[a,r]of e??[]){const e=a.getQueryResultMaxAge({...i,cameraIDs:r});if(null!==e&&Ei(t,{seconds:e})<n)return!1}}return!0}async getMediaSeekTime(e,t){const n=e.getStartTime(),i=e.getEndTime(),a=this._store.getEngineForMedia(e),r=this._api.getHASSManager().getHASS();return!r||!a||!n||!i||t<n||t>i?null:await this._requestLimit.add((()=>a.getMediaSeekTime(r,this._store,e,t)))??null}async _handleQuery(e,t){const n=id(e),i=new Map,a=new Date,r=this._api.getHASSManager().getHASS();if(!r)return i;const s=async(e,n)=>{let a=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */b_.isEventQuery(n)?a=await e.getEvents(r,this._store,n,t):b_.isRecordingQuery(n)?a=await e.getRecordings(r,this._store,n,t):b_.isRecordingSegmentsQuery(n)?a=await e.getRecordingSegments(r,this._store,n,t):b_.isMediaMetadataQuery(n)&&(a=await e.getMediaMetadata(r,this._store,n,t)),a?.forEach(((e,t)=>i.set(t,e)))},o=async e=>{const t=this._store.getEnginesForCameraIDs(e.cameraIDs);t&&await Promise.all(Array.from(t.keys()).map((n=>this._requestLimit.add((()=>s(n,{...e,cameraIDs:t.get(n)}))))))};await Promise.all(n.map((e=>o(e))));const c=(l=Array.from(i.values()).map((e=>Number(e.cached??0))))&&l.length?function(e,t){for(var n,i=-1,a=e.length;++i<a;){var r=t(e[i]);void 0!==r&&(n=void 0===n?r:n+r)}return n}(l,ss):0;var l;return qg(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager request [Input queries:",n.length,", Cached output queries:",c,", Total output queries:",i.size,", Duration:",((new Date).getTime()-a.getTime())/1e3+"s,",", Queries:",n,", Results:",i,", Options:",t??{},"]"),i}_convertQueryResultsToMedia(e){const t=[],n=this._api.getHASSManager().getHASS();if(!n)return t;for(const[i,a]of e.entries()){const e=this._store.getEngineOfType(a.engine);if(e){let r=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */b_.isEventQuery(i)&&w_.isEventQueryResult(a)?r=e.generateMediaFromEvents(n,this._store,i,a):b_.isRecordingQuery(i)&&w_.isRecordingQueryResult(a)&&(r=e.generateMediaFromRecordings(n,this._store,i,a)),r&&t.push(...r)}}return Jd(t)}getCameraEndpoints(e,t){const n=this._store.getCameraConfig(e),i=this._store.getEngineForCameraID(e);return n&&i?i.getCameraEndpoints(n,t):null}getCameraMetadata(e){const t=this._store.getCameraConfig(e),n=this._store.getEngineForCameraID(e),i=this._api.getHASSManager().getHASS();return t&&n&&i?n.getCameraMetadata(i,t):null}getCameraCapabilities(e){return this._store.getCamera(e)?.getCapabilities()??null}getAggregateCameraCapabilities(e){const t=[...e??this._store.getCameraIDs()].map((e=>this._store.getCamera(e))).filter(gd);return new Wg({live:t.some((e=>e.getCapabilities()?.has("live"))),clips:t.some((e=>e.getCapabilities()?.has("clips"))),recordings:t.some((e=>e.getCapabilities()?.has("recordings"))),snapshots:t.some((e=>e.getCapabilities()?.has("snapshots"))),"favorite-events":t.some((e=>e.getCapabilities()?.has("favorite-events"))),"favorite-recordings":t.some((e=>e.getCapabilities()?.has("favorite-recordings"))),seek:t.some((e=>e.getCapabilities()?.has("seek"))),menu:t.some((e=>e.getCapabilities()?.has("menu")))})}async executePTZAction(e,t,n){const i=this._store.getCamera(e);i&&await this._requestLimit.add((()=>i.executePTZAction(this._api.getActionsManager(),t,n)))}}class M_{constructor(){this._listeners=[],this._state={},this._callListeners=e=>{this._listeners.forEach((t=>t(e)))}}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter((t=>t!==e))}getState(){return this._state}setState(e){this._processStateChange(this._calculateTrueChange(e))}_processStateChange(e){if(!Object.keys(e).length)return;const t=this._state;this._state={...t,...e},this._callListeners({old:t,change:e,new:this._state})}_calculateTrueChange(e){const t={};for(const n of Object.keys(e))zu(e[n],this._state[n])||(t[n]=e[n]);return t}}class k_ extends Kg{constructor(){super(new Map)}}const C_=hi.object({id:hi.string(),model:hi.string().nullable(),config_entries:hi.string().array(),manufacturer:hi.string().nullable()}).array();class S_ extends k_{}class E_{constructor(e){this._fetchedDeviceList=!1,this._cache=e}async getDevice(e,t){return this._cache.has(t)?this._cache.get(t):(await this._fetchDeviceList(e),this._cache.get(t)??null)}async getMatchingDevices(e,t){return await this._fetchDeviceList(e),this._cache.getMatches(t)}async _fetchDeviceList(e){if(this._fetchedDeviceList)return;let t=null;try{t=await Zg(e,C_,{type:"config/device_registry/list"})}catch(e){return void sd(e)}t.forEach((e=>{this._cache.set(e.id,e)})),this._fetchedDeviceList=!0}}const A_=hi.object({config_entry_id:hi.string().nullable(),device_id:hi.string().nullable(),disabled_by:hi.string().nullable(),entity_id:hi.string(),hidden_by:hi.string().nullable(),platform:hi.string(),translation_key:hi.string().nullable(),unique_id:hi.string().or(hi.number()).optional()}),T_=A_.array();class $_ extends k_{}class I_{constructor(e){this._fetchedEntityList=!1,this._cache=e}async getEntity(e,t){const n=this._cache.get(t);if(n)return n;let i=null;try{i=await Zg(e,A_,{type:"config/entity_registry/get",entity_id:t})}catch(e){return sd(e),null}return this._cache.set(i.entity_id,i),i}async getMatchingEntities(e,t){return await this.fetchEntityList(e),this._cache.getMatches(t)}async getEntities(e,t){const n=new Map;return await Promise.all(t.map((async t=>{const i=await this.getEntity(e,t);i&&n.set(t,i)}))),n}async fetchEntityList(e){if(this._fetchedEntityList)return;let t=null;try{t=await Zg(e,T_,{type:"config/entity_registry/list"})}catch(e){return void sd(e)}t.forEach((e=>{this._cache.set(e.entity_id,e)})),this._fetchedEntityList=!0}}class O_ extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield e)}}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const i="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:i}):this._set(e,{value:t,expiry:i}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;!1===this._deleteIfExpired(i,a)&&(yield[i,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;if(!this.cache.has(i)){!1===this._deleteIfExpired(i,a)&&(yield[i,a.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,i]of this.entriesAscending())e.call(t,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class L_ extends Kg{constructor(e){super(new O_({maxSize:e}))}}const D_=hi.object({url:hi.string(),mime_type:hi.string()});class j_ extends L_{constructor(){super(1e3)}}const z_=async(e,t,n)=>{const i=n?.get(t)??null;if(i)return i;const a={type:"media_source/resolve_media",media_content_id:t};let r=null;try{r=await Zg(e,D_,a)}catch(e){sd(e)}return n&&r&&n.set(t,r),r},R_=e=>{Ze(window,"haptic",e)};class P_ extends Xu{}class N_{constructor(e,t,n){this._context=e,this._action=t,this._config=n}_shouldSeekConfirmation(e){const t=e.getHASSManager().getHASS();return"boolean"==typeof this._action.confirmation&&this._action.confirmation||"object"==typeof this._action.confirmation&&(!this._action.confirmation.exemptions||!this._action.confirmation.exemptions.some((e=>e.user===t?.user.id)))}async execute(e){if(this._shouldSeekConfirmation(e)){const e=Od(this._action)?this._action.advanced_camera_card_action:this._action.action,t=("object"==typeof this._action.confirmation?this._action.confirmation.text:null)??`${Hg("actions.confirmation")}: ${e}`;if(!confirm(t))throw new P_(Hg("actions.abort"))}}async stop(){}}class F_ extends N_{}class V_ extends F_{async execute(e){await super.execute(e);const t=e.getHASSManager().getHASS();if(!t)return;const[n,i]=this._action.service.split(".",2);await t.callService(n,i,this._action.data,this._action.target)}}class B_ extends F_{async execute(e){await super.execute(e);const t=this._action.camera??(this._action.triggered?e.getTriggersManager().getMostRecentlyTriggeredCameraID():null),n=e.getViewManager().getView(),i=e.getConfigManager().getConfig();if(t&&n&&t!==n.camera){const a=i?.view.camera_select??"current",r="current"===a?n.view:a;await e.getViewManager().setViewByParametersWithNewQuery({params:{view:r,camera:t},failSafe:!0})}}}class H_ extends F_{async execute(e){await super.execute(e),e.getCameraURLManager().openURL()}}class U_ extends F_{async execute(e){await super.execute(e),Ze(e.getCardElementManager().getElement(),"ll-custom",this._action)}}class q_ extends F_{async execute(e){await super.execute(e),await e.getViewManager().setViewDefaultWithNewQuery()}}class W_ extends F_{async execute(e){await super.execute(e),await e.getViewManager().setViewByParametersWithNewQuery({params:{displayMode:this._action.display_mode}})}}class Z_ extends F_{async execute(e){await super.execute(e);const t=e.getViewManager().getView()?.queryResults?.getSelectedResult();t&&await e.getViewItemManager().download(t)}}class K_ extends F_{async execute(e){await super.execute(e),e.getExpandManager().toggleExpanded()}}class Q_{constructor(e){this._query=null,e&&(this._query=e)}getQuery(){return this._query}setQuery(e){return this._query=e,this}clone(){return Il(this)}}class Y_ extends Q_{getQueryCameraIDs(){if(!this._query)return null;const e=new Set;return this._query.forEach((t=>[...t.cameraIDs].forEach((t=>e.add(t))))),e}setQueryCameraIDs(e){if(!this._query)return this;const t=[];return this._query.forEach((n=>t.push({...n,cameraIDs:ad(e)}))),this._query=Gu(t,zu),this}hasQueriesForCameraIDs(e){for(const t of e)if(!this._query?.some((e=>e.cameraIDs.has(t))))return!1;return!0}isSupersetOf(e){for(const t of e.getQuery()??[]){let e=!1;for(const n of this._query??[])if(zu({...n,end:null,start:null},{...t,end:null,start:null})&&(!n.start&&!t.start||n.start&&t.start&&n.start<=t.start)&&(!n.end&&!t.end||n.end&&t.end&&n.end>=t.end)){e=!0;break}if(!e)return!1}return!0}}class G_ extends Y_{convertToClipsQueries(){for(const e of this._query??[])delete e.hasSnapshot,e.hasClip=!0;return this}}class X_ extends Y_{}class J_ extends Q_{}class ev extends F_{async execute(e){await super.execute(e);const t=e.getFoldersManager().getFolder(this._action.folder);if(!t)return;const n=e.getFoldersManager().generateDefaultFolderQuery(t);n&&await e.getViewManager().setViewByParametersWithExistingQuery({params:{view:this._action.advanced_camera_card_action,query:new J_(n)}})}}class tv extends F_{async execute(e){await super.execute(e),e.getFullscreenManager().toggleFullscreen()}}class nv extends F_{async execute(e){await super.execute(e),await this._action.callback(e)}}class iv extends F_{async execute(e){await super.execute(e),console[this._action.level](this._action.message)}}const av=(e,t)=>e.context?.live?.overrides?.get(t??e.camera)??t??e.camera,rv=e=>av(e)!==e.camera,sv=(e,t)=>{const n=e.context?.live?.overrides??new Map;n.set(e.camera,t),e.mergeInContext({live:{overrides:n}})};class ov extends F_{async execute(e){await super.execute(e);const t=this._action.media_player,n=e.getMediaPlayerManager();if("stop"===this._action.media_player_action)return void await n.stop(t);const i=e.getViewManager().getView(),a=i?.queryResults?.getSelectedResult()??null;i?.is("live")?await n.playLive(t,av(i)):i?.isViewerView()&&a&&Xd.isMedia(a)&&await n.playMedia(t,a)}}class cv extends F_{async execute(e){await super.execute(e),e.getCardElementManager().toggleMenu()}}class lv extends F_{async execute(e){await super.execute(e),await e.getMicrophoneManager().connect()}}class uv extends F_{async execute(e){await super.execute(e),e.getMicrophoneManager().disconnect()}}class dv extends F_{async execute(e){await super.execute(e),e.getMicrophoneManager().mute()}}class hv extends F_{async execute(e){await super.execute(e),await e.getMicrophoneManager().unmute()}}class pv extends F_{async execute(e){await super.execute(e);const t=this._action.entity??this._config?.entity??null;t&&Ze(e.getCardElementManager().getElement(),"hass-more-info",{entityId:t})}}class mv extends F_{async execute(e){await super.execute(e),await(e.getMediaLoadedInfoManager().get()?.mediaPlayerController?.mute())}}class fv extends F_{async execute(e){await super.execute(e),this._action.navigation_replace?history.replaceState(null,"",this._action.navigation_path):history.pushState(null,"",this._action.navigation_path),Ze(window,"location-changed",{replace:!!this._action.navigation_replace})}}class gv extends F_{async execute(e){await super.execute(e)}}class _v extends F_{async execute(e){await super.execute(e),await(e.getMediaLoadedInfoManager().get()?.mediaPlayerController?.pause())}}class vv extends F_{async execute(e){await super.execute(e);const t=e.getHASSManager().getHASS();if(!t)return;const[n,i]=this._action.perform_action.split(".",2);await t.callService(n,i,this._action.data,this._action.target)}}class yv extends F_{async execute(e){await super.execute(e),await(e.getMediaLoadedInfoManager().get()?.mediaPlayerController?.play())}}const bv=(e,t)=>{if(e.isViewerView()){const n=e.queryResults?.getSelectedResult()?.getID()??null;return"ptz"!==t?.type&&n?{targetID:n,type:"digital"}:null}if(e.is("live")){const n=av(e);let i="digital";return"digital"!==t?.type&&t?.cameraManager&&(wv(t.cameraManager,n)&&(i="ptz"),"ptz"!==i&&"ptz"===t?.type)?null:{targetID:n,type:i}}return e.is("image")?{targetID:kg,type:"digital"}:null},wv=(e,t)=>!!e.getStore().getCamera(t)?.getCapabilities()?.hasPTZCapability(),xv=async(e,t)=>{await(t?.[e]?.inProgressAction?.stop())},Mv=(e,t,n,i)=>{Ru(t,{[n]:{[e]:{inProgressAction:i}}})};class kv extends F_{constructor(){super(...arguments),this._timer=new Dd,this._stopped=!1}async stop(){this._stopped=!0,this._timer.stop()}async execute(e){await super.execute(e);const t=e.getViewManager().getView();if(!t)return;const n=this._action.camera??bv(t,{type:"ptz",cameraManager:e.getCameraManager()})?.targetID??null,i=n?e.getCameraManager().getCameraCapabilities(n)?.getPTZCapabilities():null,a=n?e.getCameraManager().getStore().getCameraConfig(n)?.ptz:null;if(!n||!i||!a)return;if(!this._action.ptz_action)return void(i.presets&&i.presets.length>=1&&await e.getCameraManager().executePTZAction(n,"preset",{phase:this._action.ptz_phase,preset:i.presets[0]}));const r=(e=>{switch(e){case"left":case"right":case"up":case"down":return e;case"zoom_in":return"zoomIn";case"zoom_out":return"zoomOut"}return null})(this._action.ptz_action);if(r&&i[r]?.includes(this._action.ptz_phase?Zu.Continuous:Zu.Relative)||"preset"===this._action.ptz_action)return await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{phase:this._action.ptz_phase,preset:this._action.ptz_preset});if("start"===this._action.ptz_phase){await xv(n,this._context.ptz),Mv(n,this._context,"ptz",this);const t=async()=>{
/* istanbul ignore else: the else path cannot be reached as ptz_action
                being present is checked above -- @preserve */
this._action.ptz_action&&await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset}),this._stopped||this._timer.start(a.r2c_delay_between_calls_seconds,t)};this._stopped=!1,await t()}else"stop"===this._action.ptz_phase?await xv(n,this._context.ptz):(this._stopped=!1,await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset,phase:"start"}),this._timer.start(a.c2r_delay_between_calls_seconds,(async()=>{
/* istanbul ignore else: the else path cannot be reached as ptz_action
                being present is checked above -- @preserve */
this._action.ptz_action&&await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset,phase:"stop"})})))}}class Cv extends F_{async execute(e){await super.execute(e),e.getViewManager().setViewWithMergedContext({ptzControls:{enabled:this._action.enabled}})}}const Sv=50,Ev=50,Av=1,Tv=4,$v=e=>void 0===e?.pan?.x&&void 0===e?.pan?.y&&void 0===e?.zoom;class Iv{constructor(e){this._context=e}modify(e){e.mergeInContext(this._context)}}const Ov=(e,t)=>({zoom:{[e]:{observed:t?.observed??void 0,requested:t?.requested??null}}}),Lv=(e,t,n)=>{t&&n&&t.setViewByParameters({modifiers:[new Iv(Ov(n,{observed:e.detail}))]})},Dv=1,jv=10,zv=hi.number().min(1).max(10);class Rv extends F_{constructor(){super(...arguments),this._timer=new Dd}async _stepChange(e,t){e.getViewManager().setViewWithMergedContext(Ov(t,{requested:this._convertActionToZoomSettings(e.getViewManager().getView()?.context?.zoom?.[t]?.observed)}))}async stop(){this._timer.stop()}async execute(e){await super.execute(e);const t=e.getViewManager().getView();if(!t)return;const n=this._action.target_id??bv(t,{type:"digital",cameraManager:e.getCameraManager()})?.targetID;return n?this._action.absolute||!this._action.ptz_phase?await this._stepChange(e,n):
/* istanbul ignore else: the else path cannot be reached -- @preserve */
void("start"===this._action.ptz_phase?(await xv(n,this._context.ptzDigital),Mv(n,this._context,"ptzDigital",this),await this._stepChange(e,n),this._timer.startRepeated(.1,(()=>this._stepChange(e,n)))):"stop"===this._action.ptz_phase&&(await xv(n,this._context.ptzDigital),delete this._context.ptzDigital?.[n])):void 0}_convertActionToZoomSettings(e){if(!this._action.absolute&&!this._action.ptz_action)return{};if(this._action.absolute)return this._action.absolute;const t=e?.zoom??1,n=e?.pan?.x??50,i=e?.pan?.y??50,a="zoom_in"===this._action.ptz_action?.1:"zoom_out"===this._action.ptz_action?-.1:0,r="left"===this._action.ptz_action?-5:"right"===this._action.ptz_action?5:0,s="up"===this._action.ptz_action?-5:"down"===this._action.ptz_action?5:0;return{zoom:mc(t+a,1,10),pan:{x:mc(n+r,0,100),y:mc(i+s,0,100)}}}}class Pv extends F_{async execute(e){await super.execute(e);const t=e.getViewManager().getView();let n=null,i=null;if(this._action.target_id)n=this._action.target_id,i=wv(e.getCameraManager(),n)?"ptz":"digital";else if(t){const a=bv(t,{cameraManager:e.getCameraManager()});n=a?.targetID??null,i=a?.type??null}n&&null!==i&&("ptz"===i?this._toPTZAction(n):this._toPTZDigitalAction(n)).execute(e)}_toPTZAction(e){return new kv(this._context,(t={cardID:this._action.card_id,cameraID:e,ptzAction:this._action.ptz_action,ptzPhase:this._action.ptz_phase,ptzPreset:this._action.ptz_preset},{action:"fire-dom-event",advanced_camera_card_action:"ptz",...t?.cardID&&{card_id:t.cardID},...t?.ptzAction&&{ptz_action:t.ptzAction},...t?.ptzPhase&&{ptz_phase:t.ptzPhase},...t?.ptzPreset&&{ptz_preset:t.ptzPreset},...t?.cameraID&&{camera:t.cameraID}}),this._config);var t}_toPTZDigitalAction(e){return new Rv(this._context,(t={cardID:this._action.card_id,ptzPhase:this._action.ptz_phase,ptzAction:this._action.ptz_action,targetID:e},{action:"fire-dom-event",advanced_camera_card_action:"ptz_digital",...t?.cardID&&{card_id:t.cardID},...t?.ptzAction&&{ptz_action:t.ptzAction},...t?.ptzPhase&&{ptz_phase:t.ptzPhase},...t?.absolute&&{absolute:t.absolute},...t?.targetID&&{target_id:t.targetID}}),this._config);var t}}const Nv=(e,t="download")=>{const n=new URL(e).origin===window.location.origin,i=e.startsWith("data:");if(!n&&!i)return void window.open(e,"_blank");const a=document.createElement("a");a.setAttribute("download",t),a.href=e,a.click(),a.remove()},Fv=e=>Bv(e,e.naturalWidth,e.naturalHeight),Vv=e=>Bv(e,e.videoWidth,e.videoHeight),Bv=(e,t,n)=>{const i=document.createElement("canvas");i.width=t,i.height=n;const a=i.getContext("2d");return a?(a.drawImage(e,0,0,i.width,i.height),i.toDataURL("image/jpeg")):null};class Hv extends F_{async execute(e){await super.execute(e);const t=await(e.getMediaLoadedInfoManager().get()?.mediaPlayerController?.getScreenshotURL());t&&Nv(t,(e=>{if(e?.is("live")||e?.is("image"))return`${e.view}_${e.camera}_${Ea(new Date,"yyyy-MM-dd-HH-mm-ss")}.jpg`;if(e?.isViewerView()){const t=e.queryResults?.getSelectedResult(),n=t?.getID()??null;return`${e.view}_${e.camera}${n?`_${n}`:""}.jpg`}return"screenshot.jpg"})(e.getViewManager().getView()))}}const Uv=async e=>{await new Promise((t=>setTimeout(t,1e3*e)))};class qv extends F_{async execute(e){var t;await super.execute(e),await Uv((t=this._action.duration,3600*(t.h??0)+60*(t.m??0)+(t.s??0)+(t.ms??0)/1e3))}}class Wv extends F_{async execute(e){switch(await super.execute(e),this._action.status_bar_action){case"reset":e.getStatusBarItemManager().removeAllDynamicStatusBarItems();break;case"add":this._action.items?.forEach((t=>e.getStatusBarItemManager().addDynamicStatusBarItem(t)));break;case"remove":this._action.items?.forEach((t=>e.getStatusBarItemManager().removeDynamicStatusBarItem(t)))}}}class Zv{modify(e){(e=>{const t=e.context?.live?.overrides;t&&t.has(e.camera)&&e.context?.live?.overrides?.delete(e.camera)})(e)}}class Kv extends F_{async execute(e){await super.execute(e),e.getViewManager().setViewByParameters({modifiers:[new Zv]})}}class Qv{constructor(e){this._api=e}modify(e){const t=[...this._api.getCameraManager().getStore().getAllDependentCameras(e.camera,"substream")];if(t.length<=1)return;const n=av(e),i=t.indexOf(n),a=i<0?0:(i+1)%t.length;sv(e,t[a])}}class Yv extends F_{async execute(e){await super.execute(e),e.getViewManager().setViewByParameters({modifiers:[new Qv(e)]})}}class Gv{constructor(e){this._substreamID=e}modify(e){sv(e,this._substreamID)}}class Xv extends F_{async execute(e){await super.execute(e),e.getViewManager().setViewByParameters({modifiers:[new Gv(this._action.camera)]})}}const Jv=e=>e.substring(0,e.indexOf(".")),ey=["closed","locked","off"],ty=["open","unlocked","on"];class ny extends F_{async execute(e){await super.execute(e);const t=e.getHASSManager().getHASS(),n=this._config?.entity;if(!t||!n)return;const i=t.states[n]?.state;if(!i)return;const a=ey.includes(i),r=Jv(n),s="group"===r?"homeassistant":r,o="lock"===r?a?"unlock":"lock":"cover"===r?a?"open_cover":"close_cover":a?"turn_on":"turn_off";await t.callService(s,o,{entity_id:n})}}class iy extends F_{async execute(e){await super.execute(e),await(e.getMediaLoadedInfoManager().get()?.mediaPlayerController?.unmute())}}class ay extends F_{async execute(e){await super.execute(e),window.open(this._action.url_path)}}class ry extends F_{async execute(e){await super.execute(e),await e.getViewManager().setViewByParametersWithNewQuery({params:{view:this._action.advanced_camera_card_action}})}}class sy{createAction(e,t,n){if(t.card_id&&t.card_id!==n?.cardID)return null;switch(t.action){case"more-info":return new pv(e,t,n?.config);case"toggle":return new ny(e,t,n?.config);case"navigate":return new fv(e,t,n?.config);case"url":return new ay(e,t,n?.config);case"perform-action":return new vv(e,t,n?.config);case"call-service":return new V_(e,t,n?.config);case"none":return new gv(e,t,n?.config)}if(!Od(t))return new U_(e,t,n?.config);switch(t.advanced_camera_card_action){case"default":return new q_(e,t,n?.config);case"clip":case"clips":case"image":case"live":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":case"diagnostics":return new ry(e,t,n?.config);case"sleep":return new qv(e,t,n?.config);case"download":return new Z_(e,t,n?.config);case"camera_ui":return new H_(e,t,n?.config);case"expand":return new K_(e,t,n?.config);case"fullscreen":return new tv(e,t,n?.config);case"menu_toggle":return new cv(e,t,n?.config);case"camera_select":return new B_(e,t,n?.config);case"live_substream_select":return new Xv(e,t,n?.config);case"live_substream_off":return new Kv(e,t,n?.config);case"live_substream_on":return new Yv(e,t,n?.config);case"media_player":return new ov(e,t,n?.config);case"microphone_connect":return new lv(e,t,n?.config);case"microphone_disconnect":return new uv(e,t,n?.config);case"microphone_mute":return new dv(e,t,n?.config);case"microphone_unmute":return new hv(e,t,n?.config);case"mute":return new mv(e,t,n?.config);case"unmute":return new iy(e,t,n?.config);case"play":return new yv(e,t,n?.config);case"pause":return new _v(e,t,n?.config);case"screenshot":return new Hv(e,t,n?.config);case"display_mode_select":return new W_(e,t,n?.config);case"ptz":return new kv(e,t,n?.config);case"ptz_digital":return new Rv(e,t,n?.config);case"ptz_multi":return new Pv(e,t,n?.config);case"ptz_controls":return new Cv(e,t,n?.config);case"log":return new iv(e,t,n?.config);case"status_bar":return new Wv(e,t,n?.config);case wi:return new nv(e,t,n?.config);case"folder":case"folders":return new ev(e,t,n?.config)}
/* istanbul ignore next: this path cannot be reached -- @preserve */
/* istanbul ignore next: this path cannot be reached -- @preserve */
return console.warn(`Advanced Camera Card received unknown card action: ${t.advanced_camera_card_action}`),null}}class oy{constructor(e,t,n){this._actions=[],this._factory=new sy,this._stopped=!1,this._context=e;for(const i of id(t)){const t=this._factory.createAction(e,i,n);t&&this._actions.push(t)}}async execute(e){for(const t of this._actions){if(this._stopped)break;await t.execute(e)}}async stop(){this._stopped=!0}}const cy=hi.object({action:hi.enum(["tap","double_tap","hold","start_tap","end_tap"])}),ly=hi.object({detail:cy});class uy{constructor(e,t){this._actionsInFlight=[],this._actionContext={},this.handleInteractionEvent=async e=>{const t=ly.safeParse(e);if(!t.success)return;const n=t.data.detail.action,i=this.getMergedActions(),a=$d(n,i);i&&n&&a&&await this.executeActions({actions:a,config:i})},this.handleCustomActionEvent=async e=>{if(!("detail"in e))return;const t=e.detail;Od(t)&&await this.executeActions({actions:t})},this.handleActionExecutionRequestEvent=async e=>{await this.executeActions(e.detail)},this._api=e,this._templateRenderer=t??null}getMergedActions(){const e=this._api.getViewManager().getView();if(this._api.getMessageManager().hasMessage())return{};const t=this._api.getConfigManager().getConfig();let n;if(e?.is("live"))n=t?.live.actions;else if(e?.isMediaGalleryView())n=t?.media_gallery?.actions;else if(e?.isViewerView())n=t?.media_viewer.actions;else{if(!e?.is("image"))return{};n=t?.image?.actions}return{...t?.view.actions,...n}}async uninitialize(){await hd(this._actionsInFlight,(e=>e.stop()))}async executeActions(e){const t=this._api.getHASSManager().getHASS(),n=t&&this._templateRenderer?this._templateRenderer.renderRecursively(t,e.actions,{conditionState:this._api.getConditionStateManager().getState(),triggerData:e?.triggerData}):e.actions,i=new oy(this._actionContext,n,{config:e.config,cardID:this._api.getConfigManager().getConfig()?.card_id});this._actionsInFlight.push(i);try{await i.execute(this._api),R_("success")}catch(e){sd(e),R_("warning")}this._actionsInFlight=this._actionsInFlight.filter((e=>e!==i))}}var dy,hy={exports:{}};
/*! Browser bundle of nunjucks 3.2.4  */"undefined"!=typeof self&&self,dy=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){var i=Array.prototype,a=Object.prototype,r={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","\\":"&#92;"},s=/[&"'<>\\]/g;function o(e,t){return a.hasOwnProperty.call(e,t)}function c(e){return r[e]}function l(e,t,n){var i,a,r;if(e instanceof Error&&(e=(a=e).name+": "+a.message),Object.setPrototypeOf?(i=new Error(e),Object.setPrototypeOf(i,l.prototype)):(i=this,Object.defineProperty(i,"message",{enumerable:!1,writable:!0,value:e})),Object.defineProperty(i,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(i,this.constructor),a){var s=Object.getOwnPropertyDescriptor(a,"stack");(r=s&&(s.get||function(){return s.value}))||(r=function(){return a.stack})}else{var o=new Error(e).stack;r=function(){return o}}return Object.defineProperty(i,"stack",{get:function(){return r.call(i)}}),Object.defineProperty(i,"cause",{value:a}),i.lineno=t,i.colno=n,i.firstUpdate=!0,i.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},i}function u(e){return"[object Function]"===a.toString.call(e)}function d(e){return"[object Array]"===a.toString.call(e)}function h(e){return"[object String]"===a.toString.call(e)}function p(e){return"[object Object]"===a.toString.call(e)}function m(e){var t,n=(t=e)?"string"==typeof t?t.split("."):[t]:[];return function(e){for(var t=e,i=0;i<n.length;i++){var a=n[i];if(!o(t,a))return;t=t[a]}return t}}function f(e){return Array.prototype.slice.call(e)}function g(e,t,n){return Array.prototype.indexOf.call(e||[],t,n)}function _(e){var t=[];for(var n in e)o(e,n)&&t.push(n);return t}(t=e.exports={}).hasOwnProp=o,t._prettifyError=function(e,n,i){if(i.Update||(i=new t.TemplateError(i)),i.Update(e),!n){var a=i;(i=new Error(a.message)).name=a.name}return i},Object.setPrototypeOf?Object.setPrototypeOf(l.prototype,Error.prototype):l.prototype=Object.create(Error.prototype,{constructor:{value:l}}),t.TemplateError=l,t.escape=function(e){return e.replace(s,c)},t.isFunction=u,t.isArray=d,t.isString=h,t.isObject=p,t.getAttrGetter=m,t.groupBy=function(e,t,n){for(var i={},a=u(t)?t:m(t),r=0;r<e.length;r++){var s=e[r],o=a(s,r);if(void 0===o&&!0===n)throw new TypeError('groupby: attribute "'+t+'" resolved to undefined');(i[o]||(i[o]=[])).push(s)}return i},t.toArray=f,t.without=function(e){var t=[];if(!e)return t;for(var n=e.length,i=f(arguments).slice(1),a=-1;++a<n;)-1===g(i,e[a])&&t.push(e[a]);return t},t.repeat=function(e,t){for(var n="",i=0;i<t;i++)n+=e;return n},t.each=function(e,t,n){if(null!=e)if(i.forEach&&e.forEach===i.forEach)e.forEach(t,n);else if(e.length===+e.length)for(var a=0,r=e.length;a<r;a++)t.call(n,e[a],a,e)},t.map=function(e,t){var n=[];if(null==e)return n;if(i.map&&e.map===i.map)return e.map(t);for(var a=0;a<e.length;a++)n[n.length]=t(e[a],a);return e.length===+e.length&&(n.length=e.length),n},t.asyncIter=function(e,t,n){var i=-1;!function a(){++i<e.length?t(e[i],i,a,n):n()}()},t.asyncFor=function(e,t,n){var i=_(e||{}),a=i.length,r=-1;!function s(){r++;var o=i[r];r<a?t(o,e[o],r,a,s):n()}()},t.indexOf=g,t.keys=_,t._entries=function(e){return _(e).map((function(t){return[t,e[t]]}))},t._values=function(e){return _(e).map((function(t){return e[t]}))},t._assign=t.extend=function(e,t){return e=e||{},_(t).forEach((function(n){e[n]=t[n]})),e},t.inOperator=function(e,t){if(d(t)||h(t))return-1!==t.indexOf(e);if(p(t))return e in t;throw new Error('Cannot use "in" operator to search for "'+e+'" in unexpected types.')}},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?r:String(r)),i)}var a,r}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}var o=n(16),c=n(0);function l(e,t,n){n=n||{},c.keys(n).forEach((function(t){n[t]=function(e,t){return"function"!=typeof e||"function"!=typeof t?t:function(){var n=this.parent;this.parent=e;var i=t.apply(this,arguments);return this.parent=n,i}}(e.prototype[t],n[t])}));var i=function(e){function n(){return e.apply(this,arguments)||this}return r(n,e),a(n,[{key:"typename",get:function(){return t}}]),n}(e);return c._assign(i.prototype,n),i}var u=function(){function e(){this.init.apply(this,arguments)}return e.prototype.init=function(){},e.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),l(this,e,t)},a(e,[{key:"typename",get:function(){return this.constructor.name}}]),e}(),d=function(e){function t(){var t,n;return(t=n=e.call(this)||this).init.apply(t,arguments),n}return r(t,e),t.prototype.init=function(){},t.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),l(this,e,t)},a(t,[{key:"typename",get:function(){return this.constructor.name}}]),t}(o);e.exports={Obj:u,EmitterObj:d}},function(e,t,n){var i=n(0),a=Array.from,r="function"==typeof Symbol&&Symbol.iterator&&"function"==typeof a,s=function(){function e(e,t){this.variables=Object.create(null),this.parent=e,this.topLevel=!1,this.isolateWrites=t}var t=e.prototype;return t.set=function(e,t,n){var i=e.split("."),a=this.variables,r=this;if(n&&(r=this.resolve(i[0],!0)))r.set(e,t);else{for(var s=0;s<i.length-1;s++){var o=i[s];a[o]||(a[o]={}),a=a[o]}a[i[i.length-1]]=t}},t.get=function(e){var t=this.variables[e];return void 0!==t?t:null},t.lookup=function(e){var t=this.parent,n=this.variables[e];return void 0!==n?n:t&&t.lookup(e)},t.resolve=function(e,t){var n=t&&this.isolateWrites?void 0:this.parent;return void 0!==this.variables[e]?this:n&&n.resolve(e)},t.push=function(t){return new e(this,t)},t.pop=function(){return this.parent},e}();function o(e){return e&&Object.prototype.hasOwnProperty.call(e,"__keywords")}function c(e){var t=e.length;return 0===t?0:o(e[t-1])?t-1:t}function l(e){if("string"!=typeof e)return e;this.val=e,this.length=e.length}l.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),l.prototype.valueOf=function(){return this.val},l.prototype.toString=function(){return this.val},e.exports={Frame:s,makeMacro:function(e,t,n){return function(){for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];var s,l=c(a),u=function(e){var t=e.length;if(t){var n=e[t-1];if(o(n))return n}return{}}(a);if(l>e.length)s=a.slice(0,e.length),a.slice(s.length,l).forEach((function(e,n){n<t.length&&(u[t[n]]=e)})),s.push(u);else if(l<e.length){s=a.slice(0,l);for(var d=l;d<e.length;d++){var h=e[d];s.push(u[h]),delete u[h]}s.push(u)}else s=a;return n.apply(this,s)}},makeKeywordArgs:function(e){return e.__keywords=!0,e},numArgs:c,suppressValue:function(e,t){return e=null!=e?e:"",!t||e instanceof l||(e=i.escape(e.toString())),e},ensureDefined:function(e,t,n){if(null==e)throw new i.TemplateError("attempted to output null or undefined value",t+1,n+1);return e},memberLookup:function(e,t){if(null!=e)return"function"==typeof e[t]?function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e[t].apply(e,i)}:e[t]},contextOrFrameLookup:function(e,t,n){var i=t.lookup(n);return void 0!==i?i:e.lookup(n)},callWrap:function(e,t,n,i){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!=typeof e)throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(n,i)},handleError:function(e,t,n){return e.lineno?e:new i.TemplateError(e,t,n)},isArray:i.isArray,keys:i.keys,SafeString:l,copySafeness:function(e,t){return e instanceof l?new l(t):t.toString()},markSafe:function(e){var t=typeof e;return"string"===t?new l(e):"function"!==t?e:function(t){var n=e.apply(this,arguments);return"string"==typeof n?new l(n):n}},asyncEach:function(e,t,n,a){if(i.isArray(e)){var r=e.length;i.asyncIter(e,(function(e,i,a){switch(t){case 1:n(e,i,r,a);break;case 2:n(e[0],e[1],i,r,a);break;case 3:n(e[0],e[1],e[2],i,r,a);break;default:e.push(i,r,a),n.apply(this,e)}}),a)}else i.asyncFor(e,(function(e,t,i,a,r){n(e,t,i,a,r)}),a)},asyncAll:function(e,t,n,a){var r,s,o=0;function c(e,t){o++,s[e]=t,o===r&&a(null,s.join(""))}if(i.isArray(e))if(r=e.length,s=new Array(r),0===r)a(null,"");else for(var l=0;l<e.length;l++){var u=e[l];switch(t){case 1:n(u,l,r,c);break;case 2:n(u[0],u[1],l,r,c);break;case 3:n(u[0],u[1],u[2],l,r,c);break;default:u.push(l,r,c),n.apply(this,u)}}else{var d=i.keys(e||{});if(r=d.length,s=new Array(r),0===r)a(null,"");else for(var h=0;h<d.length;h++){var p=d[h];n(p,e[p],h,r,c)}}},inOperator:i.inOperator,fromIterator:function(e){return"object"!=typeof e||null===e||i.isArray(e)?e:r&&Symbol.iterator in e?a(e):e}}},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?r:String(r)),i)}var a,r}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function o(e,t,n){e instanceof t&&n.push(e),e instanceof c&&e.findAll(t,n)}var c=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(e,t){for(var n=arguments,i=this,a=arguments.length,r=new Array(a>2?a-2:0),s=2;s<a;s++)r[s-2]=arguments[s];this.lineno=e,this.colno=t,this.fields.forEach((function(e,t){var a=n[t+2];void 0===a&&(a=null),i[e]=a}))},n.findAll=function(e,t){var n=this;return t=t||[],this instanceof u?this.children.forEach((function(n){return o(n,e,t)})):this.fields.forEach((function(i){return o(n[i],e,t)})),t},n.iterFields=function(e){var t=this;this.fields.forEach((function(n){e(t[n],n)}))},t}(n(1).Obj),l=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),a(t,[{key:"typename",get:function(){return"Value"}},{key:"fields",get:function(){return["value"]}}]),t}(c),u=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(t,n,i){e.prototype.init.call(this,t,n,i||[])},n.addChild=function(e){this.children.push(e)},a(t,[{key:"typename",get:function(){return"NodeList"}},{key:"fields",get:function(){return["children"]}}]),t}(c),d=u.extend("Root"),h=l.extend("Literal"),p=l.extend("Symbol"),m=u.extend("Group"),f=u.extend("Array"),g=c.extend("Pair",{fields:["key","value"]}),_=u.extend("Dict"),v=c.extend("LookupVal",{fields:["target","val"]}),y=c.extend("If",{fields:["cond","body","else_"]}),b=y.extend("IfAsync"),w=c.extend("InlineIf",{fields:["cond","body","else_"]}),x=c.extend("For",{fields:["arr","name","body","else_"]}),M=x.extend("AsyncEach"),k=x.extend("AsyncAll"),C=c.extend("Macro",{fields:["name","args","body"]}),S=C.extend("Caller"),E=c.extend("Import",{fields:["template","target","withContext"]}),A=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(t,n,i,a,r){e.prototype.init.call(this,t,n,i,a||new u,r)},a(t,[{key:"typename",get:function(){return"FromImport"}},{key:"fields",get:function(){return["template","names","withContext"]}}]),t}(c),T=c.extend("FunCall",{fields:["name","args"]}),$=T.extend("Filter"),I=$.extend("FilterAsync",{fields:["name","args","symbol"]}),O=_.extend("KeywordArgs"),L=c.extend("Block",{fields:["name","body"]}),D=c.extend("Super",{fields:["blockName","symbol"]}),j=c.extend("TemplateRef",{fields:["template"]}).extend("Extends"),z=c.extend("Include",{fields:["template","ignoreMissing"]}),R=c.extend("Set",{fields:["targets","value"]}),P=c.extend("Switch",{fields:["expr","cases","default"]}),N=c.extend("Case",{fields:["cond","body"]}),F=u.extend("Output"),V=c.extend("Capture",{fields:["body"]}),B=h.extend("TemplateData"),H=c.extend("UnaryOp",{fields:["target"]}),U=c.extend("BinOp",{fields:["left","right"]}),q=U.extend("In"),W=U.extend("Is"),Z=U.extend("Or"),K=U.extend("And"),Q=H.extend("Not"),Y=U.extend("Add"),G=U.extend("Concat"),X=U.extend("Sub"),J=U.extend("Mul"),ee=U.extend("Div"),te=U.extend("FloorDiv"),ne=U.extend("Mod"),ie=U.extend("Pow"),ae=H.extend("Neg"),re=H.extend("Pos"),se=c.extend("Compare",{fields:["expr","ops"]}),oe=c.extend("CompareOperand",{fields:["expr","type"]}),ce=c.extend("CallExtension",{init:function(e,t,n,i){this.parent(),this.extName=e.__name||e,this.prop=t,this.args=n||new u,this.contentArgs=i||[],this.autoescape=e.autoescape},fields:["extName","prop","args","contentArgs"]}),le=ce.extend("CallExtensionAsync");function ue(e,t,n){var i=e.split("\n");i.forEach((function(e,a){e&&(n&&a>0||!n)&&process.stdout.write(" ".repeat(t));var r=a===i.length-1?"":"\n";process.stdout.write(""+e+r)}))}e.exports={Node:c,Root:d,NodeList:u,Value:l,Literal:h,Symbol:p,Group:m,Array:f,Pair:g,Dict:_,Output:F,Capture:V,TemplateData:B,If:y,IfAsync:b,InlineIf:w,For:x,AsyncEach:M,AsyncAll:k,Macro:C,Caller:S,Import:E,FromImport:A,FunCall:T,Filter:$,FilterAsync:I,KeywordArgs:O,Block:L,Super:D,Extends:j,Include:z,Set:R,Switch:P,Case:N,LookupVal:v,BinOp:U,In:q,Is:W,Or:Z,And:K,Not:Q,Add:Y,Concat:G,Sub:X,Mul:J,Div:ee,FloorDiv:te,Mod:ne,Pow:ie,Neg:ae,Pos:re,Compare:se,CompareOperand:oe,CallExtension:ce,CallExtensionAsync:le,printNodes:function e(t,n){if(n=n||0,ue(t.typename+": ",n),t instanceof u)ue("\n"),t.children.forEach((function(t){e(t,n+2)}));else if(t instanceof ce)ue(t.extName+"."+t.prop+"\n"),t.args&&e(t.args,n+2),t.contentArgs&&t.contentArgs.forEach((function(t){e(t,n+2)}));else{var i=[],a=null;t.iterFields((function(e,t){e instanceof c?i.push([t,e]):(a=a||{})[t]=e})),a?ue(JSON.stringify(a,null,2)+"\n",null,!0):ue("\n"),i.forEach((function(t){var i=t[0],a=t[1];ue("["+i+"] =>",n+2),e(a,n+4)}))}}}},function(e,t){},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(8),r=n(17),s=n(3),o=n(0).TemplateError,c=n(2).Frame,l=n(1).Obj,u={"==":"==","===":"===","!=":"!=","!==":"!==","<":"<",">":">","<=":"<=",">=":">="},d=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var r=a.prototype;return r.init=function(e,t){this.templateName=e,this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this._scopeClosers="",this.inBlock=!1,this.throwOnUndefined=t},r.fail=function(e,t,n){throw void 0!==t&&(t+=1),void 0!==n&&(n+=1),new o(e,t,n)},r._pushBuffer=function(){var e=this._tmpid();return this.bufferStack.push(this.buffer),this.buffer=e,this._emit("var "+this.buffer+' = "";'),e},r._popBuffer=function(){this.buffer=this.bufferStack.pop()},r._emit=function(e){this.codebuf.push(e)},r._emitLine=function(e){this._emit(e+"\n")},r._emitLines=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){return e._emitLine(t)}))},r._emitFuncBegin=function(e,t){this.buffer="output",this._scopeClosers="",this._emitLine("function "+t+"(env, context, frame, runtime, cb) {"),this._emitLine("var lineno = "+e.lineno+";"),this._emitLine("var colno = "+e.colno+";"),this._emitLine("var "+this.buffer+' = "";'),this._emitLine("try {")},r._emitFuncEnd=function(e){e||this._emitLine("cb(null, "+this.buffer+");"),this._closeScopeLevels(),this._emitLine("} catch (e) {"),this._emitLine("  cb(runtime.handleError(e, lineno, colno));"),this._emitLine("}"),this._emitLine("}"),this.buffer=null},r._addScopeLevel=function(){this._scopeClosers+="})"},r._closeScopeLevels=function(){this._emitLine(this._scopeClosers+";"),this._scopeClosers=""},r._withScopedSyntax=function(e){var t=this._scopeClosers;this._scopeClosers="",e.call(this),this._closeScopeLevels(),this._scopeClosers=t},r._makeCallback=function(e){var t=this._tmpid();return"function("+t+(e?","+e:"")+") {\nif("+t+") { cb("+t+"); return; }"},r._tmpid=function(){return this.lastId++,"t_"+this.lastId},r._templateName=function(){return null==this.templateName?"undefined":JSON.stringify(this.templateName)},r._compileChildren=function(e,t){var n=this;e.children.forEach((function(e){n.compile(e,t)}))},r._compileAggregate=function(e,t,n,i){var a=this;n&&this._emit(n),e.children.forEach((function(e,n){n>0&&a._emit(","),a.compile(e,t)})),i&&this._emit(i)},r._compileExpression=function(e,t){this.assertType(e,s.Literal,s.Symbol,s.Group,s.Array,s.Dict,s.FunCall,s.Caller,s.Filter,s.LookupVal,s.Compare,s.InlineIf,s.In,s.Is,s.And,s.Or,s.Not,s.Add,s.Concat,s.Sub,s.Mul,s.Div,s.FloorDiv,s.Mod,s.Pow,s.Neg,s.Pos,s.Compare,s.NodeList),this.compile(e,t)},r.assertType=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.some((function(t){return e instanceof t}))||this.fail("assertType: invalid type: "+e.typename,e.lineno,e.colno)},r.compileCallExtension=function(e,t,n){var i=this,a=e.args,r=e.contentArgs,o="boolean"!=typeof e.autoescape||e.autoescape;if(n||this._emit(this.buffer+" += runtime.suppressValue("),this._emit('env.getExtension("'+e.extName+'")["'+e.prop+'"]('),this._emit("context"),(a||r)&&this._emit(","),a&&(a instanceof s.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),a.children.forEach((function(e,n){i._compileExpression(e,t),(n!==a.children.length-1||r.length)&&i._emit(",")}))),r.length&&r.forEach((function(e,n){if(n>0&&i._emit(","),e){i._emitLine("function(cb) {"),i._emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}");var a=i._pushBuffer();i._withScopedSyntax((function(){i.compile(e,t),i._emitLine("cb(null, "+a+");")})),i._popBuffer(),i._emitLine("return "+a+";"),i._emitLine("}")}else i._emit("null")})),n){var c=this._tmpid();this._emitLine(", "+this._makeCallback(c)),this._emitLine(this.buffer+" += runtime.suppressValue("+c+", "+o+" && env.opts.autoescape);"),this._addScopeLevel()}else this._emit(")"),this._emit(", "+o+" && env.opts.autoescape);\n")},r.compileCallExtensionAsync=function(e,t){this.compileCallExtension(e,t,!0)},r.compileNodeList=function(e,t){this._compileChildren(e,t)},r.compileLiteral=function(e){if("string"==typeof e.value){var t=e.value.replace(/\\/g,"\\\\");t=(t=(t=(t=(t=t.replace(/"/g,'\\"')).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t")).replace(/\u2028/g,"\\u2028"),this._emit('"'+t+'"')}else null===e.value?this._emit("null"):this._emit(e.value.toString())},r.compileSymbol=function(e,t){var n=e.value,i=t.lookup(n);i?this._emit(i):this._emit('runtime.contextOrFrameLookup(context, frame, "'+n+'")')},r.compileGroup=function(e,t){this._compileAggregate(e,t,"(",")")},r.compileArray=function(e,t){this._compileAggregate(e,t,"[","]")},r.compileDict=function(e,t){this._compileAggregate(e,t,"{","}")},r.compilePair=function(e,t){var n=e.key,i=e.value;n instanceof s.Symbol?n=new s.Literal(n.lineno,n.colno,n.value):n instanceof s.Literal&&"string"==typeof n.value||this.fail("compilePair: Dict keys must be strings or names",n.lineno,n.colno),this.compile(n,t),this._emit(": "),this._compileExpression(i,t)},r.compileInlineIf=function(e,t){this._emit("("),this.compile(e.cond,t),this._emit("?"),this.compile(e.body,t),this._emit(":"),null!==e.else_?this.compile(e.else_,t):this._emit('""'),this._emit(")")},r.compileIn=function(e,t){this._emit("runtime.inOperator("),this.compile(e.left,t),this._emit(","),this.compile(e.right,t),this._emit(")")},r.compileIs=function(e,t){var n=e.right.name?e.right.name.value:e.right.value;this._emit('env.getTest("'+n+'").call(context, '),this.compile(e.left,t),e.right.args&&(this._emit(","),this.compile(e.right.args,t)),this._emit(") === true")},r._binOpEmitter=function(e,t,n){this.compile(e.left,t),this._emit(n),this.compile(e.right,t)},r.compileOr=function(e,t){return this._binOpEmitter(e,t," || ")},r.compileAnd=function(e,t){return this._binOpEmitter(e,t," && ")},r.compileAdd=function(e,t){return this._binOpEmitter(e,t," + ")},r.compileConcat=function(e,t){return this._binOpEmitter(e,t,' + "" + ')},r.compileSub=function(e,t){return this._binOpEmitter(e,t," - ")},r.compileMul=function(e,t){return this._binOpEmitter(e,t," * ")},r.compileDiv=function(e,t){return this._binOpEmitter(e,t," / ")},r.compileMod=function(e,t){return this._binOpEmitter(e,t," % ")},r.compileNot=function(e,t){this._emit("!"),this.compile(e.target,t)},r.compileFloorDiv=function(e,t){this._emit("Math.floor("),this.compile(e.left,t),this._emit(" / "),this.compile(e.right,t),this._emit(")")},r.compilePow=function(e,t){this._emit("Math.pow("),this.compile(e.left,t),this._emit(", "),this.compile(e.right,t),this._emit(")")},r.compileNeg=function(e,t){this._emit("-"),this.compile(e.target,t)},r.compilePos=function(e,t){this._emit("+"),this.compile(e.target,t)},r.compileCompare=function(e,t){var n=this;this.compile(e.expr,t),e.ops.forEach((function(e){n._emit(" "+u[e.type]+" "),n.compile(e.expr,t)}))},r.compileLookupVal=function(e,t){this._emit("runtime.memberLookup(("),this._compileExpression(e.target,t),this._emit("),"),this._compileExpression(e.val,t),this._emit(")")},r._getNodeName=function(e){switch(e.typename){case"Symbol":return e.value;case"FunCall":return"the return value of ("+this._getNodeName(e.name)+")";case"LookupVal":return this._getNodeName(e.target)+'["'+this._getNodeName(e.val)+'"]';case"Literal":return e.value.toString();default:return"--expression--"}},r.compileFunCall=function(e,t){this._emit("(lineno = "+e.lineno+", colno = "+e.colno+", "),this._emit("runtime.callWrap("),this._compileExpression(e.name,t),this._emit(', "'+this._getNodeName(e.name).replace(/"/g,'\\"')+'", context, '),this._compileAggregate(e.args,t,"[","])"),this._emit(")")},r.compileFilter=function(e,t){var n=e.name;this.assertType(n,s.Symbol),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emit(")")},r.compileFilterAsync=function(e,t){var n=e.name,i=e.symbol.value;this.assertType(n,s.Symbol),t.set(i,i),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emitLine(", "+this._makeCallback(i)),this._addScopeLevel()},r.compileKeywordArgs=function(e,t){this._emit("runtime.makeKeywordArgs("),this.compileDict(e,t),this._emit(")")},r.compileSet=function(e,t){var n=this,i=[];e.targets.forEach((function(e){var a=e.value,r=t.lookup(a);null==r&&(r=n._tmpid(),n._emitLine("var "+r+";")),i.push(r)})),e.value?(this._emit(i.join(" = ")+" = "),this._compileExpression(e.value,t),this._emitLine(";")):(this._emit(i.join(" = ")+" = "),this.compile(e.body,t),this._emitLine(";")),e.targets.forEach((function(e,t){var a=i[t],r=e.value;n._emitLine('frame.set("'+r+'", '+a+", true);"),n._emitLine("if(frame.topLevel) {"),n._emitLine('context.setVariable("'+r+'", '+a+");"),n._emitLine("}"),"_"!==r.charAt(0)&&(n._emitLine("if(frame.topLevel) {"),n._emitLine('context.addExport("'+r+'", '+a+");"),n._emitLine("}"))}))},r.compileSwitch=function(e,t){var n=this;this._emit("switch ("),this.compile(e.expr,t),this._emit(") {"),e.cases.forEach((function(e,i){n._emit("case "),n.compile(e.cond,t),n._emit(": "),n.compile(e.body,t),e.body.children.length&&n._emitLine("break;")})),e.default&&(this._emit("default:"),this.compile(e.default,t)),this._emit("}")},r.compileIf=function(e,t,n){var i=this;this._emit("if("),this._compileExpression(e.cond,t),this._emitLine(") {"),this._withScopedSyntax((function(){i.compile(e.body,t),n&&i._emit("cb()")})),e.else_?(this._emitLine("}\nelse {"),this._withScopedSyntax((function(){i.compile(e.else_,t),n&&i._emit("cb()")}))):n&&(this._emitLine("}\nelse {"),this._emit("cb()")),this._emitLine("}")},r.compileIfAsync=function(e,t){this._emit("(function(cb) {"),this.compileIf(e,t,!0),this._emit("})("+this._makeCallback()),this._addScopeLevel()},r._emitLoopBindings=function(e,t,n,i){var a=this;[{name:"index",val:n+" + 1"},{name:"index0",val:n},{name:"revindex",val:i+" - "+n},{name:"revindex0",val:i+" - "+n+" - 1"},{name:"first",val:n+" === 0"},{name:"last",val:n+" === "+i+" - 1"},{name:"length",val:i}].forEach((function(e){a._emitLine('frame.set("loop.'+e.name+'", '+e.val+");")}))},r.compileFor=function(e,t){var n=this,i=this._tmpid(),a=this._tmpid(),r=this._tmpid();if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+r+" = "),this._compileExpression(e.arr,t),this._emitLine(";"),this._emit("if("+r+") {"),this._emitLine(r+" = runtime.fromIterator("+r+");"),e.name instanceof s.Array){this._emitLine("var "+i+";"),this._emitLine("if(runtime.isArray("+r+")) {"),this._emitLine("var "+a+" = "+r+".length;"),this._emitLine("for("+i+"=0; "+i+" < "+r+".length; "+i+"++) {"),e.name.children.forEach((function(a,s){var o=n._tmpid();n._emitLine("var "+o+" = "+r+"["+i+"]["+s+"];"),n._emitLine('frame.set("'+a+'", '+r+"["+i+"]["+s+"]);"),t.set(e.name.children[s].value,o)})),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("} else {");var o=e.name.children,c=o[0],l=o[1],u=this._tmpid(),d=this._tmpid();t.set(c.value,u),t.set(l.value,d),this._emitLine(i+" = -1;"),this._emitLine("var "+a+" = runtime.keys("+r+").length;"),this._emitLine("for(var "+u+" in "+r+") {"),this._emitLine(i+"++;"),this._emitLine("var "+d+" = "+r+"["+u+"];"),this._emitLine('frame.set("'+c.value+'", '+u+");"),this._emitLine('frame.set("'+l.value+'", '+d+");"),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("}")}else{var h=this._tmpid();t.set(e.name.value,h),this._emitLine("var "+a+" = "+r+".length;"),this._emitLine("for(var "+i+"=0; "+i+" < "+r+".length; "+i+"++) {"),this._emitLine("var "+h+" = "+r+"["+i+"];"),this._emitLine('frame.set("'+e.name.value+'", '+h+");"),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}")}this._emitLine("}"),e.else_&&(this._emitLine("if (!"+a+") {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},r._compileAsyncLoop=function(e,t,n){var i=this,a=this._tmpid(),r=this._tmpid(),o=this._tmpid(),c=n?"asyncAll":"asyncEach";if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+o+" = runtime.fromIterator("),this._compileExpression(e.arr,t),this._emitLine(");"),e.name instanceof s.Array){var l=e.name.children.length;this._emit("runtime."+c+"("+o+", "+l+", function("),e.name.children.forEach((function(e){i._emit(e.value+",")})),this._emit(a+","+r+",next) {"),e.name.children.forEach((function(e){var n=e.value;t.set(n,n),i._emitLine('frame.set("'+n+'", '+n+");")}))}else{var u=e.name.value;this._emitLine("runtime."+c+"("+o+", 1, function("+u+", "+a+", "+r+",next) {"),this._emitLine('frame.set("'+u+'", '+u+");"),t.set(u,u)}this._emitLoopBindings(e,o,a,r),this._withScopedSyntax((function(){var r;n&&(r=i._pushBuffer()),i.compile(e.body,t),i._emitLine("next("+a+(r?","+r:"")+");"),n&&i._popBuffer()}));var d=this._tmpid();this._emitLine("}, "+this._makeCallback(d)),this._addScopeLevel(),n&&this._emitLine(this.buffer+" += "+d+";"),e.else_&&(this._emitLine("if (!"+o+".length) {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},r.compileAsyncEach=function(e,t){this._compileAsyncLoop(e,t)},r.compileAsyncAll=function(e,t){this._compileAsyncLoop(e,t,!0)},r._compileMacro=function(e,t){var n=this,i=[],a=null,r="macro_"+this._tmpid(),o=void 0!==t;e.args.children.forEach((function(t,r){r===e.args.children.length-1&&t instanceof s.Dict?a=t:(n.assertType(t,s.Symbol),i.push(t))}));var l,u=[].concat(i.map((function(e){return"l_"+e.value})),["kwargs"]),d=i.map((function(e){return'"'+e.value+'"'})),h=(a&&a.children||[]).map((function(e){return'"'+e.key.value+'"'}));l=o?t.push(!0):new c,this._emitLines("var "+r+" = runtime.makeMacro(","["+d.join(", ")+"], ","["+h.join(", ")+"], ","function ("+u.join(", ")+") {","var callerFrame = frame;","frame = "+(o?"frame.push(true);":"new runtime.Frame();"),"kwargs = kwargs || {};",'if (Object.prototype.hasOwnProperty.call(kwargs, "caller")) {','frame.set("caller", kwargs.caller); }'),i.forEach((function(e){n._emitLine('frame.set("'+e.value+'", l_'+e.value+");"),l.set(e.value,"l_"+e.value)})),a&&a.children.forEach((function(e){var t=e.key.value;n._emit('frame.set("'+t+'", '),n._emit('Object.prototype.hasOwnProperty.call(kwargs, "'+t+'")'),n._emit(' ? kwargs["'+t+'"] : '),n._compileExpression(e.value,l),n._emit(");")}));var p=this._pushBuffer();return this._withScopedSyntax((function(){n.compile(e.body,l)})),this._emitLine("frame = "+(o?"frame.pop();":"callerFrame;")),this._emitLine("return new runtime.SafeString("+p+");"),this._emitLine("});"),this._popBuffer(),r},r.compileMacro=function(e,t){var n=this._compileMacro(e),i=e.name.value;t.set(i,n),t.parent?this._emitLine('frame.set("'+i+'", '+n+");"):("_"!==e.name.value.charAt(0)&&this._emitLine('context.addExport("'+i+'");'),this._emitLine('context.setVariable("'+i+'", '+n+");"))},r.compileCaller=function(e,t){this._emit("(function (){");var n=this._compileMacro(e,t);this._emit("return "+n+";})()")},r._compileGetTemplate=function(e,t,n,i){var a=this._tmpid(),r=this._templateName(),s=this._makeCallback(a),o=n?"true":"false",c=i?"true":"false";return this._emit("env.getTemplate("),this._compileExpression(e.template,t),this._emitLine(", "+o+", "+r+", "+c+", "+s),a},r.compileImport=function(e,t){var n=e.target.value,i=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(i+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(i)),this._addScopeLevel(),t.set(n,i),t.parent?this._emitLine('frame.set("'+n+'", '+i+");"):this._emitLine('context.setVariable("'+n+'", '+i+");")},r.compileFromImport=function(e,t){var n=this,i=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(i+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(i)),this._addScopeLevel(),e.names.children.forEach((function(e){var a,r,o=n._tmpid();e instanceof s.Pair?(a=e.key.value,r=e.value.value):r=a=e.value,n._emitLine("if(Object.prototype.hasOwnProperty.call("+i+', "'+a+'")) {'),n._emitLine("var "+o+" = "+i+"."+a+";"),n._emitLine("} else {"),n._emitLine("cb(new Error(\"cannot import '"+a+"'\")); return;"),n._emitLine("}"),t.set(r,o),t.parent?n._emitLine('frame.set("'+r+'", '+o+");"):n._emitLine('context.setVariable("'+r+'", '+o+");")}))},r.compileBlock=function(e){var t=this._tmpid();this.inBlock||this._emit('(parentTemplate ? function(e, c, f, r, cb) { cb(""); } : '),this._emit('context.getBlock("'+e.name.value+'")'),this.inBlock||this._emit(")"),this._emitLine("(env, context, frame, runtime, "+this._makeCallback(t)),this._emitLine(this.buffer+" += "+t+";"),this._addScopeLevel()},r.compileSuper=function(e,t){var n=e.blockName.value,i=e.symbol.value,a=this._makeCallback(i);this._emitLine('context.getSuper(env, "'+n+'", b_'+n+", frame, runtime, "+a),this._emitLine(i+" = runtime.markSafe("+i+");"),this._addScopeLevel(),t.set(i,i)},r.compileExtends=function(e,t){var n=this._tmpid(),i=this._compileGetTemplate(e,t,!0,!1);this._emitLine("parentTemplate = "+i),this._emitLine("for(var "+n+" in parentTemplate.blocks) {"),this._emitLine("context.addBlock("+n+", parentTemplate.blocks["+n+"]);"),this._emitLine("}"),this._addScopeLevel()},r.compileInclude=function(e,t){this._emitLine("var tasks = [];"),this._emitLine("tasks.push("),this._emitLine("function(callback) {");var n=this._compileGetTemplate(e,t,!1,e.ignoreMissing);this._emitLine("callback(null,"+n+");});"),this._emitLine("});");var i=this._tmpid();this._emitLine("tasks.push("),this._emitLine("function(template, callback){"),this._emitLine("template.render(context.getVariables(), frame, "+this._makeCallback(i)),this._emitLine("callback(null,"+i+");});"),this._emitLine("});"),this._emitLine("tasks.push("),this._emitLine("function(result, callback){"),this._emitLine(this.buffer+" += result;"),this._emitLine("callback(null);"),this._emitLine("});"),this._emitLine("env.waterfall(tasks, function(){"),this._addScopeLevel()},r.compileTemplateData=function(e,t){this.compileLiteral(e,t)},r.compileCapture=function(e,t){var n=this,i=this.buffer;this.buffer="output",this._emitLine("(function() {"),this._emitLine('var output = "";'),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("return output;"),this._emitLine("})()"),this.buffer=i},r.compileOutput=function(e,t){var n=this;e.children.forEach((function(i){i instanceof s.TemplateData?i.value&&(n._emit(n.buffer+" += "),n.compileLiteral(i,t),n._emitLine(";")):(n._emit(n.buffer+" += runtime.suppressValue("),n.throwOnUndefined&&n._emit("runtime.ensureDefined("),n.compile(i,t),n.throwOnUndefined&&n._emit(","+e.lineno+","+e.colno+")"),n._emit(", env.opts.autoescape);\n"))}))},r.compileRoot=function(e,t){var n=this;t&&this.fail("compileRoot: root node can't have frame"),t=new c,this._emitFuncBegin(e,"root"),this._emitLine("var parentTemplate = null;"),this._compileChildren(e,t),this._emitLine("if(parentTemplate) {"),this._emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this._emitLine("} else {"),this._emitLine("cb(null, "+this.buffer+");"),this._emitLine("}"),this._emitFuncEnd(!0),this.inBlock=!0;var i=[],a=e.findAll(s.Block);a.forEach((function(e,t){var a=e.name.value;if(-1!==i.indexOf(a))throw new Error('Block "'+a+'" defined more than once.');i.push(a),n._emitFuncBegin(e,"b_"+a);var r=new c;n._emitLine("var frame = frame.push(true);"),n.compile(e.body,r),n._emitFuncEnd()})),this._emitLine("return {"),a.forEach((function(e,t){var i="b_"+e.name.value;n._emitLine(i+": "+i+",")})),this._emitLine("root: root\n};")},r.compile=function(e,t){var n=this["compile"+e.typename];n?n.call(this,e,t):this.fail("compile: Cannot compile node: "+e.typename,e.lineno,e.colno)},r.getCode=function(){return this.codebuf.join("")},a}(l);e.exports={compile:function(e,t,n,i,s){void 0===s&&(s={});var o=new d(i,s.throwOnUndefined),c=(n||[]).map((function(e){return e.preprocess})).filter((function(e){return!!e})),l=c.reduce((function(e,t){return t(e)}),e);return o.compile(r.transform(a.parse(l,n,s),t,i)),o.getCode()},Compiler:d}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(4),r=n(1).EmitterObj;e.exports=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var s=r.prototype;return s.resolve=function(e,t){return a.resolve(a.dirname(e),t)},s.isRelative=function(e){return 0===e.indexOf("./")||0===e.indexOf("../")},r}(r)},function(e,t,n){function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var r=n(12),s=n(15),o=n(0),c=n(5),l=n(18),u=n(10),d=u.FileSystemLoader,h=u.WebLoader,p=u.PrecompiledLoader,m=n(20),f=n(21),g=n(1),_=g.Obj,v=g.EmitterObj,y=n(2),b=y.handleError,w=y.Frame,x=n(22);function M(e,t,n){r((function(){e(t,n)}))}var k={type:"code",obj:{root:function(e,t,n,i,a){try{a(null,"")}catch(e){a(b(e,null,null))}}}},C=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t){var n=this;t=this.opts=t||{},this.opts.dev=!!t.dev,this.opts.autoescape=null==t.autoescape||t.autoescape,this.opts.throwOnUndefined=!!t.throwOnUndefined,this.opts.trimBlocks=!!t.trimBlocks,this.opts.lstripBlocks=!!t.lstripBlocks,this.loaders=[],e?this.loaders=o.isArray(e)?e:[e]:d?this.loaders=[new d("views")]:h&&(this.loaders=[new h("/views")]),"undefined"!=typeof window&&window.nunjucksPrecompiled&&this.loaders.unshift(new p(window.nunjucksPrecompiled)),this._initLoaders(),this.globals=f(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],o._entries(l).forEach((function(e){var t=e[0],i=e[1];return n.addFilter(t,i)})),o._entries(m).forEach((function(e){var t=e[0],i=e[1];return n.addTest(t,i)}))},n._initLoaders=function(){var e=this;this.loaders.forEach((function(t){t.cache={},"function"==typeof t.on&&(t.on("update",(function(n,i){t.cache[n]=null,e.emit("update",n,i,t)})),t.on("load",(function(n,i){e.emit("load",n,i,t)})))}))},n.invalidateCache=function(){this.loaders.forEach((function(e){e.cache={}}))},n.addExtension=function(e,t){return t.__name=e,this.extensions[e]=t,this.extensionsList.push(t),this},n.removeExtension=function(e){var t=this.getExtension(e);t&&(this.extensionsList=o.without(this.extensionsList,t),delete this.extensions[e])},n.getExtension=function(e){return this.extensions[e]},n.hasExtension=function(e){return!!this.extensions[e]},n.addGlobal=function(e,t){return this.globals[e]=t,this},n.getGlobal=function(e){if(void 0===this.globals[e])throw new Error("global not found: "+e);return this.globals[e]},n.addFilter=function(e,t,n){var i=t;return n&&this.asyncFilters.push(e),this.filters[e]=i,this},n.getFilter=function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},n.addTest=function(e,t){return this.tests[e]=t,this},n.getTest=function(e){if(!this.tests[e])throw new Error("test not found: "+e);return this.tests[e]},n.resolveTemplate=function(e,t,n){return e.isRelative&&t&&e.isRelative(n)&&e.resolve?e.resolve(t,n):n},n.getTemplate=function(e,t,n,i,a){var r,s=this,c=this,l=null;if(e&&e.raw&&(e=e.raw),o.isFunction(n)&&(a=n,n=null,t=t||!1),o.isFunction(t)&&(a=t,t=!1),e instanceof E)l=e;else{if("string"!=typeof e)throw new Error("template names must be a string: "+e);for(var u=0;u<this.loaders.length;u++){var d=this.loaders[u];if(l=d.cache[this.resolveTemplate(d,n,e)])break}}return l?(t&&l.compile(),a?void a(null,l):l):(o.asyncIter(this.loaders,(function(t,i,a,r){function s(e,n){e?r(e):n?(n.loader=t,r(null,n)):a()}e=c.resolveTemplate(t,n,e),t.async?t.getSource(e,s):s(null,t.getSource(e))}),(function(n,o){if(o||n||i||(n=new Error("template not found: "+e)),n){if(a)return void a(n);throw n}var c;o?(c=new E(o.src,s,o.path,t),o.noCache||(o.loader.cache[e]=c)):c=new E(k,s,"",t),a?a(null,c):r=c})),r)},n.express=function(e){return x(this,e)},n.render=function(e,t,n){o.isFunction(t)&&(n=t,t=null);var i=null;return this.getTemplate(e,(function(e,a){if(e&&n)M(n,e);else{if(e)throw e;i=a.render(t,n)}})),i},n.renderString=function(e,t,n,i){return o.isFunction(n)&&(i=n,n={}),new E(e,this,(n=n||{}).path).render(t,i)},n.waterfall=function(e,t,n){return s(e,t,n)},t}(v),S=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t,n){var i=this;this.env=n||new C,this.ctx=o.extend({},e),this.blocks={},this.exported=[],o.keys(t).forEach((function(e){i.addBlock(e,t[e])}))},n.lookup=function(e){return e in this.env.globals&&!(e in this.ctx)?this.env.globals[e]:this.ctx[e]},n.setVariable=function(e,t){this.ctx[e]=t},n.getVariables=function(){return this.ctx},n.addBlock=function(e,t){return this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t),this},n.getBlock=function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},n.getSuper=function(e,t,n,i,a,r){var s=o.indexOf(this.blocks[t]||[],n),c=this.blocks[t][s+1];if(-1===s||!c)throw new Error('no super block available for "'+t+'"');c(e,this,i,a,r)},n.addExport=function(e){this.exported.push(e)},n.getExported=function(){var e=this,t={};return this.exported.forEach((function(n){t[n]=e.ctx[n]})),t},t}(_),E=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t,n,i){if(this.env=t||new C,o.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj;break;default:throw new Error("Unexpected template object type "+e.type+"; expected 'code', or 'string'")}else{if(!o.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}if(this.path=n,i)try{this._compile()}catch(e){throw o._prettifyError(this.path,this.env.opts.dev,e)}else this.compiled=!1},n.render=function(e,t,n){var i=this;"function"==typeof e?(n=e,e={}):"function"==typeof t&&(n=t,t=null);var a=!t;try{this.compile()}catch(e){var r=o._prettifyError(this.path,this.env.opts.dev,e);if(n)return M(n,r);throw r}var s=new S(e||{},this.blocks,this.env),c=t?t.push(!0):new w;c.topLevel=!0;var l=null,u=!1;return this.rootRenderFunc(this.env,s,c,y,(function(e,t){if(!u||!n||void 0===t)if(e&&(e=o._prettifyError(i.path,i.env.opts.dev,e),u=!0),n)a?M(n,e,t):n(e,t);else{if(e)throw e;l=t}})),l},n.getExported=function(e,t,n){"function"==typeof e&&(n=e,e={}),"function"==typeof t&&(n=t,t=null);try{this.compile()}catch(e){if(n)return n(e);throw e}var i=t?t.push():new w;i.topLevel=!0;var a=new S(e||{},this.blocks,this.env);this.rootRenderFunc(this.env,a,i,y,(function(e){e?n(e,null):n(null,a.getExported())}))},n.compile=function(){this.compiled||this._compile()},n._compile=function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=c.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);e=new Function(t)()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},n._getBlocks=function(e){var t={};return o.keys(e).forEach((function(n){"b_"===n.slice(0,2)&&(t[n.slice(2)]=e[n])})),t},t}(_);e.exports={Environment:C,Template:E}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(9),r=n(3),s=n(1).Obj,o=n(0),c=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var c=s.prototype;return c.init=function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},c.nextToken=function(e){var t;if(this.peeked){if(e||this.peeked.type!==a.TOKEN_WHITESPACE)return t=this.peeked,this.peeked=null,t;this.peeked=null}if(t=this.tokens.nextToken(),!e)for(;t&&t.type===a.TOKEN_WHITESPACE;)t=this.tokens.nextToken();return t},c.peekToken=function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},c.pushToken=function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},c.error=function(e,t,n){if(void 0===t||void 0===n){var i=this.peekToken()||{};t=i.lineno,n=i.colno}return void 0!==t&&(t+=1),void 0!==n&&(n+=1),new o.TemplateError(e,t,n)},c.fail=function(e,t,n){throw this.error(e,t,n)},c.skip=function(e){var t=this.nextToken();return!(!t||t.type!==e)||(this.pushToken(t),!1)},c.expect=function(e){var t=this.nextToken();return t.type!==e&&this.fail("expected "+e+", got "+t.type,t.lineno,t.colno),t},c.skipValue=function(e,t){var n=this.nextToken();return!(!n||n.type!==e||n.value!==t)||(this.pushToken(n),!1)},c.skipSymbol=function(e){return this.skipValue(a.TOKEN_SYMBOL,e)},c.advanceAfterBlockEnd=function(e){var t;return e||((t=this.peekToken())||this.fail("unexpected end of file"),t.type!==a.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value),(t=this.nextToken())&&t.type===a.TOKEN_BLOCK_END?"-"===t.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement"),t},c.advanceAfterVariableEnd=function(){var e=this.nextToken();e&&e.type===a.TOKEN_VARIABLE_END?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.VARIABLE_END.length-1):(this.pushToken(e),this.fail("expected variable end"))},c.parseFor=function(){var e,t,n=this.peekToken();if(this.skipSymbol("for")?(e=new r.For(n.lineno,n.colno),t="endfor"):this.skipSymbol("asyncEach")?(e=new r.AsyncEach(n.lineno,n.colno),t="endeach"):this.skipSymbol("asyncAll")?(e=new r.AsyncAll(n.lineno,n.colno),t="endall"):this.fail("parseFor: expected for{Async}",n.lineno,n.colno),e.name=this.parsePrimary(),e.name instanceof r.Symbol||this.fail("parseFor: variable name expected for loop"),this.peekToken().type===a.TOKEN_COMMA){var i=e.name;for(e.name=new r.Array(i.lineno,i.colno),e.name.addChild(i);this.skip(a.TOKEN_COMMA);){var s=this.parsePrimary();e.name.addChild(s)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',n.lineno,n.colno),e.arr=this.parseExpression(),this.advanceAfterBlockEnd(n.value),e.body=this.parseUntilBlocks(t,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),e.else_=this.parseUntilBlocks(t)),this.advanceAfterBlockEnd(),e},c.parseMacro=function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var t=this.parsePrimary(!0),n=this.parseSignature(),i=new r.Macro(e.lineno,e.colno,t,n);return this.advanceAfterBlockEnd(e.value),i.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),i},c.parseCall=function(){var e=this.peekToken();this.skipSymbol("call")||this.fail("expected call");var t=this.parseSignature(!0)||new r.NodeList,n=this.parsePrimary();this.advanceAfterBlockEnd(e.value);var i=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();var a=new r.Symbol(e.lineno,e.colno,"caller"),s=new r.Caller(e.lineno,e.colno,a,t,i),o=n.args.children;return o[o.length-1]instanceof r.KeywordArgs||o.push(new r.KeywordArgs),o[o.length-1].addChild(new r.Pair(e.lineno,e.colno,a,s)),new r.Output(e.lineno,e.colno,[n])},c.parseWithContext=function(){var e=this.peekToken(),t=null;return this.skipSymbol("with")?t=!0:this.skipSymbol("without")&&(t=!1),null!==t&&(this.skipSymbol("context")||this.fail("parseFrom: expected context after with/without",e.lineno,e.colno)),t},c.parseImport=function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var t=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var n=this.parseExpression(),i=this.parseWithContext(),a=new r.Import(e.lineno,e.colno,t,n,i);return this.advanceAfterBlockEnd(e.value),a},c.parseFrom=function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var t=this.parseExpression();this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var n,i=new r.NodeList;;){var s=this.peekToken();if(s.type===a.TOKEN_BLOCK_END){i.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),"-"===s.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}i.children.length>0&&!this.skip(a.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var o=this.parsePrimary();if("_"===o.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",o.lineno,o.colno),this.skipSymbol("as")){var c=this.parsePrimary();i.addChild(new r.Pair(o.lineno,o.colno,o,c))}else i.addChild(o);n=this.parseWithContext()}return new r.FromImport(e.lineno,e.colno,t,i,n)},c.parseBlock=function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var t=new r.Block(e.lineno,e.colno);t.name=this.parsePrimary(),t.name instanceof r.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),t.body=this.parseUntilBlocks("endblock"),this.skipSymbol("endblock"),this.skipSymbol(t.name.value);var n=this.peekToken();return n||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(n.value),t},c.parseExtends=function(){var e="extends",t=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var n=new r.Extends(t.lineno,t.colno);return n.template=this.parseExpression(),this.advanceAfterBlockEnd(t.value),n},c.parseInclude=function(){var e="include",t=this.peekToken();this.skipSymbol(e)||this.fail("parseInclude: expected "+e);var n=new r.Include(t.lineno,t.colno);return n.template=this.parseExpression(),this.skipSymbol("ignore")&&this.skipSymbol("missing")&&(n.ignoreMissing=!0),this.advanceAfterBlockEnd(t.value),n},c.parseIf=function(){var e,t=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")||this.skipSymbol("elseif")?e=new r.If(t.lineno,t.colno):this.skipSymbol("ifAsync")?e=new r.IfAsync(t.lineno,t.colno):this.fail("parseIf: expected if, elif, or elseif",t.lineno,t.colno),e.cond=this.parseExpression(),this.advanceAfterBlockEnd(t.value),e.body=this.parseUntilBlocks("elif","elseif","else","endif");var n=this.peekToken();switch(n&&n.value){case"elseif":case"elif":e.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),e.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":e.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected elif, else, or endif, got end of file")}return e},c.parseSet=function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var t,n=new r.Set(e.lineno,e.colno,[]);(t=this.parsePrimary())&&(n.targets.push(t),this.skip(a.TOKEN_COMMA)););return this.skipValue(a.TOKEN_OPERATOR,"=")?(n.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value)):this.skip(a.TOKEN_BLOCK_END)?(n.body=new r.Capture(e.lineno,e.colno,this.parseUntilBlocks("endset")),n.value=null,this.advanceAfterBlockEnd()):this.fail("parseSet: expected = or block end in set tag",e.lineno,e.colno),n},c.parseSwitch=function(){var e="switch",t="endswitch",n="case",i="default",a=this.peekToken();this.skipSymbol(e)||this.skipSymbol(n)||this.skipSymbol(i)||this.fail('parseSwitch: expected "switch," "case" or "default"',a.lineno,a.colno);var s=this.parseExpression();this.advanceAfterBlockEnd(e),this.parseUntilBlocks(n,i,t);var o,c=this.peekToken(),l=[];do{this.skipSymbol(n);var u=this.parseExpression();this.advanceAfterBlockEnd(e);var d=this.parseUntilBlocks(n,i,t);l.push(new r.Case(c.line,c.col,u,d)),c=this.peekToken()}while(c&&c.value===n);switch(c.value){case i:this.advanceAfterBlockEnd(),o=this.parseUntilBlocks(t),this.advanceAfterBlockEnd();break;case t:this.advanceAfterBlockEnd();break;default:this.fail('parseSwitch: expected "case," "default" or "endswitch," got EOF.')}return new r.Switch(a.lineno,a.colno,s,l,o)},c.parseStatement=function(){var e=this.peekToken();if(e.type!==a.TOKEN_SYMBOL&&this.fail("tag name expected",e.lineno,e.colno),this.breakOnBlocks&&-1!==o.indexOf(this.breakOnBlocks,e.value))return null;switch(e.value){case"raw":return this.parseRaw();case"verbatim":return this.parseRaw("verbatim");case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();case"filter":return this.parseFilterStatement();case"switch":return this.parseSwitch();default:if(this.extensions.length)for(var t=0;t<this.extensions.length;t++){var n=this.extensions[t];if(-1!==o.indexOf(n.tags||[],e.value))return n.parse(this,r,a)}this.fail("unknown block tag: "+e.value,e.lineno,e.colno)}},c.parseRaw=function(e){for(var t="end"+(e=e||"raw"),n=new RegExp("([\\s\\S]*?){%\\s*("+e+"|"+t+")\\s*(?=%})%}"),i=1,a="",s=null,o=this.advanceAfterBlockEnd();(s=this.tokens._extractRegex(n))&&i>0;){var c=s[0],l=s[1],u=s[2];u===e?i+=1:u===t&&(i-=1),0===i?(a+=l,this.tokens.backN(c.length-l.length)):a+=c}return new r.Output(o.lineno,o.colno,[new r.TemplateData(o.lineno,o.colno,a)])},c.parsePostfix=function(e){for(var t,n=this.peekToken();n;){if(n.type===a.TOKEN_LEFT_PAREN)e=new r.FunCall(n.lineno,n.colno,e,this.parseSignature());else if(n.type===a.TOKEN_LEFT_BRACKET)(t=this.parseAggregate()).children.length>1&&this.fail("invalid index"),e=new r.LookupVal(n.lineno,n.colno,e,t.children[0]);else{if(n.type!==a.TOKEN_OPERATOR||"."!==n.value)break;this.nextToken();var i=this.nextToken();i.type!==a.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+i.value,i.lineno,i.colno),t=new r.Literal(i.lineno,i.colno,i.value),e=new r.LookupVal(n.lineno,n.colno,e,t)}n=this.peekToken()}return e},c.parseExpression=function(){return this.parseInlineIf()},c.parseInlineIf=function(){var e=this.parseOr();if(this.skipSymbol("if")){var t=this.parseOr(),n=e;(e=new r.InlineIf(e.lineno,e.colno)).body=n,e.cond=t,this.skipSymbol("else")?e.else_=this.parseOr():e.else_=null}return e},c.parseOr=function(){for(var e=this.parseAnd();this.skipSymbol("or");){var t=this.parseAnd();e=new r.Or(e.lineno,e.colno,e,t)}return e},c.parseAnd=function(){for(var e=this.parseNot();this.skipSymbol("and");){var t=this.parseNot();e=new r.And(e.lineno,e.colno,e,t)}return e},c.parseNot=function(){var e=this.peekToken();return this.skipSymbol("not")?new r.Not(e.lineno,e.colno,this.parseNot()):this.parseIn()},c.parseIn=function(){for(var e=this.parseIs();;){var t=this.nextToken();if(!t)break;var n=t.type===a.TOKEN_SYMBOL&&"not"===t.value;if(n||this.pushToken(t),!this.skipSymbol("in")){n&&this.pushToken(t);break}var i=this.parseIs();e=new r.In(e.lineno,e.colno,e,i),n&&(e=new r.Not(e.lineno,e.colno,e))}return e},c.parseIs=function(){var e=this.parseCompare();if(this.skipSymbol("is")){var t=this.skipSymbol("not"),n=this.parseCompare();e=new r.Is(e.lineno,e.colno,e,n),t&&(e=new r.Not(e.lineno,e.colno,e))}return e},c.parseCompare=function(){for(var e=["==","===","!=","!==","<",">","<=",">="],t=this.parseConcat(),n=[];;){var i=this.nextToken();if(!i)break;if(-1===e.indexOf(i.value)){this.pushToken(i);break}n.push(new r.CompareOperand(i.lineno,i.colno,this.parseConcat(),i.value))}return n.length?new r.Compare(n[0].lineno,n[0].colno,t,n):t},c.parseConcat=function(){for(var e=this.parseAdd();this.skipValue(a.TOKEN_TILDE,"~");){var t=this.parseAdd();e=new r.Concat(e.lineno,e.colno,e,t)}return e},c.parseAdd=function(){for(var e=this.parseSub();this.skipValue(a.TOKEN_OPERATOR,"+");){var t=this.parseSub();e=new r.Add(e.lineno,e.colno,e,t)}return e},c.parseSub=function(){for(var e=this.parseMul();this.skipValue(a.TOKEN_OPERATOR,"-");){var t=this.parseMul();e=new r.Sub(e.lineno,e.colno,e,t)}return e},c.parseMul=function(){for(var e=this.parseDiv();this.skipValue(a.TOKEN_OPERATOR,"*");){var t=this.parseDiv();e=new r.Mul(e.lineno,e.colno,e,t)}return e},c.parseDiv=function(){for(var e=this.parseFloorDiv();this.skipValue(a.TOKEN_OPERATOR,"/");){var t=this.parseFloorDiv();e=new r.Div(e.lineno,e.colno,e,t)}return e},c.parseFloorDiv=function(){for(var e=this.parseMod();this.skipValue(a.TOKEN_OPERATOR,"//");){var t=this.parseMod();e=new r.FloorDiv(e.lineno,e.colno,e,t)}return e},c.parseMod=function(){for(var e=this.parsePow();this.skipValue(a.TOKEN_OPERATOR,"%");){var t=this.parsePow();e=new r.Mod(e.lineno,e.colno,e,t)}return e},c.parsePow=function(){for(var e=this.parseUnary();this.skipValue(a.TOKEN_OPERATOR,"**");){var t=this.parseUnary();e=new r.Pow(e.lineno,e.colno,e,t)}return e},c.parseUnary=function(e){var t,n=this.peekToken();return t=this.skipValue(a.TOKEN_OPERATOR,"-")?new r.Neg(n.lineno,n.colno,this.parseUnary(!0)):this.skipValue(a.TOKEN_OPERATOR,"+")?new r.Pos(n.lineno,n.colno,this.parseUnary(!0)):this.parsePrimary(),e||(t=this.parseFilter(t)),t},c.parsePrimary=function(e){var t,n=this.nextToken(),i=null;if(n?n.type===a.TOKEN_STRING?t=n.value:n.type===a.TOKEN_INT?t=parseInt(n.value,10):n.type===a.TOKEN_FLOAT?t=parseFloat(n.value):n.type===a.TOKEN_BOOLEAN?"true"===n.value?t=!0:"false"===n.value?t=!1:this.fail("invalid boolean: "+n.value,n.lineno,n.colno):n.type===a.TOKEN_NONE?t=null:n.type===a.TOKEN_REGEX&&(t=new RegExp(n.value.body,n.value.flags)):this.fail("expected expression, got end of file"),void 0!==t?i=new r.Literal(n.lineno,n.colno,t):n.type===a.TOKEN_SYMBOL?i=new r.Symbol(n.lineno,n.colno,n.value):(this.pushToken(n),i=this.parseAggregate()),e||(i=this.parsePostfix(i)),i)return i;throw this.error("unexpected token: "+n.value,n.lineno,n.colno)},c.parseFilterName=function(){for(var e=this.expect(a.TOKEN_SYMBOL),t=e.value;this.skipValue(a.TOKEN_OPERATOR,".");)t+="."+this.expect(a.TOKEN_SYMBOL).value;return new r.Symbol(e.lineno,e.colno,t)},c.parseFilterArgs=function(e){return this.peekToken().type===a.TOKEN_LEFT_PAREN?this.parsePostfix(e).args.children:[]},c.parseFilter=function(e){for(;this.skip(a.TOKEN_PIPE);){var t=this.parseFilterName();e=new r.Filter(t.lineno,t.colno,t,new r.NodeList(t.lineno,t.colno,[e].concat(this.parseFilterArgs(e))))}return e},c.parseFilterStatement=function(){var e=this.peekToken();this.skipSymbol("filter")||this.fail("parseFilterStatement: expected filter");var t=this.parseFilterName(),n=this.parseFilterArgs(t);this.advanceAfterBlockEnd(e.value);var i=new r.Capture(t.lineno,t.colno,this.parseUntilBlocks("endfilter"));this.advanceAfterBlockEnd();var a=new r.Filter(t.lineno,t.colno,t,new r.NodeList(t.lineno,t.colno,[i].concat(n)));return new r.Output(t.lineno,t.colno,[a])},c.parseAggregate=function(){var e,t=this.nextToken();switch(t.type){case a.TOKEN_LEFT_PAREN:e=new r.Group(t.lineno,t.colno);break;case a.TOKEN_LEFT_BRACKET:e=new r.Array(t.lineno,t.colno);break;case a.TOKEN_LEFT_CURLY:e=new r.Dict(t.lineno,t.colno);break;default:return null}for(;;){var n=this.peekToken().type;if(n===a.TOKEN_RIGHT_PAREN||n===a.TOKEN_RIGHT_BRACKET||n===a.TOKEN_RIGHT_CURLY){this.nextToken();break}if(e.children.length>0&&(this.skip(a.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",t.lineno,t.colno)),e instanceof r.Dict){var i=this.parsePrimary();this.skip(a.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",t.lineno,t.colno);var s=this.parseExpression();e.addChild(new r.Pair(i.lineno,i.colno,i,s))}else{var o=this.parseExpression();e.addChild(o)}}return e},c.parseSignature=function(e,t){var n=this.peekToken();if(!t&&n.type!==a.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",n.lineno,n.colno)}n.type===a.TOKEN_LEFT_PAREN&&(n=this.nextToken());for(var i=new r.NodeList(n.lineno,n.colno),s=new r.KeywordArgs(n.lineno,n.colno),o=!1;;){if(n=this.peekToken(),!t&&n.type===a.TOKEN_RIGHT_PAREN){this.nextToken();break}if(t&&n.type===a.TOKEN_BLOCK_END)break;if(o&&!this.skip(a.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",n.lineno,n.colno);else{var c=this.parseExpression();this.skipValue(a.TOKEN_OPERATOR,"=")?s.addChild(new r.Pair(c.lineno,c.colno,c,this.parseExpression())):i.addChild(c)}o=!0}return s.children.length&&i.addChild(s),i},c.parseUntilBlocks=function(){for(var e=this.breakOnBlocks,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.breakOnBlocks=n;var a=this.parse();return this.breakOnBlocks=e,a},c.parseNodes=function(){for(var e,t=[];e=this.nextToken();)if(e.type===a.TOKEN_DATA){var n=e.value,i=this.peekToken(),s=i&&i.value;this.dropLeadingWhitespace&&(n=n.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),i&&(i.type===a.TOKEN_BLOCK_START&&"-"===s.charAt(s.length-1)||i.type===a.TOKEN_VARIABLE_START&&"-"===s.charAt(this.tokens.tags.VARIABLE_START.length)||i.type===a.TOKEN_COMMENT&&"-"===s.charAt(this.tokens.tags.COMMENT_START.length))&&(n=n.replace(/\s*$/,"")),t.push(new r.Output(e.lineno,e.colno,[new r.TemplateData(e.lineno,e.colno,n)]))}else if(e.type===a.TOKEN_BLOCK_START){this.dropLeadingWhitespace=!1;var o=this.parseStatement();if(!o)break;t.push(o)}else if(e.type===a.TOKEN_VARIABLE_START){var c=this.parseExpression();this.dropLeadingWhitespace=!1,this.advanceAfterVariableEnd(),t.push(new r.Output(e.lineno,e.colno,[c]))}else e.type===a.TOKEN_COMMENT?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.COMMENT_END.length-1):this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return t},c.parse=function(){return new r.NodeList(0,0,this.parseNodes())},c.parseAsRoot=function(){return new r.Root(0,0,this.parseNodes())},s}(s);e.exports={parse:function(e,t,n){var i=new c(a.lex(e,n));return void 0!==t&&(i.extensions=t),i.parseAsRoot()},Parser:c}},function(e,t,n){var i=n(0),a=" \n\t\r ",r="()[]{}%*-+~/#,:|.<>=!",s="string",o="whitespace",c="data",l="block-start",u="block-end",d="variable-start",h="variable-end",p="comment",m="left-paren",f="right-paren",g="left-bracket",_="right-bracket",v="left-curly",y="right-curly",b="operator",w="comma",x="colon",M="tilde",k="pipe",C="float",S="boolean",E="none",A="symbol",T="regex";function $(e,t,n,i){return{type:e,value:t,lineno:n,colno:i}}var I=function(){function e(e,t){this.str=e,this.index=0,this.len=e.length,this.lineno=0,this.colno=0,this.in_code=!1;var n=(t=t||{}).tags||{};this.tags={BLOCK_START:n.blockStart||"{%",BLOCK_END:n.blockEnd||"%}",VARIABLE_START:n.variableStart||"{{",VARIABLE_END:n.variableEnd||"}}",COMMENT_START:n.commentStart||"{#",COMMENT_END:n.commentEnd||"#}"},this.trimBlocks=!!t.trimBlocks,this.lstripBlocks=!!t.lstripBlocks}var t=e.prototype;return t.nextToken=function(){var e,t=this.lineno,n=this.colno;if(this.in_code){var I=this.current();if(this.isFinished())return null;if('"'===I||"'"===I)return $(s,this._parseString(I),t,n);if(e=this._extract(a))return $(o,e,t,n);if((e=this._extractString(this.tags.BLOCK_END))||(e=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,this.trimBlocks&&("\n"===(I=this.current())?this.forward():"\r"===I&&(this.forward(),"\n"===(I=this.current())?this.forward():this.back())),$(u,e,t,n);if((e=this._extractString(this.tags.VARIABLE_END))||(e=this._extractString("-"+this.tags.VARIABLE_END)))return this.in_code=!1,$(h,e,t,n);if("r"===I&&"/"===this.str.charAt(this.index+1)){this.forwardN(2);for(var O="";!this.isFinished();){if("/"===this.current()&&"\\"!==this.previous()){this.forward();break}O+=this.current(),this.forward()}for(var L=["g","i","m","y"],D="";!this.isFinished()&&-1!==L.indexOf(this.current());)D+=this.current(),this.forward();return $(T,{body:O,flags:D},t,n)}if(-1!==r.indexOf(I)){this.forward();var j,z=["==","===","!=","!==","<=",">=","//","**"],R=I+this.current();switch(-1!==i.indexOf(z,R)&&(this.forward(),I=R,-1!==i.indexOf(z,R+this.current())&&(I=R+this.current(),this.forward())),I){case"(":j=m;break;case")":j=f;break;case"[":j=g;break;case"]":j=_;break;case"{":j=v;break;case"}":j=y;break;case",":j=w;break;case":":j=x;break;case"~":j=M;break;case"|":j=k;break;default:j=b}return $(j,I,t,n)}if((e=this._extractUntil(a+r)).match(/^[-+]?[0-9]+$/)){if("."===this.current()){this.forward();var P=this._extract("0123456789");return $(C,e+"."+P,t,n)}return $("int",e,t,n)}if(e.match(/^(true|false)$/))return $(S,e,t,n);if("none"===e)return $(E,e,t,n);if("null"===e)return $(E,e,t,n);if(e)return $(A,e,t,n);throw new Error("Unexpected value while parsing: "+e)}var N,F=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.isFinished())return null;if((e=this._extractString(this.tags.BLOCK_START+"-"))||(e=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,$(l,e,t,n);if((e=this._extractString(this.tags.VARIABLE_START+"-"))||(e=this._extractString(this.tags.VARIABLE_START)))return this.in_code=!0,$(d,e,t,n);e="";var V=!1;for(this._matches(this.tags.COMMENT_START)&&(V=!0,e=this._extractString(this.tags.COMMENT_START));null!==(N=this._extractUntil(F));){if(e+=N,(this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!V){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=e.length){var B=e.slice(-this.colno);if(/^\s+$/.test(B)&&!(e=e.slice(0,-this.colno)).length)return this.nextToken()}break}if(this._matches(this.tags.COMMENT_END)){if(!V)throw new Error("unexpected end of comment");e+=this._extractString(this.tags.COMMENT_END);break}e+=this.current(),this.forward()}if(null===N&&V)throw new Error("expected end of comment, got end of file");return $(V?p:c,e,t,n)},t._parseString=function(e){this.forward();for(var t="";!this.isFinished()&&this.current()!==e;){var n=this.current();if("\\"===n){switch(this.forward(),this.current()){case"n":t+="\n";break;case"t":t+="\t";break;case"r":t+="\r";break;default:t+=this.current()}this.forward()}else t+=n,this.forward()}return this.forward(),t},t._matches=function(e){return this.index+e.length>this.len?null:this.str.slice(this.index,this.index+e.length)===e},t._extractString=function(e){return this._matches(e)?(this.forwardN(e.length),e):null},t._extractUntil=function(e){return this._extractMatching(!0,e||"")},t._extract=function(e){return this._extractMatching(!1,e)},t._extractMatching=function(e,t){if(this.isFinished())return null;var n=t.indexOf(this.current());if(e&&-1===n||!e&&-1!==n){var i=this.current();this.forward();for(var a=t.indexOf(this.current());(e&&-1===a||!e&&-1!==a)&&!this.isFinished();)i+=this.current(),this.forward(),a=t.indexOf(this.current());return i}return""},t._extractRegex=function(e){var t=this.currentStr().match(e);return t?(this.forwardN(t[0].length),t):null},t.isFinished=function(){return this.index>=this.len},t.forwardN=function(e){for(var t=0;t<e;t++)this.forward()},t.forward=function(){this.index++,"\n"===this.previous()?(this.lineno++,this.colno=0):this.colno++},t.backN=function(e){for(var t=0;t<e;t++)this.back()},t.back=function(){if(this.index--,"\n"===this.current()){this.lineno--;var e=this.src.lastIndexOf("\n",this.index-1);this.colno=-1===e?this.index:this.index-e}else this.colno--},t.current=function(){return this.isFinished()?"":this.str.charAt(this.index)},t.currentStr=function(){return this.isFinished()?"":this.str.substr(this.index)},t.previous=function(){return this.str.charAt(this.index-1)},e}();e.exports={lex:function(e,t){return new I(e,t)},TOKEN_STRING:s,TOKEN_WHITESPACE:o,TOKEN_DATA:c,TOKEN_BLOCK_START:l,TOKEN_BLOCK_END:u,TOKEN_VARIABLE_START:d,TOKEN_VARIABLE_END:h,TOKEN_COMMENT:p,TOKEN_LEFT_PAREN:m,TOKEN_RIGHT_PAREN:f,TOKEN_LEFT_BRACKET:g,TOKEN_RIGHT_BRACKET:_,TOKEN_LEFT_CURLY:v,TOKEN_RIGHT_CURLY:y,TOKEN_OPERATOR:b,TOKEN_COMMA:w,TOKEN_COLON:x,TOKEN_TILDE:M,TOKEN_PIPE:k,TOKEN_INT:"int",TOKEN_FLOAT:C,TOKEN_BOOLEAN:S,TOKEN_NONE:E,TOKEN_SYMBOL:A,TOKEN_SPECIAL:"special",TOKEN_REGEX:T}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(6),r=n(19).PrecompiledLoader,s=function(e){var t,n;function a(t,n){var i;return(i=e.call(this)||this).baseURL=t||".",n=n||{},i.useCache=!!n.useCache,i.async=!!n.async,i}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var r=a.prototype;return r.resolve=function(e,t){throw new Error("relative templates not support in the browser yet")},r.getSource=function(e,t){var n,i=this,a=this.useCache;return this.fetch(this.baseURL+"/"+e,(function(r,s){if(r)if(t)t(r.content);else{if(404!==r.status)throw r.content;n=null}else n={src:s,path:e,noCache:!a},i.emit("load",e,n),t&&t(null,n)})),n},r.fetch=function(e,t){if("undefined"==typeof window)throw new Error("WebLoader can only by used in a browser");var n=new XMLHttpRequest,i=!0;n.onreadystatechange=function(){4===n.readyState&&i&&(i=!1,0===n.status||200===n.status?t(null,n.responseText):t({status:n.status,content:n.responseText}))},e+=(-1===e.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),n.open("GET",e,this.async),n.send()},a}(a);e.exports={WebLoader:s,PrecompiledLoader:r}},function(e,t,n){var i,a=n(0),r=n(7),s=r.Environment,o=r.Template,c=n(6),l=n(10),u=n(23),d=n(5),h=n(8),p=n(9),m=n(2),f=n(3),g=n(25);function _(e,t){var n;return t=t||{},a.isObject(e)&&(t=e,e=null),l.FileSystemLoader?n=new l.FileSystemLoader(e,{watch:t.watch,noCache:t.noCache}):l.WebLoader&&(n=new l.WebLoader(e,{useCache:t.web&&t.web.useCache,async:t.web&&t.web.async})),i=new s(n,t),t&&t.express&&i.express(t.express),i}e.exports={Environment:s,Template:o,Loader:c,FileSystemLoader:l.FileSystemLoader,NodeResolveLoader:l.NodeResolveLoader,PrecompiledLoader:l.PrecompiledLoader,WebLoader:l.WebLoader,compiler:d,parser:h,lexer:p,runtime:m,lib:a,nodes:f,installJinjaCompat:g,configure:_,reset:function(){i=void 0},compile:function(e,t,n,a){return i||_(),new o(e,t,n,a)},render:function(e,t,n){return i||_(),i.render(e,t,n)},renderString:function(e,t,n){return i||_(),i.renderString(e,t,n)},precompile:u?u.precompile:void 0,precompileString:u?u.precompileString:void 0}},function(e,t,n){var i=n(13),a=[],r=[],s=i.makeRequestCallFromTimer((function(){if(r.length)throw r.shift()}));function o(e){var t;(t=a.length?a.pop():new c).task=e,i(t)}function c(){this.task=null}e.exports=o,c.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(r.push(e),s())}finally{this.task=null,a[a.length]=this}}},function(e,t,n){(function(t){function n(e){a.length||i(),a[a.length]=e}e.exports=n;var i,a=[],r=0;function s(){for(;r<a.length;){var e=r;if(r+=1,a[e].call(),r>1024){for(var t=0,n=a.length-r;t<n;t++)a[t]=a[t+r];a.length-=r,r=0}}a.length=0,r=0}var o,c,l,u=void 0!==t?t:self,d=u.MutationObserver||u.WebKitMutationObserver;function h(e){return function(){var t=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof d?(o=1,c=new d(s),l=document.createTextNode(""),c.observe(l,{characterData:!0}),i=function(){o=-o,l.data=o}):i=h(s),n.requestFlush=i,n.makeRequestCallFromTimer=h}).call(t,n(14))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i,a,r,s,o;a=function(){var e=Array.prototype.slice.call(arguments);"function"==typeof e[0]&&e[0].apply(null,e.splice(1))},r=function(e){"function"==typeof setImmediate?setImmediate(e):"undefined"!=typeof process&&process.nextTick?process.nextTick(e):setTimeout(e,0)},s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=function(e,t,n){var i=n?r:a;if(t=t||function(){},!s(e)){var o=new Error("First argument to waterfall must be an array of functions");return t(o)}if(!e.length)return t();var c=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var a=Array.prototype.slice.call(arguments,1),r=e.next();r?a.push(c(r)):a.push(t),i((function(){e.apply(null,a)}))}}};c(function(e){var t=function(n){var i=function(){return e.length&&e[n].apply(null,arguments),i.next()};return i.next=function(){return n<e.length-1?t(n+1):null},i};return t(0)}(e))()},void 0===(i=function(){return o}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i,a="object"==typeof Reflect?Reflect:null,r=a&&"function"==typeof a.apply?a.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=a&&"function"==typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function a(n){e.removeListener(t,r),i(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}_(e,t,r,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&_(e,"error",t,n)}(e,a,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var a,r,s,o;if(l(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(a=u(e))>0&&s.length>a&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,o=c,console&&console.warn&&console.warn(o)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=h.bind(i);return a.listener=n,i.wrapFn=a,a}function m(e,t,n){var i=e._events;if(void 0===i)return[];var a=i[t];return void 0===a?[]:"function"==typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):g(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function _(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(r){i.once&&e.removeEventListener(t,a),n(r)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=a[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return l(t),this.on(e,p(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,p(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,a,r,s;if(l(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,a=r;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(a=r[i])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return m(this,e,!0)},o.prototype.rawListeners=function(e){return m(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){var i=n(3),a=n(0),r=0;function s(){return"hole_"+r++}function o(e,t){for(var n=null,i=0;i<e.length;i++){var a=t(e[i]);a!==e[i]&&(n||(n=e.slice()),n[i]=a)}return n||e}function c(e,t,n){if(!(e instanceof i.Node))return e;if(!n){var a=t(e);if(a&&a!==e)return a}if(e instanceof i.NodeList){var r=o(e.children,(function(e){return c(e,t,n)}));r!==e.children&&(e=new i[e.typename](e.lineno,e.colno,r))}else if(e instanceof i.CallExtension){var s=c(e.args,t,n),l=o(e.contentArgs,(function(e){return c(e,t,n)}));s===e.args&&l===e.contentArgs||(e=new i[e.typename](e.extName,e.prop,s,l))}else{var u=e.fields.map((function(t){return e[t]})),d=o(u,(function(e){return c(e,t,n)}));d!==u&&(e=new i[e.typename](e.lineno,e.colno),d.forEach((function(t,n){e[e.fields[n]]=t})))}return n&&t(e)||e}function l(e,t){return c(e,t,!0)}function u(e,t,n){var r=[],o=l(n?e[n]:e,(function(e){var n;return e instanceof i.Block?e:((e instanceof i.Filter&&-1!==a.indexOf(t,e.name.value)||e instanceof i.CallExtensionAsync)&&(n=new i.Symbol(e.lineno,e.colno,s()),r.push(new i.FilterAsync(e.lineno,e.colno,e.name,e.args,n))),n)}));return n?e[n]=o:e=o,r.length?(r.push(e),new i.NodeList(e.lineno,e.colno,r)):e}function d(e,t){return function(e){return l(e,(function(e){if(e instanceof i.If||e instanceof i.For){var t=!1;if(c(e,(function(e){if(e instanceof i.FilterAsync||e instanceof i.IfAsync||e instanceof i.AsyncEach||e instanceof i.AsyncAll||e instanceof i.CallExtensionAsync)return t=!0,e})),t){if(e instanceof i.If)return new i.IfAsync(e.lineno,e.colno,e.cond,e.body,e.else_);if(e instanceof i.For&&!(e instanceof i.AsyncAll))return new i.AsyncEach(e.lineno,e.colno,e.arr,e.name,e.body,e.else_)}}}))}(function(e){return c(e,(function(e){if(e instanceof i.Block){var t=!1,n=s();e.body=c(e.body,(function(e){if(e instanceof i.FunCall&&"super"===e.name.value)return t=!0,new i.Symbol(e.lineno,e.colno,n)})),t&&e.body.children.unshift(new i.Super(0,0,e.name,new i.Symbol(0,0,n)))}}))}(function(e,t){return l(e,(function(e){return e instanceof i.Output?u(e,t):e instanceof i.Set?u(e,t,"value"):e instanceof i.For?u(e,t,"arr"):e instanceof i.If?u(e,t,"cond"):e instanceof i.CallExtension?u(e,t,"args"):void 0}))}(e,t)))}e.exports={transform:function(e,t){return d(e,t||[])}}},function(e,t,n){var i=n(0),a=n(2);function r(e,t){return null==e||!1===e?t:e}function s(e){return e!=e}function o(e){var t=(e=r(e,"")).toLowerCase();return a.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))}function c(e){if(i.isString(e))return e.split("");if(i.isObject(e))return i._entries(e||{}).map((function(e){return{key:e[0],value:e[1]}}));if(i.isArray(e))return e;throw new i.TemplateError("list filter: type not iterable")}function l(e){return function(t,n,a){void 0===n&&(n="truthy");var r=this,s=r.env.getTest(n);return i.toArray(t).filter((function(t){return s.call(r,t,a)===e}))}}function u(e){return a.copySafeness(e,e.replace(/^\s*|\s*$/g,""))}(t=e.exports={}).abs=Math.abs,t.batch=function(e,t,n){var i,a=[],r=[];for(i=0;i<e.length;i++)i%t==0&&r.length&&(a.push(r),r=[]),r.push(e[i]);if(r.length){if(n)for(i=r.length;i<t;i++)r.push(n);a.push(r)}return a},t.capitalize=o,t.center=function(e,t){if(t=t||80,(e=r(e,"")).length>=t)return e;var n=t-e.length,s=i.repeat(" ",n/2-n%2),o=i.repeat(" ",n/2);return a.copySafeness(e,s+e+o)},t.default=function(e,t,n){return n?e||t:void 0!==e?e:t},t.dictsort=function(e,t,n){if(!i.isObject(e))throw new i.TemplateError("dictsort filter: val must be an object");var a,r=[];for(var s in e)r.push([s,e[s]]);if(void 0===n||"key"===n)a=0;else{if("value"!==n)throw new i.TemplateError("dictsort filter: You can only sort by either key or value");a=1}return r.sort((function(e,n){var r=e[a],s=n[a];return t||(i.isString(r)&&(r=r.toUpperCase()),i.isString(s)&&(s=s.toUpperCase())),r>s?1:r===s?0:-1})),r},t.dump=function(e,t){return JSON.stringify(e,null,t)},t.escape=function(e){return e instanceof a.SafeString?e:(e=null==e?"":e,a.markSafe(i.escape(e.toString())))},t.safe=function(e){return e instanceof a.SafeString?e:(e=null==e?"":e,a.markSafe(e.toString()))},t.first=function(e){return e[0]},t.forceescape=function(e){return e=null==e?"":e,a.markSafe(i.escape(e.toString()))},t.groupby=function(e,t){return i.groupBy(e,t,this.env.opts.throwOnUndefined)},t.indent=function(e,t,n){if(""===(e=r(e,"")))return"";t=t||4;var s=e.split("\n"),o=i.repeat(" ",t),c=s.map((function(e,t){return 0!==t||n?""+o+e:e})).join("\n");return a.copySafeness(e,c)},t.join=function(e,t,n){return t=t||"",n&&(e=i.map(e,(function(e){return e[n]}))),e.join(t)},t.last=function(e){return e[e.length-1]},t.length=function(e){var t=r(e,"");return void 0!==t?"function"==typeof Map&&t instanceof Map||"function"==typeof Set&&t instanceof Set?t.size:!i.isObject(t)||t instanceof a.SafeString?t.length:i.keys(t).length:0},t.list=c,t.lower=function(e){return(e=r(e,"")).toLowerCase()},t.nl2br=function(e){return null==e?"":a.copySafeness(e,e.replace(/\r\n|\n/g,"<br />\n"))},t.random=function(e){return e[Math.floor(Math.random()*e.length)]},t.reject=l(!1),t.rejectattr=function(e,t){return e.filter((function(e){return!e[t]}))},t.select=l(!0),t.selectattr=function(e,t){return e.filter((function(e){return!!e[t]}))},t.replace=function(e,t,n,i){var r=e;if(t instanceof RegExp)return e.replace(t,n);void 0===i&&(i=-1);var s="";if("number"==typeof t)t=""+t;else if("string"!=typeof t)return e;if("number"==typeof e&&(e=""+e),"string"!=typeof e&&!(e instanceof a.SafeString))return e;if(""===t)return s=n+e.split("").join(n)+n,a.copySafeness(e,s);var o=e.indexOf(t);if(0===i||-1===o)return e;for(var c=0,l=0;o>-1&&(-1===i||l<i);)s+=e.substring(c,o)+n,c=o+t.length,l++,o=e.indexOf(t,c);return c<e.length&&(s+=e.substring(c)),a.copySafeness(r,s)},t.reverse=function(e){var t;return t=i.isString(e)?c(e):i.map(e,(function(e){return e})),t.reverse(),i.isString(e)?a.copySafeness(e,t.join("")):t},t.round=function(e,t,n){t=t||0;var i=Math.pow(10,t);return("ceil"===n?Math.ceil:"floor"===n?Math.floor:Math.round)(e*i)/i},t.slice=function(e,t,n){for(var i=Math.floor(e.length/t),a=e.length%t,r=[],s=0,o=0;o<t;o++){var c=s+o*i;o<a&&s++;var l=s+(o+1)*i,u=e.slice(c,l);n&&o>=a&&u.push(n),r.push(u)}return r},t.sum=function(e,t,n){return void 0===n&&(n=0),t&&(e=i.map(e,(function(e){return e[t]}))),n+e.reduce((function(e,t){return e+t}),0)},t.sort=a.makeMacro(["value","reverse","case_sensitive","attribute"],[],(function(e,t,n,a){var r=this,s=i.map(e,(function(e){return e})),o=i.getAttrGetter(a);return s.sort((function(e,s){var c=a?o(e):e,l=a?o(s):s;if(r.env.opts.throwOnUndefined&&a&&(void 0===c||void 0===l))throw new TypeError('sort: attribute "'+a+'" resolved to undefined');return!n&&i.isString(c)&&i.isString(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c<l?t?1:-1:c>l?t?-1:1:0})),s})),t.string=function(e){return a.copySafeness(e,e)},t.striptags=function(e,t){var n=u((e=r(e,"")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,"")),i="";return i=t?n.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,"\n").replace(/\n\n\n+/g,"\n\n"):n.replace(/\s+/gi," "),a.copySafeness(e,i)},t.title=function(e){var t=(e=r(e,"")).split(" ").map((function(e){return o(e)}));return a.copySafeness(e,t.join(" "))},t.trim=u,t.truncate=function(e,t,n,i){var s=e;if(t=t||255,(e=r(e,"")).length<=t)return e;if(n)e=e.substring(0,t);else{var o=e.lastIndexOf(" ",t);-1===o&&(o=t),e=e.substring(0,o)}return e+=null!=i?i:"...",a.copySafeness(s,e)},t.upper=function(e){return(e=r(e,"")).toUpperCase()},t.urlencode=function(e){var t=encodeURIComponent;return i.isString(e)?t(e):(i.isArray(e)?e:i._entries(e)).map((function(e){var n=e[0],i=e[1];return t(n)+"="+t(i)})).join("&")};var d=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,h=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,p=/^https?:\/\/.*$/,m=/^www\./,f=/\.(?:org|net|com)(?:\:|\/|$)/;t.urlize=function(e,t,n){s(t)&&(t=1/0);var i=!0===n?' rel="nofollow"':"";return e.split(/(\s+)/).filter((function(e){return e&&e.length})).map((function(e){var n=e.match(d),a=n?n[1]:e,r=a.substr(0,t);return p.test(a)?'<a href="'+a+'"'+i+">"+r+"</a>":m.test(a)?'<a href="http://'+a+'"'+i+">"+r+"</a>":h.test(a)?'<a href="mailto:'+a+'">'+a+"</a>":f.test(a)?'<a href="http://'+a+'"'+i+">"+r+"</a>":e})).join("")},t.wordcount=function(e){var t=(e=r(e,""))?e.match(/\w+/g):null;return t?t.length:null},t.float=function(e,t){var n=parseFloat(e);return s(n)?t:n};var g=a.makeMacro(["value","default","base"],[],(function(e,t,n){void 0===n&&(n=10);var i=parseInt(e,n);return s(i)?t:i}));t.int=g,t.d=t.default,t.e=t.escape},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=function(e){var t,n;function a(t){var n;return(n=e.call(this)||this).precompiled=t||{},n}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n),a.prototype.getSource=function(e){return this.precompiled[e]?{src:{type:"code",obj:this.precompiled[e]},path:e}:null},a}(n(6));e.exports={PrecompiledLoader:a}},function(e,t,n){var i=n(2).SafeString;t.callable=function(e){return"function"==typeof e},t.defined=function(e){return void 0!==e},t.divisibleby=function(e,t){return e%t==0},t.escaped=function(e){return e instanceof i},t.equalto=function(e,t){return e===t},t.eq=t.equalto,t.sameas=t.equalto,t.even=function(e){return e%2==0},t.falsy=function(e){return!e},t.ge=function(e,t){return e>=t},t.greaterthan=function(e,t){return e>t},t.gt=t.greaterthan,t.le=function(e,t){return e<=t},t.lessthan=function(e,t){return e<t},t.lt=t.lessthan,t.lower=function(e){return e.toLowerCase()===e},t.ne=function(e,t){return e!==t},t.null=function(e){return null===e},t.number=function(e){return"number"==typeof e},t.odd=function(e){return e%2==1},t.string=function(e){return"string"==typeof e},t.truthy=function(e){return!!e},t.undefined=function(e){return void 0===e},t.upper=function(e){return e.toUpperCase()===e},t.iterable=function(e){return"undefined"!=typeof Symbol?!!e[Symbol.iterator]:Array.isArray(e)||"string"==typeof e},t.mapping=function(e){var t=null!=e&&"object"==typeof e&&!Array.isArray(e);return Set?t&&!(e instanceof Set):t}},function(e,t,n){e.exports=function(){return{range:function(e,t,n){void 0===t?(t=e,e=0,n=1):n||(n=1);var i=[];if(n>0)for(var a=e;a<t;a+=n)i.push(a);else for(var r=e;r>t;r+=n)i.push(r);return i},cycler:function(){return e=Array.prototype.slice.call(arguments),t=-1,{current:null,reset:function(){t=-1,this.current=null},next:function(){return++t>=e.length&&(t=0),this.current=e[t],this.current}};var e,t},joiner:function(e){return function(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}(e)}}}},function(e,t,n){var i=n(4);e.exports=function(e,t){function n(e,t){if(this.name=e,this.path=e,this.defaultEngine=t.defaultEngine,this.ext=i.extname(e),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}return n.prototype.render=function(t,n){e.render(this.name,t,n)},t.set("view",n),t.set("nunjucksEnv",e),e}},function(e,t,n){var i=n(4),a=n(4),r=n(0)._prettifyError,s=n(5),o=n(7).Environment,c=n(24);function l(e,t){return!!Array.isArray(t)&&t.some((function(t){return e.match(t)}))}function u(e,t){(t=t||{}).isString=!0;var n=t.env||new o([]),i=t.wrapper||c;if(!t.name)throw new Error('the "name" option is required when compiling a string');return i([d(e,t.name,n)],t)}function d(e,t,n){var i,a=(n=n||new o([])).asyncFilters,c=n.extensionsList;t=t.replace(/\\/g,"/");try{i=s.compile(e,a,c,t,n.opts)}catch(e){throw r(t,!1,e)}return{name:t,template:i}}e.exports={precompile:function(e,t){var n=(t=t||{}).env||new o([]),r=t.wrapper||c;if(t.isString)return u(e,t);var s=i.existsSync(e)&&i.statSync(e),h=[],p=[];if(s.isFile())h.push(d(i.readFileSync(e,"utf-8"),t.name||e,n));else if(s.isDirectory()){!function n(r){i.readdirSync(r).forEach((function(s){var o=a.join(r,s),c=o.substr(a.join(e,"/").length),u=i.statSync(o);u&&u.isDirectory()?l(c+="/",t.exclude)||n(o):l(c,t.include)&&p.push(o)}))}(e);for(var m=0;m<p.length;m++){var f=p[m].replace(a.join(e,"/"),"");try{h.push(d(i.readFileSync(p[m],"utf-8"),f,n))}catch(e){if(!t.force)throw e;console.error(e)}}}return r(h,t)},precompileString:u}},function(e,t,n){e.exports=function(e,t){var n="";t=t||{};for(var i=0;i<e.length;i++){var a=JSON.stringify(e[i].name);n+="(function() {(window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["+a+"] = (function() {\n"+e[i].template+"\n})();\n",t.asFunction&&(n+="return function(ctx, cb) { return nunjucks.render("+a+", ctx, cb); }\n"),n+="})();\n"}return n}},function(e,t,n){e.exports=function(){var e,t,n=this.runtime,i=this.lib,a=this.compiler.Compiler,r=this.parser.Parser,s=this.nodes,o=this.lexer,c=n.contextOrFrameLookup,l=n.memberLookup;function u(e){return{index:e.index,lineno:e.lineno,colno:e.colno}}if(a&&(e=a.prototype.assertType),r&&(t=r.prototype.parseAggregate),n.contextOrFrameLookup=function(e,t,n){var i=c.apply(this,arguments);if(void 0!==i)return i;switch(n){case"True":return!0;case"False":return!1;case"None":return null;default:return}},s&&a&&r){var d=s.Node.extend("Slice",{fields:["start","stop","step"],init:function(e,t,n,i,a){n=n||new s.Literal(e,t,null),i=i||new s.Literal(e,t,null),a=a||new s.Literal(e,t,1),this.parent(e,t,n,i,a)}});a.prototype.assertType=function(t){t instanceof d||e.apply(this,arguments)},a.prototype.compileSlice=function(e,t){this._emit("("),this._compileExpression(e.start,t),this._emit("),("),this._compileExpression(e.stop,t),this._emit("),("),this._compileExpression(e.step,t),this._emit(")")},r.prototype.parseAggregate=function(){var e=this,n=u(this.tokens);n.colno--,n.index--;try{return t.apply(this)}catch(t){var a=u(this.tokens),r=function(){return i._assign(e.tokens,a),t};i._assign(this.tokens,n),this.peeked=!1;var c=this.peekToken();if(c.type!==o.TOKEN_LEFT_BRACKET)throw r();this.nextToken();for(var l=new d(c.lineno,c.colno),h=!1,p=0;p<=l.fields.length&&!this.skip(o.TOKEN_RIGHT_BRACKET);p++){if(p===l.fields.length){if(!h)break;this.fail("parseSlice: too many slice components",c.lineno,c.colno)}this.skip(o.TOKEN_COLON)?h=!0:(l[l.fields[p]]=this.parseExpression(),h=this.skip(o.TOKEN_COLON)||h)}if(!h)throw r();return new s.Array(c.lineno,c.colno,[l])}}}function h(e,t,i,a){e=e||[],null===t&&(t=a<0?e.length-1:0),null===i?i=a<0?-1:e.length:i<0&&(i+=e.length),t<0&&(t+=e.length);for(var r=[],s=t;!(s<0||s>e.length||a>0&&s>=i||a<0&&s<=i);s+=a)r.push(n.memberLookup(e,s));return r}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var m={pop:function(e){if(void 0===e)return this.pop();if(e>=this.length||e<0)throw new Error("KeyError");return this.splice(e,1)},append:function(e){return this.push(e)},remove:function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return this.splice(t,1);throw new Error("ValueError")},count:function(e){for(var t=0,n=0;n<this.length;n++)this[n]===e&&t++;return t},index:function(e){var t;if(-1===(t=this.indexOf(e)))throw new Error("ValueError");return t},find:function(e){return this.indexOf(e)},insert:function(e,t){return this.splice(e,0,t)}},f={items:function(){return i._entries(this)},values:function(){return i._values(this)},keys:function(){return i.keys(this)},get:function(e,t){var n=this[e];return void 0===n&&(n=t),n},has_key:function(e){return p(this,e)},pop:function(e,t){var n=this[e];if(void 0===n&&void 0!==t)n=t;else{if(void 0===n)throw new Error("KeyError");delete this[e]}return n},popitem:function(){var e=i.keys(this);if(!e.length)throw new Error("KeyError");var t=e[0],n=this[t];return delete this[t],[t,n]},setdefault:function(e,t){return void 0===t&&(t=null),e in this||(this[e]=t),this[e]},update:function(e){return i._assign(this,e),null}};return f.iteritems=f.items,f.itervalues=f.values,f.iterkeys=f.keys,n.memberLookup=function(e,t,n){return 4===arguments.length?h.apply(this,arguments):(e=e||{},i.isArray(e)&&p(m,t)?m[t].bind(e):i.isObject(e)&&p(f,t)?f[t].bind(e):l.apply(this,arguments))},function(){n.contextOrFrameLookup=c,n.memberLookup=l,a&&(a.prototype.assertType=e),r&&(r.prototype.parseAggregate=t)}}}])};var py=Nd(hy.exports=dy());function my(e,t){try{if(t){if(e.entities[t]){if(e.entities[t].area_id)return e.entities[t].area_id;t=e.entities[t].device_id??t}if(e.devices[t])return e.devices[t].area_id;for(const n in e.areas)if(e.areas[n].name==t)return n}return}catch{return}}function fy(e,t){try{if(t){let n=t;if(e.entities[t]&&(n=e.entities[t].area_id??n,t=e.entities[t].device_id??t),e.devices[t]&&(n=e.devices[t].area_id??n),e.areas[n])return e.areas[n].name}return}catch{return}}function gy(e,t){try{const n=[];if(t){const i=_y(e,t);for(const t of i)for(const i in e.entities)e.entities[i].device_id==t&&n.push(i);n.sort()}return n}catch{return[]}}function _y(e,t){try{const n=[];if(t){if(!(t in e.areas))for(const n in e.areas)if(e.areas[n].name==t){t=n;break}for(const i in e.devices)e.devices[i].area_id==t&&n.push(i);n.sort()}return n}catch{return[]}}function vy(e,t){return!!Array.isArray(e)&&e?.includes(t)}function yy(e,t,n,i){"object"!=typeof n||Array.isArray(n)||(i=n.with_unit??i,n=n.rounded??void 0);try{const a=e.states[t];let r=a?.state;if(i&&null==n&&(n=!0),n&&!isNaN(a?.state)){const n=e.entities[t]?.display_precision??0;r=Number(r).toPrecision(n)}return i&&a?.attributes?.unit_of_measurement&&(r=`${r} ${a?.attributes?.unit_of_measurement}`),r}catch{return}}function by(e,t,n){try{return e.states[t].attributes[n]}catch{return}}function wy(e,t){try{const n=yy(e,t);return!![!1,0,-0,""].includes(n)||Boolean(n)}catch{return!1}}function xy(e){const t={};for(const n in e.states){const[i,a]=n.split(".");t[i]=t[i]??{},t[i][a]=e.states[n]}return t}function My(e,t){try{const n=[];if(t)for(const i in e.entities)e.entities[i].device_id==t&&n.push(i);return n}catch{return[]}}function ky(e,t,n){try{return e.devices[t]?.[n]??by(e,t,n)}catch{return}}function Cy(e,t){try{if(t){if(e.entities[t])return e.entities[t].device_id;for(const n in e.devices){const i=e.devices[n];if(i.name==t||i.name_by_user==t)return n}}return}catch{return}}function Sy(e,t,n=!1){if(e[0]==t[0]&&e[1]==t[1])return 0;const i=1/298.257223563,a=6356752.314245,r=Math.atan((1-i)*Math.tan(e[0]*Math.PI/180)),s=Math.atan((1-i)*Math.tan(t[0]*Math.PI/180));let o=(t[1]-e[1])*Math.PI/180,c=o;const l=Math.sin(r),u=Math.cos(r),d=Math.sin(s),h=Math.cos(s);let p=0,m=0,f=0,g=0,_=0;for(let e=0;e<200;e++){const t=Math.sin(c),n=Math.cos(c);if(m=Math.sqrt((h*t)**2+(u*d-l*h*n)**2),0==m)return 0;g=l*d+u*h*n,_=Math.atan2(m,g);const a=u*h*t/m;p=1-a**2,f=0!=p?g-2*l*d/p:0;const r=i/16*p*(4+i*(4-3*p)),s=c;if(c=o+(1-r)*i*a*(_+r*m*(f+r*g*(2*f**2-1))),Math.abs(c-s)<1e-12)break;if(199==e)return null}const v=272331606109.84375*p/a**2,y=v/1024*(256+v*(v*(74-47*v)-128));let b=a*(1+v/16384*(4096+v*(v*(320-175*v)-768)))*(_-y*m*(f+y/4*(g*(2*f**2-1)-y/6*f*(4*m**2-3)*(4*f**2-3))))/1e3;return n&&(b*=.621371),b}function Ey(e,...t){function n(t){if(t.startsWith("zone."))return e.states[t].attributes.persons??[];let n=Object.keys(e.states).filter((e=>e==t||e.split(".")[0]==t));if("zone"==t){let t=[];for(const i of n)t.push(...e.states[i].attributes.persons??[]);n=Array.from(new Set(t))}return n}let i,a;if(1==t.length)i=[e.states["zone.home"].attributes.latitude,e.states["zone.home"].attributes.longitude],a=0;else if("number"==typeof t[0]){if("number"!=typeof t[1]||2==t.length)return null;i=[t[0],t[1]],a=2}else if("object"==typeof t[0]){if(Array.isArray(t[0])||!t[0].attributes)return null;i=[t[0].attributes.latitude,t[0].attributes.longitude],a=1}else{if("string"!=typeof t[0])return null;i=[e.states[t[0]].attributes.latitude,e.states[t[0]].attributes.longitude],a=1}let r=[];for(let e=a;e<t.length;e++)if("object"==typeof t[e]){let i=[];if(Array.isArray(t[e]))i=t[e];else if(t[e].entity_id)"zone"==t[e].entity_id.split(".")[0]?r.push(...t[e].attributes.persons):r.push(t[e]);else{const n=Object.keys(t[e]);if(t[e][n[0]].entity_id)i=n.map((n=>t[e][n].entity_id));else for(const a of n)i.push(...Object.keys(t[e][a]).map((n=>t[e][a][n].entity_id)))}for(const e of i)r.push(...n(e))}else"string"==typeof t[e]&&r.push(...n(t[e]));r=Array.from(new Set(r));let s=null,o=1/0;for(const t of r){let n;n="string"==typeof t?e.states[t]:t;const a=n.attributes.latitude,r=n.attributes.longitude;if(null!=a&&null!=r){const e=Sy(i,[a,r])??1/0;e<=o&&(s=n,o=e)}}return s}function Ay(e,t){try{let n=t;if(e.entities[t]&&(n=e.entities[t].area_id??n,t=e.entities[t].device_id??t),t){if(e.devices[t]&&(n=e.devices[t].area_id??n),e.areas[n])return e.areas[n].floor_id;for(const n in e.areas)if(e.areas[n].name==t)return e.areas[n].floor_id}return}catch{return}}function Ty(e,t){if(e.floors[t])return e.floors[t].name;const n=Ay(e,t);return n?e.floors[n].name:void 0}function $y(e,t){try{const n=[];if(t){let i;if(e.floors[t])i=t;else for(const n in e.floors)if(e.floors[n].name==t){i=n;break}if(!i)return[];for(const t in e.areas)e.areas[t].floor_id==i&&n.push(t)}return n}catch{return[]}}function Iy(e,...t){const n=[];for(let i of t.flat(1/0))if("string"==typeof i&&(i=e.states[i]),i)if(Array.isArray(i.attributes?.entity_id))n.push(...Iy(e,...i.attributes?.entity_id));else if(i?.attributes?.persons)n.push(...Iy(e,...i.attributes.persons));else if(i.entity_id)n.push(i);else{const t=Object.values(i);if(t[0]?.entity_id)n.push(...t);else for(const i of t){const t=Object.values(i);for(const i of t)i?.attributes?.persons?n.push(...Iy(e,...i.attributes.persons)):n.push(i)}}return n.filter(((e,t,n)=>t==n.findIndex((t=>t.entity_id==e.entity_id)))).sort(((e,t)=>e.entity_id.localeCompare(t.entity_id)))}function Oy(e,t,n,i,a){if("object"!=typeof n||Array.isArray(n)||(a=n.if_none??a,i=n.if_false??i,n=n.if_true??void 0),a){const n=qx(e,t);if([void 0,null,"undefined","null","None"].includes(n))return a}return qx(e,`\n\t\t{% if ${t} %}\n\t\t${n??!0}\n\t\t{% else %}\n\t\t${i??!1}\n\t\t{% endif %}\n\t`)}const Ly={};function Dy(e,t){try{return t?e.entities[t]?.labels??e.devices[t]?.labels??e.areas[t]?.labels??[]:Object.keys(Ly)}catch{return[]}}function jy(e){for(const t in Ly)if(Ly[t].name==e)return t}function zy(e){return Ly[e]?.name}function Ry(e,t){try{const n=[];let i;if(t){if(i=Ly[t]?t:jy(t),!i)return[];for(const t in e.areas)(e.areas[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function Py(e,t){try{const n=[];if(t){let i;if(i=Ly[t]?t:jy(t),!i)return[];for(const t in e.devices)(e.devices[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function Ny(e,t){try{const n=[];if(t){let i;if(i=Ly[t]?t:jy(t),!i)return[];for(const t in e.entities)(e.entities[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function Fy(e){return e.toString()}function Vy(e){if(e.toString().includes("NaN"))throw Error("Result returned NaN.")}function By(e){return e!=1/0&&!isNaN(e)}function Hy(e,t){if("number"==typeof e)return 0!=e;if("boolean"==typeof e)return e;if(e=e.toLowerCase(),["true","yes","on","enable","1"].includes(e))return!0;if(["false","no","off","disable","0"].includes(e))return!1;if(t)return t;throw Error("Invalid input")}function Uy(e,t=Math.E,n){try{const n=Math.log(e)/Math.log(t);return Vy(n.toString()),n}catch(e){if(n)return n;throw e}}function qy(e,t){try{const t=Math.sin(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Wy(e,t){try{const t=Math.cos(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Zy(e,t){try{const t=Math.tan(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Ky(e,t){try{const t=Math.asin(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Qy(e,t){try{const t=Math.acos(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Yy(e,t){try{const t=Math.atan(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Gy(e,t,n){try{const n=Math.atan2(e,t);return Vy(n.toString()),n}catch(e){if(n)return n;throw e}}function Xy(e,t){try{const t=Math.sqrt(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Jy(...e){return Math.max(...e.flat(1/0))}function eb(...e){return Math.min(...e.flat(1/0))}function tb(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");return e.reduce(((e,t)=>e+t))/e.length}catch(e){if(t)return t;throw e}}function nb(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");if(!e.length)throw Error("Empty array provided");e=e.sort(((e,t)=>e-t));const t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}catch(e){if(t)return t;throw e}}function ib(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");if(!e.length)throw Error("Empty array provided");const t={};for(const n of e)t[n]||(t[n]=0),t[n]++;let n=e[0],i=0;for(const e in t)t[e]>i&&(n=Number(e),i=t[e]);return n}catch(e){if(t)return t;throw e}}const ab=Math.E,rb=Math.PI,sb=2*Math.PI,ob=1/0;function cb(e,t,n){try{return e.formatEntityState(e.states[t],n)}catch{return n??e.states[t]?.state??void 0}}function lb(e,t,n){try{return e.formatEntityAttributeName(e.states[t],n)}catch{return n??e.states[t]?.attributes?.[n]??void 0}}function ub(e,t,n,i){try{return e.formatEntityAttributeValue(e.states[t],n,i)}catch{return i??e.states[t]?.attributes?.[n]??void 0}}const db=new Date,hb=new Date;function pb(e,t,n,i){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,i,r)=>{const s=[];if(n=a.ceil(n),r=null==r?1:Math.floor(r),!(n<i&&r>0))return s;let o;do{s.push(o=new Date(+n)),t(n,r),e(n)}while(o<n&&n<i);return s},a.filter=n=>pb((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,i)=>{if(e>=e)if(i<0)for(;++i<=0;)for(;t(e,-1),!n(e););else for(;--i>=0;)for(;t(e,1),!n(e););})),n&&(a.count=(t,i)=>(db.setTime(+t),hb.setTime(+i),e(db),e(hb),Math.floor(n(db,hb))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(i?t=>i(t)%e==0:t=>a.count(0,t)%e==0):a:null)),a}const mb=6e4,fb=864e5,gb=6048e5,_b=pb((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*mb)/fb),(e=>e.getDate()-1));_b.range;const vb=pb((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/fb),(e=>e.getUTCDate()-1));vb.range;const yb=pb((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/fb),(e=>Math.floor(e/fb)));function bb(e){return pb((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*mb)/gb))}yb.range;const wb=bb(0),xb=bb(1),Mb=bb(2),kb=bb(3),Cb=bb(4),Sb=bb(5),Eb=bb(6);function Ab(e){return pb((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/gb))}wb.range,xb.range,Mb.range,kb.range,Cb.range,Sb.range,Eb.range;const Tb=Ab(0),$b=Ab(1),Ib=Ab(2),Ob=Ab(3),Lb=Ab(4),Db=Ab(5),jb=Ab(6);Tb.range,$b.range,Ib.range,Ob.range,Lb.range,Db.range,jb.range;const zb=pb((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear()));zb.every=e=>isFinite(e=Math.floor(e))&&e>0?pb((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,zb.range;const Rb=pb((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function Pb(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Nb(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Fb(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}Rb.every=e=>isFinite(e=Math.floor(e))&&e>0?pb((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Rb.range;var Vb,Bb,Hb,Ub,qb,Wb={"-":"",_:" ",0:"0"},Zb=/^\s*\d+/,Kb=/^%/,Qb=/[\\^$*+?|[\]().{}]/g;function Yb(e,t,n){var i=e<0?"-":"",a=(i?-e:e)+"",r=a.length;return i+(r<n?new Array(n-r+1).join(t)+a:a)}function Gb(e){return e.replace(Qb,"\\$&")}function Xb(e){return new RegExp("^(?:"+e.map(Gb).join("|")+")","i")}function Jb(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function ew(e,t,n){var i=Zb.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function tw(e,t,n){var i=Zb.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function nw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function iw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function aw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function rw(e,t,n){var i=Zb.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function sw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function ow(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function cw(e,t,n){var i=Zb.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function lw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function uw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function dw(e,t,n){var i=Zb.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function hw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function pw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function mw(e,t,n){var i=Zb.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function fw(e,t,n){var i=Zb.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function gw(e,t,n){var i=Zb.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function _w(e,t,n){var i=Kb.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function vw(e,t,n){var i=Zb.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function yw(e,t,n){var i=Zb.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function bw(e,t){return Yb(e.getDate(),t,2)}function ww(e,t){return Yb(e.getHours(),t,2)}function xw(e,t){return Yb(e.getHours()%12||12,t,2)}function Mw(e,t){return Yb(1+_b.count(zb(e),e),t,3)}function kw(e,t){return Yb(e.getMilliseconds(),t,3)}function Cw(e,t){return kw(e,t)+"000"}function Sw(e,t){return Yb(e.getMonth()+1,t,2)}function Ew(e,t){return Yb(e.getMinutes(),t,2)}function Aw(e,t){return Yb(e.getSeconds(),t,2)}function Tw(e){var t=e.getDay();return 0===t?7:t}function $w(e,t){return Yb(wb.count(zb(e)-1,e),t,2)}function Iw(e){var t=e.getDay();return t>=4||0===t?Cb(e):Cb.ceil(e)}function Ow(e,t){return e=Iw(e),Yb(Cb.count(zb(e),e)+(4===zb(e).getDay()),t,2)}function Lw(e){return e.getDay()}function Dw(e,t){return Yb(xb.count(zb(e)-1,e),t,2)}function jw(e,t){return Yb(e.getFullYear()%100,t,2)}function zw(e,t){return Yb((e=Iw(e)).getFullYear()%100,t,2)}function Rw(e,t){return Yb(e.getFullYear()%1e4,t,4)}function Pw(e,t){var n=e.getDay();return Yb((e=n>=4||0===n?Cb(e):Cb.ceil(e)).getFullYear()%1e4,t,4)}function Nw(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Yb(t/60|0,"0",2)+Yb(t%60,"0",2)}function Fw(e,t){return Yb(e.getUTCDate(),t,2)}function Vw(e,t){return Yb(e.getUTCHours(),t,2)}function Bw(e,t){return Yb(e.getUTCHours()%12||12,t,2)}function Hw(e,t){return Yb(1+vb.count(Rb(e),e),t,3)}function Uw(e,t){return Yb(e.getUTCMilliseconds(),t,3)}function qw(e,t){return Uw(e,t)+"000"}function Ww(e,t){return Yb(e.getUTCMonth()+1,t,2)}function Zw(e,t){return Yb(e.getUTCMinutes(),t,2)}function Kw(e,t){return Yb(e.getUTCSeconds(),t,2)}function Qw(e){var t=e.getUTCDay();return 0===t?7:t}function Yw(e,t){return Yb(Tb.count(Rb(e)-1,e),t,2)}function Gw(e){var t=e.getUTCDay();return t>=4||0===t?Lb(e):Lb.ceil(e)}function Xw(e,t){return e=Gw(e),Yb(Lb.count(Rb(e),e)+(4===Rb(e).getUTCDay()),t,2)}function Jw(e){return e.getUTCDay()}function ex(e,t){return Yb($b.count(Rb(e)-1,e),t,2)}function tx(e,t){return Yb(e.getUTCFullYear()%100,t,2)}function nx(e,t){return Yb((e=Gw(e)).getUTCFullYear()%100,t,2)}function ix(e,t){return Yb(e.getUTCFullYear()%1e4,t,4)}function ax(e,t){var n=e.getUTCDay();return Yb((e=n>=4||0===n?Lb(e):Lb.ceil(e)).getUTCFullYear()%1e4,t,4)}function rx(){return"+0000"}function sx(){return"%"}function ox(e){return+e}function cx(e){return Math.floor(+e/1e3)}Vb=function(e){var t=e.dateTime,n=e.date,i=e.time,a=e.periods,r=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,l=Xb(a),u=Jb(a),d=Xb(r),h=Jb(r),p=Xb(s),m=Jb(s),f=Xb(o),g=Jb(o),_=Xb(c),v=Jb(c),y={a:function(e){return s[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:bw,e:bw,f:Cw,g:zw,G:Pw,H:ww,I:xw,j:Mw,L:kw,m:Sw,M:Ew,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ox,s:cx,S:Aw,u:Tw,U:$w,V:Ow,w:Lw,W:Dw,x:null,X:null,y:jw,Y:Rw,Z:Nw,"%":sx},b={a:function(e){return s[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:Fw,e:Fw,f:qw,g:nx,G:ax,H:Vw,I:Bw,j:Hw,L:Uw,m:Ww,M:Zw,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ox,s:cx,S:Kw,u:Qw,U:Yw,V:Xw,w:Jw,W:ex,x:null,X:null,y:tx,Y:ix,Z:rx,"%":sx},w={a:function(e,t,n){var i=p.exec(t.slice(n));return i?(e.w=m.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(e,t,n){var i=d.exec(t.slice(n));return i?(e.w=h.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(e,t,n){var i=_.exec(t.slice(n));return i?(e.m=v.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(e,t,n){var i=f.exec(t.slice(n));return i?(e.m=g.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(e,n,i){return k(e,t,n,i)},d:uw,e:uw,f:gw,g:sw,G:rw,H:hw,I:hw,j:dw,L:fw,m:lw,M:pw,p:function(e,t,n){var i=l.exec(t.slice(n));return i?(e.p=u.get(i[0].toLowerCase()),n+i[0].length):-1},q:cw,Q:vw,s:yw,S:mw,u:tw,U:nw,V:iw,w:ew,W:aw,x:function(e,t,i){return k(e,n,t,i)},X:function(e,t,n){return k(e,i,t,n)},y:sw,Y:rw,Z:ow,"%":_w};function x(e,t){return function(n){var i,a,r,s=[],o=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++o<l;)37===e.charCodeAt(o)&&(s.push(e.slice(c,o)),null!=(a=Wb[i=e.charAt(++o)])?i=e.charAt(++o):a="e"===i?" ":"0",(r=t[i])&&(i=r(n,a)),s.push(i),c=o+1);return s.push(e.slice(c,o)),s.join("")}}function M(e,t){return function(n){var i,a,r=Fb(1900,void 0,1);if(k(r,e,n+="",0)!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(t&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(a=(i=Nb(Fb(r.y,0,1))).getUTCDay(),i=a>4||0===a?$b.ceil(i):$b(i),i=vb.offset(i,7*(r.V-1)),r.y=i.getUTCFullYear(),r.m=i.getUTCMonth(),r.d=i.getUTCDate()+(r.w+6)%7):(a=(i=Pb(Fb(r.y,0,1))).getDay(),i=a>4||0===a?xb.ceil(i):xb(i),i=_b.offset(i,7*(r.V-1)),r.y=i.getFullYear(),r.m=i.getMonth(),r.d=i.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),a="Z"in r?Nb(Fb(r.y,0,1)).getUTCDay():Pb(Fb(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(a+5)%7:r.w+7*r.U-(a+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Nb(r)):Pb(r)}}function k(e,t,n,i){for(var a,r,s=0,o=t.length,c=n.length;s<o;){if(i>=c)return-1;if(37===(a=t.charCodeAt(s++))){if(a=t.charAt(s++),!(r=w[a in Wb?t.charAt(s++):a])||(i=r(e,n,i))<0)return-1}else if(a!=n.charCodeAt(i++))return-1}return i}return y.x=x(n,y),y.X=x(i,y),y.c=x(t,y),b.x=x(n,b),b.X=x(i,b),b.c=x(t,b),{format:function(e){var t=x(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=M(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=M(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Bb=Vb.format,Hb=Vb.parse,Ub=Vb.utcFormat,qb=Vb.utcParse;var lx="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||Ub(lx);var ux=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:qb(lx),dx=ux;const hx=["weeks","days","hours","minutes","seconds","milliseconds"],px={weeks:604800,days:86400,hours:3600,minutes:60,seconds:1,milliseconds:.001};function mx(e){return"object"==typeof e&&!Array.isArray(e)}class fx{constructor(e=0,t=0,n=0,i=0,a=0,r=0){this.days=0,this.seconds=0,this.milliseconds=0;let s={days:e,seconds:t,milliseconds:n,minutes:i,hours:a,weeks:r};mx(e)&&(delete s.days,Object.assign(s,e));let o=0;if(hx.forEach((e=>{o+=(s[e]??0)*px[e]})),o<this.minSeconds||o>this.maxSeconds)throw RangeError("value out of range, must have magnitude less than 999999999 days");if(o.toString().includes(".")){const e=o.toString();this.milliseconds=Math.trunc(parseFloat(`0.${e.split(".")[1]}`)/px.milliseconds),e.startsWith("-")&&(this.milliseconds*=-1),o=Math.trunc(o)}this.days=Math.trunc(o/px.days),this.days=this.days||0,this.seconds=o-this.days*px.days,this.seconds=this.seconds||0}total_seconds(){return this.days*px.days+this.seconds+this.milliseconds*px.milliseconds}valueOf(){return this.total_seconds()}toString(){return`${0!=this.days?`${this.days} day${Math.abs(this.days)>1?"s,":","}`:""} ${Ub("%-H:%M:%S"+(this.milliseconds?".%f":""))(new Date(1e3*this.valueOf()))}`.trim()}static get min(){return new fx(-1e8)}get minSeconds(){return-864e10}static get max(){return new fx(1e8)}get maxSeconds(){return 864e10}static get resolution(){return new fx({milliseconds:1})}}class gx{constructor(e=0,t=0,n=0,i=0){this.hour=0,this.minute=0,this.second=0,this.millisecond=0;let a={hour:e,minute:t,second:n,millisecond:i};mx(e)&&(delete a.hour,Object.assign(a,e));for(const e in a)if(!Number.isInteger(a[e]))throw TypeError("'float' object cannot be interpreted as an integer");if((a.hour??0)<0||(a.hour??0)>23)throw RangeError("hour must be in 0..23");if((a.minute??0)<0||(a.minute??0)>59)throw RangeError("minute must be in 0..59");if((a.second??0)<0||(a.second??0)>59)throw RangeError("second must be in 0..59");if((a.millisecond??0)<0||(a.millisecond??0)>999)throw RangeError("millisecond must be in 0..999");Object.assign(this,a)}replace(e=this.hour,t=this.minute,n=this.second,i=this.millisecond){let a={hour:e,minute:t,second:n,millisecond:i};return mx(e)&&(delete a.hour,Object.assign(a,e)),new gx(a.hour??this.hour,a.minute??this.minute,a.second??this.second,a.millisecond??this.millisecond)}isoformat(e="auto"){let t;switch(e){case"hours":t="%H";break;case"minutes":t="%H:%M";break;case"seconds":t="%H:%M:%S";break;case"milliseconds":t="%H:%M:%S.%f";break;default:t="%H:%M:%S"+(this.millisecond?".%f":"")}return this.strftime(t)}valueOf(){return this.hour*px.hours+this.minute*px.minutes+this.second*px.seconds+this.millisecond*px.milliseconds}toString(){return this.isoformat()}strftime(e){return Ub(e)(this.jsDate)}get jsDate(){return new Date(1e3*this.valueOf())}static get min(){return new gx(0,0,0,0)}static get max(){return new gx(23,59,59,999)}static get resolution(){return fx.resolution}static fromisoformat(e){const t=dx(`1970-01-01T${e}`);if(t)return new gx(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());throw SyntaxError("Unable to parse date string")}}const _x=100,vx=9999,yx=36160,bx=3652059,wx=["year","month","day","hour","minute","second","millisecond"];class xx{constructor(e,t,n,i=0,a=0,r=0,s=0,o=!1){this.year=1970,this.month=1,this.day=1,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,this.utc=!1;const c={year:e,month:t,day:n,hour:i,minute:a,second:r,millisecond:s,utc:o};if(mx(e)&&(delete c.year,Object.assign(c,e)),!c.year||!c.month||!c.day)throw SyntaxError("Missing required argument year, month, or day");for(const e in c)if(wx.includes(e)&&!Number.isInteger(c[e]))throw TypeError(`Argument ${e} value ${c[e]} is not an integer`);if(c.year<_x||c.year>vx)throw RangeError(`year ${c.year} is out of range`);if(c.month<1||c.month>12)throw RangeError(`month ${c.month} is out of range`);if(c.day<1||c.day>new Date(c.year,c.month,0).getDate())throw RangeError(`day ${n} is out of range for month`);if((c.hour??0)<0||(c.hour??0)>23)throw RangeError("hour must be in 0..23");if((c.minute??0)<0||(c.minute??0)>59)throw RangeError("minute must be in 0..59");if((c.second??0)<0||(c.second??0)>59)throw RangeError("second must be in 0..59");if((c.millisecond??0)<0||(c.millisecond??0)>999)throw RangeError("millisecond must be in 0..999");Object.assign(this,c)}date(){return new Mx(this.year,this.month,this.day)}time(){return new gx(this.hour,this.minute,this.second,this.millisecond)}replace(e=this.year,t=this.month,n=this.day,i=this.hour,a=this.minute,r=this.second,s=this.millisecond){const o={year:e,month:t,day:n,hour:i,minute:a,second:r,millisecond:s};return mx(e)&&(delete o.year,Object.assign(o,e)),new xx({year:o.year??this.year,month:o.month??this.month,day:o.day??this.day,hour:o.hour??this.hour,minute:o.minute??this.minute,second:o.second??this.second,millisecond:o.millisecond??this.millisecond})}toordinal(){return this.date().toordinal()}timestamp(){let e;return e=this.utc?Date.UTC(this.year,this.month-1,this.day||1,this.hour||0,this.minute||0,this.second||0,this.millisecond||0):this.jsDate.getTime(),e/1e3}weekday(){return this.date().weekday()}isoweekday(){return this.weekday()+1}isocalendar(){const[e,t,n]=Ub("%G-%V-%u")(this.jsDate).split("-");return[Number(e),Number(t),Number(n)]}isoformat(e="T",t="auto"){const n={sep:e,timespec:t};let i;switch(mx(e)&&(delete n.sep,Object.assign(n,e),n.sep=n.sep??"T"),n.timespec){case"hours":i=`%Y-%m-%d${n.sep}%H`;break;case"minutes":i=`%Y-%m-%d${n.sep}%H:%M`;break;case"seconds":i=`%Y-%m-%d${n.sep}%H:%M:%S`;break;case"milliseconds":i=`%Y-%m-%d${n.sep}%H:%M:%S.%f`;break;default:i=`%Y-%m-%d${n.sep}%H:%M:%S${this.millisecond?".%f":""}`}return this.strftime(i)}valueOf(){return this.timestamp()}toString(){return this.isoformat(" ")}ctime(){return Bb("%a %b %-e %H:%M:%S %Y")(this.jsDate)}strftime(e){return this.utc?Ub(e)(this.jsDate):Bb(e)(this.jsDate)}get jsDate(){return this.utc?new Date(1e3*this.valueOf()):new Date(this.year,this.month-1,this.day||1,this.hour||0,this.minute||0,this.second||0,this.millisecond||0)}static get min(){return new xx(_x,1,1)}static get max(){return new xx(vx,12,31,23,59,59,999)}static get resolution(){return fx.resolution}static today(){return xx.now()}static now(){return xx.fromjsdate(new Date)}static utcnow(){return xx.utcfromjsdate(new Date)}static fromtimestamp(e){const t=new Date(1e3*e);return xx.fromjsdate(t)}static utcfromtimestamp(e){const t=new Date(1e3*e);return xx.utcfromjsdate(t)}static fromjsdate(e){return new xx({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()})}static utcfromjsdate(e){return new xx({year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hour:e.getUTCHours(),minute:e.getUTCMinutes(),second:e.getUTCSeconds(),millisecond:e.getUTCMilliseconds(),utc:!0})}static fromordinal(e){if(e<yx||e>bx)throw RangeError(`ordinal ${e} is out of range`);return xx.fromtimestamp(Mx.min.valueOf()+new fx({days:e-yx}).valueOf())}static combine(e,t){return new xx({year:e.year,month:e.month,day:e.day,hour:t.hour,minute:t.minute,second:t.second,millisecond:t.millisecond})}static fromisoformat(e){const t=dx(e);if(t)return xx.fromjsdate(t);throw SyntaxError("Unable to parse date string")}static fromisocalendar(e,t,n){return xx.strptime(`${e}-${t}-${n}`,"%G-%V-%u")}static strptime(e,t,n=!1){const i=(n?qb:Hb)(t)(e);if(!i)throw Error(`'${e}' does not match format '${t}'`);return n?xx.utcfromjsdate(i):xx.fromjsdate(i)}}class Mx{constructor(e,t,n){if(this.year=1970,this.month=1,this.day=1,!Number.isInteger(e)||e<_x||e>vx)throw RangeError(`year ${e} is out of range`);if(!Number.isInteger(t)||t<1||t>12)throw RangeError(`month ${t} is out of range`);if(!Number.isInteger(n)||n<1||n>new Date(e,t,0).getDate())throw RangeError(`day ${n} is out of range for month`);Object.assign(this,{year:e,month:t,day:n})}replace(e=this.year,t=this.month,n=this.day){const i={year:e,month:t,day:n};return mx(e)&&(delete i.year,Object.assign(i,e)),new Mx(i.year??this.year,i.month??this.month,i.day??this.day)}toordinal(){return Math.trunc((this.valueOf()+new fx({days:719163}).total_seconds())/px.days)}weekday(){return(this.jsDate.getDay()+6)%7}isoweekday(){return this.weekday()+1}isocalendar(){const[e,t,n]=Ub("%G-%V-%u")(this.jsDate).split("-");return[Number(e),Number(t),Number(n)]}isoformat(){return Ub("%Y-%m-%d")(this.jsDate)}valueOf(){return this.jsDate.getTime()/1e3}toString(){return this.isoformat()}ctime(){return Bb("%a %b %-e 00:00:00 %Y")(this.jsDate)}strftime(e){return Bb(e)(this.jsDate)}get jsDate(){return new Date(this.year,this.month-1,this.day)}static get min(){return new Mx(_x,1,1)}static get max(){return new Mx(vx,12,31)}static get resolution(){return new fx({days:1})}static today(){const e=xx.now();return new Mx(e.year,e.month,e.day)}static fromtimestamp(e){const t=xx.fromtimestamp(e);return new Mx(t.year,t.month,t.day)}static fromordinal(e){if(e<yx||e>bx)throw RangeError(`ordinal ${e} is out of range`);return Mx.fromtimestamp(Mx.min.valueOf()+new fx({days:e-yx}).valueOf())}static fromisoformat(e){const t=dx(e);if(t)return new Mx(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate());throw SyntaxError("Unable to parse date string")}static fromisocalendar(e,t,n){const i=xx.strptime(`${e}-${t}-${n}`,"%G-%V-%u");return new Mx(Number(i.year),Number(i.month),Number(i.day))}}const kx=(...e)=>new fx(...e);kx.min=fx.min,kx.max=fx.max,kx.resolution=fx.resolution;const Cx=(...e)=>new Mx(...e);Cx.min=Mx.min,Cx.max=Mx.max,Cx.resolution=Mx.resolution,Cx.today=Mx.today,Cx.fromtimestamp=Mx.fromtimestamp,Cx.fromordinal=Mx.fromordinal,Cx.fromisoformat=Mx.fromisoformat,Cx.fromisocalendar=Mx.fromisocalendar;const Sx=(...e)=>new xx(...e);Sx.min=xx.min,Sx.max=xx.max,Sx.resolution=xx.resolution,Sx.today=xx.today,Sx.now=xx.now,Sx.utcnow=xx.utcnow,Sx.fromtimestamp=xx.fromtimestamp,Sx.utcfromtimestamp=xx.utcfromtimestamp,Sx.fromjsdate=xx.fromjsdate,Sx.utcfromjsdate=xx.utcfromjsdate,Sx.fromordinal=xx.fromordinal,Sx.combine=xx.combine,Sx.fromisoformat=xx.fromisoformat,Sx.fromisocalendar=xx.fromisocalendar,Sx.strptime=xx.strptime;const Ex=(...e)=>new gx(...e);Ex.min=gx.min,Ex.max=gx.max,Ex.resolution=gx.resolution,Ex.fromisoformat=gx.fromisoformat;const Ax={MINYEAR:_x,MAXYEAR:vx,MINYEAR_ORDINAL:yx,MAXYEAR_ORDINAL:bx,timedelta:kx,date:Cx,datetime:Sx,time:Ex};function Tx(){return Ax.datetime.now()}function $x(e="00:00"){const[t,n,i,a]=e.split(":"),r=Ax.datetime.now(),s=Ax.datetime(r.year,r.month,r.day,Number(t??0),Number(n??0),Number(i??0),Number(a??0));return Vy(s.toString()),s}function Ix(e,t=void 0,n=!0){"object"!=typeof t||Array.isArray(t)||(n=t.utc??n,t=t.fallback??void 0);try{let t;if("string"==typeof e)if(/[^\d]/g.test(e)){e=e.replace(/T/g," ");const i=["%Y-%m-%d %H:%M:%S.%f%Z","%Y-%m-%d %H:%M:%S.%f","%Y-%m-%d %H:%M:%S%Z","%Y-%m-%d %H:%M:%S"];for(const a of i)try{t=Ax.datetime.strptime(e,a,n);break}catch{}t||(e=parseFloat(e))}else e=parseFloat(e);else t="number"==typeof e?n?Ax.datetime.utcfromtimestamp(e):Ax.datetime.fromtimestamp(e):e instanceof Mx?Ax.datetime(e.year,e.month,e.day):e;return Vy((t??"NaN").toString()),t}catch(e){if(t)return t;throw e}}function Ox(e,t){try{let t;return"string"==typeof e?(e.includes(" ")||e.includes("T")||(e+=" 00:00:00"),t=Date.parse(e)/1e3):t="number"==typeof e?Ax.datetime.utcfromtimestamp(e).jsDate.getTime()/1e3:e.jsDate.getTime()/1e3,Vy(t.toString()),t}catch(e){if(t)return t;throw e}}function Lx(e){return Ax.datetime.fromjsdate(Ax.datetime(e).jsDate)}function Dx(e,t=1,n=!1){if(!(e instanceof xx))return e;let i=Tx().valueOf()-Lx(e).valueOf();if(n&&(i*=-1),i<=0)return e;(0==t||t>6)&&(t=6);const a={year:31536e3,month:2592e3,day:86400,hour:3600,minute:60,second:1},r=Object.keys(a);let s="",o=!1;for(let e=0;e<t;e++){let n=i/a[r[e]];n=e==t-1?Math.round(n):Math.floor(n),(o||n>0)&&(o=!0,s+=` ${n} ${r[e]}${1!=n?"s":""}`,i-=n*a[r[e]])}return s.trim()}function jx(e,t=1){return Dx(e,t)}function zx(e,t=1){return Dx(e,t,!0)}const Rx={states:yy,state_attr:by,has_value:wy,state_translated:cb,attr_name_translated:lb,attr_value_translated:ub,expand:Iy,device_entities:My,device_attr:ky,device_id:Cy,floor_id:Ay,floor_name:Ty,floor_areas:$y,area_id:my,area_name:fy,area_entities:gy,area_devices:_y,labels:Dy,label_areas:Ry,label_devices:Py,label_entities:Ny,iif:Oy,closest:Ey},Px={label_id:jy,label_name:zy,today_at:$x,as_datetime:Ix,as_timestamp:Ox,as_local:Lx,time_since:jx,time_until:zx,timestamp_local:function(e,t){try{const t=Ax.datetime.fromtimestamp(e).strftime("%Y-%m-%dT%H:%M:%S%Z");return Vy(t),t}catch(e){if(t)return t;throw e}},timestamp_utc:function(e,t){try{const t=Ax.datetime.utcfromtimestamp(e).strftime("%Y-%m-%dT%H:%M:%S%Z");return Vy(t),t}catch(e){if(t)return t;throw e}},timestamp_custom:function(e,t,n=!0,i=void 0){"object"!=typeof n||Array.isArray(n)||(i=n.fallback??i,n=n.local??!0);try{const i=(n?Ax.datetime.fromtimestamp(e):Ax.datetime.utcfromtimestamp(e)).strftime(t);return Vy(i),i}catch(e){if(i)return i;throw e}},to_json:function(e,t=!1,n=!1,i=!1){"object"!=typeof t||Array.isArray(t)||(i=t.sort_keys??i,n=t.pretty_print??n,t=t.ensure_ascii??!1),i&&(e=Object.keys(e).sort().reduce(((t,n)=>(t[n]=e[n],t)),{}));let a=JSON.stringify(e,void 0,n?2:void 0);return t&&(a=a.replace(/[\u007F-\uFFFF]/g,(e=>`\\u'${("0000"+e.charCodeAt(0).toString(16)).substring(-4)}`))),a},from_json:function(e){return JSON.parse(e)},closest:Ey,contains:vy,is_number:By,bool:Hy,log:Uy,sin:qy,cos:Wy,tan:Zy,asin:Ky,acos:Qy,atan:Yy,atan2:Gy,sqrt:Xy,max:Jy,min:eb,average:tb,median:nb,statistical_mode:ib,bitwise_and:function(e,t){return e&t},bitwise_or:function(e,t){return e|t},bitwise_xor:function(e,t){return e^t},bitwise_not:function(e){return~e},ord:function(e){if(1==e.length)return e.codePointAt(0);throw Error("Expected a character, but received a string")},multiply:function(e,t){return Number(e)*Number(t)},add:function(e,t){return Number(e)+Number(t)},regex_replace:function(e,t="",n=""){return e.replace(new RegExp(t,"g"),n)},regex_findall:function(e,t=""){return e.match(new RegExp(t,"g"))??[]},regex_findall_index:function(e,t="",n=0){return(e.match(new RegExp(t,"g"))??[])[n]},str:Fy};const Nx={states:yy,is_state:function(e,t,n){try{const i=yy(e,t);return Array.isArray(n)?n.includes(i):i==n}catch{return!1}},state_attr:by,is_state_attr:function(e,t,n,i){try{return by(e,t,n)==i}catch{return!1}},has_value:wy,state_translated:cb,attr_name_translated:lb,attr_value_translated:ub,expand:Iy,is_hidden_entity:function(e,t){try{return e.entities[t].hidden??!1}catch{return!1}},device_entities:My,device_attr:ky,is_device_attr:function(e,t,n,i){try{return null!=i&&ky(e,t,n)==i}catch{return!1}},device_id:Cy,floors:function(e){return Object.keys(e.floors)},floor_id:Ay,floor_name:Ty,floor_areas:$y,areas:function(e){try{return Object.keys(e.areas)}catch{return[]}},area_id:my,area_name:fy,area_entities:gy,area_devices:_y,integration_entities:function(e,t){try{const n=[];if(t){for(const i in e.entities)e.entities[i].platform==t&&n.push(i);n.sort()}return n}catch{return[]}},labels:Dy,label_areas:Ry,label_devices:Py,label_entities:Ny,iif:Oy,distance:function(e,...t){try{let n,i,a,r,s=0;if("string"==typeof t[0])n=e.states[t[0]].attributes.latitude,a=e.states[t[0]].attributes.longitude,s=1;else if("object"!=typeof t[0]||Array.isArray(t[0])){if("number"!=typeof t[0])return null;if("number"!=typeof t[1])throw Error("Latitude provided but not longitude 1");n=t[0],a=t[1],s=2}else n=t[0].attributes.latitude,a=t[0].attributes.longitude,s=1;if("string"==typeof t[s])i=e.states[t[s]].attributes.latitude,r=e.states[t[s]].attributes.longitude;else if("object"!=typeof t[s]||Array.isArray(t[s]))if("number"==typeof t[s]){if("number"!=typeof t[s+1])throw Error("Latitude provided but not longitude 2");i=t[s],r=t[s+1]}else i=e.states["zone.home"].attributes.latitude,r=e.states["zone.home"].attributes.longitude;else i=t[s].attributes.latitude,r=t[s].attributes.longitude;return Sy([n,a],[i,r],"mi"==e.config.unit_system.length)}catch{return null}},closest:Ey},Fx={label_id:jy,label_name:zy,now:Tx,utcnow:function(){return Ax.datetime.utcnow()},today_at:$x,as_datetime:Ix,as_timestamp:Ox,as_local:Lx,strptime:function(e,t,n=void 0,i=!1){"object"!=typeof n||Array.isArray(n)||n instanceof xx||n instanceof Mx||(i=n.utc??i,n=n.fallback??void 0);try{t=t.replace(/%z/g,"%Z");const n=Ax.datetime.strptime(e,t,i);return Vy(n.toString()),n}catch(e){if(n)return n;throw e}},time_since:jx,time_until:zx,as_timedelta:function(e){try{let t;if(e.includes(":")||e.includes(" ")||/^\d*\.?\d*$/.test(e)){let n,i;e.includes(" ")?e.includes("days")?[n,i]=e.split(" days "):[n,i]=e.split(" "):(n=0,i=e);const[a,r,s]=i.split(":").reverse();t=Ax.timedelta(Number(n),Number(a.replace(",",".")??0),0,Number(r??0),Number(s??0))}else{if(!e.startsWith("P"))return null;{const n=e.replace(/P|T/g,"").match(/(\d*?)[A-Z]/g);if(!n)return null;const i={};for(const e of n){const t=e.match(/^(\d*)/),n=e.match(/[A-Z]$/);t&&n&&(i[n[0]]=parseFloat(t[0]))}t=Ax.timedelta(i.D,i.S,0,i.M,i.H,i.W)}}return Vy(t.toString()),t}catch{return null}},float:function(e,t){try{const t=parseFloat(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}},is_number:By,int:function(e,t){try{const t=parseInt(e);return Vy(t.toString()),t}catch(e){if(t)return t;throw e}},bool:Hy,log:Uy,sin:qy,cos:Wy,tan:Zy,asin:Ky,acos:Qy,atan:Yy,atan2:Gy,sqrt:Xy,max:Jy,min:eb,average:tb,median:nb,statistical_mode:ib,set:function(...e){return new Set(e.flat(1/0))},list:function(...e){return e.map((e=>Array.from(e))).flat(1/0)},zip:function(...e){if(e.length>1)return e[0].map(((t,n)=>{const i=[t];for(let t=1;t<e.length;t++)i.push(e[t][n]);return i}));{e=e[0];const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)t[i]||t.push([]),t[i].push(e[n][i]);return t}},match_media:function(e){return window.matchMedia(e).matches},str:Fy},Vx={e:ab,pi:rb,tau:sb,inf:ob};const Bx={list:function(e){return Array.isArray(e)},set:function(e){return e instanceof Set},datetime:function(e){return e instanceof xx},string_like:function(e){return"string"==typeof e||e instanceof Buffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof ArrayBuffer},contains:vy,match:function(e,t){return new RegExp(`^${t}`).test(e)},search:function(e,t){return new RegExp(t,"g").test(e)},test:function(e,t){return new RegExp(t).test(e)}};let Hx;py.installJinjaCompat();const Ux=function(e){for(const t in Bx)e.addTest(t,(function(...e){return Bx[t](...e)}));return e}(function(e){for(const t in Px)e.addFilter(t,(function(...e){return Px[t](...e)}));for(const t in Rx)e.addFilter(t,(function(...e){return Rx[t](Hx,...e)}));return e}(function(e){for(const t in Fx)e.addGlobal(t,(function(...e){return Fx[t](...e)}));for(const t in Nx)e.addGlobal(t,(function(...e){return Nx[t](Hx,...e)}));for(const t in Vx)e.addGlobal(t,Vx[t]);return e.addGlobal("dt",Ax),e.addGlobal("date",Mx),e.addGlobal("time",gx),e.addGlobal("datetime",xx),e.addGlobal("timedelta",fx),e}(new py.Environment)));function qx(e,t,n){return Hx||async function(e){if(e.connection){const t=await e.connection.sendMessagePromise({type:"config/label_registry/list"});t.sort(((e,t)=>e.name.localeCompare(t.name)));for(const e of t)Ly[e.label_id]=e}}(e),Hx=e,"string"==typeof t&&(t.includes("{{")&&t.includes("}}")||t.includes("{%")&&t.includes("%}"))?(t=Ux.renderString(structuredClone(t),{hass:e,_states:xy(e),...n}).trim(),[void 0,null,"undefined","null","None"].includes(t)?"":"true"==t.toLowerCase()||"false"!=t.toLowerCase()&&t):t}class Wx{constructor(){this.renderRecursively=(e,t,n)=>this._renderTemplateRecursively(e,t,this._generateTemplateContext(n))}_generateTemplateContext(e){if(!(e?.conditionState?.camera||e?.conditionState?.view||e?.triggerData||e?.mediaData))return;const t={...e?.conditionState?.camera&&{camera:e.conditionState.camera},...e?.conditionState?.view&&{view:e.conditionState.view},...e?.triggerData&&{trigger:e.triggerData},...e?.mediaData&&{media:e.mediaData}};return{acc:t,advanced_camera_card:t}}_renderTemplateRecursively(e,t,n){if("string"==typeof t)return qx(e,t,n);if(Array.isArray(t))return t.map((t=>this._renderTemplateRecursively(e,t,n)));if("object"==typeof t&&null!==t){const i={};for(const a in t)i[a]=this._renderTemplateRecursively(e,t[a],n);return i}return t}}const Zx=(e,t,n)=>{Uu(e,t,n)},Kx=(e,t,n)=>ec(e,t,n),Qx=(e,t)=>{!function(e,t){null==e||Pu(e,t)}(e,t)},Yx=e=>Il(e),Gx=(e,t)=>e.replace("#",`[${t.toString()}]`),Xx=function(e){let t=!1;for(let n=0;n<uM.length;n++)t=uM[n](e)||t;return t},Jx=function(e){return Xx(Yx(e))},eM=function(e,t,n){return function(i){return((e,t,n,i)=>{const a=Kx(e,t);if(void 0===a)return!1;const r=i?.transform?i.transform(a):a;return!(t===n&&zu(a,r)||(null===r?i?.keepOriginal||(Qx(e,t),0):void 0===r||(i?.keepOriginal||Qx(e,t),Zx(e,n,r),0)))})(i,e,t,n)}},tM=function(e,t,n){return function(i){let a=eM(e,t,n)(i);return a=aM(hg,eM(e,t,n),(e=>e.merge&&"object"==typeof e.merge?e.merge:void 0))(i)||a,a=aM(hg,eM(e,t,n),(e=>e.set&&"object"==typeof e.set?e.set:void 0))(i)||a,a}},nM=function(e,t){return tM(e,e,{transform:t})},iM=function(e){return tM(e,e,{transform:e=>null})},aM=function(e,t,n){return function(i){let a=!1;const r=Kx(i,e);return Array.isArray(r)&&r.forEach((e=>{const i=n?n(e):e;i&&"object"==typeof i&&(a=t(i)||a)})),a}},rM=(e,t)=>{const n=i=>{let a=!1;if(i&&"object"==typeof i){const r=t?t(i):i;r&&(a=e(r)||a),Array.isArray(i)?i.forEach((e=>{a=n(e)||a})):Object.keys(i).forEach((e=>{a=n(i[e])||a}))}return a};return n},sM=e=>{if("object"!=typeof e||!e||"object"!=typeof e.conditions||!e.conditions)return!1;const t=e.conditions,n=[];if(void 0!==t.view&&n.push({condition:"view",views:t.view}),void 0!==t.fullscreen&&n.push({condition:"fullscreen",fullscreen:t.fullscreen}),void 0!==t.expand&&n.push({condition:"expand",expand:t.expand}),void 0!==t.camera&&n.push({condition:"camera",cameras:t.camera}),void 0!==t.media_loaded&&n.push({condition:"media_loaded",media_loaded:t.media_loaded}),void 0!==t.state&&Array.isArray(t.state))for(const e of t.state)"object"!=typeof e||!e||void 0===e.state&&void 0===e.state_not&&void 0===e.entity||n.push({condition:"state",...e.state&&{state:e.state},...e.state_not&&{state_not:e.state_not},...e.entity&&{entity:e.entity}});return void 0!==t.media_query&&n.push({condition:"screen",media_query:t.media_query}),!!n.length&&(e.conditions=n,!0)},oM=e=>!("object"!=typeof e||!e||"call-service"!==e.action||"string"!=typeof e.service)&&(e.action="perform-action",e.perform_action=e.service,delete e.service,!0),cM=e=>!("object"!=typeof e||!e||"call-service"!==e.action||void 0===e.service||void 0===e.service_data||void 0!==e.data)&&(e.data=e.service_data,delete e.service_data,!0),lM=e=>{const t=[{oldKey:"type",oldValue:"custom:frigate-card",newValue:"custom:advanced-camera-card"},{oldKey:"action",oldValue:"custom:frigate-card-action",newValue:"custom:advanced-camera-card-action"},{oldKey:"type",oldValue:"custom:frigate-card-menu-icon",newValue:"custom:advanced-camera-card-menu-icon"},{oldKey:"type",oldValue:"custom:frigate-card-menu-state-icon",newValue:"custom:advanced-camera-card-menu-state-icon"},{oldKey:"type",oldValue:"custom:frigate-card-menu-submenu",newValue:"custom:advanced-camera-card-menu-submenu"},{oldKey:"type",oldValue:"custom:frigate-card-menu-submenu-select",newValue:"custom:advanced-camera-card-menu-submenu-select"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-icon",newValue:"custom:advanced-camera-card-status-bar-icon"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-image",newValue:"custom:advanced-camera-card-status-bar-image"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-string",newValue:"custom:advanced-camera-card-status-bar-string"},{oldKey:"type",oldValue:"custom:frigate-card-conditional",newValue:"custom:advanced-camera-card-conditional"},{oldKey:"type",oldValue:"custom:frigate-card-conditional",newValue:"custom:advanced-camera-card-conditional"},{oldKey:"frigate_card_action",newKey:"advanced_camera_card_action"}];let n=!1;for(const i of t)i.oldValue&&i.newValue&&e[i.oldKey]===i.oldValue&&(e[i.newKey??i.oldKey]=i.newValue,n=!0),i.oldKey in e&&i.newKey&&(e[i.newKey]=e[i.oldKey],delete e[i.oldKey],n=!0);return n},uM=[e=>rM(cM)("object"==typeof e&&e?e:{}),function(e){if("object"!=typeof e||!e||!(hp in e)||!Array.isArray(e[hp]))return!1;let t=!1;const n=n=>{if(!t){if(!ec(e,"live.controls.ptz")){const{type:t,...i}=n;Uu(e,"live.controls.ptz",i)}t=!0}},i=e=>{const t=[];for(const a of e)if("custom:advanced-camera-card-ptz"===a.type)n(a);else if("conditional"!==a.type&&"custom:advanced-camera-card-conditional"!==a.type||!Array.isArray(a.elements))t.push(a);else{const e=i(a.elements);e.length&&(a.elements=e,t.push(a))}return t},a=i(e[hp]);return t&&(a.length?e[hp]=a:delete e[hp]),t},tM("view.timeout_seconds",Mp),nM("live.lazy_unload",(e=>"all"===e?["unselected","hidden"]:"never"===e?null:id(e))),nM("live.auto_play",(e=>"all"===e?null:"never"===e?[]:id(e))),nM("live.auto_pause",(e=>"all"===e?["unselected","hidden"]:"never"===e?null:id(e))),nM("live.auto_mute",(e=>"all"===e?null:"never"===e?[]:id(e))),nM("live.auto_unmute",(e=>"all"===e?["selected","visible","microphone"]:"never"===e?null:id(e))),nM("media_viewer.auto_play",(e=>"all"===e?null:"never"===e?[]:id(e))),nM("media_viewer.auto_pause",(e=>"all"===e?null:"never"===e?[]:id(e))),nM("media_viewer.auto_mute",(e=>"all"===e?null:"never"===e?[]:id(e))),nM("media_viewer.auto_unmute",(e=>"all"===e?["selected","visible"]:"never"===e?null:id(e))),tM("live.controls.thumbnails.media",Km),tM("timeline.media",Df),tM("live.controls.timeline.media",nf),tM("media_viewer.controls.timeline.media",Cm),tM("view.scan",Fp),tM("view.triggers.enabled",qp,{transform:e=>!0===e?"live":null,keepOriginal:!0}),tM("view.triggers.enabled",Bp,{transform:e=>!0!==e&&null}),tM("view.triggers.untrigger_reset",Wp,{transform:e=>e?"default":null}),tM("live.layout",up),iM("media_viewer.layout"),iM("image.layout"),aM(hg,sM),e=>rM(sM)("object"==typeof e&&e?e[hp]:{}),e=>rM(sM)("object"==typeof e&&e?e.automations:{}),aM(rh,tM("hide","capabilities",{transform:e=>!0===e?{disable_except:["substream"]}:null})),tM("performance.profile",wg,{transform:e=>"low"===e?["low-performance"]:null}),aM(hg,eM("overrides","merge")),tM("live.controls.ptz",dp,{transform:e=>{if("object"!=typeof e||!e)return;const t=["data_left","data_right","data_up","data_down","data_zoom_in","data_zoom_out","service"],n=["actions_left","actions_right","actions_up","actions_down","actions_zoom_in","actions_zoom_out"],i=[...t,...n,"data_home","actions_home"];if(!Object.keys(e).some((e=>i.includes(e))))return;const a={};t.filter((t=>t in e)).reduce(((t,n)=>(t[n]=e[n],t)),a),n.filter((t=>t in e)).reduce(((t,n)=>("object"==typeof e[n]&&"tap_action"in e[n]&&(t[n]=e[n].tap_action),t)),a);const r=()=>{a.presets="presets"in e&&"object"==typeof e.presets&&e.presets?e.presets:{}};return"actions_home"in e&&"object"==typeof e.actions_home&&e.actions_home&&"tap_action"in e.actions_home?(r(),a.presets.home=e.actions_home.tap_action):"data_home"in e&&"object"==typeof e.data_home&&e.data_home&&"string"==typeof e.service&&(r(),a.presets.service=e.service,a.presets.data_home=e.data_home),a},keepOriginal:!0}),nM("live.controls.ptz",(e=>{if("object"!=typeof e||!e)return e;const t=["mode","position","orientation","hide_pan_tilt","hide_zoom","hide_home","style"],n=Object.keys(e);return n.some((e=>!t.includes(e)))?n.filter((e=>t.includes(e))).reduce(((t,n)=>(t[n]=e[n],t)),{}):void 0})),tM("view.update_cycle_camera",Lp),tM("view.update_force",jp,{transform:e=>!0===e?"all":null}),tM("view.update_seconds",zp),tM("view.update_entities",Rp),eM("live.controls.title",ng,{transform:e=>"object"==typeof e&&e&&"string"==typeof e.mode?"none"===e.mode?{style:"none"}:e.mode.includes("bottom")?{position:"bottom"}:e.mode.includes("top")?{position:"top"}:null:null}),iM("live.controls.title"),iM("media_viewer.controls.title"),e=>rM(oM)("object"==typeof e&&e?e:{}),tM("dimensions.max_height",dg),iM("dimensions.min_height"),tM("view.dark_mode",xp,{transform:e=>"on"===e}),e=>rM(lM)("object"==typeof e&&e?e:{}),nM("view.theme.overrides",(e=>{if("object"!=typeof e||!e||Array.isArray(e))return e;const t={...e},n=new RegExp(/^--frigate-card-/);for(const i of Object.keys(e))if(i.match(n)){t[i.replace(n,"--advanced-camera-card-")]=e[i],delete t[i]}return t})),tM("menu.buttons.frigate","menu.buttons.iris")];class dM{constructor(e,t){this._listeners=[],this._mediaQueries=[],this._evaluation={result:!1},this._templateRenderer=new Wx,this._mediaQueryHandler=()=>this._evaluate(),this._stateManagerHandler=e=>{this._evaluate({stateChange:e})},this._conditions=e,e.forEach((e=>{if("screen"===e.condition){const t=window.matchMedia(e.media_query);t.addEventListener("change",this._mediaQueryHandler),this._mediaQueries.push(t)}})),this._stateManager=t??null,this._evaluate({callListeners:!1}),this._stateManager?.addListener(this._stateManagerHandler)}destroy(){this._stateManager?.removeListener(this._stateManagerHandler),this._listeners.forEach((e=>this.removeListener(e))),this._mediaQueries.forEach((e=>e.removeEventListener("change",this._mediaQueryHandler))),this._mediaQueries=[],this._conditions=[]}addListener(e){this._listeners.includes(e)||this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter((t=>t!==e))}getEvaluation(){return this._evaluation}_evaluate(e){const t=e?.stateChange?.new??this._stateManager?.getState();let n=!0,i={};for(const a of this._conditions){const r=this._evaluateCondition(a,t,e?.stateChange?.old);if(!r.result){n=!1;break}i={...i,...r.triggerData}}const a=n?{result:n,triggerData:i}:{result:n};(a.result!==this._evaluation.result||a.triggerData&&Object.keys(a.triggerData).length)&&(this._evaluation=a,(e?.callListeners??1)&&this._listeners.forEach((e=>this._evaluation&&e(this._evaluation))))}_evaluateCondition(e,t,n){switch(e.condition){case void 0:case"state":{const i=n?.hass?.states?.[e.entity]?.state,a=t?.hass?.states?.[e.entity]?.state;return{result:!e.state&&!e.state_not&&a!==i||(!!e.state||!!e.state_not)&&!!a&&(!e.state||(Array.isArray(e.state)?e.state.includes(a):e.state===a))&&(!e.state_not||(Array.isArray(e.state_not)?!e.state_not.includes(a):e.state_not!==a)),...i!==a&&{triggerData:{state:{entity:e.entity,...i&&{from:i},...a&&{to:a}}}}}}case"view":{const i=n?.view,a=t?.view;return{result:!!a&&e.views?.includes(a)||a!==i&&!e.views?.length,...i!==a&&{triggerData:{...(n?.view||t?.view)&&{view:{...n?.view&&{from:n.view},...t?.view&&{to:t.view}}}}}}}case"fullscreen":return{result:void 0!==t?.fullscreen&&e.fullscreen===t.fullscreen};case"expand":return{result:void 0!==t?.expand&&e.expand===t.expand};case"camera":{const i=n?.camera,a=t?.camera;return{result:!!a&&!!e.cameras?.includes(a)||a!==i&&!e.cameras?.length,...a!==i&&{triggerData:{...(n?.camera||t?.camera)&&{camera:{...n?.camera&&{from:n?.camera},...t?.camera&&{to:t?.camera}}}}}}}case"numeric_state":return{result:!!t?.hass?.states&&e.entity in t.hass?.states&&void 0!==t.hass.states[e.entity].state&&(void 0===e.above||Number(t.hass.states[e.entity].state)>e.above)&&(void 0===e.below||Number(t.hass.states[e.entity].state)<e.below)};case"user":return{result:!!t?.hass?.user&&e.users.includes(t.hass.user.id)};case"media_loaded":return{result:void 0!==t?.mediaLoadedInfo&&e.media_loaded===!!t.mediaLoadedInfo};case"screen":return{result:window.matchMedia(e.media_query).matches};case"display_mode":return{result:!!t?.displayMode&&e.display_mode===t.displayMode};case"triggered":return{result:e.triggered.some((e=>t?.triggered?.has(e)))};case"interaction":return{result:void 0!==t?.interaction&&e.interaction===t.interaction};case"microphone":return{result:!(void 0!==e.connected&&t?.microphone?.connected!==e.connected||void 0!==e.muted&&t?.microphone?.muted!==e.muted)};case"key":return{result:!(!t?.keys||!(e.key in t.keys)||(e.state??"down")!==t.keys[e.key].state||void 0!==e.ctrl&&e.ctrl!==!!t.keys[e.key].ctrl||void 0!==e.alt&&e.alt!==!!t.keys[e.key].alt||void 0!==e.meta&&e.meta!==!!t.keys[e.key].meta||void 0!==e.shift&&e.shift!==!!t.keys[e.key].shift)};case"user_agent":return{result:!!t?.userAgent&&(!e.user_agent||e.user_agent===t.userAgent)&&(void 0===e.companion||e.companion===(i=t.userAgent,!!i.match(/Home ?Assistant/)))&&(void 0===e.user_agent_re||new RegExp(e.user_agent_re).test(t.userAgent))};case"config":{const i=t?.config,a=n?.config;return{result:!!i&&i!==a&&(!e.paths?.length||e.paths.some((e=>Kx(i,e)!==(a?Kx(a,e):void 0)))),...i!==a&&{triggerData:{config:{...(n?.config||t?.config)&&{...n?.config&&{from:n?.config},...t?.config&&{to:t?.config}}}}}}}case"initialized":return{result:!!t?.initialized};case"or":for(const i of e.conditions){const e=this._evaluateCondition(i,t,n);if(e.result)return e}return{result:!1};case"and":{let i={};for(const a of e.conditions){const e=this._evaluateCondition(a,t,n);if(!e.result)return{result:!1};i={...i,...e.triggerData}}return{result:!0,triggerData:i}}case"not":return{result:!this._evaluateCondition({...e,condition:"and"},t,n).result};case"template":return{result:!!t?.hass&&!0===this._templateRenderer.renderRecursively(t.hass,e.value_template,{conditionState:t})}}var i}}class hM{constructor(e){this._automations=new Map,this._nestedAutomationExecutions=0,this._api=e}deleteAutomations(e){for(const[t,n]of this._automations)t.tag===e&&(this._automations.delete(t),n.destroy())}addAutomations(e){for(const t of e){const e=new dM(t.conditions,this._api.getConditionStateManager());e.addListener((e=>this._execute(t,e))),this._automations.set(t,e)}}_execute(e,t){if(!this._api.getHASSManager().hasHASS()||!this._api.getInitializationManager().isInitializedMandatory()||this._api.getMessageManager().hasErrorMessage())return;const n=t.result?e.actions:e.actions_not;if(!n?.length)return;(async e=>{++this._nestedAutomationExecutions,this._nestedAutomationExecutions>10?this._api.getMessageManager().setMessageIfHigherPriority({type:"error",message:Hg("error.too_many_automations")}):(await this._api.getActionsManager().executeActions({actions:e,triggerData:t.triggerData}),--this._nestedAutomationExecutions)})(n)}}class pM{constructor(e){this._api=e}openURL(){const e=this.getCameraURL();e&&window.open(e)}hasCameraURL(){return!!this.getCameraURL()}getCameraURL(){const e=this._api.getViewManager().getView(),t=e?.queryResults?.getSelectedResult()??null,n=e?.camera?this._api.getCameraManager().getCameraEndpoints(e.camera,{view:e.view,...t&&Xd.isMedia(t)&&{media:t}})??null:null;return n?.ui?.endpoint??null}}const mM=()=>!!navigator.userAgent.match(/CrKey\//),fM=async()=>{if(["ha-button-menu","ha-button","ha-camera-stream","ha-card","ha-combo-box","ha-hls-player","ha-icon-button","ha-icon","ha-menu-button","ha-selector","ha-spinner","ha-state-icon","ha-web-rtc-player","mwc-button","mwc-list-item","state-badge"].every((e=>customElements.get(e))))return!0;const e=await window.loadCardHelpers();await e.createCardElement({type:"picture-glance",entities:[],camera_image:"dummy-to-load-editor-components"}),await customElements.whenDefined("hui-picture-glance-card");const t=customElements.get("hui-picture-glance-card");if(!t)return!1;const n=new t;return await n.constructor.getConfigElement(),!0};class gM{constructor(){this._initialized=new Set}async initializeMultipleIfNecessary(e){return(await hd(Object.entries(e),(async([e,t])=>await this.initializeIfNecessary(e,t)))).every(Boolean)}async initializeIfNecessary(e,t){return!!this._initialized.has(e)||(t?!!await t()&&(this._initialized.add(e),!0):(this._initialized.add(e),!0))}uninitialize(e){this._initialized.delete(e)}isInitialized(e){return this._initialized.has(e)}isInitializedMultiple(e){return e.every((e=>this.isInitialized(e)))}}var _M;!function(e){e.LANGUAGES="languages",e.SIDE_LOAD_ELEMENTS="side-load-elements",e.CAMERAS="cameras",e.MICROPHONE_CONNECT="microphone-connect",e.VIEW="view"}(_M||(_M={}));class vM{constructor(e,t){this._initializationQueue=new Zd({concurrency:1}),this._everInitialized=!1,this._api=e,this._initializer=t??new gM}wasEverInitialized(){return this._everInitialized}isInitialized(e){return this._initializer.isInitialized(e)}isInitializedMandatory(){return!!this._api.getConfigManager().getConfig()&&this._initializer.isInitializedMultiple([_M.LANGUAGES,_M.SIDE_LOAD_ELEMENTS,_M.CAMERAS,...this._api.getMicrophoneManager().shouldConnectOnInitialization()?[_M.MICROPHONE_CONNECT]:[],_M.VIEW])}async initializeMandatory(){await this._initializationQueue.add((()=>this._initializeMandatory()))}async _initializeMandatory(){const e=this._api.getHASSManager().getHASS();if(!e||this.isInitializedMandatory())return;if(!await this._initializer.initializeMultipleIfNecessary({[_M.LANGUAGES]:async()=>await(async e=>{const t=Bg(e);return"ca"===t?Fg[t]=await import("./lang-ca-fbec7902.js"):"it"===t?Fg[t]=await import("./lang-it-6aae597e.js"):"pt"===t?Fg[t]=await import("./lang-pt-PT-68de29eb.js"):"pt_BR"===t?Fg[t]=await import("./lang-pt-BR-b95c12eb.js"):"fr"===t&&(Fg[t]=await import("./lang-fr-24fad00e.js")),t&&(Vg=t),!0})(e),[_M.SIDE_LOAD_ELEMENTS]:async()=>await fM()}))return;const t=this._api.getConfigManager().getConfig();t&&await this._initializer.initializeMultipleIfNecessary({[_M.CAMERAS]:async()=>(this._api.createCameraManager(),await this._api.getCameraManager().initializeCamerasFromConfig()),...this._api.getMicrophoneManager().shouldConnectOnInitialization()&&{[_M.MICROPHONE_CONNECT]:async()=>(this._api.createMicrophoneManager(),await this._api.getMicrophoneManager().connect())}})&&!this._api.getMessageManager().hasMessage()&&await this._initializer.initializeIfNecessary(_M.VIEW,this._api.getViewManager().initialize)&&(this._everInitialized=!0,this._api.getConditionStateManager().setState({config:t,initialized:this._everInitialized}),this._api.getCardElementManager().update())}uninitialize(e){this._initializer.uninitialize(e)}}class yM{constructor(e,t,n,i){this.update=()=>{this._element.requestUpdate()},this._api=e,this._element=t,this._scrollCallback=n,this._menuToggleCallback=i}getElement(){return this._element}scrollReset(){this._scrollCallback()}toggleMenu(){this._menuToggleCallback()}hasUpdated(){return this._element.hasUpdated}elementConnected(){this._api.getInteractionManager().initialize(),this._api.getFullscreenManager().initialize(),this._api.getExpandManager().initialize(),this._api.getMediaLoadedInfoManager().initialize(),this._api.getMicrophoneManager().initialize(),this._api.getKeyboardStateManager().initialize(),this._api.getDefaultManager().initialize(),this._api.getMediaPlayerManager().initialize(),this._api.getHASSManager().getStateWatcher()?.subscribe(this.update,[...this._api.getConfigManager().getConfig()?.view.render_entities??[],...this._api.getMediaPlayerManager().getMediaPlayers()??[]]),fd(this._element,(e=>{const t=e.getRootNode();return!!(t&&t instanceof ShadowRoot&&"HUI-PANEL-VIEW"===t.host.tagName)})(this._element),"panel"),fd(this._element,mM(),"casted"),this._api.getFullscreenManager().connect(),this._element.addEventListener("mousemove",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("wheel",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("ll-custom",this._api.getActionsManager().handleCustomActionEvent),this._element.addEventListener("action",this._api.getActionsManager().handleInteractionEvent),this._element.addEventListener("action",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("advanced-camera-card:action:execution-request",this._api.getActionsManager().handleActionExecutionRequestEvent),window.addEventListener("location-changed",this._api.getQueryStringManager().requestExecution),window.addEventListener("popstate",this._api.getQueryStringManager().requestExecution),this._api.getConditionStateManager()?.setState({userAgent:navigator.userAgent}),this._api.getQueryStringManager().requestExecution(),this._element.requestUpdate()}elementDisconnected(){fd(this._element,!1,"panel"),fd(this._element,!1,"tabindex"),fd(this._element,!1,"casted"),this._api.getMediaLoadedInfoManager().clear(),this._api.getFullscreenManager().disconnect(),this._api.getKeyboardStateManager().uninitialize(),this._api.getActionsManager().uninitialize(),this._api.getDefaultManager().uninitialize(),this._api.getHASSManager().getStateWatcher()?.unsubscribe(this.update),this._api.getInitializationManager().uninitialize(_M.CAMERAS),this._api.getCameraManager().destroy(),this._element.removeEventListener("mousemove",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("wheel",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("ll-custom",this._api.getActionsManager().handleCustomActionEvent),this._element.removeEventListener("action",this._api.getActionsManager().handleInteractionEvent),this._element.removeEventListener("action",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("advanced-camera-card:action:execution-request",this._api.getActionsManager().handleActionExecutionRequestEvent),window.removeEventListener("location-changed",this._api.getQueryStringManager().requestExecution),window.removeEventListener("popstate",this._api.getQueryStringManager().requestExecution)}}function bM(e){if(e instanceof hi.ZodDefault)return bM(e.removeDefault());if(e instanceof hi.ZodObject){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=hi.ZodOptional.create(bM(i))}return new hi.ZodObject({...e._def,shape:()=>t})}return e instanceof hi.ZodArray?hi.ZodArray.create(bM(e.element)).min(e._def.minLength?.value,e._def.minLength?.message).max(e._def.maxLength?.value,e._def.maxLength?.message).length(e._def.exactLength?.value,e._def.exactLength?.message):e instanceof hi.ZodOptional?hi.ZodOptional.create(bM(e.unwrap())):e instanceof hi.ZodNullable?hi.ZodNullable.create(bM(e.unwrap())):e instanceof hi.ZodTuple?hi.ZodTuple.create(e.items.map((e=>bM(e)))):e}const wM=e=>{const t=new Set;if(e.issues.length)for(const n of e.issues)if("invalid_union"===n.code){const e=n.unionErrors;for(const n of e)wM(n).forEach(t.add,t)}else t.add(xM(n.path));return t},xM=e=>{let t="";for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t+="["+i+"]":t?t+=" -> "+i:t=i}return t},MM=hi.object({enabled:hi.boolean().default(!0).optional(),priority:hi.number().min(0).max(100).default(50).optional()}),kM=bi.extend({advanced_camera_card_action:hi.literal("camera_select"),camera:hi.string().optional(),triggered:hi.boolean().optional()}),CM=hi.enum(["single","grid"]),SM=hi.enum(["default","first","last"]),EM=hi.object({mode:CM.optional(),grid_selected_position:SM.optional(),grid_selected_width_factor:hi.number().min(0).optional(),grid_max_columns:hi.number().min(0).optional(),grid_columns:hi.number().min(0).optional()}).optional(),AM=bi.extend({advanced_camera_card_action:hi.literal("display_mode_select"),display_mode:CM}),TM=bi.extend({advanced_camera_card_action:hi.literal("folders").or(hi.literal("folder")),folder:hi.string().optional()}),$M=bi.extend({advanced_camera_card_action:hi.enum(["camera_ui","default","download","expand","fullscreen","live_substream_off","live_substream_on","menu_toggle","microphone_connect","microphone_disconnect","microphone_mute","microphone_unmute","mute","pause","play","screenshot","unmute"])}),IM=bi.extend({advanced_camera_card_action:hi.literal("log"),message:hi.string(),level:hi.enum(["debug","info","warn","error"]).default("info")}),OM=bi.extend({advanced_camera_card_action:hi.literal("media_player"),media_player:hi.string(),media_player_action:hi.enum(["play","stop"])}),LM=["left","right","up","down","zoom_in","zoom_out"],DM=[...LM,"preset"],jM=["start","stop"],zM=bi.extend({advanced_camera_card_action:hi.literal("ptz"),camera:hi.string().optional(),ptz_action:hi.enum(DM).optional(),ptz_phase:hi.enum(jM).optional(),ptz_preset:hi.string().optional()}),RM=bi.extend({advanced_camera_card_action:hi.literal("ptz_controls"),enabled:hi.boolean()}),PM=hi.object({x:hi.number().min(0).max(100).optional(),y:hi.number().min(0).max(100).optional()}),NM=bi.extend({advanced_camera_card_action:hi.literal("ptz_digital"),target_id:hi.string().optional(),absolute:hi.object({zoom:zv.optional(),pan:PM.optional()}).optional(),ptz_action:hi.enum(DM).optional(),ptz_phase:hi.enum(jM).optional()}),FM=bi.extend({advanced_camera_card_action:hi.literal("ptz_multi"),target_id:hi.string().optional(),ptz_action:hi.enum(DM).optional(),ptz_phase:hi.enum(jM).optional(),ptz_preset:hi.string().optional()}),VM=hi.object({ms:hi.number().optional(),s:hi.number().optional(),m:hi.number().optional(),h:hi.number().optional()}),BM=bi.extend({advanced_camera_card_action:hi.literal("sleep"),duration:VM.optional().default({s:1})}),HM=bi.extend({advanced_camera_card_action:hi.literal("live_substream_select"),camera:hi.string()}),UM=bi.extend({advanced_camera_card_action:hi.enum(vi.filter((e=>"folder"!==e&&"folders"!==e)))}),qM=hi.object({entity_id:hi.string().or(hi.string().array()).optional(),device_id:hi.string().or(hi.string().array()).optional(),area_id:hi.string().or(hi.string().array()).optional(),floor_id:hi.string().or(hi.string().array()).optional(),label_id:hi.string().or(hi.string().array()).optional()}),WM=yi.extend({action:hi.literal("call-service"),service:hi.string(),data:hi.object({}).passthrough().optional(),target:qM.optional()}),ZM=yi.extend({action:hi.literal("fire-dom-event")}).passthrough(),KM=yi.extend({action:hi.literal("more-info"),entity:hi.string().optional()}),QM=yi.extend({action:hi.literal("navigate"),navigation_path:hi.string(),navigation_replace:hi.boolean().optional()}),YM=yi.extend({action:hi.literal("none")}),GM=yi.extend({action:hi.literal("perform-action"),perform_action:hi.string(),data:hi.object({}).passthrough().optional(),target:qM.optional()}),XM=yi.extend({action:hi.literal("toggle")}),JM=yi.extend({action:hi.literal("url"),url_path:hi.string()}),ek=hi.union([WM,ZM,KM,QM,YM,GM,XM,JM]),tk=bi.extend({advanced_camera_card_action:hi.literal("status_bar"),status_bar_action:hi.enum(["add","remove","reset"]),items:hi.lazy((()=>uk)).array().optional()}),nk=hi.union([kM,TM,$M,xi,IM,OM,zM,RM,NM,FM,BM,tk,HM,UM,AM]),ik=hi.union([ek,nk]),ak=hi.object({tap_action:ik.or(ik.array()).optional(),hold_action:ik.or(ik.array()).optional(),double_tap_action:ik.or(ik.array()).optional(),start_tap_action:ik.or(ik.array()).optional(),end_tap_action:ik.or(ik.array()).optional()}).passthrough(),rk=hi.object({actions:ak.optional()}),sk=MM.extend({sufficient:hi.boolean().default(!1).optional(),exclusive:hi.boolean().default(!1).optional(),expand:hi.boolean().default(!1).optional(),actions:ak.optional()}),ok=sk.extend({type:hi.literal("custom:advanced-camera-card-status-bar-icon"),icon:hi.string()}),ck=sk.extend({type:hi.literal("custom:advanced-camera-card-status-bar-image"),image:hi.string()}),lk=sk.extend({type:hi.literal("custom:advanced-camera-card-status-bar-string"),string:hi.string()}),uk=hi.union([ok,ck,lk]),dk=hi.object({condition:hi.literal("camera"),cameras:hi.string().array().optional()}),hk=hi.object({condition:hi.literal("config"),paths:hi.string().array().optional()}),pk=hi.object({condition:hi.literal("display_mode"),display_mode:CM}),mk=hi.object({condition:hi.literal("expand"),expand:hi.boolean()}),fk=hi.object({condition:hi.literal("fullscreen"),fullscreen:hi.boolean()}),gk=hi.object({condition:hi.literal("initialized")}),_k=hi.object({condition:hi.literal("interaction"),interaction:hi.boolean()}),vk=hi.object({condition:hi.literal("key"),key:hi.string(),state:hi.enum(["down","up"]).optional(),ctrl:hi.boolean().optional(),shift:hi.boolean().optional(),alt:hi.boolean().optional(),meta:hi.boolean().optional()}),yk=hi.object({condition:hi.literal("media_loaded"),media_loaded:hi.boolean()}),bk=hi.object({condition:hi.literal("microphone"),connected:hi.boolean().optional(),muted:hi.boolean().optional()}),wk=hi.object({condition:hi.literal("triggered"),triggered:hi.string().array()}),xk=hi.string().refine((e=>{try{new RegExp(e)}catch{return!1}return!0}),{message:"Invalid regular expression"}),Mk=hi.object({condition:hi.literal("user_agent"),user_agent:hi.string().optional(),user_agent_re:xk.optional(),companion:hi.boolean().optional()}),kk=hi.object({condition:hi.literal("view"),views:hi.string().array().optional()}),Ck=hi.object({condition:hi.literal("numeric_state"),entity:hi.string(),above:hi.number().optional(),below:hi.number().optional()}),Sk=hi.object({condition:hi.literal("screen"),media_query:hi.string()}),Ek=hi.object({condition:hi.literal("state").optional(),entity:hi.string(),state:hi.string().or(hi.string().array()).optional(),state_not:hi.string().or(hi.string().array()).optional()}),Ak=hi.object({condition:hi.literal("template"),value_template:hi.string()}),Tk=hi.object({condition:hi.literal("user"),users:hi.string().array().min(1)}),$k=hi.object({condition:hi.literal("or"),conditions:hi.lazy((()=>Lk)).array().min(1)}),Ik=hi.object({condition:hi.literal("and"),conditions:hi.lazy((()=>Lk)).array().min(1)}),Ok=hi.object({condition:hi.literal("not"),conditions:hi.lazy((()=>Lk)).array().min(1)}),Lk=hi.union([Ck,Sk,Ek,Tk,$k,Ik,Ok,Ak,dk,hk,pk,mk,fk,gk,_k,vk,yk,bk,wk,Mk,kk]),Dk=ik.array(),jk=hi.object({conditions:Lk.array(),actions:Dk.optional(),actions_not:Dk.optional()}).refine((e=>e.actions?.length||e.actions_not?.length),"Automations must include at least one action").array(),zk=hi.object({fit:hi.enum(["contain","cover","fill"]).optional(),position:hi.object({x:hi.number().min(0).max(100).optional(),y:hi.number().min(0).max(100).optional()}).optional(),view_box:hi.object({bottom:hi.number().min(0).max(100).optional().default(0),left:hi.number().min(0).max(100).optional().default(0),right:hi.number().min(0).max(100).optional().default(0),top:hi.number().min(0).max(100).optional().default(0)}).optional(),pan:PM.optional(),zoom:zv.optional()}),Rk={r2c_delay_between_calls_seconds:.5,c2r_delay_between_calls_seconds:.2},Pk=function(e){return t=>{if(!t||"object"!=typeof t||!t.service)return t;const n={...t};return Object.keys(t).forEach((i=>{const a=i.match(/^data_(.+)$/),r=a?.[1];r&&!(`${e}${r}`in t)&&(n[`${e}${r}`]={action:"perform-action",perform_action:t.service,data:t[i]},delete n[i],delete n.service)})),n}},Nk=hi.preprocess(Pk("actions_"),hi.object({actions_left:GM.optional(),actions_left_start:GM.optional(),actions_left_stop:GM.optional(),actions_right:GM.optional(),actions_right_start:GM.optional(),actions_right_stop:GM.optional(),actions_up:GM.optional(),actions_up_start:GM.optional(),actions_up_stop:GM.optional(),actions_down:GM.optional(),actions_down_start:GM.optional(),actions_down_stop:GM.optional(),actions_zoom_in:GM.optional(),actions_zoom_in_start:GM.optional(),actions_zoom_in_stop:GM.optional(),actions_zoom_out:GM.optional(),actions_zoom_out_start:GM.optional(),actions_zoom_out_stop:GM.optional(),r2c_delay_between_calls_seconds:hi.number().default(Rk.r2c_delay_between_calls_seconds),c2r_delay_between_calls_seconds:hi.number().default(Rk.c2r_delay_between_calls_seconds),presets:hi.preprocess(Pk(""),hi.union([hi.record(GM),hi.object({service:hi.string().optional()})])).optional(),service:hi.string().optional()}).passthrough()),Fk=hi.number().array().length(2).or(hi.string().regex(/^\s*\d+\.?\d*\s*[:/]\s*\d+\.?\d*\s*$/).transform((e=>e.split(/[:\/]/).map((e=>Number(e)))))),Vk={mode:"auto",refresh_seconds:1,zoomable:!0},Bk=hi.object({mode:hi.enum(["auto","camera","entity","screensaver","url"]).default(Vk.mode),refresh_seconds:hi.number().min(0).default(Vk.refresh_seconds),url:hi.string().optional(),entity:hi.string().optional(),entity_parameters:hi.string().optional()}),Hk=["events","clips","snapshots"],Uk=hi.object({url:hi.string().transform((e=>e.replace(/\/+$/,""))).optional(),host:hi.string().optional(),modes:hi.enum(["webrtc","mse","mp4","mjpeg"]).array().optional(),stream:hi.string().optional()}),qk=hi.object({entity:hi.string().optional(),url:hi.string().optional()}).passthrough(),Wk=hi.object({options:hi.object({audio:hi.boolean().optional(),video:hi.boolean().optional(),pauseWhenHidden:hi.boolean().optional(),disableGl:hi.boolean().optional(),disableWebAssembly:hi.boolean().optional(),preserveDrawingBuffer:hi.boolean().optional(),progressive:hi.boolean().optional(),throttled:hi.boolean().optional(),chunkSize:hi.number().optional(),maxAudioLag:hi.number().optional(),videoBufferSize:hi.number().optional(),audioBufferSize:hi.number().optional()}).optional()}),Zk=hi.object({method:hi.enum(["standard","dashboard"]).default("standard").optional(),dashboard:hi.object({dashboard_path:hi.string().optional(),view_path:hi.string().optional()}).optional()}),Kk={dependencies:{all_cameras:!1,cameras:[]},engine:"auto",frigate:{client_id:"frigate"},live_provider:"auto",motioneye:{images:{directory_pattern:"%Y-%m-%d",file_pattern:"%H-%M-%S"},movies:{directory_pattern:"%Y-%m-%d",file_pattern:"%H-%M-%S"}},reolink:{media_resolution:"low"},ptz:Rk,triggers:{motion:!1,occupancy:!1,events:[...Hk],entities:[]},proxy:{media:"auto",dynamic:!0,ssl_verification:"auto",ssl_ciphers:"auto"},always_error_if_entity_unavailable:!1},Qk=hi.object({media:hi.boolean().or(hi.literal("auto")).default(Kk.proxy.media),dynamic:hi.boolean().default(Kk.proxy.dynamic),ssl_verification:hi.boolean().or(hi.literal("auto")).default(Kk.proxy.ssl_verification),ssl_ciphers:hi.enum(["default","insecure","intermediate","modern"]).or(hi.literal("auto")).default(Kk.proxy.ssl_ciphers)}),Yk=hi.object({camera_entity:hi.string().optional(),icon:hi.string().optional(),title:hi.string().optional(),capabilities:hi.object({disable:hi.enum(Ju).array().optional(),disable_except:hi.enum(Ju).array().optional()}).optional(),id:hi.string().optional(),dependencies:hi.object({all_cameras:hi.boolean().default(Kk.dependencies.all_cameras),cameras:hi.string().array().default(Kk.dependencies.cameras)}).default(Kk.dependencies),triggers:hi.object({motion:hi.boolean().default(Kk.triggers.motion),occupancy:hi.boolean().default(Kk.triggers.occupancy),entities:hi.string().array().default(Kk.triggers.entities),events:hi.enum(Hk).array().default(Kk.triggers.events)}).default(Kk.triggers),engine:hi.enum(["auto","frigate","generic","motioneye","reolink"]).default("auto"),frigate:hi.object({url:hi.string().optional(),client_id:hi.string().default(Kk.frigate.client_id),camera_name:hi.string().optional(),labels:hi.string().array().optional(),zones:hi.string().array().optional()}).default(Kk.frigate),motioneye:hi.object({url:hi.string().optional(),images:hi.object({directory_pattern:hi.string().includes("%").default(Kk.motioneye.images.directory_pattern),file_pattern:hi.string().includes("%").default(Kk.motioneye.images.file_pattern)}).default(Kk.motioneye.images),movies:hi.object({directory_pattern:hi.string().includes("%").default(Kk.motioneye.movies.directory_pattern),file_pattern:hi.string().includes("%").default(Kk.motioneye.movies.file_pattern)}).default(Kk.motioneye.movies)}).default(Kk.motioneye),reolink:hi.object({url:hi.string().optional(),channel:hi.number().optional(),media_resolution:hi.enum(["high","low"]).default(Kk.reolink.media_resolution)}).default(Kk.reolink),live_provider:hi.enum(["auto","image","ha","jsmpeg","go2rtc","webrtc-card"]).default(Kk.live_provider),go2rtc:Uk.optional(),image:Bk.optional().default(Vk),jsmpeg:Wk.optional(),webrtc_card:qk.optional(),cast:Zk.optional(),ptz:Nk.default(Kk.ptz),dimensions:hi.object({aspect_ratio:Fk.optional(),layout:zk.optional()}).optional(),proxy:Qk.default(Kk.proxy),always_error_if_entity_unavailable:hi.boolean().default(Kk.always_error_if_entity_unavailable)}).default(Kk),Gk=Yk.array().min(1),Xk=hi.enum(["all","clips","snapshots"]),Jk=75,eC=100,tC=300,nC={size:100,show_details:!0,show_favorite_control:!0,show_timeline_control:!0,show_download_control:!0},iC=hi.object({size:hi.number().min(75).max(300).default(nC.size),show_details:hi.boolean().default(nC.show_details),show_favorite_control:hi.boolean().default(nC.show_favorite_control),show_timeline_control:hi.boolean().default(nC.show_timeline_control),show_download_control:hi.boolean().default(nC.show_download_control)}),aC={...nC,mode:"right"},rC=iC.extend({mode:hi.enum(["none","above","below","left","right"]).default(aC.mode)}),sC={clustering_threshold:3,events_media_type:"all",window_seconds:3600,show_recordings:!0,style:"stack",pan_mode:"pan",format:{"24h":!0}},oC=hi.enum(["pan","seek","seek-in-media","seek-in-camera"]),cC=hi.object({"24h":hi.boolean().optional().default(sC.format["24h"])}),lC=hi.object({clustering_threshold:hi.number().optional().default(sC.clustering_threshold),events_media_type:Xk.optional().default(sC.events_media_type),window_seconds:hi.number().min(60).max(86400).optional().default(sC.window_seconds),show_recordings:hi.boolean().optional().default(sC.show_recordings),style:hi.enum(["stack","ribbon"]).optional().default(sC.style),pan_mode:oC.optional().default(sC.pan_mode),format:cC.optional().default(sC.format)}),uC={...sC,mode:"none",style:"ribbon"},dC=lC.extend({mode:hi.enum(["none","above","below"]).default(uC.mode),style:lC.shape.style.default(uC.style)}),hC={...sC,controls:{thumbnails:aC}},pC={logging:!1},mC=hi.object({logging:hi.boolean().default(pC.logging)}).default(pC),fC={aspect_ratio_mode:"dynamic",aspect_ratio:[16,9],height:"auto"},gC=hi.object({aspect_ratio_mode:hi.enum(["dynamic","static","unconstrained"]).default(fC.aspect_ratio_mode),aspect_ratio:Fk.default(fC.aspect_ratio),height:hi.string().default(fC.height)}).default(fC),_C=hi.discriminatedUnion("condition",[Ek,Ck,Sk,Tk]),vC=ak.extend({style:hi.record(hi.string().nullable().or(hi.undefined()).or(hi.number())).optional(),title:hi.string().nullable().optional()}),yC=vC.extend({type:hi.literal("icon"),icon:hi.string(),entity:hi.string().optional()}),bC=hi.object({enabled:hi.boolean().default(!0).optional(),priority:hi.number().min(0).max(100).default(50).optional(),alignment:hi.enum(["matching","opposing"]).default("matching").optional(),icon:hi.string().optional(),permanent:hi.boolean().default(!1).optional()}),wC=bC.merge(yC).extend({type:hi.literal("custom:advanced-camera-card-menu-icon")}),xC=vC.extend({type:hi.literal("state-icon"),entity:hi.string(),icon:hi.string().optional(),state_color:hi.boolean().default(!0)}),MC=bC.merge(xC).extend({type:hi.literal("custom:advanced-camera-card-menu-state-icon")}).merge(bC),kC=vC.extend({entity:hi.string().optional(),icon:hi.string().optional(),state_color:hi.boolean().default(!0).optional(),selected:hi.boolean().default(!1).optional(),subtitle:hi.string().optional(),enabled:hi.boolean().default(!0).optional()}),CC=bC.merge(yC).extend({type:hi.literal("custom:advanced-camera-card-menu-submenu"),items:kC.array()}),SC=bC.merge(xC).extend({type:hi.literal("custom:advanced-camera-card-menu-submenu-select"),options:hi.record(kC.deepPartial()).optional()}),EC=hi.object({type:hi.string().superRefine(((e,t)=>{e.match(/^custom:(?!advanced-camera-card).+/)||t.addIssue({code:hi.ZodIssueCode.custom,message:"advanced-camera-card custom elements must match specific schemas",fatal:!0})}))}).passthrough(),AC=vC.extend({type:hi.literal("image"),entity:hi.string().optional(),image:hi.string().optional(),camera_image:hi.string().optional(),camera_view:hi.string().optional(),state_image:hi.object({}).passthrough().optional(),filter:hi.string().optional(),state_filter:hi.object({}).passthrough().optional(),aspect_ratio:hi.string().optional()}),TC=vC.extend({type:hi.literal("service-button"),title:hi.string(),service:hi.string(),service_data:hi.object({}).passthrough().optional()}),$C=vC.extend({type:hi.literal("state-badge"),entity:hi.string()}),IC=vC.extend({type:hi.literal("state-label"),entity:hi.string(),attribute:hi.string().optional(),prefix:hi.string().optional(),suffix:hi.string().optional()}),OC=hi.object({type:hi.literal("conditional"),conditions:_C.array(),elements:hi.lazy((()=>DC))}),LC=hi.object({type:hi.literal("custom:advanced-camera-card-conditional"),conditions:Lk.array(),elements:hi.lazy((()=>DC))}),DC=hi.union([OC,EC,LC,yC,AC,wC,MC,CC,SC,TC,$C,xC,IC,ok,ck,lk]).array().optional(),jC="media-source://",zC=hi.enum(["ha"]),RC="ha",PC={},NC=hi.object({type:hi.literal("startdate"),format:hi.string().optional(),regexp:xk.optional()}),FC=NC.extend({type:hi.literal("date")}),VC=hi.discriminatedUnion("type",[FC,NC]),BC=hi.object({type:hi.literal("startdate"),since:hi.object({years:hi.number().int().min(0).optional(),months:hi.number().int().min(0).optional(),days:hi.number().int().min(0).optional(),hours:hi.number().int().min(0).optional(),minutes:hi.number().int().min(0).optional()})}),HC=BC.extend({type:hi.literal("date")}),UC=hi.object({type:hi.literal("template"),value_template:hi.string()}),qC=hi.object({type:hi.literal("title"),regexp:xk.optional(),title:hi.string().optional()}),WC=hi.object({type:hi.literal("or"),matchers:hi.array(hi.lazy((()=>ZC)))}),ZC=hi.union([HC,WC,BC,UC,qC]),KC=hi.object({id:hi.string().optional(),parsers:VC.array().optional(),matchers:ZC.array().optional()}),QC=hi.object({url:hi.string().transform((e=>{let t=e;try{t=new URL(e).pathname}catch(e){}const n=decodeURIComponent(t).split(",").filter(gd).slice(1),i=[{id:jC},...n.slice(0,-1).map((e=>({id:e.replace(/\/[^/]+$/,"")}))),...n.slice(-1).map((e=>({id:e})))];for(const t of i)if(t.id&&!t.id.startsWith(jC))throw new Xu(`Could not parse media source URL: ${e}`);return i})).optional(),path:KC.array().nonempty().optional()}),YC=hi.object({type:zC.default(RC),id:hi.string().optional(),ha:QC.default(PC).optional(),title:hi.string().optional(),icon:hi.string().optional()}).array(),GC=Bk.extend({zoomable:hi.boolean().default(Vk.zoomable)}).merge(rk).default(Vk),XC=hi.object({style:hi.enum(["none","chevrons","icons","thumbnails"]),size:hi.number().min(20)}),JC={orientation:"horizontal",mode:"auto",hide_pan_tilt:!1,hide_zoom:!1,hide_home:!1,position:"bottom-right"},eS=hi.object({mode:hi.enum(["off","auto","on"]).default(JC.mode),position:hi.enum(["top-left","top-right","bottom-left","bottom-right"]).default(JC.position),orientation:hi.enum(["vertical","horizontal"]).default(JC.orientation),hide_pan_tilt:hi.boolean().default(JC.hide_pan_tilt),hide_zoom:hi.boolean().default(JC.hide_zoom),hide_home:hi.boolean().default(JC.hide_home),style:hi.object({}).passthrough().optional()}),tS=["selected","visible"],nS=["unselected","hidden"],iS=[...nS,"microphone"],aS=[...tS,"microphone"],rS=hi.enum(["none","slide"]),sS={always_connected:!1,disconnect_seconds:90,mute_after_microphone_mute_seconds:60},oS=hi.object({always_connected:hi.boolean().default(sS.always_connected),disconnect_seconds:hi.number().min(0).default(sS.disconnect_seconds),mute_after_microphone_mute_seconds:hi.number().min(0).default(sS.mute_after_microphone_mute_seconds)}).default(sS),cS={...aC,media_type:"events",events_media_type:"all"},lS={auto_play:[...tS],auto_pause:[],auto_mute:[...iS],auto_unmute:["microphone"],preload:!1,lazy_load:!0,lazy_unload:[],draggable:!0,zoomable:!0,transition_effect:"slide",show_image_during_load:!0,mode:"single",controls:{builtin:!0,next_previous:{size:48,style:"chevrons"},ptz:JC,thumbnails:cS,timeline:uC},microphone:{...sS}},uS=rC.extend({media_type:hi.enum(["events","recordings"]).default(lS.controls.thumbnails.media_type),events_media_type:Xk.default(lS.controls.thumbnails.events_media_type)}),dS=hi.object({auto_pause:hi.enum(nS).array().default(lS.auto_pause),auto_play:hi.enum(tS).array().default(lS.auto_play),auto_mute:hi.enum(iS).array().default(lS.auto_mute),auto_unmute:hi.enum(aS).array().default(lS.auto_unmute),controls:hi.object({builtin:hi.boolean().default(lS.controls.builtin),next_previous:XC.extend({style:hi.enum(["none","chevrons","icons"]).default(lS.controls.next_previous.style),size:XC.shape.size.default(lS.controls.next_previous.size)}).default(lS.controls.next_previous),ptz:eS.default(lS.controls.ptz),thumbnails:uS.default(lS.controls.thumbnails),timeline:dC.default(lS.controls.timeline)}).default(lS.controls),display:EM,draggable:hi.boolean().default(lS.draggable),lazy_load:hi.boolean().default(lS.lazy_load),lazy_unload:hi.enum(nS).array().default(lS.lazy_unload),microphone:oS.default(lS.microphone),preload:hi.boolean().default(lS.preload),show_image_during_load:hi.boolean().default(lS.show_image_during_load),transition_effect:rS.default(lS.transition_effect),zoomable:hi.boolean().default(lS.zoomable)}).merge(rk).default(lS),hS={...aC,show_details:!1},pS={controls:{thumbnails:hS,filter:{mode:"right"}}},mS=iC.extend({show_details:hi.boolean().default(hS.show_details)}),fS=hi.object({controls:hi.object({thumbnails:mS.default(pS.controls.thumbnails),filter:hi.object({mode:hi.enum(["none","left","right"]).default(pS.controls.filter.mode)}).default(pS.controls.filter)}).default(pS.controls)}).merge(rk).default(pS),gS=["left","right","top","bottom"],_S=gS,vS={priority:50,enabled:!0},yS={priority:50,enabled:!1},bS={alignment:"left",button_size:40,buttons:{camera_ui:vS,cameras:vS,clips:vS,ptz_home:yS,display_mode:vS,download:vS,expand:yS,folders:vS,iris:vS,fullscreen:vS,image:yS,live:vS,media_player:vS,microphone:{...yS,type:"momentary"},mute:yS,play:yS,ptz_controls:yS,recordings:yS,screenshot:yS,snapshots:vS,substreams:vS,timeline:vS},position:"top",style:"hidden"},wS=bC.extend({enabled:bC.shape.enabled.default(vS.enabled),priority:bC.shape.priority.default(vS.priority)}),xS=bC.extend({enabled:bC.shape.enabled.default(yS.enabled),priority:bC.shape.priority.default(yS.priority)}),MS=hi.object({style:hi.enum(["none","hidden","overlay","hover","hover-card","outside"]).default(bS.style),position:hi.enum(gS).default(bS.position),alignment:hi.enum(_S).default(bS.alignment),buttons:hi.object({camera_ui:wS.default(bS.buttons.camera_ui),cameras:wS.default(bS.buttons.cameras),clips:wS.default(bS.buttons.clips),ptz_home:xS.default(bS.buttons.ptz_home),display_mode:wS.default(bS.buttons.display_mode),download:wS.default(bS.buttons.download),expand:xS.default(bS.buttons.expand),folders:wS.default(bS.buttons.folders),iris:wS.default(bS.buttons.iris),fullscreen:wS.default(bS.buttons.fullscreen),image:xS.default(bS.buttons.image),live:wS.default(bS.buttons.live),media_player:wS.default(bS.buttons.media_player),microphone:xS.extend({type:hi.enum(["momentary","toggle"]).default(bS.buttons.microphone.type)}).default(bS.buttons.microphone),mute:xS.default(bS.buttons.mute),play:xS.default(bS.buttons.play),ptz_controls:xS.default(bS.buttons.ptz_controls),recordings:xS.default(bS.buttons.recordings),screenshot:xS.default(bS.buttons.screenshot),snapshots:wS.default(bS.buttons.snapshots),substreams:wS.default(bS.buttons.substreams),timeline:wS.default(bS.buttons.timeline)}).default(bS.buttons),button_size:hi.number().min(20).default(bS.button_size)}).default(bS),kS=hi.object({conditions:Lk.array(),merge:hi.object({}).passthrough().optional(),set:hi.object({}).passthrough().optional(),delete:hi.string().array().optional()}).array().optional(),CS={features:{animated_progress_indicator:!0,card_loading_indicator:!0,media_chunk_size:50},style:{border_radius:!0,box_shadow:!0}},SS=hi.object({features:hi.object({animated_progress_indicator:hi.boolean().default(CS.features.animated_progress_indicator),card_loading_indicator:hi.boolean().default(CS.features.card_loading_indicator),media_chunk_size:hi.number().min(0).max(1e3).default(CS.features.media_chunk_size),max_simultaneous_engine_requests:hi.number().min(1).optional()}).default(CS.features),style:hi.object({border_radius:hi.boolean().default(CS.style.border_radius),box_shadow:hi.boolean().default(CS.style.box_shadow)}).default(CS.style)}).default(CS),ES=hi.enum(["casting","low-performance","scrubbing"]).array().optional(),AS={entities:{camera_priority:"card"}},TS=hi.enum(["card","entity"]),$S=hi.object({entities:hi.object({camera:hi.string().startsWith("input_select.").optional(),camera_priority:TS.default(AS.entities.camera_priority)}).default(AS.entities)}).default(AS),IS=20,OS={priority:50,enabled:!0},LS={height:40,items:{engine:OS,resolution:OS,technology:OS,title:OS},position:"bottom",style:"popup",popup_seconds:3},DS=hi.object({position:hi.enum(["top","bottom"]).default(LS.position),style:hi.enum(["none","overlay","hover","hover-card","outside","popup"]).default(LS.style),popup_seconds:hi.number().min(0).max(60).default(LS.popup_seconds),height:hi.number().min(20).default(LS.height),items:hi.object({engine:MM.default(LS.items.engine),technology:MM.default(LS.items.technology),resolution:MM.default(LS.items.resolution),title:MM.default(LS.items.title)}).default(LS.items)}).default(LS),jS=lC.extend({controls:hi.object({thumbnails:rC.default(hC.controls.thumbnails)}).default(hC.controls)}).default(hC),zS=hi.object({key:hi.string(),ctrl:hi.boolean().optional(),shift:hi.boolean().optional(),alt:hi.boolean().optional(),meta:hi.boolean().optional()}),RS={enabled:!0,ptz_left:{key:"ArrowLeft"},ptz_right:{key:"ArrowRight"},ptz_up:{key:"ArrowUp"},ptz_down:{key:"ArrowDown"},ptz_zoom_in:{key:"+"},ptz_zoom_out:{key:"-"},ptz_home:{key:"h"}},PS=hi.object({enabled:hi.boolean().default(RS.enabled),ptz_left:zS.nullable().default(RS.ptz_left),ptz_right:zS.nullable().default(RS.ptz_right),ptz_up:zS.nullable().default(RS.ptz_up),ptz_down:zS.nullable().default(RS.ptz_down),ptz_zoom_in:zS.nullable().default(RS.ptz_zoom_in),ptz_zoom_out:zS.nullable().default(RS.ptz_zoom_out),ptz_home:zS.nullable().default(RS.ptz_home)}),NS={default:_i,camera_select:"current",interaction_seconds:300,default_reset:{every_seconds:0,after_interaction:!1,entities:[],interaction_mode:"inactive"},default_cycle_camera:!1,dim:!1,theme:{themes:["traditional"]},triggers:{show_trigger_status:!1,filter_selected_camera:!0,actions:{trigger:"update",untrigger:"none"},untrigger_seconds:0},keyboard_shortcuts:RS},FS=hi.enum(["all","inactive","active"]).default("inactive"),VS=hi.object({actions:hi.object({interaction_mode:FS,trigger:hi.enum(["default","live","media","none","update"]).default(NS.triggers.actions.trigger),untrigger:hi.enum(["default","none"]).default(NS.triggers.actions.untrigger)}).default(NS.triggers.actions),filter_selected_camera:hi.boolean().default(NS.triggers.filter_selected_camera),show_trigger_status:hi.boolean().default(NS.triggers.show_trigger_status),untrigger_seconds:hi.number().default(NS.triggers.untrigger_seconds)}),BS=hi.enum(["ha","dark","light","traditional"]),HS=hi.object({themes:BS.array().default(NS.theme.themes),overrides:hi.record(hi.string()).optional()}),US=hi.object({default:hi.enum(vi).default(NS.default),camera_select:hi.enum([...vi,"current"]).default(NS.camera_select),interaction_seconds:hi.number().default(NS.interaction_seconds),default_cycle_camera:hi.boolean().default(NS.default_cycle_camera),default_reset:hi.object({after_interaction:hi.boolean().default(NS.default_reset.after_interaction),every_seconds:hi.number().default(NS.default_reset.every_seconds),entities:hi.string().array().default(NS.default_reset.entities),interaction_mode:FS.default(NS.default_reset.interaction_mode)}).default(NS.default_reset),render_entities:hi.string().array().optional(),theme:HS.default(NS.theme),dim:hi.boolean().default(NS.dim),triggers:VS.default(NS.triggers),keyboard_shortcuts:PS.default(NS.keyboard_shortcuts)}).merge(rk).default(NS),qS={auto_play:[...tS],auto_pause:[...nS],auto_mute:[...nS],auto_unmute:[],lazy_load:!0,draggable:!0,zoomable:!0,transition_effect:"slide",snapshot_click_plays_clip:!0,display_mode:"single",controls:{builtin:!0,next_previous:{size:48,style:"thumbnails"},thumbnails:aC,timeline:uC,ptz:{...JC,mode:"off"}}},WS=XC.extend({style:hi.enum(["none","thumbnails","chevrons"]).default(qS.controls.next_previous.style),size:XC.shape.size.default(qS.controls.next_previous.size)}),ZS=hi.object({auto_play:hi.enum(tS).array().default(qS.auto_play),auto_pause:hi.enum(nS).array().default(qS.auto_pause),auto_mute:hi.enum(nS).array().default(qS.auto_mute),auto_unmute:hi.enum(tS).array().default(qS.auto_unmute),lazy_load:hi.boolean().default(qS.lazy_load),draggable:hi.boolean().default(qS.draggable),zoomable:hi.boolean().default(qS.zoomable),transition_effect:rS.default(qS.transition_effect),snapshot_click_plays_clip:hi.boolean().default(qS.snapshot_click_plays_clip),display:EM,controls:hi.object({builtin:hi.boolean().default(qS.controls.builtin),next_previous:WS.default(qS.controls.next_previous),ptz:eS.extend({mode:hi.enum(["off","on"]).default(qS.controls.ptz.mode)}).default(qS.controls.ptz),thumbnails:rC.default(qS.controls.thumbnails),timeline:dC.default(qS.controls.timeline)}).default(qS.controls)}).merge(rk).default(qS),KS=hi.object({cameras:bM(Gk),cameras_global:Yk,view:US,menu:MS,status_bar:DS,live:dS,media_gallery:fS,media_viewer:ZS,image:GC,elements:DC,dimensions:gC,timeline:jS,performance:SS,debug:mC,automations:jk.optional(),profiles:ES,folders:YC.optional(),overrides:kS,card_mod:hi.unknown(),card_id:hi.string().regex(pi).optional(),remote_control:$S,type:hi.string()}),QS={cameras:Kk,view:NS,menu:bS,status_bar:LS,live:lS,media_gallery:pS,media_viewer:qS,image:Vk,timeline:hC,performance:CS,debug:pC,remote_control:AS},YS={casting:{[Pm]:!1,[fm]:!1,[Zf]:"none",[`${Xf}.enabled`]:!0,[`${Jf}.enabled`]:!0,[`${Yf}.enabled`]:!1,[`${eg}.enabled`]:!1,[Rm]:["selected","visible"],[ug]:"static",[lg]:"16:9",[lp]:1,[bf]:!0},"low-performance":{[Qm]:"none",[vm]:"none",[Pf]:"none",[of]:!1,[Tm]:!1,[zf]:!1,[zm]:[],[nm]:[],[im]:[],[am]:[],[_f]:["unselected","hidden"],[ff]:!1,[dm]:!1,[yf]:"none",[mm]:"none",[bf]:!1,[gm]:"chevrons",[ag]:"none",[Zf]:"outside",[`${Gf}.enabled`]:!1,[`${tg}.enabled`]:!1,[`${tg}.enabled`]:!1,[`${eg}.enabled`]:!1,[Gp]:!1,[Xp]:!1,[Jp]:!1,[Yp]:!1,[Xm]:!1,[Jm]:!1,[ef]:!1,[Gm]:!1,[bm]:!1,[wm]:!1,[xm]:!1,[ym]:!1,[Vf]:!1,[Bf]:!1,[Hf]:!1,[Ff]:!1,[mg]:!1,[fg]:!1,[gg]:10,[bg]:!1,[yg]:!1,[pm]:!1,[cp]:!1,[op]:"image",[lp]:10,[qp]:"none",[_g]:1},scrubbing:{[rf]:"below",[cf]:"ribbon",[sf]:"seek",[Em]:"below",[$m]:"ribbon",[Am]:"seek"}},GS=(e,t,n)=>{const i=bM(KS).safeParse(e);if(!i.success)return t;const a=i.data;for(const e of n??[])e in YS&&Object.entries(YS[e]).forEach((([e,n])=>{return r=n,void(void 0===Kx(a,i=e)&&Zx(t,i,r));var i,r}));return t},XS=e=>{const t=XS;e.getAutomationsManager().deleteAutomations(t);const n=e.getConfigManager().getConfig()?.remote_control,i=n?.entities.camera;if(!i)return;const a=n.entities.camera_priority,r=[{conditions:[{condition:"config",paths:["cameras","remote_control.entities.camera"]}],actions:[(s=e=>JS(i,e),{action:"fire-dom-event",advanced_camera_card_action:wi,callback:s,...o?.cardID&&{card_id:o.cardID}})],tag:t},{conditions:[{condition:"camera"}],actions:[Td("input_select",i,"{{ advanced_camera_card.trigger.camera.to }}")],tag:t},{conditions:[{condition:"initialized"}],actions:["entity"===a?Cd("camera_select",`{{ hass.states["${i}"].state }}`):Td("input_select",i,"{{ advanced_camera_card.camera }}")],tag:t},{conditions:[{condition:"state",entity:i}],actions:[Cd("camera_select","{{ advanced_camera_card.trigger.state.to }}")],tag:t}];var s,o;e.getAutomationsManager().addAutomations(r)},JS=async(e,t)=>{const n=t.getHASSManager().getHASS(),i=t.getCameraManager().getStore().getCameraIDs(),a=(n?.states[e]?.attributes?.options??[]).sort(),r=[...i].sort();zu(a,r)||await(n?.callService("input_select","set_options",{options:r},{entity_id:e}))},eE=e=>{const t=eE;e.getAutomationsManager().deleteAutomations(t);const n=e.getConfigManager().getConfig()?.view.keyboard_shortcuts;if(!n)return;const i=nE(t,n);i.length&&e.getAutomationsManager().addAutomations(i)},tE=e=>{switch(e){case"ptz_left":return"left";case"ptz_right":return"right";case"ptz_up":return"up";case"ptz_down":return"down";case"ptz_zoom_in":return"zoom_in";case"ptz_zoom_out":return"zoom_out"}
/* istanbul ignore next: No (current) way to reach this code -- @preserve */return null},nE=(e,t)=>{if(!t.enabled)return[];const n=[];for(const i of["ptz_down","ptz_left","ptz_right","ptz_up","ptz_zoom_in","ptz_zoom_out"]){const a=t[i],r=tE(i);a&&r&&(n.push({conditions:[{condition:"key",key:a.key,state:"down",shift:a.shift,ctrl:a.ctrl,alt:a.alt,meta:a.meta}],actions:[Ad({ptzAction:r,ptzPhase:"start"})],tag:e}),n.push({conditions:[{condition:"key",key:a.key,state:"up"}],actions:[Ad({ptzAction:r,ptzPhase:"stop"})],tag:e}))}const i=t.ptz_home;return i&&n.push({conditions:[{condition:"key",key:i.key,state:"down",shift:i.shift,ctrl:i.ctrl,alt:i.alt,meta:i.meta}],actions:[Ad()],tag:e}),n};class iE extends Xu{}class aE{constructor(e){this._overrides=new Map,this._callback=e}_clear(){this._overrides.forEach((e=>e.destroy())),this._overrides.clear()}hasOverrides(){return!!this._overrides.size}set(e,t){this._clear(),t?.forEach((t=>{const n=new dM(t.conditions,e);n.addListener(this._callback),this._overrides.set(t,n)}))}getConfig(e){let t=Yx(e),n=!1,i=!1;for(const[e,a]of this._overrides.entries())a.getEvaluation()?.result&&(e.delete?.forEach((e=>{Qx(t,e),i=!0})),Object.keys(e.set??{}).forEach((n=>{Zx(t,n,e.set?.[n])})),Object.keys(e.merge??{}).forEach((n=>{Zx(t,n,Ru({},Kx(t,n),e.merge?.[n]))})),n=!0);if(!n)return e;i&&(t=wd(t));const a=KS.safeParse(t);if(!a.success)throw new iE(Hg("error.invalid_configuration_override"),[a.error.errors,t]);return a.data}}class rE{constructor(e){this._config=null,this._overriddenConfig=null,this._rawConfig=null,this._cardWideConfig=null,this._overridesManager=new aE((()=>this._processOverrideConfig())),this._api=e}hasConfig(){return!!this.getConfig()}getConfig(){return this._overriddenConfig??this._config}getCardWideConfig(){return this._cardWideConfig}getNonOverriddenConfig(){return this._config}getRawConfig(){return this._rawConfig}setConfig(e){if(!e)throw new Error(Hg("error.invalid_configuration"));const t=KS.safeParse(e);if(!t.success){const n=Jx(e),i=wM(t.error);let a="";throw n&&(a=`${Hg("error.upgrade_available")}. `),new Error(a+`${Hg("error.invalid_configuration")}: `+(i&&i.size?JSON.stringify([...i],null," "):Hg("error.invalid_configuration_no_hint")))}const n=GS(e,t.data,t.data.profiles);var i;(this._rawConfig=e,zu(this._config,n))||(this._config=n,this._cardWideConfig={performance:n.performance,debug:n.debug},this._overridesManager.set(this._api.getConditionStateManager(),this._config.overrides),this._api.getConditionStateManager().setState({view:void 0,displayMode:void 0,camera:void 0}),this._api.getMediaLoadedInfoManager().clear(),this._api.getInitializationManager().uninitialize(_M.VIEW),this._api.getViewManager().reset(),this._api.getMessageManager().reset(),this._api.getStatusBarItemManager().removeAllDynamicStatusBarItems(),eE(this._api),XS(this._api),(i=this._api).getAutomationsManager().deleteAutomations(),i.getAutomationsManager().addAutomations(i.getConfigManager().getNonOverriddenConfig()?.automations??[]),this._processOverrideConfig(),this._api.getCardElementManager().update())}_processOverrideConfig(){const e=this._getOverriddenConfig();if(!e||zu(e,this._overriddenConfig))return;const t=this._overriddenConfig;this._overriddenConfig=e,(e=>{e.getFoldersManager().deleteFolders();try{e.getFoldersManager().addFolders(e.getConfigManager().getConfig()?.folders??[])}catch(t){e.getMessageManager().setErrorIfHigherPriority(t)}})(this._api),this._api.getStyleManager().updateFromConfig(),!t||zu(t?.cameras,this._overriddenConfig?.cameras)&&zu(t?.cameras_global,this._overriddenConfig?.cameras_global)||(this._api.getInitializationManager().uninitialize(_M.CAMERAS),this._api.getCameraManager().destroy()),t&&t?.live.microphone.always_connected!==this._overriddenConfig?.live.microphone.always_connected&&this._api.getInitializationManager().uninitialize(_M.MICROPHONE_CONNECT),this._initializeBackgroundAndUpdate(t)}_getOverriddenConfig(){
/* istanbul ignore if: No (current) way to reach this code -- @preserve */
if(!this._config)return null;try{return this._overridesManager.getConfig(this._config)}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e),null}}async _initializeBackgroundAndUpdate(e){await this._api.getDefaultManager().initializeIfNecessary(e),await this._api.getMediaPlayerManager().initializeIfNecessary(e),this._overriddenConfig&&this._api.getInitializationManager().isInitializedMandatory()&&this._api.getConditionStateManager().setState({config:this._overriddenConfig}),this._api.getCardElementManager().update()}}class sE{constructor(e){this._timer=new Dd,this._stateChangeHandler=()=>{this._setToDefaultIfAllowed()},this._api=e}async initializeIfNecessary(e){zu(e?.view.default_reset,this._api.getConfigManager().getConfig()?.view.default_reset)||await this.initialize()}async initialize(){this.uninitialize();const e=this._api.getConfigManager().getConfig()?.view.default_reset;e?.entities.length&&this._api.getHASSManager().getStateWatcher().subscribe(this._stateChangeHandler,e.entities);const t=this._api.getConfigManager().getConfig()?.view.default_reset.every_seconds;return t&&this._timer.startRepeated(t,(()=>this._setToDefaultIfAllowed())),this._api.getConfigManager().getConfig()?.view.default_reset.after_interaction&&this._api.getAutomationsManager().addAutomations([{actions:[Md("default")],conditions:[{condition:"interaction",interaction:!1}],tag:this}]),!0}uninitialize(){this._timer.stop(),this._api.getHASSManager().getStateWatcher().unsubscribe(this._stateChangeHandler),this._api.getAutomationsManager().deleteAutomations(this)}_setToDefaultIfAllowed(){this._isAutomatedUpdateAllowed()&&this._api.getViewManager().setViewDefault()}_isAutomatedUpdateAllowed(){const e=this._api.getConfigManager().getConfig()?.view.default_reset.interaction_mode;return!!e&&((e,t)=>{switch(e){case"all":return!0;case"active":return t;case"inactive":return!t}})(e,this._api.getInteractionManager().hasInteraction())}}class oE{constructor(e){this._expanded=!1,this._api=e}initialize(){this._setConditionState()}isExpanded(){return this._expanded}toggleExpanded(){this.setExpanded(!this._expanded)}setExpanded(e){e&&this._api.getFullscreenManager().isInFullscreen()&&this._api.getFullscreenManager().setFullscreen(!1),this._expanded=e,this._setConditionState(),this._api.getCardElementManager().update()}_setConditionState(){this._api.getConditionStateManager()?.setState({expand:this._expanded})}}const cE={album:{icon:"mdi:album"},app:{icon:"mdi:application"},artist:{icon:"mdi:account-music"},channel:{icon:"mdi:television-classic"},composer:{icon:"mdi:account-music-outline"},contributing_artist:{icon:"mdi:account-music"},directory:{icon:"mdi:folder"},episode:{icon:"mdi:television-classic"},game:{icon:"mdi:gamepad-variant"},genre:{icon:"mdi:drama-masks"},image:{icon:"mdi:image"},movie:{icon:"mdi:movie"},music:{icon:"mdi:music"},playlist:{icon:"mdi:playlist-music"},podcast:{icon:"mdi:podcast"},season:{icon:"mdi:television-classic"},track:{icon:"mdi:file-music"},tv_show:{icon:"mdi:television-classic"},url:{icon:"mdi:web"},video:{icon:"mdi:video"}},lE=e=>cE[e]?.icon??null;class uE extends Yd{constructor(e,t,n){super(e,{cameraID:n?.cameraID??t._metadata?.cameraID,...n}),this._browseMedia=t,this._icon=lE(t.media_class),this._id=t._metadata?.startDate&&this._cameraID?`${this._cameraID}/${Ea(t._metadata.startDate,"yyyy-MM-dd HH:mm:ss")}`:t.media_content_id}getStartTime(){return this._browseMedia._metadata?.startDate??null}getEndTime(){return this._browseMedia._metadata?.endDate??null}getVideoContentType(){return this._mediaType===Kd.Clip?Qd.MP4:null}getID(){return this._id}getContentID(){return this._browseMedia.media_content_id}getTitle(){const e=this.getStartTime();return e?cd(e):this._browseMedia.title}getThumbnail(){return this._browseMedia.thumbnail}getIcon(){return this._icon}getWhat(){return this._browseMedia._metadata?.what??null}getScore(){return null}getTags(){return null}isGroupableWith(e){return this.getMediaType()===e.getMediaType()&&zu(this.getWhat(),e.getWhat())}}class dE extends Gd{constructor(e,t){super(e,{id:t.media_content_id,icon:lE(t.children_media_class??t.media_class),title:t.title,thumbnail:t.thumbnail}),this._browseMedia=t}getBrowseMedia(){return this._browseMedia}}class hE{static create(e,t){if(e.can_expand)return t?.folder?new dE(t.folder,e):null;const n=e.media_class===e_?Kd.Clip:e.media_class===t_?Kd.Snapshot:null;return n?new uE(n,e,t):null}}const pE=(e,t)=>mE(e,t).filter((e=>Xd.isMedia(e))),mE=(e,t)=>e.map((e=>hE.create(e,{cameraID:e._metadata?.cameraID,...t}))).filter(gd);function fE(e){return!!e?.startsWith("/")}function gE(e,t){return fE(t)?e.hassUrl(t):t??null}const _E=async(e,t,n)=>{if(!t)return null;const i=await z_(e,t,n);return i?{endpoint:gE(e,i.url)}:null},vE=(e,t,n)=>{const i=t.match(e);return n?.groupName&&i?.groups?.[n.groupName]?i.groups[n.groupName]:void 0!==n?.groupNumber&&i?.[n.groupNumber]?i[n.groupNumber]:i?i[0]:null},yE="value";class bE{constructor(){this._templateRenderer=new Wx}match(e,t,n){if(n?.foldersOnly&&!t.can_expand)return!1;for(const i of n?.matchers??[])switch(i.type){case"date":case"startdate":if(!this._matchStartDate(i,t))return!1;break;case"template":if(!this._matchTemplate(e,i,t,n?.conditionState))return!1;break;case"title":if(!this._matchTitle(i,t))return!1;break;case"or":if(!i.matchers.some((i=>this.match(e,t,{foldersOnly:n?.foldersOnly,matchers:[i],conditionState:n?.conditionState}))))return!1}return!0}_matchStartDate(e,t){const n=t._metadata?.startDate;return!!n&&n>=kr(new Date,{years:e.since.years??0,months:e.since.months??0,days:e.since.days??0,hours:e.since.hours??0,minutes:e.since.minutes??0})}_matchTemplate(e,t,n,i){return!0===this._templateRenderer.renderRecursively(e,t.value_template,{conditionState:i,mediaData:{title:n.title,is_folder:n.can_expand}})}_matchTitle(e,t){const n=e.regexp?vE(e.regexp,t.title,{groupName:yE}):t.title;return!!n&&(!e.title||n===e.title)}}class wE{constructor(){this._anyDateParser=null}async prepare(e){this._anyDateParser||e?.some((e=>["date","startdate"].includes(e.type)&&!e.format))&&(this._anyDateParser=(await import("./index-a94d25a3.js")).default)}generate(e,t,n){const i={...t?._metadata};for(const a of n??[]){const n=a.regexp?vE(a.regexp,e.title,{groupName:yE}):e.title;n&&("startdate"!==a.type&&"date"!==a.type||(i.startDate=this._parseDate(a,n,t?._metadata?.startDate)??void 0))}return Object.keys(i).length>0?i:null}_parseDate(e,t,n){return e.format?this._parseFormattedDate(e.format,t,n):this._parseUnknownDate(t,n)}_parseFormattedDate(e,t,n){const i=Mr(t,e,n??new Date);return md(i)?i:void 0}_parseUnknownDate(e,t){if(!this._anyDateParser)return;const n=this._anyDateParser.attempt(e);return Object.keys(n).length?this._anyDateParser.fromObject({...t&&{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),millisecond:t.getMilliseconds()},...n}):void 0}}class xE{constructor(e){this._cache=new Jg,this._browseMediaManager=e?.browseMediaManager??new i_,this._metadataGenerator=e?.metadataGenerator??new wE,this._mediaMatcher=e?.mediaMatcher??new bE}getItemCapabilities(e){return{canFavorite:!1,canDownload:!Xd.isFolder(e)}}async getDownloadPath(e,t,n){return Xd.isMedia(t)?_E(e,t.getContentID(),n?.resolvedMediaCache):null}async favorite(e,t,n){}generateDefaultFolderQuery(e){return e.type!==zC.enum.ha?null:{folder:e,path:this.getDefaultFolderPathComponents(e.ha)}}getDefaultFolderPathComponents(e){return[...!e?.url&&!e?.path?.[0]?.id?[{id:jC}]:[],...e?.url??[],...e?.path??[]].map((e=>({ha:e})))}async expandFolder(e,t,n,i){if(t.folder.type!==zC.enum.ha)return null;const a=[...t.path];let r=null;for(;a.length>0;){const e=(a[0]?.folder instanceof dE?a[0].folder.getBrowseMedia():null)??a[0]?.ha?.id??null;if(!e)break;r=e,a.shift()}if(null===r)return null;await this._metadataGenerator.prepare(a.flatMap((e=>e.ha?.parsers??[])));const s=t=>{const i=a.shift();return[{targets:t,metadataGenerator:(e,t)=>this._metadataGenerator.generate(e,t,i?.ha?.parsers),...i&&{matcher:t=>this._mediaMatcher.match(e,t,{matchers:i.ha?.matchers,foldersOnly:a.length>0,conditionState:n}),advance:e=>a.length?s(e):[]}}]},o=await this._browseMediaManager.walk(e,s([r]),{...(i?.useCache??!0)&&{cache:this._cache}});return mE(o,{folder:t.folder})}}class ME{constructor(e){this._ha=e?.ha??new xE}generateDefaultFolderQuery(e){return this._getFolderEngine(e.type)?.generateDefaultFolderQuery(e)??null}async expandFolder(e,t,n,i){const a=await(this._getFolderEngine(t.folder.type)?.expandFolder(e,t,n,i))??null;return a?Jd(a):null}getItemCapabilities(e){return this._getFolderEngine(e.getFolder()?.type)?.getItemCapabilities(e)??null}async getDownloadPath(e,t,n){return await(this._getFolderEngine(t.getFolder()?.type)?.getDownloadPath(e,t,n)??null)}async favorite(e,t,n){return await(this._getFolderEngine(t.getFolder()?.type)?.favorite(e,t,n))}_getFolderEngine(e){return e===zC.enum.ha?this._ha:null}}class kE extends Xu{}class CE{constructor(e,t){this._folders=new Map,this._api=e,this._executor=t??new ME}deleteFolders(){this._folders.clear()}addFolders(e){for(const t of e){const e=this._folders.size,n=t.id??`folder/${e.toString()}`;if(this._folders.has(n))throw new kE(Hg("error.duplicate_folder_id"),t);this._folders.set(n,{title:`${Hg("common.folder")} ${e}`,...Il(t),id:n})}}hasFolders(){return this._folders.size>0}getFolderCount(){return this._folders.size}getFolders(){return this._folders.entries()}getFolder(e){return e?this._folders.get(e)??null:this._folders.values().next().value??null}generateDefaultFolderQuery(e){const t=e??this.getFolder();return t?this._executor.generateDefaultFolderQuery(t):null}async expandFolder(e,t,n){const i=this._api.getHASSManager().getHASS();return i?this._executor.expandFolder(i,e,t,n):null}getItemCapabilities(e){return this._executor.getItemCapabilities(e)}async getDownloadPath(e){return await this._executor.getDownloadPath(this._api.getHASSManager().getHASS(),e,{resolvedMediaCache:this._api.getResolvedMediaCache()})}async favorite(e,t){return await this._executor.favorite(this._api.getHASSManager().getHASS(),e,t)}}const SE=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],EE=(()=>{if("undefined"==typeof document)return!1;const e=SE[0],t={};for(const n of SE){const i=n?.[1];if(i in document){for(const[i,a]of n.entries())t[e[i]]=a;return t}}return!1})(),AE={change:EE.fullscreenchange,error:EE.fullscreenerror};let TE={request:(e=document.documentElement,t)=>new Promise(((n,i)=>{const a=()=>{TE.off("change",a),n()};TE.on("change",a);const r=e[EE.requestFullscreen](t);r instanceof Promise&&r.then(a).catch(i)})),exit:()=>new Promise(((e,t)=>{if(!TE.isFullscreen)return void e();const n=()=>{TE.off("change",n),e()};TE.on("change",n);const i=document[EE.exitFullscreen]();i instanceof Promise&&i.then(n).catch(t)})),toggle:(e,t)=>TE.isFullscreen?TE.exit():TE.request(e,t),onchange(e){TE.on("change",e)},onerror(e){TE.on("error",e)},on(e,t){const n=AE[e];n&&document.addEventListener(n,t,!1)},off(e,t){const n=AE[e];n&&document.removeEventListener(n,t,!1)},raw:EE};Object.defineProperties(TE,{isFullscreen:{get:()=>Boolean(document[EE.fullscreenElement])},element:{enumerable:!0,get:()=>document[EE.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>Boolean(document[EE.fullscreenEnabled])}}),EE||(TE={isEnabled:!1});var $E=TE;class IE{constructor(e,t){this._api=e,this._handler=t}}class OE extends IE{connect(){$E.isEnabled&&$E.on("change",this._handler)}disconnect(){$E.isEnabled&&$E.off("change",this._handler)}isInFullscreen(){return $E.isEnabled&&$E.isFullscreen}isSupported(){return $E.isEnabled}setFullscreen(e){this.isSupported()&&(e?$E.request(this._api.getCardElementManager().getElement()):$E.exit())}}class LE extends IE{constructor(){super(...arguments),this._playTimer=new Dd,this._stateChangeHandler=e=>{if(e.old.mediaLoadedInfo?.mediaPlayerController?.getFullscreenElement()!==e.new.mediaLoadedInfo?.mediaPlayerController?.getFullscreenElement()){const t=e.old.mediaLoadedInfo?.mediaPlayerController?.getFullscreenElement();t?.removeEventListener("webkitbeginfullscreen",this._handler),t?.removeEventListener("webkitendfullscreen",this._endHandler);const n=e.new.mediaLoadedInfo?.mediaPlayerController?.getFullscreenElement();n?.addEventListener("webkitbeginfullscreen",this._handler),n?.addEventListener("webkitendfullscreen",this._endHandler)}},this._endHandler=()=>{this._handler(),this._playTimer.start(.5,(()=>{this._getVideoElement()?.play()}))}}connect(){this._api.getConditionStateManager().addListener(this._stateChangeHandler)}disconnect(){this._api.getConditionStateManager().removeListener(this._stateChangeHandler)}_getVideoElement(){const e=this._api.getMediaLoadedInfoManager().get()?.mediaPlayerController?.getFullscreenElement();return e instanceof HTMLVideoElement?e:null}isInFullscreen(){return!!this._getVideoElement()?.webkitDisplayingFullscreen}isSupported(){return!!this._getVideoElement()?.webkitSupportsFullscreen}setFullscreen(e){if(!this.isSupported())return;const t=this._getVideoElement();e?t?.webkitEnterFullscreen?.():t?.webkitExitFullscreen?.()}}class DE{static create(e,t){if($E.isEnabled)return new OE(e,t);return document.createElement("video").webkitEnterFullscreen?new LE(e,t):null}}class jE{constructor(e,t){this._fullscreenHandler=()=>{this._api.getExpandManager().setExpanded(!1),this._setConditionState(),this._api.getCardElementManager().update()},this._api=e,this._provider=t??DE.create(e,this._fullscreenHandler)}connect(){this._provider?.connect()}disconnect(){this._provider?.disconnect()}setFullscreen(e){this._provider?.setFullscreen(e)}isInFullscreen(){return this._provider?.isInFullscreen()??!1}isSupported(){return!mM()&&(this._provider?.isSupported()??!1)}initialize(){this._setConditionState()}toggleFullscreen(){this._provider?.isInFullscreen()?this._provider.setFullscreen(!1):this._provider?.setFullscreen(!0)}_setConditionState(){this._api.getConditionStateManager()?.setState({fullscreen:this.isInFullscreen()})}}function zE(e,t,n,i){if(!e||!n?.length)return[];const a=[];for(const r of n){const n=t?.states[r],s=e.states[r];if((i?.stateOnly&&n?.state!==s?.state||!i?.stateOnly&&n!==s)&&(a.push({entityID:r,oldState:n,newState:s}),i?.firstOnly))break}return a}class RE{constructor(){this._watcherCallbacks=new Map}setHASS(e,t){if(e)for(const[n,i]of this._watcherCallbacks.entries()){const a=zE(t,e,i,{stateOnly:!0,firstOnly:!0});a.length&&n(a[0])}}subscribe(e,t){return!!t.length&&(this._watcherCallbacks.has(e)?this._watcherCallbacks.get(e)?.push(...t):this._watcherCallbacks.set(e,t),!0)}unsubscribe(e){this._watcherCallbacks.delete(e)}}class PE{constructor(e){this._hass=null,this._stateWatcher=new RE,this._api=e}getHASS(){return this._hass}hasHASS(){return!!this._hass}getStateWatcher(){return this._stateWatcher}setHASS(e){if(((e,t)=>e?.connected!==t?.connected)(this._hass,e)&&(e?.connected?this._api.getMessageManager().resetType("connection"):this._api.getMessageManager().setMessageIfHigherPriority({message:Hg("error.reconnecting"),icon:"mdi:lan-disconnect",type:"connection",dotdotdot:!0})),!e)return;const t=this._hass;this._hass=e,this._api.getConditionStateManager().setState({hass:this._hass}),this._api.getStyleManager().applyTheme(),this._stateWatcher.setHASS(t,e)}}class NE{constructor(e){this._timer=new Dd,this._interacted=!1,this.reportInteraction=Wu((()=>{this._reportInteraction()}),1e3),this._api=e}initialize(){this._setInteraction(!1)}hasInteraction(){return this._interacted}_setInteraction(e){this._interacted=e,fd(this._api.getCardElementManager().getElement(),e,"interaction"),this._api.getConditionStateManager().setState({interaction:e})}_reportInteraction(){this._timer.stop(),this._setInteraction(!0);const e=this._api.getConfigManager().getConfig()?.view.interaction_seconds;e&&this._timer.start(e,(()=>{this._setInteraction(!1)}))}}class FE{constructor(e){this._state={},this._handleKeydown=e=>{const t={state:"down",ctrl:e.ctrlKey,alt:e.altKey,meta:e.metaKey,shift:e.shiftKey};zu(this._state[e.key],t)||(this._state[e.key]=t,this._processStateChange())},this._handleKeyup=e=>{e.key in this._state&&"down"===this._state[e.key].state&&(this._state[e.key].state="up",this._processStateChange())},this._handleBlur=()=>{Object.keys(this._state).length&&(this._state={},this._processStateChange())},this._api=e}initialize(){const e=this._api.getCardElementManager().getElement();e.addEventListener("keydown",this._handleKeydown),e.addEventListener("keyup",this._handleKeyup),e.addEventListener("blur",this._handleBlur)}uninitialize(){const e=this._api.getCardElementManager().getElement();e.removeEventListener("keydown",this._handleKeydown),e.removeEventListener("keyup",this._handleKeyup),e.removeEventListener("blur",this._handleBlur)}_processStateChange(){this._api.getConditionStateManager().setState({keys:this._state})}}function VE(e,t,n,i){e.dispatchEvent(new CustomEvent(`advanced-camera-card:${t}`,{bubbles:i?.bubbles??!0,composed:i?.composed??!0,cancelable:i?.cancelable??!1,detail:n}))}function BE(e,t){let n;return n=e instanceof Event?e.composedPath()[0]:e,n instanceof HTMLImageElement?{width:n.naturalWidth,height:n.naturalHeight,...t}:n instanceof HTMLVideoElement?{width:n.videoWidth,height:n.videoHeight,...t}:n instanceof HTMLCanvasElement?{width:n.width,height:n.height,mediaPlayerController:t?.mediaPlayerController,...t}:null}function HE(e,t,n){const i=BE(t,n);i&&UE(e,i)}function UE(e,t){VE(e,"media:loaded",t)}function qE(e){VE(e,"media:unloaded")}function WE(e){VE(e,"media:volumechange")}function ZE(e){VE(e,"media:play")}function KE(e){VE(e,"media:pause")}class QE{constructor(e){this._current=null,this._lastKnown=null,this._api=e}initialize(){this.clear()}set(e){var t;(t=e).height>=50&&t.width>=50&&(qg(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card media load: ",e),this._current=e,this._lastKnown=e,this._api.getConditionStateManager().setState({mediaLoadedInfo:e}),this._api.getStyleManager().setExpandedMode(),this._api.getCardElementManager().update())}get(){return this._current}getLastKnown(){return this._lastKnown}clear(){this._current=null,this._api.getConditionStateManager().setState({mediaLoadedInfo:null})}has(){return!!this._current}}const YE=(e,t)=>!!((e.attributes.supported_features??0)&t);class GE{constructor(e){this._mediaPlayers=[],this._api=e}getMediaPlayers(){return this._mediaPlayers}hasMediaPlayers(){return this._mediaPlayers.length>0}async initializeIfNecessary(e){e?.menu.buttons.media_player.enabled!==this._api.getConfigManager().getConfig()?.menu.buttons.media_player.enabled&&await this.initialize()}async initialize(){const e=this._api.getHASSManager().getHASS();if(!e||!this._api.getConfigManager().getConfig()?.menu.buttons.media_player.enabled)return!1;const t=Object.keys(e.states).filter((t=>{if(t.startsWith("media_player.")){const n=e.states[t];if(n&&"unavailable"!==n.state&&YE(n,131072))return!0}return!1}));let n=null;try{n=await this._api.getEntityRegistryManager().getEntities(e,t)}catch(e){sd(e)}return this._mediaPlayers=t.filter((e=>{const t=n?.get(e);return!t||!t.hidden_by})),!0}async stop(e){const t=this._api.getHASSManager().getHASS(),n=t?.states[e];if(!n)return;let i;if(YE(n,4096))i="media_stop";else{if(!YE(n,256))return;i="turn_off"}await t.callService("media_player",i,{entity_id:e})}async playLive(e,t){const n=this._api.getCameraManager().getStore().getCameraConfig(t);n&&("dashboard"===n.cast?.method?await this._playLiveDashboard(e,n):await this._playLiveStandard(e,t,n))}async _playLiveStandard(e,t,n){const i=this._api.getHASSManager().getHASS(),a=n?.camera_entity??null;if(!i||!a)return;const r=this._api.getCameraManager().getCameraMetadata(t)?.title??null,s=i.states[a]?.attributes?.entity_picture??null;await i.callService("media_player","play_media",{entity_id:e,media_content_id:`media-source://camera/${a}`,media_content_type:"application/vnd.apple.mpegurl",extra:{...r&&{title:r},...s&&{thumb:s}}})}async _playLiveDashboard(e,t){const n=this._api.getHASSManager().getHASS();if(!n)return;const i=t.cast?.dashboard;i?.dashboard_path&&i?.view_path?await n.callService("cast","show_lovelace_view",{entity_id:e,dashboard_path:i.dashboard_path,view_path:i.view_path}):this._api.getMessageManager().setMessageIfHigherPriority({type:"error",icon:"mdi:cast",message:Hg("error.no_dashboard_or_view")})}async playMedia(e,t){const n=this._api.getHASSManager().getHASS();if(!n||!t)return;const i=t.getTitle(),a=t.getThumbnail();await n.callService("media_player","play_media",{entity_id:e,media_content_id:t.getContentID(),media_content_type:Xd.isVideo(t)?"video":"image",extra:{...i&&{title:i},...a&&{thumb:a}}})}}const XE={info:10,error:20,connection:30,diagnostics:40};class JE{constructor(e){this._message=null,this._api=e}getMessage(){return this._message}hasMessage(){return!!this._message}hasErrorMessage(){return"error"===this._message?.type}reset(){const e=this.hasMessage();this._message=null,e&&this._api.getCardElementManager().update()}resetType(e){this._message?.type===e&&this.reset()}setErrorIfHigherPriority(e,t){e&&"object"==typeof e&&"message"in e&&(sd(e),this.setMessageIfHigherPriority({message:t?`${t}: ${e.message}`:String(e.message),type:"error",...e instanceof Xu&&{context:e.context}}))}setMessageIfHigherPriority(e){const t=e=>e.type??"info",n=this._message?XE[t(this._message)]:0,i=XE[t(e)];return!(this._message&&i<n)&&(this._message=e,this._api.getMediaLoadedInfoManager().clear(),this._api.getCardElementManager().scrollReset(),this._api.getCardElementManager().update(),!0)}}class eA{constructor(e){this._timer=new Dd,this._state={connected:!1,muted:!0,forbidden:!1},this._desireMute=!0,this._api=e}getState(){return this._state}initialize(){this._setState()}shouldConnectOnInitialization(){return!!this._api.getConfigManager().getConfig()?.live.microphone?.always_connected&&this.isSupported()}isSupported(){return!!navigator.mediaDevices?.getUserMedia}async connect(){if(!this.isSupported())return!1;try{this._stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}catch(e){return sd(e),this._stream=null,this._setState(),!1}return this._setDesiredMuteOnStream(),this._setState(),!0}disconnect(){this._stream?.getTracks().forEach((e=>e.stop())),this._stream=void 0,this._setState()}getStream(){return this._stream??void 0}mute(){this._desireMute=!0,this._setDesiredMuteOnStream(),this._setState()}async unmute(){this.isSupported()&&(this._desireMute=!1,this.isConnected()||this.isForbidden()?this.isConnected()&&(this._setDesiredMuteOnStream(),this._setState()):await this.connect())}isConnected(){return!!this._stream}isForbidden(){return null===this._stream}isMuted(){return!this._stream||this._stream.getTracks().every((e=>!e.enabled))}_setDesiredMuteOnStream(){this._stream?.getTracks().forEach((e=>{e.enabled=!this._desireMute})),this._startDisconnectTimer()}_startDisconnectTimer(){const e=this._api.getConfigManager().getConfig()?.live.microphone;if(e?.always_connected)return;const t=e?.disconnect_seconds??0;t&&this._timer.start(t,(()=>{this.disconnect()}))}_setState(){this._state={stream:this._stream,connected:this.isConnected(),muted:this.isMuted(),forbidden:this.isForbidden()},this._api.getConditionStateManager().setState({microphone:this._state}),this._api.getCardElementManager().update()}}class tA{constructor(e){this._shouldRun=!0,this.requestExecution=()=>{this._shouldRun=!0,this._api.getCardElementManager().update()},this.executeIfNecessary=async()=>{this._shouldRun&&(this._shouldRun=!1,await this._executeViewRelated(this._calculateIntent()),await this._executeNonViewRelated(this._calculateIntent()))},this._isViewAction=e=>{switch(e.advanced_camera_card_action){case"clip":case"clips":case"diagnostics":case"image":case"live":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":return!0}return!1},this._api=e}hasViewRelatedActionsToRun(){return!!this._calculateIntent().view&&this._shouldRun}async _executeViewRelated(e){e.view&&(e.view.default?await this._api.getViewManager().setViewDefaultWithNewQuery({params:{camera:e.view.camera},...e.view.substream&&{modifiers:[new Gv(e.view.substream)]}}):await this._api.getViewManager().setViewByParametersWithNewQuery({params:{...e.view.view&&{view:e.view.view},...e.view.camera&&{camera:e.view.camera}},...e.view.substream&&{modifiers:[new Gv(e.view.substream)]}}))}async _executeNonViewRelated(e){e.other&&await this._api.getActionsManager().executeActions({actions:e.other})}_calculateIntent(){const e={};for(const t of this._getActions())this._isViewAction(t)?((e.view??={}).view=t.advanced_camera_card_action,(e.view??={}).default=void 0):"default"===t.advanced_camera_card_action?((e.view??={}).default=!0,(e.view??={}).view=void 0):"camera_select"===t.advanced_camera_card_action?(e.view??={}).camera=t.camera:"live_substream_select"===t.advanced_camera_card_action?(e.view??={}).substream=t.camera:(e.other??=[]).push(t);return e}_getActions(){const e=new URLSearchParams(window.location.search),t=[],n=new RegExp(/^(advanced-camera-card|frigate-card)-action([.:](?<cardID>\w+))?[.:](?<action>\w+)/);for(const[i,a]of e.entries()){const e=i.match(n);if(!e||!e.groups)continue;const r=e.groups.cardID,s=e.groups.action;let o=null;switch(s){case"camera_select":case"live_substream_select":a&&(o=Cd(s,a,{cardID:r}));break;case"camera_ui":case"default":case"download":case"expand":case"menu_toggle":o=Md(s,{cardID:r});break;case"clip":case"clips":case"diagnostics":case"image":case"live":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":o=kd(s,{cardID:r});break;default:console.warn(`Advanced Camera Card received unknown card action in query string: ${s}`)}o&&t.push(o)}return t}}class nA{constructor(e){this._items=[],this._dynamicItems=[],this._api=e}addDynamicStatusBarItem(e){this._dynamicItems.includes(e)||this._dynamicItems.push(e),this._api.getCardElementManager().update()}removeDynamicStatusBarItem(e){this._dynamicItems=this._dynamicItems.filter((t=>!zu(t,e))),this._api.getCardElementManager().update()}removeAllDynamicStatusBarItems(){this._dynamicItems=[],this._api.getCardElementManager().update()}calculateItems(e){const t=e?.view?e?.cameraManager?.getCameraMetadata(e?.view?.camera):null,n=t?.engineIcon??null,i=e?.view?.is("live")?t?.title??null:e?.view?.isViewerView()?e?.view.queryResults?.getSelectedResult()?.getTitle()??null:null,a=e?.mediaLoadedInfo?this._calculateResolution(e?.mediaLoadedInfo):null,r=e?.mediaLoadedInfo?.technology?.length?e?.mediaLoadedInfo.technology[0]:null;return[...i?[{type:"custom:advanced-camera-card-status-bar-string",string:i,expand:!0,sufficient:!0,...e?.statusConfig?.items.title}]:[],...a?[{type:"custom:advanced-camera-card-status-bar-string",string:a,...e?.statusConfig?.items.resolution}]:[],...r&&"webrtc"===r?[{type:"custom:advanced-camera-card-status-bar-icon",icon:"mdi:webrtc",...e?.statusConfig?.items.technology}]:r?[{type:"custom:advanced-camera-card-status-bar-string",string:r.toUpperCase(),...e?.statusConfig?.items.technology}]:[],...n?[{type:"custom:advanced-camera-card-status-bar-icon",icon:n,...e?.statusConfig?.items.engine}]:[],...this._dynamicItems]}_matchesWidthHeight(e,t,n){const i=.99*t,a=1.01*t,r=.99*n,s=1.01*n,o=(e,t,n)=>e>=t&&e<=n;return!!e&&(o(e.width,i,a)&&o(e.height,r,s)||o(e.height,i,a)&&o(e.width,r,s))}_calculateResolution(e){return this._matchesWidthHeight(e,1920,1080)?"1080p":this._matchesWidthHeight(e,1280,720)?"720p":this._matchesWidthHeight(e,640,480)?"VGA":this._matchesWidthHeight(e,3840,2160)?"4K":this._matchesWidthHeight(e,720,480)?"480p":this._matchesWidthHeight(e,720,576)?"576p":this._matchesWidthHeight(e,7680,4320)?"8K":`${e.width}x${e.height}`}}class iA{constructor(e){this._api=e}setExpandedMode(){const e=this._api.getCardElementManager().getElement(),t=this._api.getViewManager().getView(),n=this._api.getMediaLoadedInfoManager().getLastKnown();e.style.setProperty("--advanced-camera-card-expand-aspect-ratio",t?.isAnyMediaView()&&n?`${n.width} / ${n.height}`:"unset");const i=t?.isGrid();e.style.setProperty("--advanced-camera-card-expand-width",!i&&t?.isAnyMediaView()?"none":"var(--advanced-camera-card-expand-max-width)"),e.style.setProperty("--advanced-camera-card-expand-height",!i&&t?.isAnyMediaView()?"none":"var(--advanced-camera-card-expand-max-height)")}updateFromConfig(){this.applyTheme(),this._setMinMaxHeight(),this._setPerformance(),this._setDimmable()}applyTheme(){const e=this._api.getConfigManager().getConfig()?.view.theme;if(!e)return;const t=this._api.getCardElementManager().getElement(),n=this._getThemeNames(e);if(fd(t,!!n,"themes",n?.join(" ")),e.overrides)for(const[n,i]of Object.entries(e.overrides))t.style.setProperty(n,i)}_getThemeNames(e){return e.themes.length?e.themes:QS.view.theme.themes}_setDimmable(){const e=this._api.getConfigManager().getConfig();fd(this._api.getCardElementManager().getElement(),!!e?.view.dim,"dimmable")}_setMinMaxHeight(){const e=this._api.getConfigManager().getConfig();if(e){this._api.getCardElementManager().getElement().style.setProperty("--advanced-camera-card-height",e.dimensions.height)}}_setPerformance(){const e={box_shadow:"none",border_radius:"0px"},t=this._api.getCardElementManager().getElement(),n=this._api.getConfigManager().getCardWideConfig()?.performance,i=n?.style??{};for(const n of Object.keys(i)){const a=`--advanced-camera-card-css-${n.replaceAll("_","-")}`;!1===i[n]?t.style.setProperty(a,e[n]):t.style.removeProperty(a)}}_isAspectRatioEnforced(e,t){const n=e.dimensions.aspect_ratio_mode;return!(this._api.getFullscreenManager().isInFullscreen()||this._api.getExpandManager().isExpanded()||"unconstrained"===n||"dynamic"===n&&(!t||t?.isAnyMediaView()||t?.is("timeline")||t?.is("diagnostics")))}getAspectRatioStyle(){const e=this._api.getConfigManager().getConfig(),t=this._api.getViewManager().getView();if(e){if(!this._isAspectRatioEnforced(e,t))return bd();const n=e.dimensions.aspect_ratio_mode,i=this._api.getMediaLoadedInfoManager().getLastKnown();return bd(i&&"dynamic"===n?{ratio:[i.width,i.height]}:{ratio:e.dimensions.aspect_ratio})}return bd({defaultStatic:!0})}}class aA{constructor(e){this._triggeredCameras=new Map,this._triggeredCameraTimers=new Map,this._throttledTriggerAction=Wu(this._triggerAction.bind(this),1e3,{trailing:!0}),this._api=e}getTriggeredCameraIDs(){return new Set(this._triggeredCameras.keys())}isTriggered(){return!!this._triggeredCameras.size}getMostRecentlyTriggeredCameraID(){const e=Vu([...this._triggeredCameras.entries()],(e=>e[1].getTime()),"desc");return e.length?e[0][0]:null}async handleCameraEvent(e){const t=this._api.getConfigManager().getConfig()?.view.triggers,n=this._api.getViewManager().getView()?.camera;if(!t||!n)return;const i=this._api.getCameraManager().getStore().getAllDependentCameras(n);t.filter_selected_camera&&!i.has(e.cameraID)||("end"!==e.type?(this._triggeredCameras.set(e.cameraID,new Date),this._setConditionStateIfNecessary(),await this._throttledTriggerAction(e)):this._startUntriggerTimer(e.cameraID))}_hasAllowableInteractionStateForAction(){const e=this._api.getConfigManager().getConfig()?.view.triggers,t=this._api.getInteractionManager().hasInteraction();return!!e&&("all"===e.actions.interaction_mode||"active"===e.actions.interaction_mode&&t||"inactive"===e.actions.interaction_mode&&!t)}async _triggerAction(e){const t=this._api.getConfigManager().getConfig()?.view.triggers.actions.trigger,n=this._api.getConfigManager().getConfig()?.view.default;("high"!==e.fidelity||e.snapshot||e.clip||"live"===t||"default"===t&&"live"===n)&&(this._hasAllowableInteractionStateForAction()&&("update"===t?await this._api.getViewManager().setViewByParametersWithNewQuery({queryExecutorOptions:{useCache:!1}}):"live"===t?await this._api.getViewManager().setViewByParametersWithNewQuery({params:{view:"live",camera:e.cameraID}}):"default"===t?await this._api.getViewManager().setViewDefaultWithNewQuery({params:{camera:e.cameraID}}):"high"===e.fidelity&&"media"===t&&await this._api.getViewManager().setViewByParametersWithNewQuery({params:{view:e.clip?"clip":"snapshot",camera:e.cameraID}})),this._api.getCardElementManager().update())}_setConditionStateIfNecessary(){const e=new Set(this._triggeredCameras.keys()),t=e.size?e:void 0;this._api.getConditionStateManager().setState({triggered:t})}async _untriggerAction(e){const t=this._api.getConfigManager().getConfig()?.view.triggers.actions.untrigger;"default"===t&&this._hasAllowableInteractionStateForAction()&&await this._api.getViewManager().setViewDefaultWithNewQuery(),this._triggeredCameras.delete(e),this._deleteTimer(e),this._setConditionStateIfNecessary(),this._api.getCardElementManager().update()}_startUntriggerTimer(e){this._deleteTimer(e);const t=new Dd;this._triggeredCameraTimers.set(e,t),t.start(
/* istanbul ignore next: the case of config being null here cannot be
           reached, as there's no way to have the untrigger call happen without
           a config. -- @preserve */
this._api.getConfigManager().getConfig()?.view.triggers.untrigger_seconds??0,(async()=>{await this._untriggerAction(e)}))}_deleteTimer(e){this._triggeredCameraTimers.get(e)?.stop(),this._triggeredCameraTimers.delete(e)}}async function rA(e,t,n){const i={type:"auth/sign_path",path:t,expires:n},a=await Zg(e,ed,i);return a?e.hassUrl(a.path):null}var sA;!function(e){e.Camera="camera",e.Folder="folder"}(sA||(sA={}));class oA{constructor(e){this._api=e}getCapabilities(e){const t=this._getMediaSource(e);return t===sA.Camera&&Xd.isMedia(e)?this._api.getCameraManager().getMediaCapabilities(e):t===sA.Folder?this._api.getFoldersManager().getItemCapabilities(e):null}async download(e){try{await this._download(e)}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e),!1}return!0}async favorite(e,t){const n=this._getMediaSource(e);return n===sA.Camera&&Xd.isMedia(e)?await this._api.getCameraManager().favoriteMedia(e,t):
/* istanbul ignore else: this path cannot be reached -- @preserve */
n===sA.Folder?this._api.getFoldersManager().favorite(e,t):void 0}_getMediaSource(e){return Xd.isMedia(e)&&e.getCameraID()?sA.Camera:Xd.isFolder(e)||e.getFolder()?sA.Folder:null
/* istanbul ignore next: this path cannot be reached -- @preserve */}async _download(e){const t=this._api.getHASSManager().getHASS();if(!t)return;const n=this._getMediaSource(e),i=n===sA.Camera&&Xd.isMedia(e)?await this._api.getCameraManager().getMediaDownloadPath(e):n===sA.Folder?await this._api.getFoldersManager().getDownloadPath(e):null;if(!i)throw new Xu(Hg("error.download_no_media"));let a=i.endpoint;if(i.sign){let e;try{e=await rA(t,i.endpoint)}catch(e){sd(e)}if(!e)throw new Xu(Hg("error.download_sign_failed"));a=e}Nv(a,this._generateDownloadFilename(e))}_generateDownloadFilename(e){const t=e=>e.toLowerCase().replaceAll(/[^a-z0-9]/gi,"-");if(Xd.isMedia(e)){const n=e.getCameraID(),i=e.getID(),a=e.getStartTime();return(n?t(n):"media")+(i?`_${t(i)}`:"")+(a?`_${Ea(a,"yyyy-MM-dd-HH-mm-ss")}`:"")+"."+("clip"===e.getMediaType()?"mp4":"jpg")}
/* istanbul ignore else: this path cannot be reached -- @preserve */return Xd.isFolder(e)?t(e.getTitle()??"media"):"download"
/* istanbul ignore next: this path cannot be reached -- @preserve */}}class cA{static isEventQuery(e){return e instanceof G_}static isRecordingQuery(e){return e instanceof X_}static isMediaQuery(e){return this.isEventQuery(e)||this.isRecordingQuery(e)}static isFolderQuery(e){return e instanceof J_}static isClipsQuery(e){return this.isEventQuery(e)&&!!e?.getQuery()?.every((e=>e.hasClip))}static isSnapshotQuery(e){return this.isEventQuery(e)&&!!e?.getQuery()?.every((e=>e.hasSnapshot))}static getQueryType(e){return this.isEventQuery(e)?"event":this.isRecordingQuery(e)?"recording":this.isFolderQuery(e)?"folder":null}static getMediaType(e){return this.isClipsQuery(e)?"clips":this.isSnapshotQuery(e)?"snapshots":this.isRecordingQuery(e)?"recordings":null}}const lA=(e,t,n)=>{const i={anyCapabilities:["clips","snapshots","recordings"]};switch(t){case"diagnostics":case"image":case"folder":case"folders":case"media":return e.getStore().getCameraIDs();case"live":case"clip":case"clips":case"snapshot":case"snapshots":case"recording":case"recordings":const a="clip"===t?"clips":"snapshot"===t?"snapshots":"recording"===t?"recordings":t;return n?e.getStore().getAllDependentCameras(n,a):e.getStore().getCameraIDsWithCapability(a);case"timeline":return e.getStore().getCameraIDsWithCapability(i)}},uA=(e,t)=>Ru({},e,t);class dA{constructor(e){this.view=e.view,this.camera=e.camera,this.query=e.query??null,this.queryResults=e.queryResults??null,this.context=e.context??null,this.displayMode=e.displayMode??null}clone(){return new dA({view:this.view,camera:this.camera,query:this.query?.clone()??null,queryResults:this.queryResults?.clone()??null,context:this.context,displayMode:this.displayMode})}evolve(e){return new dA({view:void 0!==e.view?e.view:this.view,camera:void 0!==e.camera?e.camera:this.camera,query:void 0!==e.query?e.query:this.query?.clone()??null,queryResults:void 0!==e.queryResults?e.queryResults:this.queryResults?.clone()??null,context:void 0!==e.context?e.context:this.context,displayMode:void 0!==e.displayMode?e.displayMode:this.displayMode})}mergeInContext(e){return this.context=uA(this.context,e),this}removeContext(e){return this.context&&delete this.context[e],this}removeContextProperty(e,t){const n=this.context?.[e];return n&&delete n[t],this}is(e){return this.view==e}isMediaGalleryView(){return["clips","folders","snapshots","recordings"].includes(this.view)}isAnyMediaView(){return this.isViewerView()||this.is("live")||this.is("image")}isAnyFolderView(){return["folder","folders"].includes(this.view)}isViewerView(){return["folder","media","clip","snapshot","recording"].includes(this.view)}supportsMultipleDisplayModes(){return this.isViewerView()||this.is("live")}getDefaultMediaType(){return["clip","clips"].includes(this.view)?"clips":["snapshot","snapshots"].includes(this.view)?"snapshots":["recording","recordings"].includes(this.view)?"recordings":null}isGrid(){return"grid"===this.displayMode}}const hA=(e,t)=>{t?.forEach((t=>t.modify(e)))};class pA extends Xu{}class mA extends Xu{}class fA{constructor(e){this._api=e}getViewDefault(e){const t=this._api.getConfigManager().getConfig();if(!t)return null;let n=null;const i=e?.params?.view??t.view.default;if(e?.params?.camera)n=e.params.camera;else{const a=[...lA(this._api.getCameraManager(),i)];if(a.length&&e?.baseView?.camera&&t.view.default_cycle_camera){const t=a.indexOf(e.baseView.camera);n=a[t+1>=a.length?0:t+1]}else n=a[0]??null}return this.getViewByParameters({params:{...e?.params,view:i,camera:n},baseView:e?.baseView})}getViewByParameters(e){const t=this._api.getConfigManager().getConfig();if(!t)return null;let n=e?.params?.camera??e?.baseView?.camera??null,i=e?.params?.view??e?.baseView?.view??t.view.default;const a=this._api.getCameraManager().getStore().getCameraIDs();if(!n||!a.has(n)){n=lA(this._api.getCameraManager(),i).keys().next().value??null}if(!n){const e=[...this._api.getCameraManager().getStore().getCameras()].reduce(((e,[t,n])=>{const i=n.getCapabilities()?.getRawCapabilities();return i&&(e[t]=i),e}),{});throw new pA(Hg("error.no_supported_cameras"),{view:i,cameras_capabilities:e})}if(!this.isViewSupportedByCamera(n,i)){if(!e?.failSafe||!this.isViewSupportedByCamera(n,_i)){const e=this._api.getCameraManager().getStore().getCamera(n)?.getCapabilities()?.getRawCapabilities();throw new mA(Hg("error.no_supported_camera"),{view:i,camera:n,...e&&{camera_capabilities:e}})}i=_i}const r=this._getDefaultDisplayModeForView(i,t),s=(i!==e?.baseView?.view?r:null)??e?.params?.displayMode??e?.baseView?.displayMode??r??"single",o={...e?.params,view:i,camera:n,displayMode:s},c=e?.baseView?e.baseView.evolve(o):new dA(o);return hA(c,e?.modifiers),c}isViewSupportedByCamera(e,t){return!!lA(this._api.getCameraManager(),t,e).size}_getDefaultDisplayModeForView(e,t){let n=null;switch(e){case"media":case"clip":case"recording":case"snapshot":n=t.media_viewer.display?.mode??null;break;case"live":n=t.live.display?.mode??null}return n}}class gA{constructor(e,t){this._key=e,this._property=t}modify(e){e.removeContextProperty(this._key,this._property)}}class _A{constructor(e){this._query=e?.query,this._queryResults=e?.queryResults}modify(e){void 0!==this._query&&(e.query=this._query),void 0!==this._queryResults&&(e.queryResults=this._queryResults)}}const vA=(e,t,n)=>{let i;for(const[a,r]of e.entries()){if(!Xd.isMedia(r))continue;const e=r.getStartTime(),s=r.getUsableEndTime();if(r.includesTime(t)&&e&&s){const t=s.getTime()-e.getTime();(!i||n&&i.cameraID!==n&&r.getCameraID()===n||t>i.duration&&(!n||i.cameraID!==n||r.getCameraID()===n))&&(i={index:a,duration:t,cameraID:r.getCameraID()})}}return i?i.index:null};class yA{constructor(e){this._results=e?.results??[],this._selectedIndex=this._getInitialSelectedIndex(e)}_getInitialSelectedIndex(e){return null!=e?.selectedIndex?e.selectedIndex:e?.results&&e.results.length?e?.selectApproach&&"last"!==e?.selectApproach?0:e.results.length-1:null}clone(){return new yA({results:this._results,selectedIndex:this._selectedIndex})}getResults(){return this._results}getSelectedIndex(){return this._selectedIndex}getResultsCount(){return this.getResults().length}hasResults(){return 0!==this.getResultsCount()}getResult(e){return void 0===e?null:this._results[e]}getSelectedResult(){const e=this.getSelectedIndex();return null!==e?this.getResult(e):null}hasSelectedResult(){return null!==this.getSelectedResult()}resetSelectedResult(){this._selectedIndex=null}selectIndex(e){(null===e||e>=0&&e<this._results.length)&&(this._selectedIndex=e)}selectResultIfFound(e){for(const[t,n]of this._results.entries())if(e(n)){this.selectIndex(t);break}}selectBestResult(e){const t=e(this._results);null!==t&&this.selectIndex(t)}}class bA{constructor(e){this._resultsTimestamp=null,this._cameras=new Map,this._resultsTimestamp=new Date,this._main=new yA(e),this._buildByCameraSlices(e?.selectApproach)}_buildByCameraSlices(e){const t=new Map;for(const e of this._main.getResults()){const n=Xd.isMedia(e)?e.getCameraID():null;if(n){const i=t.get(n)??[];i.push(e),t.set(n,i)}}for(const[n,i]of t.entries())this._cameras.set(n,new yA({results:i,selectApproach:e}))}clone(){const e=new bA;e._resultsTimestamp=this._resultsTimestamp,e._main=this._main.clone();for(const[t,n]of this._cameras.entries())e._cameras.set(t,n.clone());return e}isSupersetOf(e){const t=new Set(this._main.getResults()?.map((e=>e.getID()))),n=new Set(e._main.getResults()?.map((e=>e.getID())));return!(!t.size||!n.size||t.has(null)||n.has(null))&&((e,t)=>{for(const n of t)if(!e.has(n))return!1;return!0})(t,n)}getCameraIDs(){return new Set(this._cameras.keys())}getSlice(e){return e?this._cameras.get(e)??null:this._main}getResults(e){return this.getSlice(e)?.getResults()??null}getResultsCount(e){return this.getSlice(e)?.getResultsCount()??0}hasResults(e){return 0!==this.getSlice(e)?.getResultsCount()}getResult(e,t){return this.getSlice(t)?.getResult(e)??null}getSelectedIndex(e){return this.getSlice(e)?.getSelectedIndex()??null}getSelectedResult(e){return this.getSlice(e)?.getSelectedResult()??null}getMultipleSelectedResults(e){const t=[];if(!e||e.main){const e=this.getSelectedResult();e&&t.push(e)}const n=this._getCameraIDsFromCriteria(e);for(const e of n??[]){const n=this.getSelectedResult(e);n&&t.push(n)}return t}hasSelectedResult(e){return this.getSlice(e)?.hasSelectedResult()??!1}resetSelectedResult(e){return this.getSlice(e)?.resetSelectedResult(),this}getResultsTimestamp(){return this._resultsTimestamp}selectIndex(e,t){return this.getSlice(t)?.selectIndex(e),t||this.demoteMainSelectionToCameraSelection(),this}demoteMainSelectionToCameraSelection(){const e=this.getSelectedResult(),t=Xd.isMedia(e)?e?.getCameraID():null;return e&&t&&(this.resetSelectedResult(t),this.selectResultIfFound((t=>t===e),{cameraID:t})),this}promoteCameraSelectionToMainSelection(e){const t=this.getSelectedResult(e);return this.resetSelectedResult(),this.selectResultIfFound((e=>e===t)),this}_getCameraIDsFromCriteria(e){return e?.allCameras?this.getCameraIDs():e?.cameraID?new Set([e.cameraID]):null}selectResultIfFound(e,t){t&&!t?.main||(this._main.selectResultIfFound(e),this.demoteMainSelectionToCameraSelection());const n=this._getCameraIDsFromCriteria(t);for(const t of n??[])this.getSlice(t)?.selectResultIfFound(e);return this}selectBestResult(e,t){t&&!t.main||(this._main.selectBestResult(e),this.demoteMainSelectionToCameraSelection());const n=this._getCameraIDsFromCriteria(t);for(const t of n??[])this.getSlice(t)?.selectBestResult(e);return this}}class wA{constructor(e){this._api=e}async executeDefaultEventQuery(e){const t=e?.eventsMediaType&&"all"!==e?.eventsMediaType?e.eventsMediaType:{anyCapabilities:["clips","snapshots"]},n=this._api.getCameraManager(),i=e?.cameraID?n.getStore().getAllDependentCameras(e.cameraID,t):n.getStore().getCameraIDsWithCapability(t);if(!i.size)return null;const a=n.generateDefaultEventQueries(i,{limit:this._getChunkLimit(),..."clips"===e?.eventsMediaType&&{hasClip:!0},..."snapshots"===e?.eventsMediaType&&{hasSnapshot:!0}});if(!a)return null;const r=new G_(a);return await this.executeMediaQuery(r,e?.executorOptions)}async executeDefaultRecordingQuery(e){const t=this._api.getCameraManager(),n=e?.cameraID?t.getStore().getAllDependentCameras(e.cameraID,"recordings"):t.getStore().getCameraIDsWithCapability("recordings");if(!n.size)return null;const i=t.generateDefaultRecordingQueries(n,{limit:this._getChunkLimit()});if(!i)return null;const a=new X_(i);return await this.executeMediaQuery(a,e?.executorOptions)}async executeQuery(e,t){
/* istanbul ignore else: this path cannot be reached -- @preserve */
return cA.isMediaQuery(e)?await this.executeMediaQuery(e,t):cA.isFolderQuery(e)?await this._executeFolderQuery(e,t):null
/* istanbul ignore next: this path cannot be reached -- @preserve */}async executeMediaQuery(e,t){const n=e.getQuery();if(!n)return null;const i=await this._api.getCameraManager().executeMediaQueries(n,{useCache:t?.useCache}),a=i?this._generateQueriesResults(i,t):null;return a?{query:e,queryResults:a}:null}_generateQueriesResults(e,t){const n=new bA({results:e});return t?.rejectResults?.(n)?null:(t?.selectResult?.id?n.selectBestResult((e=>e.findIndex((e=>e.getID()===t.selectResult?.id)))):t?.selectResult?.func?n.selectResultIfFound(t.selectResult.func):t?.selectResult?.time&&n.selectBestResult((e=>vA(e,t.selectResult?.time?.time,t.selectResult?.time?.favorCameraID))),n)}async executeDefaultFolderQuery(e){const t=this._api.getFoldersManager().generateDefaultFolderQuery();return t?this._executeFolderQuery(new J_(t),e):null}async _executeFolderQuery(e,t){const n=e.getQuery();if(!n)return null;const i=await this._api.getFoldersManager().expandFolder(n,this._api.getConditionStateManager().getState(),{useCache:t?.useCache}),a=i?this._generateQueriesResults(i,t):null;return a?{query:e,queryResults:a}:null}_getChunkLimit(){const e=this._api.getConfigManager().getCardWideConfig();return e?.performance?.features.media_chunk_size??50}}class xA{constructor(e,t){this._api=e,this._executor=t??new wA(e)}async getExistingQueryModifiers(e,t){return e.query?[new _A({queryResults:(await this._executor.executeQuery(e.query,t))?.queryResults})]:[]}async getNewQueryModifiers(e,t){return await this._executeNewQuery(e,{useCache:!1,...t})}async _executeNewQuery(e,t){const n=this._api.getConfigManager().getConfig();if(!n)return null;const i=e?.getDefaultMediaType(),a=[],r=async n=>{
/* istanbul ignore if: this path cannot be reached -- @preserve */
if(!n)return[];const i="recordings"===n?await this._executor.executeDefaultRecordingQuery({...!e.isGrid()&&{cameraID:e.camera},executorOptions:t}):"clips"===n||"snapshots"===n||"all"===n?await this._executor.executeDefaultEventQuery({...!e.isGrid()&&{cameraID:e.camera},eventsMediaType:n,executorOptions:t}):/* istanbul ignore next -- @preserve */
null;return i?[new _A(i)]:[]},s=async()=>{const e=await this._executor.executeDefaultFolderQuery(t);return e?[new _A(e)]:[]};switch(e.view){case"live":"none"!==n.live.controls.thumbnails.mode&&a.push(...await r("recordings"===n.live.controls.thumbnails.media_type?"recordings":n.live.controls.thumbnails.events_media_type));break;case"media":a.push(...await r("clips"));break;case"clip":case"clips":case"snapshot":case"snapshots":case"recording":case"recordings":a.push(...await r(i));break;case"folder":case"folders":a.push(...await s())}return a.push(...this._getTimelineWindowViewModifier(e)),a.push(...this._getSeekTimeModifier(t?.selectResult?.time?.time)),a}_getTimelineWindowViewModifier(e){if(e.is("live")){const e=new Date,t=this._api.getConfigManager().getConfig()?.live;
/* istanbul ignore if: this if branch cannot be reached as if the config is
               empty this function is never called -- @preserve */
return t?[new Iv({timeline:{window:{start:kr(e,{seconds:t.controls.timeline.window_seconds}),end:e}}})]:[]}return[new gA("timeline","window")]}_getSeekTimeModifier(e){return e?[new Iv({mediaViewer:{seek:e}})]:[new gA("mediaViewer","seek")]}}class MA{constructor(e,t){this._view=null,this._epoch=this._createEpoch(),this._loadingIndex=1,this.setViewDefault=e=>this._setViewGeneric(this._viewFactory.getViewDefault.bind(this._viewFactory),e),this.setViewByParameters=e=>this._setViewGeneric(this._viewFactory.getViewByParameters.bind(this._viewFactory),e),this.setViewDefaultWithNewQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewDefault.bind(this._viewFactory),this._viewQueryExecutor.getNewQueryModifiers.bind(this._viewQueryExecutor),e),this.setViewByParametersWithNewQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewByParameters.bind(this._viewFactory),this._viewQueryExecutor.getNewQueryModifiers.bind(this._viewQueryExecutor),e),this.setViewByParametersWithExistingQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewByParameters.bind(this._viewFactory),this._viewQueryExecutor.getExistingQueryModifiers.bind(this._viewQueryExecutor),e),this.initialize=async()=>(this._api.getQueryStringManager().hasViewRelatedActionsToRun()||this.setViewDefaultWithNewQuery({failSafe:!0}),!0),this._api=e,this._viewFactory=t?.viewFactory??new fA(e),this._viewQueryExecutor=t?.viewQueryExecutor??new xA(e)}getEpoch(){return this._epoch}_createEpoch(e){return{manager:this,...e&&{oldView:e}}}getView(){return this._view}hasView(){return!!this.getView()}reset(){this._view&&this._setView(null)}_setViewGeneric(e,t){if(!this._isAllowedToSetView())return;let n=null;try{n=e({baseView:this._view,...t})}catch(e){this._api.getMessageManager().setErrorIfHigherPriority(e)}n&&this._setView(n)}_markViewLoadingQuery(e,t){return e.mergeInContext({loading:{query:t}})}_markViewAsNotLoadingQuery(e){return e.removeContextProperty("loading","query")}_isAllowedToSetView(){return this._api.getInitializationManager().isInitialized(_M.CAMERAS)}async _setViewThenModifyAsync(e,t,n){if(!this._isAllowedToSetView())return;let i=null;try{i=e({baseView:this._view,...n,params:{query:null,queryResults:null,...n?.params}})}catch(e){this._api.getMessageManager().setErrorIfHigherPriority(e)}if(!i)return;if(this._view&&this._shouldAdoptQueryAndResults(i))return i.query=this._view.query,i.queryResults=this._view.queryResults,this._markViewAsNotLoadingQuery(i),void this._setView(i);const a=this._loadingIndex++;this._markViewLoadingQuery(i,a),this._setView(i);let r=null,s=null;try{r=await t(i,n?.queryExecutorOptions)}catch(e){s=e}if(this._view&&this.hasMajorMediaChange(this._view,i))return void(this._view.context?.loading?.query===a&&this._setView(this._markViewAsNotLoadingQuery(this._view.clone())));if(s)return void this._api.getMessageManager().setErrorIfHigherPriority(s);
/* istanbul ignore if: the if path cannot be reached as the view is set
        above -- @preserve */if(!this._view)return;const o=this._view.clone();this._view.context?.loading?.query===a&&this._markViewAsNotLoadingQuery(o),hA(o,r),this._setView(o)}_shouldAdoptQueryAndResults(e){const t=this._view?.isViewerView()&&e?.isMediaGalleryView(),n=e?.getDefaultMediaType(),i=cA.getMediaType(this._view?.query)===n;return!!t&&i}setViewWithMergedContext(e){if(this._view)return this._setView(this._view?.clone().mergeInContext(e))}isViewSupportedByCamera(e,t){return!!lA(this._api.getCameraManager(),t,e).size}hasMajorMediaChange(e,t){const n=t??this._view;return!!e!=!!n||e?.view!==n?.view||e?.camera!==n?.camera||"live"===n?.view&&e&&av(e)!==av(n)||"live"!==n?.view&&e?.queryResults!==n?.queryResults}_setView(e){const t=this._view;qg(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card view change: ",e),this._view=e,this._epoch=this._createEpoch(t),this.hasMajorMediaChange(t)&&this._api.getMediaLoadedInfoManager().clear(),t?.view!==e?.view&&this._api.getCardElementManager().scrollReset(),this._api.getMessageManager().reset(),this._api.getStyleManager().setExpandedMode(),this._api.getConditionStateManager()?.setState({view:e?.view,camera:e?.camera,displayMode:e?.displayMode??void 0}),this._api.getCardElementManager().update()}}class kA{constructor(e,t,n){this._conditionStateManager=new M_,this._deviceRegistryManager=new E_(new S_),this._entityRegistryManager=new I_(new $_),this._resolvedMediaCache=new j_,this._actionsManager=new uy(this,new Wx),this._automationsManager=new hM(this),this._cameraManager=new x_(this),this._cameraURLManager=new pM(this),this._configManager=new rE(this),this._defaultManager=new sE(this),this._expandManager=new oE(this),this._foldersManager=new CE(this),this._fullscreenManager=new jE(this),this._hassManager=new PE(this),this._initializationManager=new vM(this),this._interactionManager=new NE(this),this._keyboardStateManager=new FE(this),this._mediaLoadedInfoManager=new QE(this),this._mediaPlayerManager=new GE(this),this._messageManager=new JE(this),this._microphoneManager=new eA(this),this._queryStringManager=new tA(this),this._statusBarItemManager=new nA(this),this._styleManager=new iA(this),this._triggersManager=new aA(this),this._viewManager=new MA(this),this._viewItemManager=new oA(this),e.addController(this),this._cardElementManager=new yM(this,e,t,n)}getActionsManager(){return this._actionsManager}getAutomationsManager(){return this._automationsManager}getCameraManager(){return this._cameraManager}createCameraManager(){this._cameraManager=new x_(this)}getCameraURLManager(){return this._cameraURLManager}getCardElementManager(){return this._cardElementManager}getConditionStateManager(){return this._conditionStateManager}static async getConfigElement(){return await import("./editor-913fbdd2.js"),document.createElement("advanced-camera-card-editor")}getConfigManager(){return this._configManager}getDefaultManager(){return this._defaultManager}getDeviceRegistryManager(){return this._deviceRegistryManager}getEntityRegistryManager(){return this._entityRegistryManager}getExpandManager(){return this._expandManager}getFoldersManager(){return this._foldersManager}getFullscreenManager(){return this._fullscreenManager}getHASSManager(){return this._hassManager}getInitializationManager(){return this._initializationManager}getInteractionManager(){return this._interactionManager}getKeyboardStateManager(){return this._keyboardStateManager}getMediaLoadedInfoManager(){return this._mediaLoadedInfoManager}getMediaPlayerManager(){return this._mediaPlayerManager}getMessageManager(){return this._messageManager}getMicrophoneManager(){return this._microphoneManager}createMicrophoneManager(){this._microphoneManager=new eA(this)}getQueryStringManager(){return this._queryStringManager}getResolvedMediaCache(){return this._resolvedMediaCache}getStatusBarItemManager(){return this._statusBarItemManager}static getStubConfig(e){return{cameras:[{camera_entity:e.find((e=>e.startsWith("camera.")))??"camera.demo"}]}}getStyleManager(){return this._styleManager}getTriggersManager(){return this._triggersManager}getViewManager(){return this._viewManager}getViewItemManager(){return this._viewItemManager}hostConnected(){this.getCardElementManager().elementConnected()}hostDisconnected(){this.getCardElementManager().elementDisconnected()}}function CA(e,t){return t?e?.states[t]?.attributes?.friendly_name??null:null}class SA{constructor(){this._dynamicMenuButtons=[]}addDynamicMenuButton(e){this._dynamicMenuButtons.includes(e)||this._dynamicMenuButtons.push(e)}removeDynamicMenuButton(e){this._dynamicMenuButtons=this._dynamicMenuButtons.filter((t=>t!=e))}calculateButtons(e,t,n,i){return[this._getIrisButton(t),this._getCamerasButton(t,n,i?.view),this._getSubstreamsButton(t,n,i?.view),this._getLiveButton(t,i?.view,i?.viewManager),this._getClipsButton(t,i?.view,i?.viewManager),this._getSnapshotsButton(t,i?.view,i?.viewManager),this._getRecordingsButton(t,i?.view,i?.viewManager),this._getImageButton(t,i?.view,i?.viewManager),this._getTimelineButton(t,i?.view,i?.viewManager),this._getDownloadButton(t,n,i?.view),this._getCameraUIButton(t,i?.showCameraUIButton),this._getMicrophoneButton(t,i?.microphoneManager,i?.currentMediaLoadedInfo),this._getExpandButton(t,i?.inExpandedMode),this._getFullscreenButton(t,i?.fullscreenManager),this._getCastButton(e,t,n,i?.view,i?.mediaPlayerController),this._getPlayPauseButton(t,i?.currentMediaLoadedInfo),this._getMuteUnmuteButton(t,i?.currentMediaLoadedInfo),this._getScreenshotButton(t,i?.currentMediaLoadedInfo),this._getDisplayModeButton(t,n,i?.view),this._getPTZControlsButton(t,n,i?.view),this._getPTZHomeButton(t,n,i?.view),this._getFoldersButton(t,i?.foldersManager,i?.view),...this._dynamicMenuButtons.map((e=>({style:this._getStyleFromActions(t,e,i),...e})))].filter(gd)}_getIrisButton(e){return{icon:"iris",...e.menu.buttons.iris,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.iris"),permanent:!0,tap_action:"hidden"===e.menu?.style?Md("menu_toggle"):Md("default"),hold_action:kd("diagnostics")}}_getCamerasButton(e,t,n){const i=t.getStore().getCameraIDsWithCapability("menu");if(i.size>1){const a=Array.from(i,(e=>{const i=Cd("camera_select",e),a=t.getCameraMetadata(e);return{enabled:!0,icon:a?.icon.icon,entity:a?.icon.entity,state_color:!0,title:a?.title,selected:n?.camera===e,...i&&{tap_action:i}}}));return{icon:"mdi:video-switch",...e.menu.buttons.cameras,type:"custom:advanced-camera-card-menu-submenu",title:Hg("config.menu.buttons.cameras"),items:a}}return null}_getSubstreamsButton(e,t,n){if(!n)return null;const i=t.getStore().getAllDependentCameras(n.camera,"substream");if(i.size&&n.is("live")){const a=[...i].filter((e=>e!==n.camera)),r=[n.camera,...a],s=av(n);if(2===r.length)return{icon:"mdi:video-input-component",style:s!==n.camera?this._getEmphasizedStyle():{},title:Hg("config.menu.buttons.substreams"),...e.menu.buttons.substreams,type:"custom:advanced-camera-card-menu-icon",tap_action:Md(rv(n)?"live_substream_off":"live_substream_on")};if(r.length>2){const i=Array.from(r,(e=>{const n=Cd("live_substream_select",e),i=t.getCameraMetadata(e)??void 0;return{enabled:!0,icon:i?.icon.icon,entity:i?.icon.entity,state_color:!0,title:i?.title,selected:s===e,...n&&{tap_action:n}}}));return{icon:"mdi:video-input-component",title:Hg("config.menu.buttons.substreams"),style:s!==n.camera?this._getEmphasizedStyle():{},...e.menu.buttons.substreams,type:"custom:advanced-camera-card-menu-submenu",items:i}}}return null}_getLiveButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"live")?{icon:"mdi:cctv",...e.menu.buttons.live,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.live"),style:t.is("live")?this._getEmphasizedStyle():{},tap_action:kd("live")}:null}_getClipsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"clips")?{icon:"mdi:filmstrip",...e.menu.buttons.clips,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.clips"),style:t?.is("clips")?this._getEmphasizedStyle():{},tap_action:kd("clips"),hold_action:kd("clip")}:null}_getSnapshotsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"snapshots")?{icon:"mdi:camera",...e.menu.buttons.snapshots,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.snapshots"),style:t?.is("snapshots")?this._getEmphasizedStyle():{},tap_action:kd("snapshots"),hold_action:kd("snapshot")}:null}_getRecordingsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"recordings")?{icon:"mdi:album",...e.menu.buttons.recordings,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.recordings"),style:t.is("recordings")?this._getEmphasizedStyle():{},tap_action:kd("recordings"),hold_action:kd("recording")}:null}_getImageButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"image")?{icon:"mdi:image",...e.menu.buttons.image,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.image"),style:t?.is("image")?this._getEmphasizedStyle():{},tap_action:kd("image")}:null}_getTimelineButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"timeline")?{icon:"mdi:chart-gantt",...e.menu.buttons.timeline,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.view.views.timeline"),style:t.is("timeline")?this._getEmphasizedStyle():{},tap_action:kd("timeline")}:null}_getDownloadButton(e,t,n){const i=n?.queryResults?.getSelectedResult(),a=i&&Xd.isMedia(i)?t?.getMediaCapabilities(i):null;return n?.isViewerView()&&a?.canDownload&&!mM()?{icon:"mdi:download",...e.menu.buttons.download,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.download"),tap_action:Md("download")}:null}_getCameraUIButton(e,t){return t?{icon:"mdi:web",...e.menu.buttons.camera_ui,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.camera_ui"),tap_action:Md("camera_ui")}:null}_getMicrophoneButton(e,t,n){if(t&&n?.capabilities?.supports2WayAudio){const n=t.isForbidden()||!t.isSupported(),i=t.isMuted(),a=e.menu.buttons.microphone.type;return{icon:n?"mdi:microphone-message-off":i?"mdi:microphone-off":"mdi:microphone",...e.menu.buttons.microphone,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.microphone"),style:n||i?{}:this._getEmphasizedStyle(!0),...!n&&"momentary"===a&&{start_tap_action:Md("microphone_unmute"),end_tap_action:Md("microphone_mute")},...!n&&"toggle"===a&&{tap_action:Md(i?"microphone_unmute":"microphone_mute")}}}return null}_getExpandButton(e,t){return{icon:t?"mdi:arrow-collapse-all":"mdi:arrow-expand-all",...e.menu.buttons.expand,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.expand"),tap_action:Md("expand"),style:t?this._getEmphasizedStyle():{}}}_getFullscreenButton(e,t){const n=t?.isInFullscreen();return t?.isSupported()?{icon:n?"mdi:fullscreen-exit":"mdi:fullscreen",...e.menu.buttons.fullscreen,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.fullscreen"),tap_action:Md("fullscreen"),style:n?this._getEmphasizedStyle():{}}:null}_getCastButton(e,t,n,i,a){if(!i)return null;const r=n.getStore().getCameraConfig(i.camera);if(a?.hasMediaPlayers()&&(i.isViewerView()||i.is("live")&&r?.camera_entity)){const n=a.getMediaPlayers().map((t=>{const n=CA(e,t)||t,i=e.states[t],a=Ed(t,"play"),r=Ed(t,"stop"),s=!i||"unavailable"===i.state;return{enabled:!0,selected:!1,entity:t,state_color:!1,title:n,disabled:s,...!s&&a&&{tap_action:a},...!s&&r&&{hold_action:r}}}));return{icon:"mdi:cast",...t.menu.buttons.media_player,type:"custom:advanced-camera-card-menu-submenu",title:Hg("config.menu.buttons.media_player"),items:n}}return null}_getPlayPauseButton(e,t){if(t&&t.mediaPlayerController&&t.capabilities?.supportsPause){const n=t.mediaPlayerController?.isPaused();return{icon:n?"mdi:play":"mdi:pause",...e.menu.buttons.play,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.play"),tap_action:Md(n?"play":"pause")}}return null}_getMuteUnmuteButton(e,t){if(t&&t.mediaPlayerController&&t?.capabilities?.hasAudio){const n=t.mediaPlayerController?.isMuted();return{icon:n?"mdi:volume-off":"mdi:volume-high",...e.menu.buttons.mute,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.mute"),tap_action:Md(n?"unmute":"mute")}}return null}_getScreenshotButton(e,t){return t&&t.mediaPlayerController?{icon:"mdi:monitor-screenshot",...e.menu.buttons.screenshot,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.screenshot"),tap_action:Md("screenshot")}:null}_getDisplayModeButton(e,t,n){const i=n?lA(t,n.view):null;if(n?.supportsMultipleDisplayModes()&&i&&i.size>1){const t=n.isGrid();return{icon:t?"mdi:grid-off":"mdi:grid",...e.menu.buttons.display_mode,style:t?this._getEmphasizedStyle():{},type:"custom:advanced-camera-card-menu-icon",title:Hg(t?"display_modes.single":"display_modes.grid"),tap_action:(a=t?"single":"grid",{action:"fire-dom-event",advanced_camera_card_action:"display_mode_select",display_mode:a,...r?.cardID&&{card_id:r.cardID}})}}var a,r;return null}_getPTZControlsButton(e,t,n){const i=n?.is("live")?e.live.controls.ptz:n?.isViewerView()?e.media_viewer.controls.ptz:null;if(!n||!i)return null;const a=bv(n,{cameraManager:t});if(a){const t=void 0!==n.context?.ptzControls?.enabled?n.context.ptzControls.enabled:"on"===i.mode||"auto"===i.mode&&"ptz"===a.type;return{icon:"mdi:pan",...e.menu.buttons.ptz_controls,style:t?this._getEmphasizedStyle():{},type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.ptz_controls"),tap_action:(r=!t,{action:"fire-dom-event",advanced_camera_card_action:"ptz_controls",enabled:r,...s?.cardID&&{card_id:s.cardID}})}}var r,s;return null}_getPTZHomeButton(e,t,n){const i=n?bv(n,{cameraManager:t}):null;return!i||(("digital"===i.type&&n?.context?.zoom?.[i.targetID]?.observed?.isDefault)??1)?null:{icon:"mdi:home",...e.menu.buttons.ptz_home,type:"custom:advanced-camera-card-menu-icon",title:Hg("config.menu.buttons.ptz_home"),tap_action:Ad({targetID:i.targetID})}}_getFoldersButton(e,t,n){const i=[...t?.getFolders()??[]];if(!i?.length)return null;if(1===i.length){const t=cA.isFolderQuery(n?.query)&&n.query.getQuery()?.folder.id===i[0][0],a=i[0][1];return{icon:a.icon??"mdi:folder",...e.menu.buttons.folders,type:"custom:advanced-camera-card-menu-icon",title:a.title??Hg("config.menu.buttons.folders"),style:t?this._getEmphasizedStyle():{},tap_action:Sd("folders"),hold_action:Sd("folder")}}const a=i.map((([e,t])=>{const i=cA.isFolderQuery(n?.query)&&n.query.getQuery()?.folder.id===e;return{enabled:!0,title:t.title??t.id,icon:t.icon??"mdi:folder",selected:i,style:i?this._getEmphasizedStyle():{},tap_action:Sd("folders",{folderID:e}),hold_action:Sd("folder",{folderID:e})}}));return{icon:"mdi:folder-multiple",...e.menu.buttons.folders,type:"custom:advanced-camera-card-menu-submenu",title:Hg("config.menu.buttons.folders"),items:a,style:n?.isAnyFolderView()?this._getEmphasizedStyle():{}}}_getEmphasizedStyle(e){return e?{animation:"pulse 3s infinite",color:"var(--advanced-camera-card-menu-button-critical-color)"}:{color:"var(--advanced-camera-card-menu-button-active-color)"}}_getStyleFromActions(e,t,n){for(const i of[t.tap_action,t.double_tap_action,t.hold_action,t.start_tap_action,t.end_tap_action])for(const t of id(i))if(Od(t)&&(vi.some((e=>e===t.advanced_camera_card_action&&n?.view?.is(t.advanced_camera_card_action)))||"default"===t.advanced_camera_card_action&&n?.view?.is(e.view.default)||"fullscreen"===t.advanced_camera_card_action&&n?.fullscreenManager?.isInFullscreen()||"camera_select"===t.advanced_camera_card_action&&n?.view?.camera===t.camera))return this._getEmphasizedStyle();return{}}}const EA=(e,t)=>{t instanceof Error&&VE(e,"message",{message:t.message,type:"error",...t instanceof Xu&&{context:t.context}})};class AA extends Event{constructor(e){super("advanced-camera-card:condition-state-manager:get",e)}}let TA=class extends oe{constructor(){super(...arguments),this._root=null}createRenderRoot(){return this}_createRoot(){const e=customElements.get("hui-conditional-element");if(!e||!this.hass)throw new Error(Hg("error.could_not_render_elements"));const t=new e;t.hass=this.hass;const n={type:"conditional",conditions:[],elements:this.elements};try{t.setConfig(n)}catch(e){throw sd(e,console.error),new Xu(Hg("error.invalid_elements_config"))}return t}willUpdate(e){try{!this.elements||this._root&&!e.has("elements")||(this._root=this._createRoot())}catch(e){return EA(this,e)}}render(){return U`${this._root||""}`}updated(){this.hass&&this._root&&(this._root.hass=this.hass)}};e([he({attribute:!1})],TA.prototype,"elements",void 0),e([he({attribute:!1})],TA.prototype,"hass",void 0),TA=e([le("advanced-camera-card-elements-core")],TA);let $A=class extends oe{constructor(){super(...arguments),this._menuRemoveHandler=e=>{VE(this,"menu:remove",e.detail)},this._statusBarRemoveHandler=e=>{VE(this,"status-bar:remove",e.detail)},this._menuAddHandler=e=>{const t=e.composedPath();t.length&&this._addHandler(t[0],"advanced-camera-card:menu:remove",this._menuRemoveHandler)},this._statusBarAddHandler=e=>{const t=e.composedPath();t.length&&this._addHandler(t[0],"advanced-camera-card:status-bar:add",this._statusBarRemoveHandler)}}_addHandler(e,t,n){e.removeEventListener(t,n),e.addEventListener(t,n)}connectedCallback(){super.connectedCallback(),this.addEventListener("advanced-camera-card:menu:add",this._menuAddHandler),this.addEventListener("advanced-camera-card:status-bar:add",this._statusBarAddHandler)}disconnectedCallback(){this.removeEventListener("advanced-camera-card:menu:add",this._menuAddHandler),this.addEventListener("advanced-camera-card:status-bar:add",this._statusBarAddHandler),super.disconnectedCallback()}render(){return U`<advanced-camera-card-elements-core
      .hass=${this.hass}
      .elements=${this.elements}
    >
    </advanced-camera-card-elements-core>`}static get styles(){return s(":host {\n  position: absolute;\n  inset: 0;\n  overflow: hidden;\n  pointer-events: none;\n}\n\n.element {\n  position: absolute;\n  transform: translate(-50%, -50%);\n  pointer-events: auto;\n}\n\nhui-error-card.element {\n  inset: 0px;\n  transform: unset;\n}")}};e([he({attribute:!1})],$A.prototype,"hass",void 0),e([he({attribute:!1})],$A.prototype,"elements",void 0),$A=e([le("advanced-camera-card-elements")],$A);let IA=class extends oe{constructor(){super(...arguments),this._conditionManager=null}setConfig(e){this._config=e,this._createConditionManager()}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this.className="",this._createConditionManager()}disconnectedCallback(){this._conditionManager?.destroy(),super.disconnectedCallback()}_createConditionManager(){const e=function(e){const t=new AA({bubbles:!0,composed:!0});return e.dispatchEvent(t),t.conditionStateManager??null}(this);this._config&&e&&(this._conditionManager?.destroy(),this._conditionManager=new dM(this._config.conditions,e),this._conditionManager.addListener((()=>this.requestUpdate())))}render(){if(this._conditionManager?.getEvaluation()?.result)return U` <advanced-camera-card-elements-core
        .hass=${this.hass}
        .elements=${this._config?.elements}
      >
      </advanced-camera-card-elements-core>`}};e([he({attribute:!1,hasChanged:()=>!0})],IA.prototype,"hass",void 0),IA=e([le("advanced-camera-card-conditional")],IA);class OA extends oe{constructor(e){super(),this._config=null,this._eventCategory=e}setConfig(e){this._config=e}connectedCallback(){super.connectedCallback(),this._config&&VE(this,`${this._eventCategory}:add`,this._config)}disconnectedCallback(){this._config&&VE(this,`${this._eventCategory}:remove`,this._config),super.disconnectedCallback()}}e([pe()],OA.prototype,"_config",void 0);class LA extends OA{constructor(){super("menu")}}let DA=class extends LA{};DA=e([le("advanced-camera-card-menu-icon")],DA);let jA=class extends LA{};jA=e([le("advanced-camera-card-menu-state-icon")],jA);let zA=class extends LA{};zA=e([le("advanced-camera-card-menu-submenu")],zA);let RA=class extends LA{};RA=e([le("advanced-camera-card-menu-submenu-select")],RA);class PA extends OA{constructor(){super("status-bar")}}let NA=class extends PA{};NA=e([le("advanced-camera-card-status-bar-icon")],NA);let FA=class extends PA{};FA=e([le("advanced-camera-card-status-bar-image")],FA);let VA=class extends PA{};VA=e([le("advanced-camera-card-status-bar-string")],VA);var BA="Wed, 04 Jun 2025 03:28:50 GMT",HA="13e43b8",UA="Tue, 3 Jun 2025 20:27:40 -0700";const qA=hi.object({domain:hi.string(),version:hi.string().optional()}).passthrough(),WA="hass_web_proxy",ZA=(e,t)=>`/api/${WA}/v${t??0}/?url=${encodeURIComponent(e)}`,KA=(e,t,n="media")=>(e=>e.config.components.includes(WA))(e)&&!!t[n];async function QA(e,t,n){await e.callService(WA,"create_proxied_url",{url_pattern:t,...n&&{url_id:n.urlID,ssl_verification:n.sslVerification,ssl_ciphers:n.sslCiphers,open_limit:n.openLimit,ttl:n.ttl,allow_unauthenticated:n.allowUnauthenticated}})}const YA=async(e,t)=>{let n=null;if(t)try{n=await(async(e,t)=>await Zg(e,qA,{type:"manifest/get",integration:t}))(t,e)}catch(e){}return{detected:!!n,...n?.version&&{version:n.version}}};class GA{getCustomIcon(e){switch(e?.icon){case"frigate":return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.876 22.744c.087.692.812 1.163.379 1.271-.433.109-2.327-3.436-2.76-4.952-.433-1.515-.677-3.22-.569-4.194.109-.974 5.71-2.49 5.71-2.895 0-.406-1.813-.028-1.894-.352-.081-.325 1.37-.13 1.759-.65.609-.811 1.38-.676 1.867-1.11.487-.432 1.082-2.083 1.19-2.786.109-.704-1.082-1.516-1.407-2.057-.324-.541.704-.92 3.194-1.948C14.835 2.042 22.735-.231 22.844.04c.108.27-2.598 1.407-4.492 2.11-1.894.704-4.98 2.057-4.98 2.436s.163.677.055 1.543c-.108.866-.121 1.27-.325 1.84-.135.379-.27 1.272 0 2.083.217.65.92 1.137 1.245 1.245.27.018 1.017.043 1.84 0 1.028-.054 2.49.054 2.49.325 0 .27-2.22.108-2.22.487s2.274-.054 2.22.325c-.054.378-1.895.216-2.869.216-.78 0-1.93-.036-2.435-.216l-.108.378c-.18 0-.558.109-.948.109-.487 0-.514.162-1.407.162s-.622-.054-1.434-.108c-.812-.054-3.842 2.273-4.384 3.03-.54.758-.216 2.598-.216 3.437 0 .754-.108 2.436 0 3.302z" fill="#000" style="fill:#fff;fill-opacity:1;stroke:none;stroke-width:.1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/></svg>';case"motioneye":return'<svg xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><linearGradient id="d"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:#585858;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="b"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:gray;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="a"><stop style="stop-color:#4aa3e0;stop-opacity:1" offset="0"/><stop style="stop-color:#3096db;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="c"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:#585858;stop-opacity:1" offset="1"/></linearGradient><linearGradient xlink:href="#a" id="i" x1="26.602" y1="43.035" x2="26.602" y2="29.466" gradientUnits="userSpaceOnUse" gradientTransform="matrix(.96429 0 0 .96429 .914 .914)"/><linearGradient xlink:href="#b" id="e" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><linearGradient xlink:href="#c" id="f" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><linearGradient xlink:href="#d" id="g" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><filter style="color-interpolation-filters:sRGB" id="h" x="-.02" y="-.14" width="1.041" height="1.208"><feFlood flood-opacity=".588" flood-color="#000" result="flood"/><feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1"/><feGaussianBlur in="composite1" stdDeviation=".2" result="blur"/><feOffset dy="-.5" result="offset"/><feComposite in="SourceGraphic" in2="offset" result="composite2"/></filter></defs><path d="M8.935 40.515C5.365 36.547 3.2 31.358 3.2 25.6c0-12.371 10.029-22.4 22.4-22.4C37.971 3.2 48 13.229 48 25.6c0 5.737-2.161 10.952-5.708 14.915-1.696-.623-3.388-1.349-5.061-2.288a7.777 7.777 0 0 0 5.6-7.458c0-4.26-3.47-7.754-7.754-7.754-3.634 0-6.69 2.51-7.539 5.87h-3.876a7.784 7.784 0 0 0-7.539-5.87c-4.284 0-7.78 3.494-7.78 7.754 0 3.561 2.456 6.586 5.76 7.485-1.675.912-3.404 1.62-5.168 2.261zM25.6 26.462c.533-1.982 1.102-3.948 3.446-5.17L25.6 16.123l-3.446 5.17c2.053 1.454 3 3.237 3.446 5.169z" style="fill:url(#e);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path d="M16.123 33.354a2.585 2.585 0 1 1 0-5.17 2.585 2.585 0 0 1 0 5.17z" style="fill:url(#f);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path d="M35.077 33.354a2.585 2.585 0 1 1 0-5.17 2.585 2.585 0 0 1 0 5.17z" style="fill:url(#g);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path style="fill:#d9d9d9;fill-opacity:1;stroke:none;filter:url(#h)" d="M25.6 47.2c-4.374 0-8.437-1.4-11.838-3.635 3.677-.394 7.305-1.343 11.423-3.375 4.166 2.123 8.434 3.01 12.28 3.453A21.465 21.465 0 0 1 25.6 47.2Z" transform="matrix(.51063 0 0 -.51063 -1.072 25.031)"/><path style="fill:url(#i);fill-opacity:1;stroke:none;filter:url(#filter4315)" d="M39.723 42.553c-4.329-.029-10.243-2.156-14.538-4.12-4.516 1.631-9.15 4.216-14.383 4.094a20.537 20.537 0 0 1-1.039-.052l-4.101-.337 3.894-1.299c5.342-1.74 10.04-2.85 14.175-10.026h3.738c4.12 7.134 9.06 8.325 14.15 10.026l3.842 1.247-3.998.389c-.545.052-1.121.082-1.74.078z" transform="matrix(.51063 0 0 -.51063 -1.072 25.031)"/></svg>';case"reolink":return'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path style="fill:#fff;stroke-width:.0393282;fill-opacity:1" d="M17.037 23.965a1.724 1.724 0 0 1-.711-.285c-.13-.086-1.782-1.727-4.108-4.078-2.14-2.164-3.998-4.02-4.128-4.123a3.023 3.023 0 0 0-1.591-.677c-.185-.021-1.42-.039-2.745-.039H1.345l.007-7.394V-.025h6.204c3.98 0 6.36.015 6.637.041a7.269 7.269 0 0 1 5.579 3.501c.686 1.131 1.02 2.278 1.067 3.655.063 1.885-.574 3.66-1.831 5.1a7.592 7.592 0 0 1-2.93 2.025l-.319.118-1.951-1.98-1.951-1.979 1.046-.023c.576-.013 1.1-.037 1.165-.053.596-.151.95-.314 1.322-.611a3.05 3.05 0 0 0 1.138-2.067c.168-1.506-.771-2.87-2.263-3.29l-.315-.089-4.152-.012-4.159-.013V10.437h1.419c1.627.001 1.779.02 2.31.28.31.152.39.22 1.082.915 3.027 3.043 12.194 12.309 12.205 12.337.016.044-5.365.04-5.618-.004z"/></svg>';case"iris":return'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g style="fill-opacity:.05;fill:#fff;stroke-width:1.0015748;stroke-dasharray:none"><path d="m13.73 15-3.9 6.76a9.984 9.984 0 0 0 8.49-2.01l-3.66-6.35M2.46 15c.92 2.92 3.15 5.26 5.99 6.34L12.12 15m-3.58-3-3.9-6.75A9.855 9.855 0 0 0 2 12c0 .68.07 1.35.2 2h7.49m12.11-4h-7.49l.29.5 4.76 8.25A9.93 9.93 0 0 0 22 12c0-.69-.07-1.36-.2-2m-.26-1c-.92-2.93-3.15-5.26-5.99-6.34L11.88 9M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.84-6.32 2.25l3.66 6.35z" style="fill-opacity:1;fill:#fff;opacity:1;stroke-width:1.0015748;stroke-dasharray:none"/></g></svg>';default:return null}}createStateObjectForStateBadge(e,t){return e.states[t]?{...e.states[t],attributes:{...e.states[t].attributes,entity_picture:void 0,entity_picture_local:void 0}}:null}}let XA=class extends oe{constructor(){super(...arguments),this.allowOverrideNonActiveStyles=!1,this._controller=new GA,this._svg=null}willUpdate(e){if(e.has("icon")){const e=this._controller.getCustomIcon(this.icon);if(e){const t=document.createElement("svg");t.innerHTML=e,this._svg=t}else this._svg=null}}render(){if(this._svg)return U`${this._svg}`;if(this.hass&&this.icon?.entity){const e=this._controller.createStateObjectForStateBadge(this.hass,this.icon.entity);if(e)return U`<state-badge
          .color="${this.style.color??void 0}"
          .stateColor=${this.icon.stateColor??!0}
          .hass=${this.hass}
          .stateObj=${e}
          .overrideIcon=${this.icon.icon}
        ></state-badge>`}return this.icon?.icon?U`<ha-icon icon="${this.icon.icon}"></ha-icon>`:this.icon?.fallback?U`<ha-icon icon="${this.icon.fallback}"></ha-icon>`:U``}static get styles(){return s(":host {\n  display: inline-block;\n  width: var(--mdc-icon-size, 24px);\n  height: var(--mdc-icon-size, 24px);\n  --ha-icon-display: block;\n}\n\nha-icon,\nstate-badge,\nsvg {\n  display: block;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n}\n\nsvg path {\n  fill: currentColor !important;\n}\n\n:host([allow-override-non-active-styles]) state-badge {\n  --state-inactive-color: inherit;\n}")}};e([he({attribute:!1})],XA.prototype,"hass",void 0),e([he({attribute:!1})],XA.prototype,"icon",void 0),e([he({attribute:"allow-override-non-active-styles",type:Boolean})],XA.prototype,"allowOverrideNonActiveStyles",void 0),XA=e([le("advanced-camera-card-icon")],XA);let JA=class extends oe{render(){return U`<advanced-camera-card-icon
        .icon=${{icon:"iris"}}
      ></advanced-camera-card-icon
      ><span>${"7.11.2"}</span>`}static get styles(){return s(":host {\n  width: intrinsic;\n  height: intrinsic;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  pointer-events: none;\n  background-color: var(--advanced-camera-card-loading-background-color);\n  color: var(--advanced-camera-card-loading-foreground-color);\n  transition: opacity 1.5s ease-in;\n  opacity: 1;\n}\n\n:host([loaded]) {\n  opacity: 0;\n}\n\nadvanced-camera-card-icon {\n  margin-bottom: 20px;\n  height: 25%;\n  width: auto;\n  animation: rotate 8s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\nspan {\n  font-size: x-large;\n}")}};JA=e([le("advanced-camera-card-loading")],JA);const eT=(e,t)=>{VE(e,"action:execution-request",t)};class tT{constructor(e){this._config=null,this._buttons=[],this._expanded=!1,this._host=e}setMenuConfig(e){this._config=e,this._host.style.setProperty("--advanced-camera-card-menu-button-size",`${e.button_size}px`),this._host.setAttribute("data-style",e.style),this._host.setAttribute("data-position",e.position),this._host.setAttribute("data-alignment",e.alignment),this._sortButtons(),this._host.requestUpdate()}getMenuConfig(){return this._config}isExpanded(){return this._expanded}setButtons(e){this._buttons=e,this._sortButtons(),this._host.requestUpdate()}getButtons(e){const t=e=>!this._isHidingMenu()||this._expanded||!!e.permanent;return this._buttons.filter((n=>(e=>!1!==e.enabled)(n)&&(t=>t.alignment===e||"matching"===e&&!t.alignment)(n)&&t(n)))}setExpanded(e){this._expanded=e,fd(this._host,e,"expanded"),this._host.requestUpdate()}toggleExpanded(){this.setExpanded(!this._expanded)}handleAction(e,t){e.stopPropagation();const n=t??e.detail.item??null;if(!n)return;const i=e.detail.action,a=$d(i,n);if(!a)return;const r=id(a);let s=!1;const o=r.filter((e=>gd(e)&&!this._isMenuToggleAction(e)));if(o.length!=r.length&&(s=!0),o.length&&eT(this._host,{actions:r,config:n}),this._isHidingMenu())if(s)this.setExpanded(!this._expanded);else{const e=$d("hold",n),t=$d("double_tap",n),a=$d("tap",n),r=$d("end_tap",n);"end_tap"!==i&&("start_tap"!==i||e||t||a||r)&&("end_tap"===i||r)||this.setExpanded(!1)}}_sortButtons(){this._buttons=Vu(this._buttons,(e=>(e.priority??0)+(this._isHidingMenu()&&e.permanent?100:0)),["desc"])}_isHidingMenu(){return"hidden"===this._config?.style}_isMenuToggleAction(e){return"fire-dom-event"===e.action&&"menu_toggle"===e.advanced_camera_card_action}}const nT=(e,t,n)=>{const i=e.states[t],a=n?.state?n.state:i?i.state:null;if(!a)return null;const r=Jv(t),s=i?i.attributes:null;return n?.entity?.translation_key&&e.localize(`component.${n.entity.platform}.entity.${r}.${n.entity.translation_key}.state.${a}`)||s?.device_class&&e.localize(`component.${r}.state.${s.device_class}.${a}`)||e.localize(`component.${r}.state._.${a}`)||a};function iT(e,t,n,i){return!!zE(e,t,n,{...i,firstOnly:!0}).length}var aT="ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\nha-icon-button {\n  --state-inactive-color: var(--advanced-camera-card-button-color);\n  color: var(--advanced-camera-card-menu-button-inactive-color);\n  background-color: var(--advanced-camera-card-menu-button-background);\n}";let rT=class extends oe{_renderItem(e){if(!this.hass)return;const t=e.title??CA(this.hass,e.entity),n=je(e.style||{});return U`
      <mwc-list-item
        graphic=${ve(e.icon||e.entity?"icon":void 0)}
        ?twoline=${!!e.subtitle}
        ?selected=${e.selected}
        ?activated=${e.selected}
        ?disabled=${!1===e.enabled}
        aria-label="${t??""}"
        @action=${t=>{t.detail.item=e}}
        .actionHandler=${Rd({allowPropagation:!0,hasHold:Id(e.hold_action),hasDoubleClick:Id(e.double_tap_action)})}
      >
        <span style="${n}">${t??""}</span>
        ${e.subtitle?U`<span slot="secondary" style="${n}">${e.subtitle}</span>`:""}
        <advanced-camera-card-icon
          slot="graphic"
          .hass=${this.hass}
          .icon=${{icon:e.icon,entity:e.entity}}
          style="${n}"
        ></advanced-camera-card-icon>
      </mwc-list-item>
    `}render(){return U`
      <ha-button-menu
        fixed
        corner=${"BOTTOM_LEFT"}
        @closed=${e=>e.stopPropagation()}
        @click=${e=>Ld(e)}
      >
        <slot slot="trigger"></slot>
        ${this.items?.map(this._renderItem.bind(this))}
      </ha-button-menu>
    `}static get styles(){return s('ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\nha-icon-button {\n  --state-inactive-color: var(--advanced-camera-card-button-color);\n  color: var(--advanced-camera-card-menu-button-inactive-color);\n  background-color: var(--advanced-camera-card-menu-button-background);\n}\n\n/************\n * Managing z-indicies and stacking contexts is very challenging on the card,\n * due to the volume of different potentially overlapping surfaces. In\n * particular, care must be taken to not generate new stacking contexts\n * inadvertently which would make "z-index" weaving challenging (e.g. submenu\n * shown for PTZ presets, needs to render "over" the media drawer open/close\n * control).\n *************/\n:host {\n  pointer-events: auto;\n  --mdc-menu-z-index: 5;\n}')}};e([he({attribute:!1})],rT.prototype,"hass",void 0),e([he({attribute:!1})],rT.prototype,"items",void 0),rT=e([le("advanced-camera-card-submenu")],rT);let sT=class extends oe{shouldUpdate(e){const t=e.get("hass");return!e.has("hass")||!t||!this.submenuSelect||iT(this.hass,t,[this.submenuSelect.entity])}async _refreshOptionTitles(){if(!this.hass||!this.submenuSelect)return;const e=this.submenuSelect.entity,t=this.hass.states[e],n=t?.attributes?.options,i=await(this.entityRegistryManager?.getEntity(this.hass,e))??null,a={};for(const t of n){const n=nT(this.hass,e,{...i&&{entity:i},state:t});n&&(a[t]=n)}this._optionTitles=a}willUpdate(){if(!this.submenuSelect||!this.hass)return;this._optionTitles||this._refreshOptionTitles();const e=this.submenuSelect.entity,t=Jv(e),n=this.hass.states[e],i=n?.attributes?.options;if(!n||!i)return;const a=[];for(const r of i){const i=this._optionTitles?.[r]??r;a.push({state_color:!0,selected:n.state===r,enabled:!0,title:i||r,...("select"===t||"input_select"===t)&&{tap_action:Td(t,e,r)},...this.submenuSelect.options&&this.submenuSelect.options[r]})}this._generatedSubmenuItems=a,this._generatedIcon={icon:this.submenuSelect.icon,entity:e,fallback:"mdi:format-list-bulleted",stateColor:this.submenuSelect.state_color}}render(){if(!this._generatedSubmenuItems||!this._generatedIcon||!this.submenuSelect)return U``;const e=CA(this.hass,this.submenuSelect.entity),t=je(this.submenuSelect.style||{});return U` <advanced-camera-card-submenu
      .hass=${this.hass}
      .items=${this._generatedSubmenuItems}
    >
      <ha-icon-button style="${t}" .label=${e||""}>
        <advanced-camera-card-icon
          ?allow-override-non-active-styles=${!0}
          style="${t}"
          title=${e||""}
          .hass=${this.hass}
          .icon=${this._generatedIcon}
        ></advanced-camera-card-icon>
      </ha-icon-button>
    </advanced-camera-card-submenu>`}static get styles(){return s(aT)}};e([he({attribute:!1})],sT.prototype,"hass",void 0),e([he({attribute:!1})],sT.prototype,"submenuSelect",void 0),e([he({attribute:!1})],sT.prototype,"entityRegistryManager",void 0),e([pe()],sT.prototype,"_optionTitles",void 0),sT=e([le("advanced-camera-card-submenu-select-button")],sT);let oT=class extends oe{render(){if(!this.submenu)return U``;const e=je(this.submenu.style||{});return U` <advanced-camera-card-submenu
      .hass=${this.hass}
      .items=${this.submenu?.items}
    >
      <ha-icon-button style="${e}" .label=${this.submenu.title||""}>
        <advanced-camera-card-icon
          ?allow-override-non-active-styles=${!0}
          style="${e}"
          title=${this.submenu.title||""}
          .hass=${this.hass}
          .icon=${{icon:this.submenu.icon}}
          .actionHandler=${Rd({allowPropagation:!0,hasHold:Id(this.submenu.hold_action),hasDoubleClick:Id(this.submenu.double_tap_action)})}
        ></advanced-camera-card-icon>
      </ha-icon-button>
    </advanced-camera-card-submenu>`}static get styles(){return s(aT)}};e([he({attribute:!1})],oT.prototype,"hass",void 0),e([he({attribute:!1})],oT.prototype,"submenu",void 0),oT=e([le("advanced-camera-card-submenu-button")],oT);let cT=class extends oe{constructor(){super(...arguments),this._controller=new tT(this)}set menuConfig(e){this._controller.setMenuConfig(e)}set buttons(e){this._controller.setButtons(e)}set expanded(e){this._controller.setExpanded(e)}toggleMenu(){this._controller.toggleExpanded()}_renderButton(e){if(!this.hass)return;if("custom:advanced-camera-card-menu-submenu"===e.type)return U` <advanced-camera-card-submenu-button
        .hass=${this.hass}
        .submenu=${e}
        @action=${e=>this._controller.handleAction(e)}
      >
      </advanced-camera-card-submenu-button>`;if("custom:advanced-camera-card-menu-submenu-select"===e.type)return U` <advanced-camera-card-submenu-select-button
        .hass=${this.hass}
        .submenuSelect=${e}
        .entityRegistryManager=${this.entityRegistryManager}
        @action=${e=>this._controller.handleAction(e)}
      >
      </advanced-camera-card-submenu-select-button>`;const t=this.hass&&"custom:advanced-camera-card-menu-state-icon"===e.type&&!e.title?CA(this.hass,e.entity):e.title;return U` <ha-icon-button
      .actionHandler=${Rd({hasHold:Id(e.hold_action),hasDoubleClick:Id(e.double_tap_action)})}
      .label=${t??""}
      @action=${t=>this._controller.handleAction(t,e)}
    >
      <advanced-camera-card-icon
        ?allow-override-non-active-styles=${!0}
        style="${je(e.style||{})}"
        .hass=${this.hass}
        .icon=${{icon:e.icon,entity:e.entity,stateColor:e.state_color,fallback:"mdi:gesture-tap-button"}}
      ></advanced-camera-card-icon>
    </ha-icon-button>`}_renderPerInstanceStyle(){const e=this._controller.getMenuConfig();if(!e)return;const t=e.position,n=e.style,i=e.alignment,a=e=>`\n        var(--advanced-camera-card-menu-override-${e},\n        var(--advanced-camera-card-menu-position-${t}-alignment-${i}-style-${n}-${e},\n        var(--advanced-camera-card-menu-position-${t}-alignment-${i}-${e},\n        var(--advanced-camera-card-menu-position-${t}-${e},\n        var(--advanced-camera-card-menu-style-${n}-${e},\n        var(--advanced-camera-card-menu-alignment-${i}-${e},\n        var(--advanced-camera-card-menu-${e})))))))`;return U`<style>
      :host(${`[data-position='${t}'][data-style='${n}'][data-alignment='${i}']`+("hidden"===n?"[expanded]":"")}) {
        background: ${a("background")};

        ha-icon-button {
          color: ${a("button-inactive-color")};
          background: ${a("button-background")};
        }
      }
    </style>`}render(){const e=this._controller.getMenuConfig(),t=e?.style;if(!e||"none"===t)return;const n=this._controller.getButtons("matching"),i=this._controller.getButtons("opposing");return U` ${this._renderPerInstanceStyle()}
      <div
        class="matching"
        style="${je({flex:String(n.length)})}"
      >
        ${n.map((e=>this._renderButton(e)))}
      </div>
      <div
        class="opposing"
        style="${je({flex:String(i.length)})}"
      >
        ${i.map((e=>this._renderButton(e)))}
      </div>`}static get styles(){return s('ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\nha-icon-button {\n  --state-inactive-color: var(--advanced-camera-card-button-color);\n  color: var(--advanced-camera-card-menu-button-inactive-color);\n  background-color: var(--advanced-camera-card-menu-button-background);\n}\n\n:host {\n  --advanced-camera-card-menu-button-size: 40px;\n  --mdc-icon-button-size: var(--advanced-camera-card-menu-button-size);\n  --mdc-icon-size: calc(var(--mdc-icon-button-size) / 2);\n  pointer-events: auto;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n\n:host([data-style=outside]) {\n  width: 100%;\n}\n\n/*******************************************************\n * Non-hover styles should not interact with the pointer\n *******************************************************/\n:host(:not([data-style*=hover])) {\n  pointer-events: none;\n}\n\n/***********************************\n * Aligned divs: matching & opposing\n ***********************************/\ndiv.matching,\ndiv.opposing {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: row;\n  align-items: flex-start;\n  min-width: 0px;\n  min-height: 0px;\n}\n\ndiv.matching {\n  justify-content: flex-start;\n}\n\ndiv.opposing {\n  justify-content: flex-end;\n}\n\n/********************************************************\n * Hack: Ensure host & div expand for column flex layouts\n ********************************************************/\n:host(:not([data-style=outside])[data-position=left]) {\n  writing-mode: vertical-lr;\n}\n\n:host(:not([data-style=outside])[data-position=right]) {\n  writing-mode: vertical-rl;\n}\n\n:host(:not([data-style=outside])[data-style=overlay][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style=overlay][data-position=right]) div > *,\n:host(:not([data-style=outside])[data-style*=hover][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style*=hover][data-position=right]) div > *,\n:host(:not([data-style=outside])[data-style=hidden][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style=hidden][data-position=right]) div > * {\n  writing-mode: horizontal-tb;\n}\n\n/**********************\n * "Reverse" alignments\n **********************/\n:host(:not([data-style=outside])[data-position=left][data-alignment=bottom]),\n:host(:not([data-style=outside])[data-position=right][data-alignment=bottom]),\n:host([data-position=top][data-alignment=right]),\n:host([data-position=bottom][data-alignment=right]),\n:host(:not([data-style=outside])[data-position=left][data-alignment=bottom]) div,\n:host(:not([data-style=outside])[data-position=right][data-alignment=bottom]) div,\n:host([data-position=top][data-alignment=right]) div,\n:host([data-position=bottom][data-alignment=right]) div {\n  flex-direction: row-reverse;\n}\n\n/****************************\n * Wrap upwards on the bottom\n ****************************/\n:host(:not([data-style=outside])[data-position=bottom]) div {\n  flex-wrap: wrap-reverse;\n}\n\n/********************************************\n * Positioning for absolute based menu styles\n ********************************************/\n:host([data-style=overlay][data-position=top]),\n:host([data-style=overlay][data-position=bottom]),\n:host([data-style*=hover][data-position=top]),\n:host([data-style*=hover][data-position=bottom]),\n:host([data-style=hidden][data-position=top]),\n:host([data-style=hidden][data-position=bottom]) {\n  width: 100%;\n  height: auto;\n}\n\n:host([data-style=overlay][data-position=left]),\n:host([data-style=overlay][data-position=right]),\n:host([data-style*=hover][data-position=left]),\n:host([data-style*=hover][data-position=right]),\n:host([data-style=hidden][data-position=left]),\n:host([data-style=hidden][data-position=right]) {\n  width: auto;\n  height: 100%;\n}\n\n/************\n * Menu theme\n ************/\n:host([data-style=hidden]:not([expanded])) ha-icon-button {\n  background: var(--advanced-camera-card-menu-background);\n}')}};
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */
function lT(e){return null==e}e([he({attribute:!1})],cT.prototype,"entityRegistryManager",void 0),e([he({attribute:!1})],cT.prototype,"hass",void 0),cT=e([le("advanced-camera-card-menu")],cT);var uT=function(e,t){var n,i="";for(n=0;n<t;n+=1)i+=e;return i},dT={isNothing:lT,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:lT(e)?[]:[e]},repeat:uT,isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,i,a,r;if(t)for(n=0,i=(r=Object.keys(t)).length;n<i;n+=1)e[a=r[n]]=t[a];return e}};function hT(e,t){var n="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),i+" "+n):i}function pT(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=hT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}pT.prototype=Object.create(Error.prototype),pT.prototype.constructor=pT,pT.prototype.toString=function(e){return this.name+": "+hT(this,e)};var mT=pT;function fT(e,t,n,i,a){var r="",s="",o=Math.floor(a/2)-1;return i-t>o&&(t=i-o+(r=" ... ").length),n-i>o&&(n=i+o-(s=" ...").length),{str:r+e.slice(t,n).replace(/\t/g,"→")+s,pos:i-t+r.length}}function gT(e,t){return dT.repeat(" ",t-e.length)+e}var _T=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,i=/\r?\n|\r|\0/g,a=[0],r=[],s=-1;n=i.exec(e.buffer);)r.push(n.index),a.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=a.length-2);s<0&&(s=a.length-1);var o,c,l="",u=Math.min(e.line+t.linesAfter,r.length).toString().length,d=t.maxLength-(t.indent+u+3);for(o=1;o<=t.linesBefore&&!(s-o<0);o++)c=fT(e.buffer,a[s-o],r[s-o],e.position-(a[s]-a[s-o]),d),l=dT.repeat(" ",t.indent)+gT((e.line-o+1).toString(),u)+" | "+c.str+"\n"+l;for(c=fT(e.buffer,a[s],r[s],e.position,d),l+=dT.repeat(" ",t.indent)+gT((e.line+1).toString(),u)+" | "+c.str+"\n",l+=dT.repeat("-",t.indent+u+3+c.pos)+"^\n",o=1;o<=t.linesAfter&&!(s+o>=r.length);o++)c=fT(e.buffer,a[s+o],r[s+o],e.position-(a[s]-a[s+o]),d),l+=dT.repeat(" ",t.indent)+gT((e.line+o+1).toString(),u)+" | "+c.str+"\n";return l.replace(/\n$/,"")},vT=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],yT=["scalar","sequence","mapping"];var bT=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===vT.indexOf(t))throw new mT('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===yT.indexOf(this.kind))throw new mT('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function wT(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,i){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=i)})),n[t]=e})),n}function xT(e){return this.extend(e)}xT.prototype.extend=function(e){var t=[],n=[];if(e instanceof bT)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new mT("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof bT))throw new mT("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new mT("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new mT("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof bT))throw new mT("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var i=Object.create(xT.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=wT(i,"implicit"),i.compiledExplicit=wT(i,"explicit"),i.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return n}(i.compiledImplicit,i.compiledExplicit),i};var MT=xT,kT=new bT("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),CT=new bT("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),ST=new bT("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),ET=new MT({explicit:[kT,CT,ST]});var AT=new bT("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var TT=new bT("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function $T(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function IT(e){return 48<=e&&e<=55}function OT(e){return 48<=e&&e<=57}var LT=new bT("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n=e.length,i=0,a=!1;if(!n)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===n)return!0;if("b"===(t=e[++i])){for(i++;i<n;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;a=!0}return a&&"_"!==t}if("x"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!$T(e.charCodeAt(i)))return!1;a=!0}return a&&"_"!==t}if("o"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!IT(e.charCodeAt(i)))return!1;a=!0}return a&&"_"!==t}}if("_"===t)return!1;for(;i<n;i++)if("_"!==(t=e[i])){if(!OT(e.charCodeAt(i)))return!1;a=!0}return!(!a||"_"===t)},construct:function(e){var t,n=e,i=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(i=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return i*parseInt(n.slice(2),2);if("x"===n[1])return i*parseInt(n.slice(2),16);if("o"===n[1])return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!dT.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),DT=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var jT=/^[-+]?[0-9]+e/;var zT=new bT("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!DT.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||dT.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(dT.isNegativeZero(e))return"-0.0";return n=e.toString(10),jT.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),RT=ET.extend({implicit:[AT,TT,LT,zT]}),PT=RT,NT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),FT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var VT=new bT("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==NT.exec(e)||null!==FT.exec(e))},construct:function(e){var t,n,i,a,r,s,o,c,l=0,u=null;if(null===(t=NT.exec(e))&&(t=FT.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],i=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,i,a));if(r=+t[4],s=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),c=new Date(Date.UTC(n,i,a,r,s,o,l)),u&&c.setTime(c.getTime()-u),c},instanceOf:Date,represent:function(e){return e.toISOString()}});var BT=new bT("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),HT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var UT=new bT("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=0,a=e.length,r=HT;for(n=0;n<a;n++)if(!((t=r.indexOf(e.charAt(n)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){var t,n,i=e.replace(/[\r\n=]/g,""),a=i.length,r=HT,s=0,o=[];for(t=0;t<a;t++)t%4==0&&t&&(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)),s=s<<6|r.indexOf(i.charAt(t));return 0===(n=a%4*6)?(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)):18===n?(o.push(s>>10&255),o.push(s>>2&255)):12===n&&o.push(s>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,i="",a=0,r=e.length,s=HT;for(t=0;t<r;t++)t%3==0&&t&&(i+=s[a>>18&63],i+=s[a>>12&63],i+=s[a>>6&63],i+=s[63&a]),a=(a<<8)+e[t];return 0===(n=r%3)?(i+=s[a>>18&63],i+=s[a>>12&63],i+=s[a>>6&63],i+=s[63&a]):2===n?(i+=s[a>>10&63],i+=s[a>>4&63],i+=s[a<<2&63],i+=s[64]):1===n&&(i+=s[a>>2&63],i+=s[a<<4&63],i+=s[64],i+=s[64]),i}}),qT=Object.prototype.hasOwnProperty,WT=Object.prototype.toString;var ZT=new bT("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,a,r,s=[],o=e;for(t=0,n=o.length;t<n;t+=1){if(i=o[t],r=!1,"[object Object]"!==WT.call(i))return!1;for(a in i)if(qT.call(i,a)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==s.indexOf(a))return!1;s.push(a)}return!0},construct:function(e){return null!==e?e:[]}}),KT=Object.prototype.toString;var QT=new bT("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,a,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(i=s[t],"[object Object]"!==KT.call(i))return!1;if(1!==(a=Object.keys(i)).length)return!1;r[t]=[a[0],i[a[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,i,a,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1)i=s[t],a=Object.keys(i),r[t]=[a[0],i[a[0]]];return r}}),YT=Object.prototype.hasOwnProperty;var GT=new bT("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(YT.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),XT=PT.extend({implicit:[VT,BT],explicit:[UT,ZT,QT,GT]}),JT=Object.prototype.hasOwnProperty,e$=1,t$=2,n$=3,i$=4,a$=1,r$=2,s$=3,o$=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,c$=/[\x85\u2028\u2029]/,l$=/[,\[\]\{\}]/,u$=/^(?:!|!!|![a-z\-]+!)$/i,d$=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function h$(e){return Object.prototype.toString.call(e)}function p$(e){return 10===e||13===e}function m$(e){return 9===e||32===e}function f$(e){return 9===e||32===e||10===e||13===e}function g$(e){return 44===e||91===e||93===e||123===e||125===e}function _$(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function v$(e){return 120===e?2:117===e?4:85===e?8:0}function y$(e){return 48<=e&&e<=57?e-48:-1}function b$(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function w$(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var x$=new Array(256),M$=new Array(256),k$=0;k$<256;k$++)x$[k$]=b$(k$)?1:0,M$[k$]=b$(k$);function C$(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||XT,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function S$(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=_T(n),new mT(t,n)}function E$(e,t){throw S$(e,t)}function A$(e,t){e.onWarning&&e.onWarning.call(null,S$(e,t))}var T$={YAML:function(e,t,n){var i,a,r;null!==e.version&&E$(e,"duplication of %YAML directive"),1!==n.length&&E$(e,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&E$(e,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),r=parseInt(i[2],10),1!==a&&E$(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=r<2,1!==r&&2!==r&&A$(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var i,a;2!==n.length&&E$(e,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],u$.test(i)||E$(e,"ill-formed tag handle (first argument) of the TAG directive"),JT.call(e.tagMap,i)&&E$(e,'there is a previously declared suffix for "'+i+'" tag handle'),d$.test(a)||E$(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch(t){E$(e,"tag prefix is malformed: "+a)}e.tagMap[i]=a}};function $$(e,t,n,i){var a,r,s,o;if(t<n){if(o=e.input.slice(t,n),i)for(a=0,r=o.length;a<r;a+=1)9===(s=o.charCodeAt(a))||32<=s&&s<=1114111||E$(e,"expected valid JSON character");else o$.test(o)&&E$(e,"the stream contains non-printable characters");e.result+=o}}function I$(e,t,n,i){var a,r,s,o;for(dT.isObject(n)||E$(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,o=(a=Object.keys(n)).length;s<o;s+=1)r=a[s],JT.call(t,r)||(t[r]=n[r],i[r]=!0)}function O$(e,t,n,i,a,r,s,o,c){var l,u;if(Array.isArray(a))for(l=0,u=(a=Array.prototype.slice.call(a)).length;l<u;l+=1)Array.isArray(a[l])&&E$(e,"nested arrays are not supported inside keys"),"object"==typeof a&&"[object Object]"===h$(a[l])&&(a[l]="[object Object]");if("object"==typeof a&&"[object Object]"===h$(a)&&(a="[object Object]"),a=String(a),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(r))for(l=0,u=r.length;l<u;l+=1)I$(e,t,r[l],n);else I$(e,t,r,n);else e.json||JT.call(n,a)||!JT.call(t,a)||(e.line=s||e.line,e.lineStart=o||e.lineStart,e.position=c||e.position,E$(e,"duplicated mapping key")),"__proto__"===a?Object.defineProperty(t,a,{configurable:!0,enumerable:!0,writable:!0,value:r}):t[a]=r,delete n[a];return t}function L$(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):E$(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function D$(e,t,n){for(var i=0,a=e.input.charCodeAt(e.position);0!==a;){for(;m$(a);)9===a&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),a=e.input.charCodeAt(++e.position);if(t&&35===a)do{a=e.input.charCodeAt(++e.position)}while(10!==a&&13!==a&&0!==a);if(!p$(a))break;for(L$(e),a=e.input.charCodeAt(e.position),i++,e.lineIndent=0;32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position)}return-1!==n&&0!==i&&e.lineIndent<n&&A$(e,"deficient indentation"),i}function j$(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!f$(t)))}function z$(e,t){1===t?e.result+=" ":t>1&&(e.result+=dT.repeat("\n",t-1))}function R$(e,t){var n,i,a=e.tag,r=e.anchor,s=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),i=e.input.charCodeAt(e.position);0!==i&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,E$(e,"tab characters must not be used in indentation")),45===i)&&f$(e.input.charCodeAt(e.position+1));)if(o=!0,e.position++,D$(e,!0,-1)&&e.lineIndent<=t)s.push(null),i=e.input.charCodeAt(e.position);else if(n=e.line,F$(e,t,n$,!1,!0),s.push(e.result),D$(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==i)E$(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!o&&(e.tag=a,e.anchor=r,e.kind="sequence",e.result=s,!0)}function P$(e){var t,n,i,a,r=!1,s=!1;if(33!==(a=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&E$(e,"duplication of a tag property"),60===(a=e.input.charCodeAt(++e.position))?(r=!0,a=e.input.charCodeAt(++e.position)):33===a?(s=!0,n="!!",a=e.input.charCodeAt(++e.position)):n="!",t=e.position,r){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&62!==a);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):E$(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!f$(a);)33===a&&(s?E$(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),u$.test(n)||E$(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),l$.test(i)&&E$(e,"tag suffix cannot contain flow indicator characters")}i&&!d$.test(i)&&E$(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch(t){E$(e,"tag name is malformed: "+i)}return r?e.tag=i:JT.call(e.tagMap,n)?e.tag=e.tagMap[n]+i:"!"===n?e.tag="!"+i:"!!"===n?e.tag="tag:yaml.org,2002:"+i:E$(e,'undeclared tag handle "'+n+'"'),!0}function N$(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&E$(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!f$(n)&&!g$(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&E$(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function F$(e,t,n,i,a){var r,s,o,c,l,u,d,h,p,m=1,f=!1,g=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,r=s=o=i$===n||n$===n,i&&D$(e,!0,-1)&&(f=!0,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)),1===m)for(;P$(e)||N$(e);)D$(e,!0,-1)?(f=!0,o=r,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)):o=!1;if(o&&(o=f||a),1!==m&&i$!==n||(h=e$===n||t$===n?t:t+1,p=e.position-e.lineStart,1===m?o&&(R$(e,p)||function(e,t,n){var i,a,r,s,o,c,l,u=e.tag,d=e.anchor,h={},p=Object.create(null),m=null,f=null,g=null,_=!1,v=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=h),l=e.input.charCodeAt(e.position);0!==l;){if(_||-1===e.firstTabInLine||(e.position=e.firstTabInLine,E$(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),r=e.line,63!==l&&58!==l||!f$(i)){if(s=e.line,o=e.lineStart,c=e.position,!F$(e,n,t$,!1,!0))break;if(e.line===r){for(l=e.input.charCodeAt(e.position);m$(l);)l=e.input.charCodeAt(++e.position);if(58===l)f$(l=e.input.charCodeAt(++e.position))||E$(e,"a whitespace character is expected after the key-value separator within a block mapping"),_&&(O$(e,h,p,m,f,null,s,o,c),m=f=g=null),v=!0,_=!1,a=!1,m=e.tag,f=e.result;else{if(!v)return e.tag=u,e.anchor=d,!0;E$(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=u,e.anchor=d,!0;E$(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===l?(_&&(O$(e,h,p,m,f,null,s,o,c),m=f=g=null),v=!0,_=!0,a=!0):_?(_=!1,a=!0):E$(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,l=i;if((e.line===r||e.lineIndent>t)&&(_&&(s=e.line,o=e.lineStart,c=e.position),F$(e,t,i$,!0,a)&&(_?f=e.result:g=e.result),_||(O$(e,h,p,m,f,g,s,o,c),m=f=g=null),D$(e,!0,-1),l=e.input.charCodeAt(e.position)),(e.line===r||e.lineIndent>t)&&0!==l)E$(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return _&&O$(e,h,p,m,f,null,s,o,c),v&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=h),v}(e,p,h))||function(e,t){var n,i,a,r,s,o,c,l,u,d,h,p,m=!0,f=e.tag,g=e.anchor,_=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))s=93,l=!1,r=[];else{if(123!==p)return!1;s=125,l=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),p=e.input.charCodeAt(++e.position);0!==p;){if(D$(e,!0,t),(p=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=f,e.anchor=g,e.kind=l?"mapping":"sequence",e.result=r,!0;m?44===p&&E$(e,"expected the node content, but found ','"):E$(e,"missed comma between flow collection entries"),h=null,o=c=!1,63===p&&f$(e.input.charCodeAt(e.position+1))&&(o=c=!0,e.position++,D$(e,!0,t)),n=e.line,i=e.lineStart,a=e.position,F$(e,t,e$,!1,!0),d=e.tag,u=e.result,D$(e,!0,t),p=e.input.charCodeAt(e.position),!c&&e.line!==n||58!==p||(o=!0,p=e.input.charCodeAt(++e.position),D$(e,!0,t),F$(e,t,e$,!1,!0),h=e.result),l?O$(e,r,_,d,u,h,n,i,a):o?r.push(O$(e,null,_,d,u,h,n,i,a)):r.push(u),D$(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(m=!0,p=e.input.charCodeAt(++e.position)):m=!1}E$(e,"unexpected end of the stream within a flow collection")}(e,h)?g=!0:(s&&function(e,t){var n,i,a,r,s=a$,o=!1,c=!1,l=t,u=0,d=!1;if(124===(r=e.input.charCodeAt(e.position)))i=!1;else{if(62!==r)return!1;i=!0}for(e.kind="scalar",e.result="";0!==r;)if(43===(r=e.input.charCodeAt(++e.position))||45===r)a$===s?s=43===r?s$:r$:E$(e,"repeat of a chomping mode identifier");else{if(!((a=y$(r))>=0))break;0===a?E$(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?E$(e,"repeat of an indentation width identifier"):(l=t+a-1,c=!0)}if(m$(r)){do{r=e.input.charCodeAt(++e.position)}while(m$(r));if(35===r)do{r=e.input.charCodeAt(++e.position)}while(!p$(r)&&0!==r)}for(;0!==r;){for(L$(e),e.lineIndent=0,r=e.input.charCodeAt(e.position);(!c||e.lineIndent<l)&&32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>l&&(l=e.lineIndent),p$(r))u++;else{if(e.lineIndent<l){s===s$?e.result+=dT.repeat("\n",o?1+u:u):s===a$&&o&&(e.result+="\n");break}for(i?m$(r)?(d=!0,e.result+=dT.repeat("\n",o?1+u:u)):d?(d=!1,e.result+=dT.repeat("\n",u+1)):0===u?o&&(e.result+=" "):e.result+=dT.repeat("\n",u):e.result+=dT.repeat("\n",o?1+u:u),o=!0,c=!0,u=0,n=e.position;!p$(r)&&0!==r;)r=e.input.charCodeAt(++e.position);$$(e,n,e.position,!1)}}return!0}(e,h)||function(e,t){var n,i,a;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,i=a=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if($$(e,i,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;i=e.position,e.position++,a=e.position}else p$(n)?($$(e,i,a,!0),z$(e,D$(e,!1,t)),i=a=e.position):e.position===e.lineStart&&j$(e)?E$(e,"unexpected end of the document within a single quoted scalar"):(e.position++,a=e.position);E$(e,"unexpected end of the stream within a single quoted scalar")}(e,h)||function(e,t){var n,i,a,r,s,o;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return $$(e,n,e.position,!0),e.position++,!0;if(92===o){if($$(e,n,e.position,!0),p$(o=e.input.charCodeAt(++e.position)))D$(e,!1,t);else if(o<256&&x$[o])e.result+=M$[o],e.position++;else if((s=v$(o))>0){for(a=s,r=0;a>0;a--)(s=_$(o=e.input.charCodeAt(++e.position)))>=0?r=(r<<4)+s:E$(e,"expected hexadecimal character");e.result+=w$(r),e.position++}else E$(e,"unknown escape sequence");n=i=e.position}else p$(o)?($$(e,n,i,!0),z$(e,D$(e,!1,t)),n=i=e.position):e.position===e.lineStart&&j$(e)?E$(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position)}E$(e,"unexpected end of the stream within a double quoted scalar")}(e,h)?g=!0:!function(e){var t,n,i;if(42!==(i=e.input.charCodeAt(e.position)))return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!f$(i)&&!g$(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&E$(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),JT.call(e.anchorMap,n)||E$(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],D$(e,!0,-1),!0}(e)?function(e,t,n){var i,a,r,s,o,c,l,u,d=e.kind,h=e.result;if(f$(u=e.input.charCodeAt(e.position))||g$(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(f$(i=e.input.charCodeAt(e.position+1))||n&&g$(i)))return!1;for(e.kind="scalar",e.result="",a=r=e.position,s=!1;0!==u;){if(58===u){if(f$(i=e.input.charCodeAt(e.position+1))||n&&g$(i))break}else if(35===u){if(f$(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&j$(e)||n&&g$(u))break;if(p$(u)){if(o=e.line,c=e.lineStart,l=e.lineIndent,D$(e,!1,-1),e.lineIndent>=t){s=!0,u=e.input.charCodeAt(e.position);continue}e.position=r,e.line=o,e.lineStart=c,e.lineIndent=l;break}}s&&($$(e,a,r,!1),z$(e,e.line-o),a=r=e.position,s=!1),m$(u)||(r=e.position+1),u=e.input.charCodeAt(++e.position)}return $$(e,a,r,!1),!!e.result||(e.kind=d,e.result=h,!1)}(e,h,e$===n)&&(g=!0,null===e.tag&&(e.tag="?")):(g=!0,null===e.tag&&null===e.anchor||E$(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===m&&(g=o&&R$(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&E$(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,l=e.implicitTypes.length;c<l;c+=1)if((d=e.implicitTypes[c]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(JT.call(e.typeMap[e.kind||"fallback"],e.tag))d=e.typeMap[e.kind||"fallback"][e.tag];else for(d=null,c=0,l=(u=e.typeMap.multi[e.kind||"fallback"]).length;c<l;c+=1)if(e.tag.slice(0,u[c].tag.length)===u[c].tag){d=u[c];break}d||E$(e,"unknown tag !<"+e.tag+">"),null!==e.result&&d.kind!==e.kind&&E$(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result,e.tag)?(e.result=d.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):E$(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||g}function V$(e){var t,n,i,a,r=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(a=e.input.charCodeAt(e.position))&&(D$(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==a));){for(s=!0,a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!f$(a);)a=e.input.charCodeAt(++e.position);for(i=[],(n=e.input.slice(t,e.position)).length<1&&E$(e,"directive name must not be less than one character in length");0!==a;){for(;m$(a);)a=e.input.charCodeAt(++e.position);if(35===a){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&!p$(a));break}if(p$(a))break;for(t=e.position;0!==a&&!f$(a);)a=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}0!==a&&L$(e),JT.call(T$,n)?T$[n](e,n,i):A$(e,'unknown document directive "'+n+'"')}D$(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,D$(e,!0,-1)):s&&E$(e,"directives end mark is expected"),F$(e,e.lineIndent-1,i$,!1,!0),D$(e,!0,-1),e.checkLineBreaks&&c$.test(e.input.slice(r,e.position))&&A$(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&j$(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,D$(e,!0,-1)):e.position<e.length-1&&E$(e,"end of the stream or a document separator is expected")}function B$(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new C$(e,t),i=e.indexOf("\0");for(-1!==i&&(n.position=i,E$(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)V$(n);return n.documents}var H$={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var i=B$(e,n);if("function"!=typeof t)return i;for(var a=0,r=i.length;a<r;a+=1)t(i[a])},load:function(e,t){var n=B$(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new mT("expected a single document in the stream, but found more")}}},U$=Object.prototype.toString,q$=Object.prototype.hasOwnProperty,W$=65279,Z$=9,K$=10,Q$=13,Y$=32,G$=33,X$=34,J$=35,eI=37,tI=38,nI=39,iI=42,aI=44,rI=45,sI=58,oI=61,cI=62,lI=63,uI=64,dI=91,hI=93,pI=96,mI=123,fI=124,gI=125,_I={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},vI=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],yI=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function bI(e){var t,n,i;if(t=e.toString(16).toUpperCase(),e<=255)n="x",i=2;else if(e<=65535)n="u",i=4;else{if(!(e<=4294967295))throw new mT("code point within a string may not be greater than 0xFFFFFFFF");n="U",i=8}return"\\"+n+dT.repeat("0",i-t.length)+t}var wI=1,xI=2;function MI(e){this.schema=e.schema||XT,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=dT.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,i,a,r,s,o,c;if(null===t)return{};for(n={},a=0,r=(i=Object.keys(t)).length;a<r;a+=1)s=i[a],o=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(c=e.compiledTypeMap.fallback[s])&&q$.call(c.styleAliases,o)&&(o=c.styleAliases[o]),n[s]=o;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?xI:wI,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function kI(e,t){for(var n,i=dT.repeat(" ",t),a=0,r=-1,s="",o=e.length;a<o;)-1===(r=e.indexOf("\n",a))?(n=e.slice(a),a=o):(n=e.slice(a,r+1),a=r+1),n.length&&"\n"!==n&&(s+=i),s+=n;return s}function CI(e,t){return"\n"+dT.repeat(" ",e.indent*t)}function SI(e){return e===Y$||e===Z$}function EI(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==W$||65536<=e&&e<=1114111}function AI(e){return EI(e)&&e!==W$&&e!==Q$&&e!==K$}function TI(e,t,n){var i=AI(e),a=i&&!SI(e);return(n?i:i&&e!==aI&&e!==dI&&e!==hI&&e!==mI&&e!==gI)&&e!==J$&&!(t===sI&&!a)||AI(t)&&!SI(t)&&e===J$||t===sI&&a}function $I(e,t){var n,i=e.charCodeAt(t);return i>=55296&&i<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(i-55296)+n-56320+65536:i}function II(e){return/^\n* /.test(e)}var OI=1,LI=2,DI=3,jI=4,zI=5;function RI(e,t,n,i,a,r,s,o){var c,l=0,u=null,d=!1,h=!1,p=-1!==i,m=-1,f=function(e){return EI(e)&&e!==W$&&!SI(e)&&e!==rI&&e!==lI&&e!==sI&&e!==aI&&e!==dI&&e!==hI&&e!==mI&&e!==gI&&e!==J$&&e!==tI&&e!==iI&&e!==G$&&e!==fI&&e!==oI&&e!==cI&&e!==nI&&e!==X$&&e!==eI&&e!==uI&&e!==pI}($I(e,0))&&function(e){return!SI(e)&&e!==sI}($I(e,e.length-1));if(t||s)for(c=0;c<e.length;l>=65536?c+=2:c++){if(!EI(l=$I(e,c)))return zI;f=f&&TI(l,u,o),u=l}else{for(c=0;c<e.length;l>=65536?c+=2:c++){if((l=$I(e,c))===K$)d=!0,p&&(h=h||c-m-1>i&&" "!==e[m+1],m=c);else if(!EI(l))return zI;f=f&&TI(l,u,o),u=l}h=h||p&&c-m-1>i&&" "!==e[m+1]}return d||h?n>9&&II(e)?zI:s?r===xI?zI:LI:h?jI:DI:!f||s||a(e)?r===xI?zI:LI:OI}function PI(e,t,n,i,a){e.dump=function(){if(0===t.length)return e.quotingType===xI?'""':"''";if(!e.noCompatMode&&(-1!==vI.indexOf(t)||yI.test(t)))return e.quotingType===xI?'"'+t+'"':"'"+t+"'";var r=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-r),o=i||e.flowLevel>-1&&n>=e.flowLevel;switch(RI(t,o,e.indent,s,(function(t){return function(e,t){var n,i;for(n=0,i=e.implicitTypes.length;n<i;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!i,a)){case OI:return t;case LI:return"'"+t.replace(/'/g,"''")+"'";case DI:return"|"+NI(t,e.indent)+FI(kI(t,r));case jI:return">"+NI(t,e.indent)+FI(kI(function(e,t){var n,i,a=/(\n+)([^\n]*)/g,r=(o=e.indexOf("\n"),o=-1!==o?o:e.length,a.lastIndex=o,VI(e.slice(0,o),t)),s="\n"===e[0]||" "===e[0];var o;for(;i=a.exec(e);){var c=i[1],l=i[2];n=" "===l[0],r+=c+(s||n||""===l?"":"\n")+VI(l,t),s=n}return r}(t,s),r));case zI:return'"'+function(e){for(var t,n="",i=0,a=0;a<e.length;i>=65536?a+=2:a++)i=$I(e,a),!(t=_I[i])&&EI(i)?(n+=e[a],i>=65536&&(n+=e[a+1])):n+=t||bI(i);return n}(t)+'"';default:throw new mT("impossible error: invalid scalar style")}}()}function NI(e,t){var n=II(e)?String(t):"",i="\n"===e[e.length-1];return n+(i&&("\n"===e[e.length-2]||"\n"===e)?"+":i?"":"-")+"\n"}function FI(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function VI(e,t){if(""===e||" "===e[0])return e;for(var n,i,a=/ [^ ]/g,r=0,s=0,o=0,c="";n=a.exec(e);)(o=n.index)-r>t&&(i=s>r?s:o,c+="\n"+e.slice(r,i),r=i+1),s=o;return c+="\n",e.length-r>t&&s>r?c+=e.slice(r,s)+"\n"+e.slice(s+1):c+=e.slice(r),c.slice(1)}function BI(e,t,n,i){var a,r,s,o="",c=e.tag;for(a=0,r=n.length;a<r;a+=1)s=n[a],e.replacer&&(s=e.replacer.call(n,String(a),s)),(UI(e,t+1,s,!0,!0,!1,!0)||void 0===s&&UI(e,t+1,null,!0,!0,!1,!0))&&(i&&""===o||(o+=CI(e,t)),e.dump&&K$===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=c,e.dump=o||"[]"}function HI(e,t,n){var i,a,r,s,o,c;for(r=0,s=(a=n?e.explicitTypes:e.implicitTypes).length;r<s;r+=1)if(((o=a[r]).instanceOf||o.predicate)&&(!o.instanceOf||"object"==typeof t&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(c=e.styleMap[o.tag]||o.defaultStyle,"[object Function]"===U$.call(o.represent))i=o.represent(t,c);else{if(!q$.call(o.represent,c))throw new mT("!<"+o.tag+'> tag resolver accepts not "'+c+'" style');i=o.represent[c](t,c)}e.dump=i}return!0}return!1}function UI(e,t,n,i,a,r,s){e.tag=null,e.dump=n,HI(e,n,!1)||HI(e,n,!0);var o,c=U$.call(e.dump),l=i;i&&(i=e.flowLevel<0||e.flowLevel>t);var u,d,h="[object Object]"===c||"[object Array]"===c;if(h&&(d=-1!==(u=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||d||2!==e.indent&&t>0)&&(a=!1),d&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(h&&d&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),"[object Object]"===c)i&&0!==Object.keys(e.dump).length?(!function(e,t,n,i){var a,r,s,o,c,l,u="",d=e.tag,h=Object.keys(n);if(!0===e.sortKeys)h.sort();else if("function"==typeof e.sortKeys)h.sort(e.sortKeys);else if(e.sortKeys)throw new mT("sortKeys must be a boolean or a function");for(a=0,r=h.length;a<r;a+=1)l="",i&&""===u||(l+=CI(e,t)),o=n[s=h[a]],e.replacer&&(o=e.replacer.call(n,s,o)),UI(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&K$===e.dump.charCodeAt(0)?l+="?":l+="? "),l+=e.dump,c&&(l+=CI(e,t)),UI(e,t+1,o,!0,c)&&(e.dump&&K$===e.dump.charCodeAt(0)?l+=":":l+=": ",u+=l+=e.dump));e.tag=d,e.dump=u||"{}"}(e,t,e.dump,a),d&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,n){var i,a,r,s,o,c="",l=e.tag,u=Object.keys(n);for(i=0,a=u.length;i<a;i+=1)o="",""!==c&&(o+=", "),e.condenseFlow&&(o+='"'),s=n[r=u[i]],e.replacer&&(s=e.replacer.call(n,r,s)),UI(e,t,r,!1,!1)&&(e.dump.length>1024&&(o+="? "),o+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),UI(e,t,s,!1,!1)&&(c+=o+=e.dump));e.tag=l,e.dump="{"+c+"}"}(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if("[object Array]"===c)i&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?BI(e,t-1,e.dump,a):BI(e,t,e.dump,a),d&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,n){var i,a,r,s="",o=e.tag;for(i=0,a=n.length;i<a;i+=1)r=n[i],e.replacer&&(r=e.replacer.call(n,String(i),r)),(UI(e,t,r,!1,!1)||void 0===r&&UI(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=o,e.dump="["+s+"]"}(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else{if("[object String]"!==c){if("[object Undefined]"===c)return!1;if(e.skipInvalid)return!1;throw new mT("unacceptable kind of an object to dump "+c)}"?"!==e.tag&&PI(e,e.dump,t,r,l)}null!==e.tag&&"?"!==e.tag&&(o=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),o="!"===e.tag[0]?"!"+o:"tag:yaml.org,2002:"===o.slice(0,18)?"!!"+o.slice(18):"!<"+o+">",e.dump=o+" "+e.dump)}return!0}function qI(e,t){var n,i,a=[],r=[];for(WI(e,a,r),n=0,i=r.length;n<i;n+=1)t.duplicates.push(a[r[n]]);t.usedDuplicates=new Array(i)}function WI(e,t,n){var i,a,r;if(null!==e&&"object"==typeof e)if(-1!==(a=t.indexOf(e)))-1===n.indexOf(a)&&n.push(a);else if(t.push(e),Array.isArray(e))for(a=0,r=e.length;a<r;a+=1)WI(e[a],t,n);else for(a=0,r=(i=Object.keys(e)).length;a<r;a+=1)WI(e[i[a]],t,n)}function ZI(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var KI={Type:bT,Schema:MT,FAILSAFE_SCHEMA:ET,JSON_SCHEMA:RT,CORE_SCHEMA:PT,DEFAULT_SCHEMA:XT,load:H$.load,loadAll:H$.loadAll,dump:{dump:function(e,t){var n=new MI(t=t||{});n.noRefs||qI(e,n);var i=e;return n.replacer&&(i=n.replacer.call({"":i},"",i)),UI(n,0,i,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:mT,types:{binary:UT,float:zT,map:ST,null:AT,pairs:QT,set:GT,timestamp:VT,bool:TT,int:LT,merge:BT,omap:ZT,seq:CT,str:kT},safeLoad:ZI("safeLoad","load"),safeLoadAll:ZI("safeLoadAll","loadAll"),safeDump:ZI("safeDump","dump")};class QI{getMessageString(e){return e.message+(e.context&&"string"==typeof e.context?": "+e.context:"")}getIcon(e){return e.icon?e.icon:"error"===e.type?"mdi:alert-circle":"mdi:information-outline"}getURL(e){return e.url?e.url:"error"===e.type?{link:th,title:Hg("error.troubleshooting")}:null}getContextStrings(e){return Array.isArray(e.context)?e.context.map((e=>KI.dump(e))):"object"==typeof e.context?[KI.dump(e.context)]:"string"==typeof e.context?[e.context]:[]}}var YI='.dotdotdot:after {\n  animation: dots 2s linear infinite;\n  content: "";\n  display: inline-block;\n  width: 3em;\n}\n@keyframes dots {\n  0%, 20% {\n    content: ".";\n  }\n  40% {\n    content: "..";\n  }\n  60% {\n    content: "...";\n  }\n  90%, 100% {\n    content: "";\n  }\n}\n\n:host {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  user-select: text;\n  -webkit-user-select: text;\n}\n\n:host(:not([overlay])) {\n  height: 100%;\n  width: 100%;\n  background: var(--advanced-camera-card-message-background);\n  color: var(--advanced-camera-card-message-color);\n}\n\n:host([overlay]) {\n  position: absolute;\n  inset: 5%;\n  background: var(--advanced-camera-card-message-overlay-background);\n  color: var(--advanced-camera-card-message-overlay-color);\n}\n\ndiv.wrapper {\n  height: 100%;\n}\n\ndiv.message {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  height: 100%;\n}\n\ndiv.message.padded {\n  padding: 20px;\n}\n\ndiv.message div.contents {\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n  margin-top: auto;\n  margin-bottom: auto;\n  min-width: 0;\n}\n\ndiv.message div.icon {\n  padding: 10px;\n}\n\n.vertical {\n  flex-direction: column;\n}\n\na {\n  word-break: break-word;\n}\n\n:host(:not([overlay])) a {\n  color: var(--advanced-camera-card-message-color);\n}\n\n:host([overlay]) a {\n  color: var(--advanced-camera-card-message-overlay-color);\n}\n\n.message pre {\n  margin-top: 20px;\n  overflow-x: auto;\n  border: 1px dotted var(--advanced-camera-card-divider-color);\n  padding: 1em;\n}';function GI(e,t){return U` <advanced-camera-card-message
    .message=${e}
    ?overlay=${!!t?.overlay}
  ></advanced-camera-card-message>`}let XI=class extends oe{constructor(){super(...arguments),this.overlay=!1,this._controller=new QI}render(){if(!this.message)return;const e=this._controller.getURL(this.message),t=U`
      ${this._controller.getMessageString(this.message)}
      ${e?U`. <a href="${e.link}">${e.title}</a>`:""}
    `,n=this._controller.getIcon(this.message),i={dotdotdot:!!this.message?.dotdotdot};return U` <div class="wrapper">
      <div class="message padded">
        <div class="icon">
          <advanced-camera-card-icon
            part="icon"
            .icon="${{icon:n}}"
          ></advanced-camera-card-icon>
        </div>
        <div class="contents">
          <span class="${_e(i)}">${t}</span>
          ${this._controller.getContextStrings(this.message).map((e=>U`<pre>${e}</pre>`))}
        </div>
      </div>
    </div>`}static get styles(){return s(YI)}};e([he({attribute:!1})],XI.prototype,"message",void 0),e([he({attribute:!0,type:Boolean})],XI.prototype,"overlay",void 0),XI=e([le("advanced-camera-card-message")],XI);let JI=class extends oe{render(){return U`
      <slot name="top"></slot>
      <slot name="left"></slot>
      <slot name="right"></slot>
      <slot name="bottom"></slot>
    `}static get styles(){return s("ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n\nslot {\n  position: absolute;\n  display: flex;\n}\n\n/***************\n * Slot position\n ***************/\nslot[name=top] {\n  top: 0px;\n}\n\nslot[name=bottom] {\n  bottom: 0px;\n}\n\nslot[name=left] {\n  left: 0px;\n}\n\nslot[name=right] {\n  right: 0px;\n}\n\n/***********\n * Slot size\n ***********/\nslot[name=top],\nslot[name=bottom] {\n  width: 100%;\n  flex-direction: column;\n}\n\nslot[name=left],\nslot[name=right] {\n  height: 100%;\n  flex-direction: row;\n}\n\nslot[name=top],\nslot[name=left] {\n  justify-content: flex-start;\n}\n\nslot[name=bottom],\nslot[name=right] {\n  justify-content: flex-end;\n}")}};JI=e([le("advanced-camera-card-overlay")],JI);class eO{constructor(e){this._config=null,this._popupTimer=new Dd,this._items=[],this._host=e}getRenderItems(){return this._items}setItems(e){const t=e.filter((e=>!!e.exclusive)),n=Vu(t.length?t:e,(e=>e.priority??50),"desc"),i=this._getSufficientValues(this._items),a=this._getSufficientValues(n);this._items=n,"popup"!==this._config?.style||zu(i,a)||(this._show(),this._popupTimer.start(this._config.popup_seconds,(()=>this._hide()))),this._host.requestUpdate()}setConfig(e){this._config=e,this._host.style.setProperty("--advanced-camera-card-status-bar-height",`${e.height}px`),this._host.setAttribute("data-style",e.style),this._host.setAttribute("data-position",e.position),"popup"!==this._config?.style&&this._show(),this._host.requestUpdate()}getConfig(){return this._config}shouldRender(){return this._items.some((e=>!1!==e.enabled&&e.sufficient))}actionHandler(e,t){e.stopPropagation();const n=$d(e.detail.action,t);n&&eT(this._host,{actions:id(n),config:t})}_getSufficientValue(e){
/* istanbul ignore else: cannot happen -- @preserve */
return"custom:advanced-camera-card-status-bar-icon"===e.type?e.icon:"custom:advanced-camera-card-status-bar-string"===e.type?e.string:"custom:advanced-camera-card-status-bar-image"===e.type?e.image:null}_getSufficientValues(e){return e.filter((e=>!1!==e.enabled&&e.sufficient)).map((e=>this._getSufficientValue(e)))}_show(){fd(this._host,!1,"hide")}_hide(){fd(this._host,!0,"hide")}}let tO=class extends oe{constructor(){super(...arguments),this._controller=new eO(this)}willUpdate(e){e.has("config")&&this.config&&this._controller.setConfig(this.config),e.has("items")&&this._controller.setItems(this.items??[])}_renderPerInstanceStyle(){const e=this._controller.getConfig();if(!e)return;const t=e.position,n=e.style,i=e=>`\n        var(--advanced-camera-card-status-bar-override-${e},\n        var(--advanced-camera-card-status-bar-position-${t}-style-${n}-${e},\n        var(--advanced-camera-card-status-bar-position-${t}-${e},\n        var(--advanced-camera-card-status-bar-style-${n}-${e},\n        var(--advanced-camera-card-status-bar-${e})))))`;return U`<style>
      :host(${`[data-position='${t}'][data-style='${n}']`}) {
        color: ${i("color")};
        background: ${i("background")};
      }
    </style>`}render(){if(this._controller.shouldRender())return U`
      ${this._renderPerInstanceStyle()}
      <div class="status">
        ${this._controller.getRenderItems().map((e=>{if(!1===e.enabled)return;const t=_e({item:!0,expand:!!e.expand,action:!!Object.keys(e.actions??{}).length}),n=Rd({hasHold:Id(e.actions?.hold_action),hasDoubleClick:Id(e.actions?.double_tap_action)});return"custom:advanced-camera-card-status-bar-string"===e.type?U`<div
              .actionHandler=${n}
              class="${t}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            >
              ${e.string}
            </div>`:"custom:advanced-camera-card-status-bar-icon"===e.type?U`<advanced-camera-card-icon
              .actionHandler=${n}
              .icon=${{icon:e.icon}}
              class="${t}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            ></advanced-camera-card-icon>`:"custom:advanced-camera-card-status-bar-image"===e.type?U`<img
              .actionHandler=${n}
              class="${t}"
              src="${e.image}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            />`:void 0}))}
      </div>
    `}static get styles(){return s("ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  --mdc-icon-size: calc(var(--advanced-camera-card-status-bar-height) / 2);\n  display: block;\n  width: 100%;\n  pointer-events: auto;\n  opacity: 1;\n  transition: opacity 1s;\n}\n\n/*******************************************************\n * Non-hover styles should not interact with the pointer\n *******************************************************/\n:host(:not([data-style*=hover])) {\n  pointer-events: none;\n}\n\n/**********************\n * Popup style behavior\n **********************/\n:host([data-style=popup][hide]) {\n  opacity: 0;\n}\n\n/*********************\n * Status bar contents\n *********************/\n.status {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  overflow: hidden;\n  width: 100%;\n  height: var(--advanced-camera-card-status-bar-height);\n}\n\n.item {\n  display: inline-block;\n  margin: 3px 5px;\n  align-content: center;\n}\n\n.item:first-child {\n  margin-left: 10px;\n}\n\n.item:last-child {\n  margin-right: 10px;\n}\n\n.item.expand {\n  flex: 1;\n}\n\n.item.action {\n  cursor: pointer;\n}\n\nimg.item,\nadvanced-camera-card-icon.item {\n  display: block;\n  height: var(--mdc-icon-size, 24px);\n  width: auto;\n}\n\n/************************\n * Status bar theme hooks\n ************************/")}};e([he({attribute:!1})],tO.prototype,"items",void 0),e([he({attribute:!1})],tO.prototype,"config",void 0),tO=e([le("advanced-camera-card-status-bar")],tO);class nO{constructor(e){this._keys=e}modify(e){this._keys.forEach((t=>e.removeContext(t)))}}const iO=(e,t,n)=>{Ld(t);const i=n?.manager.getView()?.query;if(!i||!cA.isFolderQuery(i))return;const a=i?.getQuery();if(!a?.path||a?.path.length<=1)return;const r=a.path.slice(0,-1);n?.manager.setViewByParametersWithExistingQuery({params:{query:i.clone().setQuery({folder:a.folder,path:[r[0],...r.slice(1)]})}})},aO=e=>{const t=e?.query;if(!t||!cA.isFolderQuery(t))return null;const n=t.getQuery();return!n?.folder||!n?.path||n.path.length<=1?null:new Gd(n.folder,{icon:"mdi:arrow-up-left"})};function rO(e){return"number"==typeof e}function sO(e){return"string"==typeof e}function oO(e){return"boolean"==typeof e}function cO(e){return"[object Object]"===Object.prototype.toString.call(e)}function lO(e){return Math.abs(e)}function uO(e){return Math.sign(e)}function dO(e,t){return lO(e-t)}function hO(e){return _O(e).map(Number)}function pO(e){return e[mO(e)]}function mO(e){return Math.max(0,e.length-1)}function fO(e,t){return t===mO(e)}function gO(e,t=0){return Array.from(Array(e),((e,n)=>t+n))}function _O(e){return Object.keys(e)}function vO(e,t){return[e,t].reduce(((e,t)=>(_O(t).forEach((n=>{const i=e[n],a=t[n],r=cO(i)&&cO(a);e[n]=r?vO(i,a):a})),e)),{})}function yO(e,t){return void 0!==t.MouseEvent&&e instanceof t.MouseEvent}function bO(){let e=[];const t={add:function(n,i,a,r={passive:!0}){let s;if("addEventListener"in n)n.addEventListener(i,a,r),s=()=>n.removeEventListener(i,a,r);else{const e=n;e.addListener(a),s=()=>e.removeListener(a)}return e.push(s),t},clear:function(){e=e.filter((e=>e()))}};return t}function wO(e,t,n,i){const a=bO(),r=1e3/60;let s=null,o=0,c=0;function l(e){if(!c)return;s||(s=e);const a=e-s;for(s=e,o+=a;o>=r;)n(r),o-=r;i(o/r),c&&t.requestAnimationFrame(l)}function u(){t.cancelAnimationFrame(c),s=null,o=0,c=0}return{init:function(){a.add(e,"visibilitychange",(()=>{e.hidden&&(s=null,o=0)}))},destroy:function(){u(),a.clear()},start:function(){c||(c=t.requestAnimationFrame(l))},stop:u,update:()=>n(r),render:i}}function xO(e=0,t=0){const n=lO(e-t);function i(t){return t<e}function a(e){return e>t}function r(e){return i(e)||a(e)}const s={length:n,max:t,min:e,constrain:function(n){return r(n)?i(n)?e:t:n},reachedAny:r,reachedMax:a,reachedMin:i,removeOffset:function(e){return n?e-n*Math.ceil((e-t)/n):e}};return s}function MO(e,t,n){const{constrain:i}=xO(0,e),a=e+1;let r=s(t);function s(e){return n?lO((a+e)%a):i(e)}function o(){return r}function c(){return MO(e,o(),n)}const l={get:o,set:function(e){return r=s(e),l},add:function(e){return c().set(o()+e)},clone:c};return l}function kO(e,t,n,i,a,r,s,o,c,l,u,d,h,p,m,f,g,_,v){const{cross:y,direction:b}=e,w=["INPUT","SELECT","TEXTAREA"],x={passive:!1},M=bO(),k=bO(),C=xO(50,225).constrain(p.measure(20)),S={mouse:300,touch:400},E={mouse:500,touch:600},A=m?43:25;let T=!1,$=0,I=0,O=!1,L=!1,D=!1,j=!1;function z(e){if(!yO(e,i)&&e.touches.length>=2)return R(e);const t=r.readPoint(e),n=r.readPoint(e,y),s=dO(t,$),c=dO(n,I);if(!L&&!j){if(!e.cancelable)return R(e);if(L=s>c,!L)return R(e)}const u=r.pointerMove(e);s>f&&(D=!0),l.useFriction(.3).useDuration(.75),o.start(),a.add(b(u)),e.preventDefault()}function R(e){const t=u.byDistance(0,!1).index!==d.get(),n=r.pointerUp(e)*(m?E:S)[j?"mouse":"touch"],i=function(e,t){const n=d.add(-1*uO(e)),i=u.byDistance(e,!m).distance;return m||lO(e)<C?i:g&&t?.5*i:u.byIndex(n.get(),0).distance}(b(n),t),a=function(e,t){if(0===e||0===t)return 0;if(lO(e)<=lO(t))return 0;const n=dO(lO(e),lO(t));return lO(n/e)}(n,i),s=A-10*a,o=_+a/50;L=!1,O=!1,k.clear(),l.useDuration(s).useFriction(o),c.distance(i,!m),j=!1,h.emit("pointerUp")}function P(e){D&&(e.stopPropagation(),e.preventDefault(),D=!1)}return{init:function(e){if(!v)return;function o(o){(oO(v)||v(e,o))&&function(e){const o=yO(e,i);if(j=o,D=m&&o&&!e.buttons&&T,T=dO(a.get(),s.get())>=2,o&&0!==e.button)return;if(function(e){const t=e.nodeName||"";return w.includes(t)}(e.target))return;O=!0,r.pointerDown(e),l.useFriction(0).useDuration(0),a.set(s),function(){const e=j?n:t;k.add(e,"touchmove",z,x).add(e,"touchend",R).add(e,"mousemove",z,x).add(e,"mouseup",R)}(),$=r.readPoint(e),I=r.readPoint(e,y),h.emit("pointerDown")}(o)}const c=t;M.add(c,"dragstart",(e=>e.preventDefault()),x).add(c,"touchmove",(()=>{}),x).add(c,"touchend",(()=>{})).add(c,"touchstart",o).add(c,"mousedown",o).add(c,"touchcancel",R).add(c,"contextmenu",R).add(c,"click",P,!0)},destroy:function(){M.clear(),k.clear()},pointerDown:function(){return O}}}function CO(e,t){let n,i;function a(e){return e.timeStamp}function r(n,i){const a="client"+("x"===(i||e.scroll)?"X":"Y");return(yO(n,t)?n:n.touches[0])[a]}return{pointerDown:function(e){return n=e,i=e,r(e)},pointerMove:function(e){const t=r(e)-r(i),s=a(e)-a(n)>170;return i=e,s&&(n=e),t},pointerUp:function(e){if(!n||!i)return 0;const t=r(i)-r(n),s=a(e)-a(n),o=a(e)-a(i)>170,c=t/s;return s&&!o&&lO(c)>.1?c:0},readPoint:r}}function SO(e,t,n,i,a,r,s){const o=[e].concat(i);let c,l,u=[],d=!1;function h(e){return a.measureSize(s.measure(e))}return{init:function(a){r&&(l=h(e),u=i.map(h),c=new ResizeObserver((n=>{(oO(r)||r(a,n))&&function(n){for(const r of n){if(d)return;const n=r.target===e,s=i.indexOf(r.target),o=n?l:u[s];if(lO(h(n?e:i[s])-o)>=.5){a.reInit(),t.emit("resize");break}}}(n)})),n.requestAnimationFrame((()=>{o.forEach((e=>c.observe(e)))})))},destroy:function(){d=!0,c&&c.disconnect()}}}function EO(e,t,n,i,a){const r=a.measure(10),s=a.measure(50),o=xO(.1,.99);let c=!1;function l(){return!c&&(!!e.reachedAny(n.get())&&!!e.reachedAny(t.get()))}return{shouldConstrain:l,constrain:function(a){if(!l())return;const c=e.reachedMin(t.get())?"min":"max",u=lO(e[c]-t.get()),d=n.get()-t.get(),h=o.constrain(u/s);n.subtract(d*h),!a&&lO(d)<r&&(n.set(e.constrain(n.get())),i.useDuration(25).useBaseFriction())},toggleActive:function(e){c=!e}}}function AO(e,t,n,i){const a=t.min+.1,r=t.max+.1,{reachedMin:s,reachedMax:o}=xO(a,r);const c={loop:function(t){if(!function(e){return 1===e?o(n.get()):-1===e&&s(n.get())}(t))return;const a=e*(-1*t);i.forEach((e=>e.add(a)))}};return c}function TO(e,t,n,i,a){const{reachedAny:r,removeOffset:s,constrain:o}=i;function c(e){return e.concat().sort(((e,t)=>lO(e)-lO(t)))[0]}function l(t,i){const a=[t,t+n,t-n];if(!e)return t;if(!i)return c(a);const r=a.filter((e=>uO(e)===i));return r.length?c(r):pO(a)-n}const u={byDistance:function(n,i){const c=a.get()+n,{index:u,distance:d}=function(n){const i=e?s(n):o(n),a=t.map(((e,t)=>({diff:l(e-i,0),index:t}))).sort(((e,t)=>lO(e.diff)-lO(t.diff))),{index:r}=a[0];return{index:r,distance:i}}(c),h=!e&&r(c);return!i||h?{index:u,distance:n}:{index:u,distance:n+l(t[u]-d,0)}},byIndex:function(e,n){return{index:e,distance:l(t[e]-a.get(),n)}},shortcut:l};return u}function $O(e,t,n,i,a,r,s,o){const c={passive:!0,capture:!0};let l=0;function u(e){"Tab"===e.code&&(l=(new Date).getTime())}return{init:function(d){o&&(r.add(document,"keydown",u,!1),t.forEach(((t,u)=>{r.add(t,"focus",(t=>{(oO(o)||o(d,t))&&function(t){if((new Date).getTime()-l>10)return;s.emit("slideFocusStart"),e.scrollLeft=0;const r=n.findIndex((e=>e.includes(t)));rO(r)&&(a.useDuration(0),i.index(r,0),s.emit("slideFocus"))}(u)}),c)})))}}}function IO(e){let t=e;function n(e){return rO(e)?e:e.get()}const i={get:function(){return t},set:function(e){t=n(e)},add:function(e){t+=n(e)},subtract:function(e){t-=n(e)}};return i}function OO(e,t){const n="x"===e.scroll?function(e){return`translate3d(${e}px,0px,0px)`}:function(e){return`translate3d(0px,${e}px,0px)`},i=t.style;let a=!1;return{clear:function(){a||(i.transform="",t.getAttribute("style")||t.removeAttribute("style"))},to:function(t){a||(i.transform=n(e.direction(t)))},toggleActive:function(e){a=!e}}}function LO(e,t,n,i,a,r,s,o,c){const l=.5,u=hO(a),d=hO(a).reverse(),h=function(){const e=s[0];return f(m(d,e),n,!1)}().concat(function(){const e=t-s[0]-1;return f(m(u,e),-n,!0)}());function p(e,t){return e.reduce(((e,t)=>e-a[t]),t)}function m(e,t){return e.reduce(((e,n)=>p(e,t)>0?e.concat([n]):e),[])}function f(a,s,u){const d=function(e){return r.map(((n,a)=>({start:n-i[a]+l+e,end:n+t-l+e})))}(s);return a.map((t=>{const i=u?0:-n,a=u?n:0,r=u?"end":"start",s=d[t][r];return{index:t,loopPoint:s,slideLocation:IO(-1),translate:OO(e,c[t]),target:()=>o.get()>s?i:a}}))}const g={canLoop:function(){return h.every((({index:e})=>{const n=u.filter((t=>t!==e));return p(n,t)<=.1}))},clear:function(){h.forEach((e=>e.translate.clear()))},loop:function(){h.forEach((e=>{const{target:t,translate:n,slideLocation:i}=e,a=t();a!==i.get()&&(n.to(a),i.set(a))}))},loopPoints:h};return g}function DO(e,t,n){let i,a=!1;return{init:function(r){n&&(i=new MutationObserver((e=>{a||(oO(n)||n(r,e))&&function(e){for(const n of e)if("childList"===n.type){r.reInit(),t.emit("slidesChanged");break}}(e)})),i.observe(e,{childList:!0}))},destroy:function(){i&&i.disconnect(),a=!0}}}function jO(e,t,n,i){const a={};let r,s=null,o=null,c=!1;const l={init:function(){r=new IntersectionObserver((e=>{c||(e.forEach((e=>{const n=t.indexOf(e.target);a[n]=e})),s=null,o=null,n.emit("slidesInView"))}),{root:e.parentElement,threshold:i}),t.forEach((e=>r.observe(e)))},destroy:function(){r&&r.disconnect(),c=!0},get:function(e=!0){if(e&&s)return s;if(!e&&o)return o;const t=function(e){return _O(a).reduce(((t,n)=>{const i=parseInt(n),{isIntersecting:r}=a[i];return(e&&r||!e&&!r)&&t.push(i),t}),[])}(e);return e&&(s=t),e||(o=t),t}};return l}function zO(e,t,n,i,a,r,s,o,c){const{startEdge:l,endEdge:u,direction:d}=e,h=rO(n);const p={groupSlides:function(e){return h?function(e,t){return hO(e).filter((e=>e%t==0)).map((n=>e.slice(n,n+t)))}(e,n):function(e){return e.length?hO(e).reduce(((n,h,p)=>{const m=pO(n)||0,f=0===m,g=h===mO(e),_=a[l]-r[m][l],v=a[l]-r[h][u],y=!i&&f?d(s):0,b=lO(v-(!i&&g?d(o):0)-(_+y));return p&&b>t+c&&n.push(h),g&&n.push(e.length),n}),[]).map(((t,n,i)=>{const a=Math.max(i[n-1]||0);return e.slice(a,t)})):[]}(e)}};return p}function RO(e,t,n,i,a,r,s){const{align:o,axis:c,direction:l,startIndex:u,loop:d,duration:h,dragFree:p,dragThreshold:m,inViewThreshold:f,slidesToScroll:g,skipSnaps:_,containScroll:v,watchResize:y,watchSlides:b,watchDrag:w,watchFocus:x}=r,M={measure:function(e){const{offsetTop:t,offsetLeft:n,offsetWidth:i,offsetHeight:a}=e;return{top:t,right:n+i,bottom:t+a,left:n,width:i,height:a}}},k=M.measure(t),C=n.map(M.measure),S=function(e,t){const n="rtl"===t,i="y"===e,a=!i&&n?-1:1,r={scroll:i?"y":"x",cross:i?"x":"y",startEdge:i?"top":n?"right":"left",endEdge:i?"bottom":n?"left":"right",measureSize:function(e){const{height:t,width:n}=e;return i?t:n},direction:function(e){return e*a}};return r}(c,l),E=S.measureSize(k),A=function(e){const t={measure:function(t){return e*(t/100)}};return t}(E),T=function(e,t){const n={start:function(){return 0},center:function(e){return i(e)/2},end:i};function i(e){return t-e}const a={measure:function(i,a){return sO(e)?n[e](i):e(t,i,a)}};return a}(o,E),$=!d&&!!v,I=d||!!v,{slideSizes:O,slideSizesWithGaps:L,startGap:D,endGap:j}=function(e,t,n,i,a,r){const{measureSize:s,startEdge:o,endEdge:c}=e,l=n[0]&&a,u=function(){if(!l)return 0;const e=n[0];return lO(t[o]-e[o])}(),d=function(){if(!l)return 0;const e=r.getComputedStyle(pO(i));return parseFloat(e.getPropertyValue(`margin-${c}`))}(),h=n.map(s),p=n.map(((e,t,n)=>{const i=!t,a=fO(n,t);return i?h[t]+u:a?h[t]+d:n[t+1][o]-e[o]})).map(lO);return{slideSizes:h,slideSizesWithGaps:p,startGap:u,endGap:d}}(S,k,C,n,I,a),z=zO(S,E,g,d,k,C,D,j,2),{snaps:R,snapsAligned:P}=function(e,t,n,i,a){const{startEdge:r,endEdge:s}=e,{groupSlides:o}=a,c=o(i).map((e=>pO(e)[s]-e[0][r])).map(lO).map(t.measure),l=i.map((e=>n[r]-e[r])).map((e=>-lO(e))),u=o(l).map((e=>e[0])).map(((e,t)=>e+c[t]));return{snaps:l,snapsAligned:u}}(S,T,k,C,z),N=-pO(R)+pO(L),{snapsContained:F,scrollContainLimit:V}=function(e,t,n,i,a){const r=xO(-t+e,0),s=n.map(((e,t)=>{const{min:i,max:a}=r,s=r.constrain(e),o=!t,c=fO(n,t);return o?a:c||l(i,s)?i:l(a,s)?a:s})).map((e=>parseFloat(e.toFixed(3)))),o=function(){const e=s[0],t=pO(s);return xO(s.lastIndexOf(e),s.indexOf(t)+1)}(),c=function(){if(t<=e+a)return[r.max];if("keepSnaps"===i)return s;const{min:n,max:c}=o;return s.slice(n,c)}();function l(e,t){return dO(e,t)<1}return{snapsContained:c,scrollContainLimit:o}}(E,N,P,v,2),B=$?F:P,{limit:H}=function(e,t,n){const i=t[0];return{limit:xO(n?i-e:pO(t),i)}}(N,B,d),U=MO(mO(B),u,d),q=U.clone(),W=hO(n),Z=wO(i,a,(e=>(({dragHandler:e,scrollBody:t,scrollBounds:n,options:{loop:i}},a)=>{i||n.constrain(e.pointerDown()),t.seek(a)})(oe,e)),(e=>(({scrollBody:e,translate:t,location:n,offsetLocation:i,scrollLooper:a,slideLooper:r,dragHandler:s,animation:o,eventHandler:c,scrollBounds:l,options:{loop:u}},d)=>{const h=e.settled(),p=!l.shouldConstrain(),m=u?h:h&&p;m&&!s.pointerDown()&&(o.stop(),c.emit("settle")),m||c.emit("scroll");const f=n.get()*d+Y.get()*(1-d);i.set(f),u&&(a.loop(e.direction()),r.loop()),t.to(i.get())})(oe,e))),K=B[U.get()],Q=IO(K),Y=IO(K),G=IO(K),X=IO(K),J=function(e,t,n,i,a,r){let s=0,o=0,c=a,l=r,u=e.get(),d=0;function h(e){return c=e,m}function p(e){return l=e,m}const m={direction:function(){return o},duration:function(){return c},velocity:function(){return s},seek:function(t){const a=t/1e3,r=c*a,h=i.get()-e.get();let p=0;return c?(n.set(e),s+=h/r,s*=l,u+=s,e.add(s*a),p=u-d):(s=0,n.set(i),e.set(i),p=h),o=uO(p),d=u,m},settled:function(){return lO(i.get()-t.get())<.001},useBaseFriction:function(){return p(r)},useBaseDuration:function(){return h(a)},useFriction:p,useDuration:h};return m}(Q,G,Y,X,h,.68),ee=TO(d,B,N,H,X),te=function(e,t,n,i,a,r,s){function o(a){const o=a.distance,c=a.index!==t.get();r.add(o),o&&(i.duration()?e.start():(e.update(),e.render(1),e.update())),c&&(n.set(t.get()),t.set(a.index),s.emit("select"))}const c={distance:function(e,t){o(a.byDistance(e,t))},index:function(e,n){const i=t.clone().set(e);o(a.byIndex(i.get(),n))}};return c}(Z,U,q,J,ee,X,s),ne=function(e){const{max:t,length:n}=e,i={get:function(e){return n?(e-t)/-n:0}};return i}(H),ie=bO(),ae=jO(t,n,s,f),{slideRegistry:re}=function(e,t,n,i,a,r){const{groupSlides:s}=a,{min:o,max:c}=i;return{slideRegistry:function(){const i=s(r),a=!e||"keepSnaps"===t;return 1===n.length?[r]:a?i:i.slice(o,c).map(((e,t,n)=>{const i=!t,a=fO(n,t);return i?gO(pO(n[0])+1):a?gO(mO(r)-pO(n)[0]+1,pO(n)[0]):e}))}()}}($,v,B,V,z,W),se=$O(e,n,re,te,J,ie,s,x),oe={ownerDocument:i,ownerWindow:a,eventHandler:s,containerRect:k,slideRects:C,animation:Z,axis:S,dragHandler:kO(S,e,i,a,X,CO(S,a),Q,Z,te,J,ee,U,s,A,p,m,_,.68,w),eventStore:ie,percentOfView:A,index:U,indexPrevious:q,limit:H,location:Q,offsetLocation:G,previousLocation:Y,options:r,resizeHandler:SO(t,s,a,n,S,y,M),scrollBody:J,scrollBounds:EO(H,G,X,J,A),scrollLooper:AO(N,H,G,[Q,G,Y,X]),scrollProgress:ne,scrollSnapList:B.map(ne.get),scrollSnaps:B,scrollTarget:ee,scrollTo:te,slideLooper:LO(S,E,N,O,L,R,B,G,n),slideFocus:se,slidesHandler:DO(t,s,b),slidesInView:ae,slideIndexes:W,slideRegistry:re,slidesToScroll:z,target:X,translate:OO(S,t)};return oe}const PO={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function NO(e){function t(e,t){return vO(e,t||{})}const n={mergeOptions:t,optionsAtMedia:function(n){const i=n.breakpoints||{},a=_O(i).filter((t=>e.matchMedia(t).matches)).map((e=>i[e])).reduce(((e,n)=>t(e,n)),{});return t(n,a)},optionsMediaQueries:function(t){return t.map((e=>_O(e.breakpoints||{}))).reduce(((e,t)=>e.concat(t)),[]).map(e.matchMedia)}};return n}function FO(e,t,n){const i=e.ownerDocument,a=i.defaultView,r=NO(a),s=function(e){let t=[];const n={init:function(n,i){return t=i.filter((({options:t})=>!1!==e.optionsAtMedia(t).active)),t.forEach((t=>t.init(n,e))),i.reduce(((e,t)=>Object.assign(e,{[t.name]:t})),{})},destroy:function(){t=t.filter((e=>e.destroy()))}};return n}(r),o=bO(),c=function(){let e,t={};function n(e){return t[e]||[]}const i={init:function(t){e=t},emit:function(t){return n(t).forEach((n=>n(e,t))),i},off:function(e,a){return t[e]=n(e).filter((e=>e!==a)),i},on:function(e,a){return t[e]=n(e).concat([a]),i},clear:function(){t={}}};return i}(),{mergeOptions:l,optionsAtMedia:u,optionsMediaQueries:d}=r,{on:h,off:p,emit:m}=c,f=S;let g,_,v,y,b=!1,w=l(PO,FO.globalOptions),x=l(w),M=[];function k(t){const n=RO(e,v,y,i,a,t,c);if(t.loop&&!n.slideLooper.canLoop()){return k(Object.assign({},t,{loop:!1}))}return n}function C(t,n){b||(w=l(w,t),x=u(w),M=n||M,function(){const{container:t,slides:n}=x,i=sO(t)?e.querySelector(t):t;v=i||e.children[0];const a=sO(n)?v.querySelectorAll(n):n;y=[].slice.call(a||v.children)}(),g=k(x),d([w,...M.map((({options:e})=>e))]).forEach((e=>o.add(e,"change",S))),x.active&&(g.translate.to(g.location.get()),g.animation.init(),g.slidesInView.init(),g.slideFocus.init($),g.eventHandler.init($),g.resizeHandler.init($),g.slidesHandler.init($),g.options.loop&&g.slideLooper.loop(),v.offsetParent&&y.length&&g.dragHandler.init($),_=s.init($,M)))}function S(e,t){const n=T();E(),C(l({startIndex:n},e),t),c.emit("reInit")}function E(){g.dragHandler.destroy(),g.eventStore.clear(),g.translate.clear(),g.slideLooper.clear(),g.resizeHandler.destroy(),g.slidesHandler.destroy(),g.slidesInView.destroy(),g.animation.destroy(),s.destroy(),o.clear()}function A(e,t,n){x.active&&!b&&(g.scrollBody.useBaseFriction().useDuration(!0===t?0:x.duration),g.scrollTo.index(e,n||0))}function T(){return g.index.get()}const $={canScrollNext:function(){return g.index.add(1).get()!==T()},canScrollPrev:function(){return g.index.add(-1).get()!==T()},containerNode:function(){return v},internalEngine:function(){return g},destroy:function(){b||(b=!0,o.clear(),E(),c.emit("destroy"),c.clear())},off:p,on:h,emit:m,plugins:function(){return _},previousScrollSnap:function(){return g.indexPrevious.get()},reInit:f,rootNode:function(){return e},scrollNext:function(e){A(g.index.add(1).get(),e,-1)},scrollPrev:function(e){A(g.index.add(-1).get(),e,1)},scrollProgress:function(){return g.scrollProgress.get(g.location.get())},scrollSnapList:function(){return g.scrollSnapList},scrollTo:A,selectedScrollSnap:T,slideNodes:function(){return y},slidesInView:function(){return g.slidesInView.get()},slidesNotInView:function(){return g.slidesInView.get(!1)}};return C(t,n),setTimeout((()=>c.emit("init")),0),$}function VO(){return VO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},VO.apply(this,arguments)}FO.globalOptions=void 0;var BO=function(e,t){return void 0===t&&(t=.996),e*t/(1-t)};function HO(e,t){if(e.length!==t.length)throw new Error("vectors must be same length");return e.map((function(e,n){return e+t[n]}))}function UO(e){return Math.max.apply(Math,e.map(Math.abs))}function qO(e){return Object.freeze(e),Object.values(e).forEach((function(e){null===e||"object"!=typeof e||Object.isFrozen(e)||qO(e)})),e}var WO=[1,18,"undefined"!=typeof window&&window.innerHeight||800];var ZO=[-1,-1,-1];var KO=function(e){return VO({},e,{axisDelta:e.axisDelta.map((function(e){return function(e,t,n){return Math.min(Math.max(t,e),n)}(e,-700,700)}))})},QO=.6,YO=.96,GO=2,XO=5,JO=qO({preventWheelAction:!0,reverseSign:[!0,!0,!1]}),eL=400;function tL(){return{isStarted:!1,isStartPublished:!1,isMomentum:!1,startTime:0,lastAbsDelta:1/0,axisMovement:[0,0,0],axisVelocity:[0,0,0],accelerationFactors:[],scrollPoints:[],scrollPointsToMerge:[],willEndTimeout:eL}}function nL(e){void 0===e&&(e={});var t,n,i,a=function(){var e={};function t(t,n){e[t]=(e[t]||[]).filter((function(e){return e!==n}))}return qO({on:function(n,i){return e[n]=(e[n]||[]).concat(i),function(){return t(n,i)}},off:t,dispatch:function(t,n){t in e&&e[t].forEach((function(e){return e(n)}))}})}(),r=a.on,s=a.off,o=a.dispatch,c=JO,l=tL(),u=!1,d=function(e){Array.isArray(e)?e.forEach((function(e){return m(e)})):m(e)},h=function(e){return void 0===e&&(e={}),Object.values(e).some((function(e){return null==e}))?c:c=qO(VO({},JO,c,e))},p=function(e){var i=VO({event:t,isStart:!1,isEnding:!1,isMomentumCancel:!1,isMomentum:l.isMomentum,axisDelta:[0,0,0],axisVelocity:l.axisVelocity,axisMovement:l.axisMovement,get axisMovementProjection(){return HO(i.axisMovement,i.axisVelocity.map((function(e){return BO(e)})))}},e);o("wheel",VO({},i,{previous:n})),n=i},m=function(e){var n=KO(function(e,t){if(!t)return e;var n=!0===t?ZO:t.map((function(e){return e?-1:1}));return VO({},e,{axisDelta:e.axisDelta.map((function(e,t){return e*n[t]}))})}(function(e){var t=e.deltaX*WO[e.deltaMode],n=e.deltaY*WO[e.deltaMode],i=(e.deltaZ||0)*WO[e.deltaMode];return{timeStamp:e.timeStamp,axisDelta:[t,n,i]}}(e),c.reverseSign)),i=n.axisDelta,a=n.timeStamp,r=UO(i);e.preventDefault&&function(e,t){var n=c.preventWheelAction,i=t[0],a=t[1],r=t[2];if("boolean"==typeof n)return n;switch(n){case"x":return Math.abs(i)>=e;case"y":return Math.abs(a)>=e;case"z":return Math.abs(r)>=e;default:return!1}}(r,i)&&e.preventDefault(),l.isStarted?l.isMomentum&&r>Math.max(2,2*l.lastAbsDelta)&&(k(!0),x()):x(),0===r&&Object.is&&Object.is(e.deltaX,-0)?u=!0:(t=e,l.axisMovement=HO(l.axisMovement,i),l.lastAbsDelta=r,l.scrollPointsToMerge.push({axisDelta:i,timeStamp:a}),f(),p({axisDelta:i,isStart:!l.isStartPublished}),l.isStartPublished=!0,M())},f=function(){var e;l.scrollPointsToMerge.length===GO?(l.scrollPoints.unshift({axisDeltaSum:l.scrollPointsToMerge.map((function(e){return e.axisDelta})).reduce(HO),timeStamp:(e=l.scrollPointsToMerge.map((function(e){return e.timeStamp})),e.reduce((function(e,t){return e+t}))/e.length)}),_(),l.scrollPointsToMerge.length=0,l.scrollPoints.length=1,l.isMomentum||b()):l.isStartPublished||g()},g=function(){var e;l.axisVelocity=(e=l.scrollPointsToMerge,e[e.length-1]).axisDelta.map((function(e){return e/l.willEndTimeout}))},_=function(){var e=l.scrollPoints,t=e[0],n=e[1];if(n&&t){var i=t.timeStamp-n.timeStamp;if(!(i<=0)){var a=t.axisDeltaSum.map((function(e){return e/i})),r=a.map((function(e,t){return e/(l.axisVelocity[t]||1)}));l.axisVelocity=a,l.accelerationFactors.push(r),v(i)}}},v=function(e){var t=10*Math.ceil(e/10)*1.2;l.isMomentum||(t=Math.max(100,2*t)),l.willEndTimeout=Math.min(1e3,Math.round(t))},y=function(e){return 0===e||e<=YO&&e>=QO},b=function(){if(l.accelerationFactors.length>=XO){if(u&&(u=!1,UO(l.axisVelocity)>=.2))return void w();var e=l.accelerationFactors.slice(-1*XO);e.every((function(e){var t=!!e.reduce((function(e,t){return e&&e<1&&e===t?1:0})),n=e.filter(y).length===e.length;return t||n}))&&w(),l.accelerationFactors=e}},w=function(){l.isMomentum=!0},x=function(){(l=tL()).isStarted=!0,l.startTime=Date.now(),n=void 0,u=!1},M=function(){clearTimeout(i),i=setTimeout(k,l.willEndTimeout)},k=function(e){void 0===e&&(e=!1),l.isStarted&&(l.isMomentum&&e?p({isEnding:!0,isMomentumCancel:!0}):p({isEnding:!0}),l.isMomentum=!1,l.isStarted=!1)},C=function(e){var t=[],n=function(n){n.removeEventListener("wheel",e),t=t.filter((function(e){return e!==n}))};return qO({observe:function(i){return i.addEventListener("wheel",e,{passive:!1}),t.push(i),function(){return n(i)}},unobserve:n,disconnect:function(){t.forEach(n)}})}(d),S=C.observe,E=C.unobserve,A=C.disconnect;return h(e),qO({on:r,off:s,observe:S,unobserve:E,disconnect:A,feedWheel:d,updateOptions:h})}var iL={active:!0,breakpoints:{},wheelDraggingClass:"is-wheel-dragging",forceWheelAxis:void 0,target:void 0};function aL(e){var t;void 0===e&&(e={});var n=function(){};var i={name:"wheelGestures",options:e,init:function(i,a){var r,s,o=a.mergeOptions,c=a.optionsAtMedia,l=o(iL,aL.globalOptions),u=o(l,e);t=c(u);var d,h=i.internalEngine(),p=null!=(r=t.target)?r:i.containerNode().parentNode,m=null!=(s=t.forceWheelAxis)?s:h.options.axis,f=nL({preventWheelAction:m,reverseSign:[!0,!0,!1]}),g=f.observe(p),_=f.on("wheel",(function(e){var i=e.axisDelta,a=i[0],r=i[1],s="x"===m?a:r,o="x"===m?r:a,c=e.isMomentum&&e.previous&&!e.previous.isMomentum,l=e.isEnding&&!e.isMomentum||c;Math.abs(s)>Math.abs(o)&&!v&&!e.isMomentum&&function(e){try{x(d=new MouseEvent("mousedown",e.event))}catch(e){return n()}v=!0,document.documentElement.addEventListener("mousemove",b,!0),document.documentElement.addEventListener("mouseup",b,!0),void document.documentElement.addEventListener("mousedown",b,!0),t.wheelDraggingClass&&p.classList.add(t.wheelDraggingClass)}(e);if(!v)return;l?function(e){v=!1,x(w("mouseup",e)),y(),t.wheelDraggingClass&&p.classList.remove(t.wheelDraggingClass)}(e):x(w("mousemove",e))})),v=!1;function y(){document.documentElement.removeEventListener("mousemove",b,!0),document.documentElement.removeEventListener("mouseup",b,!0),document.documentElement.removeEventListener("mousedown",b,!0)}function b(e){v&&e.isTrusted&&e.stopImmediatePropagation()}function w(e,t){var n,i;if(m===h.options.axis){var a=t.axisMovement;n=a[0],i=a[1]}else{var r=t.axisMovement;i=r[0],n=r[1]}if(!h.options.skipSnaps&&!h.options.dragFree){var s=h.containerRect.width,o=h.containerRect.height;n=n<0?Math.max(n,-s):Math.min(n,s),i=i<0?Math.max(i,-o):Math.min(i,o)}return new MouseEvent(e,{clientX:d.clientX+n,clientY:d.clientY+i,screenX:d.screenX+n,screenY:d.screenY+i,movementX:n,movementY:i,button:0,bubbles:!0,cancelable:!0,composed:!0})}function x(e){i.containerNode().dispatchEvent(e)}n=function(){g(),_(),y()}},destroy:function(){return n()}};return i}aL.globalOptions=void 0;class rL{constructor(e,t,n){this._mutationObserver=new MutationObserver(((e,t)=>this._refreshCarouselContents())),this._refreshCarouselContents=()=>{const e=vd(this._parent);!zu(this._carousel.slideNodes(),e)&&(this._carousel.destroy(),this._carousel=this._createCarousel(e))},this._root=e,this._parent=t,this._direction=n?.direction??"horizontal",this._transitionEffect=n?.transitionEffect??"slide",this._startIndex=n?.startIndex??0,this._dragFree=n?.dragFree??!1,this._loop=n?.loop??!1,this._draggable=n?.dragEnabled??!0,this._plugins=n?.plugins??[],this._textDirection=n?.textDirection??"ltr",this._carousel=this._createCarousel(vd(this._parent)),t instanceof HTMLSlotElement&&t.addEventListener("slotchange",this._refreshCarouselContents),this._mutationObserver.observe(this._parent,{childList:!0})}destroy(){this._parent instanceof HTMLSlotElement&&this._parent.removeEventListener("slotchange",this._refreshCarouselContents),this._mutationObserver.disconnect(),this._carousel.destroy()}getSlide(e){return this._carousel.slideNodes()[e]??null}getSelectedSlide(){return this.getSlide(this.getSelectedIndex())}getSelectedIndex(){return this._carousel.selectedScrollSnap()}selectSlide(e){this._carousel.scrollTo(e,"none"===this._transitionEffect);const t=this.getSlide(e);t&&VE(this._parent,"carousel:force-select",{index:e,element:t})}_createCarousel(e){const t=FO(this._root,{slides:e,axis:"horizontal"===this._direction?"x":"y",duration:20,startIndex:this._startIndex,dragFree:this._dragFree,loop:this._loop,containScroll:"trimSnaps",watchSlides:!1,watchResize:!0,watchDrag:this._draggable,direction:this._textDirection},[...this._plugins,...e.length>1?[aL({forceWheelAxis:"y"})]:[]]),n=()=>{const e=(()=>{const e=t.selectedScrollSnap(),n=t.slideNodes()[e]??null;return n?{index:e,element:n}:null})();e&&VE(this._parent,"carousel:select",e)};return t.on("select",(()=>n())),t}}const sL=e=>"rtl"===getComputedStyle(e).direction?"rtl":"ltr";let oL=class extends oe{constructor(){super(...arguments),this.direction="horizontal",this.dragEnabled=!0,this.selected=0,this._refParent=Te(),this._refRoot=Te(),this._carousel=null}connectedCallback(){super.connectedCallback(),this.requestUpdate()}disconnectedCallback(){this._carousel?.destroy(),this._carousel=null,super.disconnectedCallback()}willUpdate(e){e.has("direction")&&this.setAttribute("direction",this.direction);["direction","dragEnabled","dragFree","loop","plugins","transitionEffect"].some((t=>e.has(t)))&&(this._carousel?.destroy(),this._carousel=null)}render(){return U` <div class="embla">
      <slot name="left"></slot>
      <div ${Oe(this._refRoot)} class="embla__viewport">
        <div class="embla__container">
          <slot ${Oe(this._refParent)}></slot>
        </div>
      </div>
      <slot name="right"></slot>
    </div>`}updated(e){!this._carousel&&this._refRoot.value&&this._refParent.value&&this.isConnected?this._carousel=new rL(this._refRoot.value,this._refParent.value,{direction:this.direction,dragEnabled:this.dragEnabled,dragFree:this.dragFree,startIndex:this.selected,transitionEffect:this.transitionEffect,loop:this.loop,plugins:this.plugins,textDirection:sL(this)}):e.has("selected")&&this._carousel?.selectSlide(this.selected)}static get styles(){return s(":host {\n  display: block;\n  height: 100%;\n  width: 100%;\n  position: relative;\n}\n\n.embla {\n  width: 100%;\n  height: 100%;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.embla__container {\n  display: flex;\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  -webkit-touch-callout: none;\n  -khtml-user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n:host([direction=vertical]) .embla__container {\n  flex-direction: column;\n}\n\n:host([direction=horizontal]) .embla__container {\n  flex-direction: row;\n}\n\n.embla__viewport {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.embla__viewport.is-draggable {\n  cursor: move;\n  cursor: grab;\n}\n\n.embla__viewport.is-dragging {\n  cursor: grabbing;\n}\n\n:host([direction=vertical]) ::slotted(.embla__slide) {\n  margin-bottom: 5px;\n}\n\n:host([direction=horizontal]) ::slotted(.embla__slide) {\n  margin-right: 5px;\n}")}};e([he({attribute:!0,reflect:!0})],oL.prototype,"direction",void 0),e([he({attribute:!0})],oL.prototype,"transitionEffect",void 0),e([he({attribute:!1})],oL.prototype,"loop",void 0),e([he({attribute:!1})],oL.prototype,"dragFree",void 0),e([he({attribute:!1})],oL.prototype,"dragEnabled",void 0),e([he({attribute:!1})],oL.prototype,"plugins",void 0),e([he({attribute:!1})],oL.prototype,"selected",void 0),oL=e([le("advanced-camera-card-carousel")],oL);class cL{constructor(){this._details=[],this._heading=null}calculate(e,t,n){const i=Xd.isMedia(t)?t.getCameraID():null,a=i?e?.getCameraMetadata(i)??null:null;this._calculateHeading(a,t),this._calculateDetails(a,t,n)}_calculateHeading(e,t){if(Xd.isEvent(t)){const e=td(t.getWhat()?.join(", "))??null,n=td(t.getTags()?.join(", "))??null,i=e||n?(e??"")+(e&&n?": ":"")+(n??""):null,a=t.getScore(),r=a?(100*a).toFixed(2)+"%":null;this._heading=i?`${i}${r?` ${r}`:""}`:null}else this._heading=e?.title?e.title:null}_calculateDetails(e,t,n){const i=t?.getTitle()??null,a=Xd.isMedia(t)?t.getStartTime():null,r=Xd.isMedia(t)?t.getEndTime():null,s=a&&r?dd(a,r):null,o=Xd.isMedia(t)&&t.inProgress()?Hg("thumbnail.in_progress"):null,c=Xd.isMedia(t)?td(t?.getWhere()?.join(", "))??null:null,l=Xd.isEvent(t)?td(t?.getTags()?.join(", "))??null:null,u=n?Ea(n,"HH:mm:ss"):null,d=[...a?[{hint:Hg("thumbnail.start"),icon:{icon:"mdi:calendar-clock-outline"},title:Ea(a,"yyyy-MM-dd HH:mm:ss")}]:[],...s||o?[{hint:Hg("thumbnail.duration"),icon:{icon:"mdi:clock-outline"},title:`${s??""}${s&&o?" ":""}${o??""}`}]:[],...e?.title?[{hint:Hg("thumbnail.camera"),title:e.title,icon:{icon:"mdi:cctv"}}]:[],...c?[{hint:Hg("thumbnail.where"),title:c,icon:{icon:"mdi:map-marker-outline"}}]:[],...l?[{hint:Hg("thumbnail.tag"),title:l,icon:{icon:"mdi:tag"}}]:[],...u?[{hint:Hg("thumbnail.seek"),title:u,icon:{icon:"mdi:clock-fast"}}]:[]],h=!Xd.isEvent(t)||!a;this._details=[...h&&i?[{title:i,...d.length>0&&{icon:{icon:"mdi:rename"},hint:Hg("thumbnail.title")}}]:[],...d]}getHeading(){return this._heading}getDetails(){return this._details}}let lL=class extends oe{constructor(){super(...arguments),this._controller=new cL}willUpdate(e){["item","seek","cameraManager"].some((t=>e.has(t)))&&this._controller.calculate(this.cameraManager,this.item,this.seek)}render(){const e=this._controller.getHeading(),t=this._controller.getDetails();return U`
      ${e?U` <div class="heading">
            <span title=${e}>${e}</span>
          </div>`:""}
      ${t?U` <div class="details">
            ${t.map((e=>U`<div>
                  ${e.icon?U` <advanced-camera-card-icon
                        title=${e.hint??""}
                        .icon=${e.icon}
                      ></advanced-camera-card-icon>`:""}
                  <span>${e.title}</span>
                </div>`))}
          </div>`:""}
    `}static get styles(){return s(":host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  margin-left: 5px;\n  padding: 5px;\n  color: var(--advanced-camera-card-thumbnail-text-color);\n  overflow: hidden;\n  column-gap: 5%;\n}\n\ndiv.heading {\n  font-size: 1.2rem;\n  font-weight: bold;\n}\n\ndiv.details {\n  flex: 1;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: wrap;\n  --mdc-icon-size: 16px;\n  min-height: 0px;\n}\n\ndiv.details div {\n  display: flex;\n  align-items: center;\n}\n\ndiv.details div * {\n  margin: 0px 3px;\n}")}};e([he({attribute:!1})],lL.prototype,"hass",void 0),e([he({attribute:!1})],lL.prototype,"cameraManager",void 0),e([he({attribute:!1})],lL.prototype,"item",void 0),e([he({attribute:!1})],lL.prototype,"seek",void 0),lL=e([le("advanced-camera-card-thumbnail-details")],lL);const uL=e=>!!e?.startsWith("https://brands.home-assistant.io/");class dL{constructor(){this._title=null,this._subtitles=[],this._icon=null,this._thumbnail=null,this._thumbnailClass=null}calculate(e,t,n){const i=Xd.isMedia(t)?t.getCameraID():null,a=i?e?.getCameraMetadata(i)??null:null;this._calculateVisuals(a,t),this._calculateTitles(a,t,n)}_calculateTitles(e,t,n){if(n)return;if(this._thumbnail&&Xd.isMedia(t))return this._title=null,void(this._subtitles=[]);const i=Xd.isEvent(t)||Xd.isRecording(t)?t.getStartTime():null;this._title=i?Ea(i,"HH:mm"):null;const a=i?Ea(i,"MMM do"):null,r=t?.getTitle()??null,s=e?.title??r??null;this._subtitles=[...a?[a]:[],...s?[s]:[]]}_calculateVisuals(e,t){let n=t?.getThumbnail()??null;var i,a;n&&uL(n)&&(n=`https://brands.home-assistant.io/${(i={domain:(a=n,a.split("/")[4]),type:"icon",useFallback:!0,brand:!0}).brand?"brands/":""}${i.useFallback?"_/":""}${i.domain}/${i.darkOptimized?"dark_":""}${i.type}.png`),n?(this._thumbnail=n,this._icon=null,this._thumbnailClass=uL(n)?"brand":null):(this._thumbnail=null,this._thumbnailClass=null,this._icon=t?.getIcon()??e?.engineIcon??null)}getTitle(){return this._title}getSubtitles(){return this._subtitles}getIcon(){return this._icon}getThumbnail(){return this._thumbnail}getThumbnailClass(){return this._thumbnailClass}}
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const hL=window,pL=hL.ShadowRoot&&(void 0===hL.ShadyCSS||hL.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,mL=Symbol(),fL=new WeakMap;let gL=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==mL)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(pL&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=fL.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&fL.set(t,e))}return e}toString(){return this.cssText}};const _L=(e,t)=>{pL?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const n=document.createElement("style"),i=hL.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=t.cssText,e.appendChild(n)}))},vL=pL?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return(e=>new gL("string"==typeof e?e:e+"",void 0,mL))(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var yL;const bL=window,wL=bL.trustedTypes,xL=wL?wL.emptyScript:"",ML=bL.reactiveElementPolyfillSupport,kL={toAttribute(e,t){switch(t){case Boolean:e=e?xL:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},CL=(e,t)=>t!==e&&(t==t||e==e),SL={attribute:!0,type:String,converter:kL,reflect:!1,hasChanged:CL},EL="finalized";class AL extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const i=this._$Ep(n,t);void 0!==i&&(this._$Ev.set(i,n),e.push(i))})),e}static createProperty(e,t=SL){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,n,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||SL}static finalize(){if(this.hasOwnProperty(EL))return!1;this[EL]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(vL(e))}else void 0!==e&&t.push(vL(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return _L(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=SL){var i;const a=this.constructor._$Ep(e,n);if(void 0!==a&&!0===n.reflect){const r=(void 0!==(null===(i=n.converter)||void 0===i?void 0:i.toAttribute)?n.converter:kL).toAttribute(t,n.type);this._$El=e,null==r?this.removeAttribute(a):this.setAttribute(a,r),this._$El=null}}_$AK(e,t){var n;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:kL;this._$El=a,this[a]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let i=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||CL)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}AL[EL]=!0,AL.elementProperties=new Map,AL.elementStyles=[],AL.shadowRootOptions={mode:"open"},null==ML||ML({ReactiveElement:AL}),(null!==(yL=bL.reactiveElementVersions)&&void 0!==yL?yL:bL.reactiveElementVersions=[]).push("1.6.3");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const TL=0,$L=Symbol();let IL=class{constructor(e,t,n){this.o=0,this.status=0,this.autoRun=!0,this.i=e,this.i.addController(this);const i="object"==typeof t?t:{task:t,args:n};this.t=i.task,this.h=i.args,void 0!==i.autoRun&&(this.autoRun=i.autoRun),this.taskComplete=new Promise(((e,t)=>{this.l=e,this.u=t}))}hostUpdated(){this.performTask()}async performTask(){var e;const t=null===(e=this.h)||void 0===e?void 0:e.call(this);this.shouldRun(t)&&this.run(t)}shouldRun(e){return this.autoRun&&this.v(e)}async run(e){var t;let n,i;null!=e||(e=null===(t=this.h)||void 0===t?void 0:t.call(this)),2!==this.status&&3!==this.status||(this.taskComplete=new Promise(((e,t)=>{this.l=e,this.u=t}))),this.status=1,this._=void 0,this.m=void 0,this.i.requestUpdate();const a=++this.o;try{n=await this.t(e)}catch(e){i=e}this.o===a&&(n===$L?this.status=0:(void 0===i?(this.status=2,this.l(n)):(this.status=3,this.u(i)),this.m=n,this._=i),this.i.requestUpdate())}get value(){return this.m}get error(){return this._}render(e){var t,n,i,a;switch(this.status){case 0:return null===(t=e.initial)||void 0===t?void 0:t.call(e);case 1:return null===(n=e.pending)||void 0===n?void 0:n.call(e);case 2:return null===(i=e.complete)||void 0===i?void 0:i.call(e,this.value);case 3:return null===(a=e.error)||void 0===a?void 0:a.call(e,this.error);default:this.status}}v(e){const t=this.T;return this.T=e,Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.some(((e,n)=>CL(e,t[n]))):e!==t}};function OL(e){return U`
    <advanced-camera-card-progress-indicator
      class="${_e(e?.classes??{})}"
      .size=${e?.size}
      ${e?.componentRef?Oe(e.componentRef):""}
      .message=${e?.message||""}
      .animated=${e?.cardWideConfig?.performance?.features.animated_progress_indicator??!0}
    >
    </advanced-camera-card-progress-indicator>
  `}let LL=class extends oe{constructor(){super(...arguments),this.message="",this.animated=!1,this.size="large"}render(){return U` <div class="message vertical">
      ${this.animated?U`<ha-spinner indeterminate size="${this.size}"> </ha-spinner>`:U`<advanced-camera-card-icon
            .icon=${{icon:"mdi:timer-sand"}}
          ></advanced-camera-card-icon>`}
      ${this.message?U`<span>${this.message}</span>`:U``}
    </div>`}static get styles(){return s(YI)}};e([he({attribute:!1})],LL.prototype,"message",void 0),e([he({attribute:!1})],LL.prototype,"animated",void 0),e([he({attribute:!1})],LL.prototype,"size",void 0),LL=e([le("advanced-camera-card-progress-indicator")],LL);const DL=(e,t,n)=>{const i={...n?.cardWideConfig&&{cardWideConfig:n.cardWideConfig}};return U` ${e.render({initial:()=>n?.inProgressFunc?.()??OL(i),pending:()=>n?.inProgressFunc?.()??OL(i),error:e=>(sd(e),n?.errorFunc?.(e)),complete:t})}`},jL=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,zL=(e,t,n,i=!0)=>new IL(e,{args:()=>[!!t(),n()],task:async([e,n])=>{const i=t();return e&&i&&n?await(async(e,t)=>t.startsWith("data:")||t.match(jL)?t:new Promise(((n,i)=>{e.fetchWithAuth(t).then((e=>{if(!e.ok)throw new Error(e.statusText);return e.blob()})).then((e=>{const t=new FileReader;t.onload=()=>{const e=t.result;n("string"==typeof e?e:null)},t.onerror=e=>i(e),t.readAsDataURL(e)})).catch((e=>i(e)))})))(i,n):null},autoRun:i});let RL=class extends oe{constructor(){super(...arguments),this._intersectionObserver=new IntersectionObserver(this._intersectionHandler.bind(this))}connectedCallback(){super.connectedCallback(),this._intersectionObserver.observe(this)}disconnectedCallback(){this._intersectionObserver.disconnect(),super.disconnectedCallback()}willUpdate(e){e.has("thumbnail")&&(this._embedThumbnailTask=zL(this,(()=>this.hass),(()=>this.thumbnail),!1),this._intersectionObserver.unobserve(this),this._intersectionObserver.observe(this))}_intersectionHandler(e){this._embedThumbnailTask?.status===TL&&e.some((e=>e.isIntersecting))&&this._embedThumbnailTask?.run()}render(){const e=U`<advanced-camera-card-icon
      .icon=${{icon:"mdi:image-off"}}
      title=${Hg("thumbnail.no_thumbnail")}
    ></advanced-camera-card-icon> `;return this._embedThumbnailTask?U`${this.thumbnail?DL(this._embedThumbnailTask,(e=>e?U`<img src="${e}" />`:U``),{inProgressFunc:()=>U`<advanced-camera-card-icon
                .icon=${{icon:"mdi:image-refresh"}}
                title=${Hg("thumbnail.no_thumbnail")}
              ></advanced-camera-card-icon> `,errorFunc:()=>e}):e} `:e}static get styles(){return s(":host {\n  display: block;\n  overflow: hidden;\n  aspect-ratio: 1/1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\nimg {\n  display: block;\n}\n\nimg {\n  display: inline-block;\n  width: 100%;\n  height: 100%;\n  vertical-align: top;\n  margin: 0;\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  object-fit: cover;\n}\n\nadvanced-camera-card-icon {\n  display: flex;\n  width: 50%;\n  --mdc-icon-size: 100%;\n  color: var(--primary-text-color);\n  justify-content: center;\n  align-items: center;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  box-sizing: border-box;\n  opacity: 0.2;\n}")}};e([he({attribute:!1})],RL.prototype,"thumbnail",void 0),e([he({attribute:!1})],RL.prototype,"hass",void 0),RL=e([le("advanced-camera-card-thumbnail-feature-thumbnail")],RL);let PL=class extends oe{constructor(){super(...arguments),this._controller=new dL}willUpdate(e){["item","hasDetails","cameraManager"].some((t=>e.has(t)))&&this._controller.calculate(this.cameraManager,this.item,this.hasDetails)}render(){const e=this._controller.getTitle(),t=this._controller.getSubtitles(),n=_e({background:e||t.length}),i=this._controller.getThumbnailClass(),a=_e({...i&&{[i]:!0}});return U`
      ${this._controller.getThumbnail()?U` <advanced-camera-card-thumbnail-feature-thumbnail
            class="${a}"
            .hass=${this.hass}
            .thumbnail=${this._controller.getThumbnail()}
            aria-label=${this.item?.getTitle()??""}
            title=${this.item?.getTitle()??""}
          ></advanced-camera-card-thumbnail-feature-thumbnail>`:this._controller.getIcon()?U`<advanced-camera-card-icon
              class="${n}"
              .icon=${{icon:this._controller.getIcon()}}
            ></advanced-camera-card-icon>`:""}
      ${e||t.length?U`
            ${e?U`<div class="title">${e}</div>`:""}
            ${t.length?U`<div>
                  ${t.map((e=>U`<div class="subtitle">${e}</div>`))}
                </div>`:""}
          `:U``}
    `}static get styles(){return s(":host {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-evenly;\n  align-items: center;\n  max-width: var(--advanced-camera-card-thumbnail-size);\n  max-height: var(--advanced-camera-card-thumbnail-size);\n  aspect-ratio: 1/1;\n  border: 1px solid var(--secondary-color);\n  background-color: var(--secondary-background-color);\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  box-sizing: border-box;\n  position: relative;\n}\n\nadvanced-camera-card-thumbnail-feature-thumbnail {\n  height: 50%;\n}\n\nadvanced-camera-card-thumbnail-feature-thumbnail.brand:only-child {\n  height: 60%;\n}\n\nadvanced-camera-card-thumbnail-feature-thumbnail:not(.brand):only-child {\n  height: 100%;\n}\n\nadvanced-camera-card-icon:only-child {\n  width: 60%;\n  height: 60%;\n  --mdc-icon-size: 100%;\n}\n\nadvanced-camera-card-icon.background {\n  display: block;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  inset: 0;\n  padding: 10%;\n  box-sizing: border-box;\n  pointer-events: none;\n  opacity: 0.1;\n  --mdc-icon-size: 100%;\n}\n\ndiv {\n  text-align: center;\n  color: var(--primary-text-color);\n}\n\ndiv.title {\n  font-size: 1.5rem;\n}\n\ndiv.subtitle {\n  font-size: 0.8em;\n}")}};e([he({attribute:!1})],PL.prototype,"hass",void 0),e([he({attribute:!1})],PL.prototype,"cameraManager",void 0),e([he({attribute:!1})],PL.prototype,"item",void 0),e([he({attribute:!1})],PL.prototype,"hasDetails",void 0),PL=e([le("advanced-camera-card-thumbnail-feature")],PL);let NL=class extends oe{constructor(){super(...arguments),this.details=!1,this.show_favorite_control=!1,this.show_timeline_control=!1,this.show_download_control=!1}render(){if(!this.item)return;const e={star:!0,starred:Xd.isMedia(this.item)&&!!this.item?.isFavorite()},t=this.show_timeline_control&&(Xd.isEvent(this.item)&&this.item.getStartTime()||Xd.isRecording(this.item)&&this.item.getStartTime()&&this.item.getEndTime()),n=this.viewItemManager?.getCapabilities(this.item)??null,i=this.show_favorite_control&&this.item&&this.hass&&n?.canFavorite,a=this.show_download_control&&this.hass&&this.item.getID()&&n?.canDownload;return U`
      <advanced-camera-card-thumbnail-feature
        .cameraManager=${this.cameraManager}
        .hasDetails=${this.details}
        .hass=${this.hass}
        .item=${this.item}
      >
      </advanced-camera-card-thumbnail-feature>
      ${i?U` <advanced-camera-card-icon
            class="${_e(e)}"
            title=${Hg("thumbnail.retain_indefinitely")}
            .icon=${{icon:this.item.isFavorite()?"mdi:star":"mdi:star-outline"}}
            @click=${async e=>{if(Ld(e),this.hass&&this.item){try{await(this.viewItemManager?.favorite(this.item,!this.item.isFavorite()))}catch(e){return void sd(e)}this.requestUpdate()}}}
          /></advanced-camera-card-icon>`:""}
      ${this.details?U`<advanced-camera-card-thumbnail-details
            .hass=${this.hass}
            .item=${this.item??void 0}
            .cameraManager=${this.cameraManager}
            .seek=${this.seek}
          ></advanced-camera-card-thumbnail-details>`:""}
      ${t?U`<advanced-camera-card-icon
            class="timeline"
            .icon=${{icon:"mdi:target"}}
            title=${Hg("thumbnail.timeline")}
            @click=${e=>{Ld(e),this.viewManagerEpoch&&this.item&&this.viewManagerEpoch.manager.setViewByParameters({params:{view:"timeline",queryResults:this.viewManagerEpoch?.manager.getView()?.queryResults?.clone().selectResultIfFound((e=>e===this.item))},modifiers:[new nO(["timeline"])]})}}
          ></advanced-camera-card-icon>`:""}
      ${a?U` <advanced-camera-card-icon
            class="download"
            .icon=${{icon:"mdi:download"}}
            title=${Hg("thumbnail.download")}
            @click=${async e=>{if(Ld(e),this.hass&&this.item)try{this.viewItemManager?.download(this.item)}catch(e){EA(this,e)}}}
          ></advanced-camera-card-icon>`:""}
    `}static get styles(){return s(":host {\n  display: flex;\n  flex-direction: row;\n  box-sizing: border-box;\n  position: relative;\n  overflow: hidden;\n  transition: transform 0.2s linear;\n}\n\n:host(:not([details])) {\n  aspect-ratio: 1/1;\n}\n\n:host([details]) {\n  border: 1px solid var(--advanced-camera-card-thumbnail-border-color);\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  padding: 2px;\n  background-color: var(--advanced-camera-card-thumbnail-background);\n}\n\n:host(:hover) {\n  transform: scale(1.04);\n}\n\nadvanced-camera-card-icon {\n  position: absolute;\n  border-radius: 50%;\n  color: var(--advanced-camera-card-thumbnail-icon-color);\n  cursor: pointer;\n  transition: opacity 0.2s ease-in-out, color 0.2s ease-in-out;\n}\n\nadvanced-camera-card-icon:hover {\n  opacity: 1;\n}\n\nadvanced-camera-card-icon.star {\n  top: 3px;\n  left: 3px;\n}\n\nadvanced-camera-card-icon.star.starred {\n  color: var(--advanced-camera-card-thumbnail-icon-favorite-color);\n}\n\nadvanced-camera-card-icon.timeline {\n  top: 3px;\n  right: 3px;\n}\n\nadvanced-camera-card-icon.download {\n  right: 3px;\n  bottom: 3px;\n}\n\nadvanced-camera-card-thumbnail-details {\n  flex: 1;\n}")}};e([he({attribute:!1})],NL.prototype,"cameraManager",void 0),e([he({attribute:!1})],NL.prototype,"viewItemManager",void 0),e([he({attribute:!1})],NL.prototype,"folderManager",void 0),e([he({attribute:!1})],NL.prototype,"item",void 0),e([he({attribute:!0,type:Boolean})],NL.prototype,"details",void 0),e([he({attribute:!0,type:Boolean})],NL.prototype,"show_favorite_control",void 0),e([he({attribute:!0,type:Boolean})],NL.prototype,"show_timeline_control",void 0),e([he({attribute:!0,type:Boolean})],NL.prototype,"show_download_control",void 0),e([he({attribute:!1})],NL.prototype,"seek",void 0),NL=e([le("advanced-camera-card-thumbnail")],NL);let FL=class extends oe{constructor(){super(...arguments),this.fadeThumbnails=!1,this._thumbnails=[]}willUpdate(e){if(e.has("config")){this.config?.size&&this.style.setProperty("--advanced-camera-card-thumbnail-size",`${this.config.size}px`);const e=this._getDirection();e?this.setAttribute("direction",e):this.removeAttribute("direction")}["cameraManager","config","transitionEffect","viewManagerEpoch"].some((t=>e.has(t)))&&(this._thumbnails=this._renderThumbnails()),e.has("viewManagerEpoch")&&this.style.setProperty("--advanced-camera-card-carousel-thumbnail-opacity",this.fadeThumbnails&&null!==this._getSelectedSlide()?"0.4":"1.0")}_getSelectedSlide(){return this.viewManagerEpoch?.manager.getView()?.queryResults?.getSelectedIndex()??null}_itemClickCallback(e,t){Ld(t);const n=this.viewManagerEpoch?.manager.getView(),i=n?.query,a=n?.queryResults;if(n&&i&&a)if(Xd.isMedia(e)){const t=a.clone().selectResultIfFound((t=>t===e)),n=e.getCameraID();VE(this,"thumbnails-carousel:media-select",{media:e}),this.viewManagerEpoch?.manager.setViewByParameters({params:{view:"media",queryResults:t,...n&&{camera:n}},modifiers:[new nO(["timeline","mediaViewer"])]})}else if(cA.isFolderQuery(i)&&Xd.isFolder(e)){const t=i.getQuery();if(!t)return;this.viewManagerEpoch?.manager.setViewByParametersWithExistingQuery({params:{query:i.clone().setQuery({folder:t.folder,path:[...t.path??[],{folder:e}]})}})}}_renderThumbnail(e,t,n,i){return U` <advanced-camera-card-thumbnail
      class="${_e({embla__slide:!0,"slide-selected":t})}"
      .cameraManager=${this.cameraManager}
      .hass=${this.hass}
      .item=${e}
      .viewManagerEpoch=${this.viewManagerEpoch}
      .viewItemManager=${this.viewItemManager}
      .seek=${i&&Xd.isMedia(e)&&e.includesTime(i)?i:void 0}
      ?details=${!!this.config?.show_details}
      ?show_favorite_control=${this.config?.show_favorite_control}
      ?show_timeline_control=${this.config?.show_timeline_control}
      ?show_download_control=${this.config?.show_download_control}
      @click=${t=>n(e,t)}
    >
    </advanced-camera-card-thumbnail>`}_renderThumbnails(){const e=aO(this.viewManagerEpoch?.manager.getView()),t=[...e?[this._renderThumbnail(e,!1,((e,t)=>iO(0,t,this.viewManagerEpoch)))]:[]],n=this.viewManagerEpoch?.manager.getView(),i=this._getSelectedSlide();for(const e of n?.queryResults?.getResults()??[])t.push(this._renderThumbnail(e,i===t.length,((e,t)=>this._itemClickCallback(e,t)),n?.context?.mediaViewer?.seek));return t}_getDirection(){return"left"===this.config?.mode||"right"===this.config?.mode?"vertical":"above"===this.config?.mode||"below"===this.config?.mode?"horizontal":null}render(){const e=this._getDirection();if(this._thumbnails.length&&this.config&&e)return U`<advanced-camera-card-carousel
      direction=${e}
      .selected=${this._getSelectedSlide()??0}
      .dragFree=${!0}
    >
      ${this._thumbnails}
    </advanced-camera-card-carousel>`}static get styles(){return s(":host {\n  --advanced-camera-card-thumbnail-size-max: 300px;\n  --advanced-camera-card-thumbnail-details-width: calc(\n    var(--advanced-camera-card-thumbnail-size) + 200px\n  );\n}\n\n:host {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-color: var(--advanced-camera-card-thumbnail-background);\n  --advanced-camera-card-carousel-thumbnail-opacity: 1;\n}\n\n:host([direction=vertical]) {\n  height: 100%;\n}\n\n:host([direction=horizontal]) {\n  height: auto;\n}\n\n.embla__slide {\n  flex: 0 0 auto;\n  opacity: var(--advanced-camera-card-carousel-thumbnail-opacity);\n}\n\n.embla__slide.slide-selected {\n  opacity: 1;\n}\n\nadvanced-camera-card-thumbnail {\n  width: var(--advanced-camera-card-thumbnail-size);\n  height: var(--advanced-camera-card-thumbnail-size);\n  max-width: 100%;\n}\n\nadvanced-camera-card-thumbnail[details] {\n  width: var(--advanced-camera-card-thumbnail-details-width);\n}")}};e([he({attribute:!1})],FL.prototype,"hass",void 0),e([he({attribute:!1})],FL.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1})],FL.prototype,"cameraManager",void 0),e([he({attribute:!1})],FL.prototype,"viewItemManager",void 0),e([he({attribute:!1})],FL.prototype,"config",void 0),e([he({attribute:!1})],FL.prototype,"fadeThumbnails",void 0),FL=e([le("advanced-camera-card-thumbnail-carousel")],FL);var VL=":host {\n  width: 100%;\n  height: 100%;\n  display: block;\n}";const BL=document.createElement("template");BL.innerHTML='<style>\n:host {\n  background-color: #ffffff;\n  width: 350px;\n  max-width: 75vw;\n\n  visibility: hidden;\n  transition: visibility 0.5s;\n}\n\n:host([open]) {\n  visibility: visible;\n}\n\n::slotted(div) {\n  box-sizing: border-box;\n}\n\n#d {\n  position: fixed;\n  z-index: 99;\n  background-color: inherit;\n  -webkit-overflow-scrolling: touch;\n  overflow: auto;\n  overscroll-behavior: contain;\n  backdrop-filter: var(--side-drawer-backdrop-filter, none);\n\n  top: 0;\n  bottom: 0;\n  left: 0;\n  height: 100%;\n  box-sizing: border-box;\n  transform: translateX(-100%);\n  transition: var(\n    --side-drawer-transition,\n    transform 0.25s ease-out\n  );\n  width: inherit;\n  max-width: inherit;\n  border-top-right-radius: inherit;\n  border-bottom-right-radius: inherit;\n}\n\n:host([open]) #d {\n  transform: none;\n  box-shadow: 0px 0px 25px 0px rgba(0, 0, 0, 0.5);\n}\n\n#fs {\n  position: fixed;\n  z-index: 98;\n  background-color: #000000;\n  backdrop-filter: var(--side-drawer-backdrop-filter, none);\n\n  top: 0;\n  bottom: 0;\n  right: -30px; /* hide scrollbar until overscroll bug is fixed */\n  height: 100vh;\n  transition: var(\n    --side-drawer-overlay-transition,\n    opacity linear 0.25s\n  );\n  width: calc(\n    100vw + 30px\n  ); /* put back to just 100vw once overscroll bug fixed */\n  opacity: 0;\n  visibility: hidden;\n\n  overflow: auto;\n  overscroll-behavior: contain;\n}\n\n:host([open]) #fs {\n  opacity: var(--side-drawer-overlay-opacity, 0.7);\n  visibility: visible;\n}\n\n/*\n   * Workaround for bug https://bugs.chromium.org/p/chromium/issues/detail?id=813094\n   * Once bug is fixed and in the wild we can remove this element and make #if overflow:hidden\n   * and set "right: 0; width: 100vw" for #fs\n   */\n#ifs {\n  height: calc(100vh + 1px);\n}\n</style>\n<div id="d"><slot></slot></div>\n<div id="fs"><div id="ifs"></div></div>\n';class HL extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});e.appendChild(BL.content.cloneNode(!0)),this._freeSpaceDiv=e.getElementById("fs")}connectedCallback(){this._freeSpaceDiv&&this._freeSpaceDiv.addEventListener("click",this.handleFreeSpaceDivClick),this.upgradeProperty("open")}disconnectedCallback(){document.removeEventListener("keyup",this.handleKeyUp)}upgradeProperty(e){if(this.hasOwnProperty(e)){let t=this[e];delete this[e],this[e]=t}}handleKeyUp=e=>{if(!e.altKey&&"Escape"===e.key)e.preventDefault(),this.open=!1};get open(){return this.hasAttribute("open")}set open(e){e?this.hasAttribute("open")||this.setAttribute("open",""):this.hasAttribute("open")&&this.removeAttribute("open")}static get observedAttributes(){return["open"]}attributeChangedCallback(e,t,n){"open"===e&&(this.open?(this.setAttribute("tabindex","0"),this.setAttribute("aria-disabled","false"),this.focus({preventScroll:!0}),document.addEventListener("keyup",this.handleKeyUp),this.dispatchEvent(new CustomEvent("open",{bubbles:!0}))):(this.setAttribute("tabindex","-1"),this.setAttribute("aria-disabled","true"),document.removeEventListener("keyup",this.handleKeyUp),this.dispatchEvent(new CustomEvent("close",{bubbles:!0}))))}handleFreeSpaceDivClick=()=>{this.open=!1}}customElements.define("side-drawer",HL);let UL=class extends oe{constructor(){super(...arguments),this.location="left",this.control=!0,this.open=!1,this.empty=!0,this._refDrawer=Te(),this._refSlot=Te(),this._resizeObserver=new ResizeObserver((()=>this._hideDrawerIfNecessary())),this._isHoverableDevice=od()}firstUpdated(e){super.firstUpdated(e);const t=document.createElement("style");t.innerHTML='/************\n * Managing z-indicies and stacking contexts is very challenging on the card,\n * due to the volume of different potentially overlapping surfaces. In\n * particular, care must be taken to not generate new stacking contexts\n * inadvertently which would make "z-index" weaving challenging (e.g. submenu\n * shown for PTZ presets, needs to render "over" the media drawer open/close\n * control).\n *************/\n:host {\n  width: unset;\n}\n\n#fs {\n  display: none;\n  width: 100%;\n  inset: 0;\n}\n\n#d,\n#fs {\n  height: 100%;\n  position: absolute;\n}\n\n#d {\n  overflow: visible;\n  max-width: 90%;\n  z-index: 3;\n}\n\n:host([location=right]) #d {\n  left: unset;\n  right: 0;\n  transform: translateX(100%);\n}\n\n:host([location=right][open]) #d {\n  transform: none;\n  box-shadow: var(--advanced-camera-card-css-box-shadow, 0px 0px 25px 0px black);\n}\n\n#ifs {\n  height: 100%;\n}',this._refDrawer.value?.shadowRoot?.appendChild(t)}_slotChanged(){const e=this._refSlot.value?vd(this._refSlot.value):[];this._resizeObserver.disconnect();for(const t of e)this._resizeObserver.observe(t);this._hideDrawerIfNecessary()}_hideDrawerIfNecessary(){if(!this._refDrawer.value)return;const e=this._refSlot.value?vd(this._refSlot.value):null;this.empty=!e||!e.length||e.every((e=>{const t=e.getBoundingClientRect();return!t.width||!t.height}))}render(){return U`
      <side-drawer
        ${Oe(this._refDrawer)}
        location="${this.location}"
        ?open=${this.open}
        @mouseleave=${()=>{this.open=!1}}
      >
        ${this.control?U`
              <div
                class="control-surround"
                @click=${e=>{Ld(e),this.open=!this.open}}
              >
                <advanced-camera-card-icon
                  class="control"
                  .icon="${{icon:this.open?this.icons?.open??"mdi:menu-open":this.icons?.closed??"mdi:menu"}}"
                  @mouseenter=${()=>{this._isHoverableDevice&&!this.open&&(this.open=!0)}}
                >
                </advanced-camera-card-icon>
              </div>
            `:""}
        <slot ${Oe(this._refSlot)} @slotchange=${()=>this._slotChanged()}></slot>
      </side-drawer>
    `}static get styles(){return s("side-drawer {\n  background-color: var(--card-background-color);\n}\n\ndiv.control-surround {\n  position: absolute;\n  bottom: 50%;\n  transform: translateY(50%);\n  padding-top: 20px;\n  padding-bottom: 20px;\n}\n\n:host([location=left]) div.control-surround {\n  padding-right: 12px;\n  left: 100%;\n}\n\n:host([location=right]) div.control-surround {\n  padding-left: 12px;\n  right: 100%;\n}\n\n:host([empty]),\n:host([empty]) > * {\n  visibility: hidden;\n}\n\n:host(:not([empty])),\n:host(:not([empty])) > * {\n  visibility: visible;\n}\n\nadvanced-camera-card-icon.control {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  pointer-events: all;\n  --mdc-icon-size: 20px;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  transition: opacity 0.5s ease;\n}\n\n:host([location=left]) advanced-camera-card-icon.control {\n  border-top-right-radius: 20px;\n  border-bottom-right-radius: 20px;\n}\n\n:host([location=right]) advanced-camera-card-icon.control {\n  border-top-left-radius: 20px;\n  border-bottom-left-radius: 20px;\n}")}};e([he({attribute:!0,reflect:!0})],UL.prototype,"location",void 0),e([he({attribute:!0,reflect:!0,type:Boolean})],UL.prototype,"control",void 0),e([he({type:Boolean,reflect:!0,attribute:!0})],UL.prototype,"open",void 0),e([he({attribute:!1})],UL.prototype,"icons",void 0),e([he({type:Boolean,reflect:!0,attribute:!0})],UL.prototype,"empty",void 0),UL=e([le("advanced-camera-card-drawer")],UL);let qL=class extends oe{constructor(){super(...arguments),this._refDrawerLeft=Te(),this._refDrawerRight=Te(),this._boundDrawerHandler=this._drawerHandler.bind(this)}connectedCallback(){super.connectedCallback(),this.addEventListener("advanced-camera-card:drawer:open",this._boundDrawerHandler),this.addEventListener("advanced-camera-card:drawer:close",this._boundDrawerHandler)}disconnectedCallback(){this.removeEventListener("advanced-camera-card:drawer:open",this._boundDrawerHandler),this.removeEventListener("advanced-camera-card:drawer:close",this._boundDrawerHandler),super.disconnectedCallback()}_drawerHandler(e){const t=e.detail.drawer,n=e.type.endsWith(":open");"left"===t&&this._refDrawerLeft.value?this._refDrawerLeft.value.open=n:"right"===t&&this._refDrawerRight.value&&(this._refDrawerRight.value.open=n)}render(){return U` <slot name="above"></slot>
      <slot></slot>
      <advanced-camera-card-drawer
        ${Oe(this._refDrawerLeft)}
        location="left"
        .icons=${this.drawerIcons?.left}
      >
        <slot name="left"></slot>
      </advanced-camera-card-drawer>
      <advanced-camera-card-drawer
        ${Oe(this._refDrawerRight)}
        location="right"
        .icons=${this.drawerIcons?.right}
      >
        <slot name="right"></slot>
      </advanced-camera-card-drawer>
      <slot name="below"></slot>`}static get styles(){return s(":host {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: hidden;\n}\n\n::slotted(:not([slot])) {\n  flex: 1;\n  min-height: 0px;\n}")}};e([he({attribute:!1})],qL.prototype,"drawerIcons",void 0),qL=e([le("advanced-camera-card-surround-basic")],qL);let WL=class extends oe{_hasDrawer(){return!!this.thumbnailConfig&&["left","right"].includes(this.thumbnailConfig.mode)}willUpdate(e){this.timelineConfig?.mode&&"none"!==this.timelineConfig.mode&&import("./timeline-core-e087b1fb.js");const t=this.viewManagerEpoch?.manager.getView();e.has("viewManagerEpoch")&&(this.viewManagerEpoch?.manager.hasMajorMediaChange(this.viewManagerEpoch?.oldView)||this.viewManagerEpoch?.oldView?.displayMode!==t?.displayMode)&&(this._cameraIDsForTimeline=this._getCameraIDsForTimeline()??void 0)}_getCameraIDsForTimeline(){const e=this.viewManagerEpoch?.manager.getView();if(!e||!this.cameraManager)return null;if(e.is("live")){const t={anyCapabilities:["clips","snapshots","recordings"]};return e.supportsMultipleDisplayModes()&&e.isGrid()?this.cameraManager.getStore().getCameraIDsWithCapability(t):this.cameraManager.getStore().getAllDependentCameras(e.camera,t)}const t=e.query;return e.isViewerView()&&cA.isMediaQuery(t)?t.getQueryCameraIDs()??null:null}render(){const e=this.viewManagerEpoch?.manager.getView();if(!this.hass||!e)return;const t=(e,t)=>{this.thumbnailConfig&&this._hasDrawer()&&VE(e.composedPath()[0],"drawer:"+t,{drawer:this.thumbnailConfig.mode})};return U` <advanced-camera-card-surround-basic
      @advanced-camera-card:thumbnails-carousel:media-select=${e=>t(e,"close")}
    >
      ${this.thumbnailConfig&&"none"!==this.thumbnailConfig.mode?U` <advanced-camera-card-thumbnail-carousel
            slot=${this.thumbnailConfig.mode}
            .hass=${this.hass}
            .config=${this.thumbnailConfig}
            .cameraManager=${this.cameraManager}
            .viewItemManager=${this.viewItemManager}
            .fadeThumbnails=${e.isViewerView()}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .selected=${e.queryResults?.getSelectedIndex()??void 0}
          >
          </advanced-camera-card-thumbnail-carousel>`:""}
      ${this.timelineConfig&&"none"!==this.timelineConfig.mode?U` <advanced-camera-card-timeline-core
            slot=${this.timelineConfig.mode}
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .itemClickAction=${e.isViewerView()||!this.thumbnailConfig||"none"===this.thumbnailConfig?.mode?"play":"select"}
            .cameraIDs=${this._cameraIDsForTimeline}
            .mini=${!0}
            .timelineConfig=${this.timelineConfig}
            .thumbnailConfig=${this.thumbnailConfig}
            .cameraManager=${this.cameraManager}
            .viewItemManager=${this.viewItemManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-timeline-core>`:""}
      <slot></slot>
    </advanced-camera-card-surround-basic>`}static get styles(){return s(VL)}};e([he({attribute:!1})],WL.prototype,"hass",void 0),e([he({attribute:!1})],WL.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1,hasChanged:rd})],WL.prototype,"thumbnailConfig",void 0),e([he({attribute:!1,hasChanged:rd})],WL.prototype,"timelineConfig",void 0),e([he({attribute:!1})],WL.prototype,"cameraManager",void 0),e([he({attribute:!1})],WL.prototype,"viewItemManager",void 0),e([he({attribute:!1})],WL.prototype,"cardWideConfig",void 0),WL=e([le("advanced-camera-card-surround")],WL);
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
class ZL{constructor(e){this.Y=e}disconnect(){this.Y=void 0}reconnect(e){this.Y=e}deref(){return this.Y}}class KL{constructor(){this.Z=void 0,this.q=void 0}get(){return this.Z}pause(){this.Z??=new Promise((e=>this.q=e))}resume(){this.q?.(),this.Z=this.q=void 0}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const QL=e=>!(e=>null===e||"object"!=typeof e&&"function"!=typeof e)(e)&&"function"==typeof e.then,YL=1073741823;const GL=fe(class extends Ae{constructor(){super(...arguments),this._$Cwt=YL,this._$Cbt=[],this._$CK=new ZL(this),this._$CX=new KL}render(...e){return e.find((e=>!QL(e)))??q}update(e,t){const n=this._$Cbt;let i=n.length;this._$Cbt=t;const a=this._$CK,r=this._$CX;this.isConnected||this.disconnected();for(let e=0;e<t.length&&!(e>this._$Cwt);e++){const s=t[e];if(!QL(s))return this._$Cwt=e,s;e<i&&s===n[e]||(this._$Cwt=YL,i=0,Promise.resolve(s).then((async e=>{for(;r.get();)await r.get();const t=a.deref();if(void 0!==t){const n=t._$Cbt.indexOf(s);n>-1&&n<t._$Cwt&&(t._$Cwt=n,t.setValue(e))}})))}return q}disconnected(){this._$CK.disconnect(),this._$CX.pause()}reconnected(){this._$CK.reconnect(this),this._$CX.resume()}});let XL=class extends oe{async _renderDiagnostics(){const e=await(async(e,t,n)=>{const i=e&&t?await t.getMatchingDevices(e,(e=>"Frigate"===e.manufacturer)):[],a=new Map;return i?.forEach((e=>{e.config_entries.forEach((t=>{e.model&&a.set(t,e.model)}))})),{card_version:"7.11.2",browser:navigator.userAgent,date:new Date,lang:Bg(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,git:{hash:HA,build_date:BA,commit_date:UA},...e&&{ha_version:e.config.version},custom_integrations:{frigate:{...await YA("frigate",e),...a.size&&{devices:Object.fromEntries(a)}},hass_web_proxy:await YA(WA,e)},...n&&{config:n}}})(this.hass,this.deviceRegistryManager,this.rawConfig);return GI({message:Hg("error.diagnostics"),icon:"mdi:cogs",context:e})}render(){return U`${GL(this._renderDiagnostics(),GI({message:Hg("error.fetching_diagnostics"),dotdotdot:!0,icon:"mdi:cogs"}))}`}static get styles(){return s(VL)}};e([he({attribute:!1})],XL.prototype,"deviceRegistryManager",void 0),e([he({attribute:!1})],XL.prototype,"rawConfig",void 0),XL=e([le("advanced-camera-card-diagnostics")],XL);let JL=class extends oe{willUpdate(e){if(e.has("viewManagerEpoch")||e.has("config")){const e=this.viewManagerEpoch?.manager.getView();(e?.is("live")||this._shouldLivePreload())&&import("./index-05ed2b1e.js"),e?.isMediaGalleryView()&&!e.is("folders")?import("./media-gallery-7644b6af.js"):e?.isViewerView()?import("./index-6b63d6a2.js"):e?.is("image")?import("./image-0c786bef.js"):e?.is("timeline")?import("./timeline-49b6be0d.js"):e?.is("folders")&&import("./folder-gallery-5a8cb4e6.js")}e.has("hide")&&(this.hide?this.setAttribute("hidden",""):this.removeAttribute("hidden"))}_shouldLivePreload(){const e=this.viewManagerEpoch?.manager.getView();return!!this.config?.live.preload&&!e?.is("diagnostics")}render(){if(!this.hass||!this.config||!this.cardWideConfig)return U``;const e=this.viewManagerEpoch?.manager.getView(),t={hidden:this._shouldLivePreload()&&!e?.is("live")},n={hidden:!!this.hide},i=e?.is("live")?this.config.live.controls.thumbnails:e?.isViewerView()?this.config.media_viewer.controls.thumbnails:e?.is("timeline")?this.config.timeline.controls.thumbnails:void 0,a=e?.is("live")?this.config.live.controls.timeline:e?.isViewerView()?this.config.media_viewer.controls.timeline:void 0,r=e?this.cameraManager?.getStore().getCameraConfig(e.camera)??null:null;return U` <advanced-camera-card-surround
      class="${_e(n)}"
      .hass=${this.hass}
      .viewManagerEpoch=${this.viewManagerEpoch}
      .thumbnailConfig=${this.hide?void 0:i}
      .timelineConfig=${this.hide?void 0:a}
      .cameraManager=${this.cameraManager}
      .viewItemManager=${this.viewItemManager}
      .cardWideConfig=${this.cardWideConfig}
    >
      ${!this.hide&&e?.is("image")&&r?U` <advanced-camera-card-image
            .imageConfig=${this.config.image}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .hass=${this.hass}
            .cameraConfig=${r}
            .cameraManager=${this.cameraManager}
          >
          </advanced-camera-card-image>`:""}
      ${this.hide||!e?.isMediaGalleryView()||e.is("folders")?"":U` <advanced-camera-card-media-gallery
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .galleryConfig=${this.config.media_gallery}
            .cameraManager=${this.cameraManager}
            .viewItemManager=${this.viewItemManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-media-gallery>`}
      ${!this.hide&&e?.isViewerView()?U`
            <advanced-camera-card-viewer
              .hass=${this.hass}
              .viewManagerEpoch=${this.viewManagerEpoch}
              .viewerConfig=${this.config.media_viewer}
              .resolvedMediaCache=${this.resolvedMediaCache}
              .cameraManager=${this.cameraManager}
              .cardWideConfig=${this.cardWideConfig}
            >
            </advanced-camera-card-viewer>
          `:""}
      ${!this.hide&&e?.is("timeline")?U` <advanced-camera-card-timeline
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .timelineConfig=${this.config.timeline}
            .cameraManager=${this.cameraManager}
            .viewItemManager=${this.viewItemManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-timeline>`:""}
      ${!this.hide&&e?.is("diagnostics")?U` <advanced-camera-card-diagnostics
            .hass=${this.hass}
            .rawConfig=${this.rawConfig}
            .deviceRegistryManager=${this.deviceRegistryManager}
          >
          </advanced-camera-card-diagnostics>`:""}
      ${!this.hide&&e?.is("folders")?U` <advanced-camera-card-folder-gallery
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .viewItemManager=${this.viewItemManager}
            .galleryConfig=${this.config.media_gallery}
          ></advanced-camera-card-folder-gallery>`:""}
      ${this._shouldLivePreload()||!this.hide&&e?.is("live")?U`
              <advanced-camera-card-live
                .hass=${this.hass}
                .viewManagerEpoch=${this.viewManagerEpoch}
                .liveConfig=${this.config.live}
                .cameraManager=${this.cameraManager}
                .cardWideConfig=${this.cardWideConfig}
                .microphoneState=${this.microphoneState}
                .triggeredCameraIDs=${this.triggeredCameraIDs}
                class="${_e(t)}"
              >
              </advanced-camera-card-live>
            `:""}
    </advanced-camera-card-surround>`}static get styles(){return s(":host {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n:host([hidden]),\n.hidden {\n  display: none;\n}")}};e([he({attribute:!1})],JL.prototype,"hass",void 0),e([he({attribute:!1})],JL.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1})],JL.prototype,"cameraManager",void 0),e([he({attribute:!1})],JL.prototype,"viewItemManager",void 0),e([he({attribute:!1})],JL.prototype,"config",void 0),e([he({attribute:!1})],JL.prototype,"cardWideConfig",void 0),e([he({attribute:!1})],JL.prototype,"rawConfig",void 0),e([he({attribute:!1})],JL.prototype,"resolvedMediaCache",void 0),e([he({attribute:!1})],JL.prototype,"hide",void 0),e([he({attribute:!1})],JL.prototype,"microphoneState",void 0),e([he({attribute:!1})],JL.prototype,"triggeredCameraIDs",void 0),e([he({attribute:!1})],JL.prototype,"deviceRegistryManager",void 0),JL=e([le("advanced-camera-card-views")],JL);console.info("%c 📷 Advanced Camera Card %c 7.11.2 ","padding: 3px; color: black; background: pink;","padding: 3px; color: black; background: white;"),window.customCards=window.customCards||[],window.customCards.push({type:"advanced-camera-card",name:Hg("common.advanced_camera_card"),description:Hg("common.advanced_camera_card_description"),preview:!0,documentationURL:"https://github.com/dermotduffy/advanced-camera-card"});let eD=class extends oe{constructor(){super(...arguments),this._controller=new kA(this,(()=>this._refMain.value?.scroll({top:0})),(()=>this._refMenu.value?.toggleMenu())),this._menuButtonController=new SA,this._refMenu=Te(),this._refOverlay=Te(),this._refMain=Te(),this._refElements=Te(),this._refViews=Te()}get _config(){return this._controller.getConfigManager().getConfig()}get _hass(){return this._controller.getHASSManager().getHASS()}set hass(e){this._controller.getHASSManager().setHASS(e),this._refMenu.value&&(this._refMenu.value.hass=e),this._refElements.value&&(this._refElements.value.hass=e),this._refViews.value&&(this._refViews.value.hass=e)}static async getConfigElement(){return await kA.getConfigElement()}static getStubConfig(e,t){return kA.getStubConfig(t)}setConfig(e){this._controller.getConfigManager().setConfig(e)}shouldUpdate(){return!!this.isConnected&&(this._controller.getMessageManager().hasMessage()||this._controller.getInitializationManager().isInitializedMandatory()||this._controller.getInitializationManager().initializeMandatory(),!0)}_renderMenuStatusContainer(e){if(!this._config)return;const t=this._config.menu.style,n=this._config.menu.position,i=this._config.status_bar.style,a=this._config.status_bar.position;if("none"===t&&"none"===i||"overlay"===e&&"outside"===t&&"outside"===i||"overlay"!==e&&("outside"!==t||n!==e)&&("outside"!==i||a!==e))return;const r=r=>{const s="none"!==t&&("outside"===t&&"outerlay"===r&&n===e||"outside"!==t&&"overlay"===r),o="none"!==i&&("outside"===i&&"outerlay"===r&&a===e||"outside"!==i&&"overlay"===r),c="left"===n||"right"===n||"bottom"===n&&"hidden"===t&&"popup"!==i||"top"===n&&"popup"===i;return U`
        ${s&&c?this._renderMenu(n):""}
        ${o?this._renderStatusBar(a):""}
        ${s&&!c?this._renderMenu(n):""}
      `};return U`
      ${"overlay"===e?U`<advanced-camera-card-overlay
            >${r("overlay")}</advanced-camera-card-overlay
          >`:U`<div class="outerlay" data-position="${e}">
            ${r("outerlay")}
          </div>`}
    `}_renderMenu(e){const t=this._controller.getViewManager().getView();if(this._hass&&this._config)return U`
      <advanced-camera-card-menu
        ${Oe(this._refMenu)}
        slot=${ve(e)}
        .hass=${this._hass}
        .menuConfig=${this._config.menu}
        .buttons=${this._menuButtonController.calculateButtons(this._hass,this._config,this._controller.getCameraManager(),{currentMediaLoadedInfo:this._controller.getMediaLoadedInfoManager().get(),foldersManager:this._controller.getFoldersManager(),fullscreenManager:this._controller.getFullscreenManager(),inExpandedMode:this._controller.getExpandManager().isExpanded(),mediaPlayerController:this._controller.getMediaPlayerManager(),microphoneManager:this._controller.getMicrophoneManager(),showCameraUIButton:this._controller.getCameraURLManager().hasCameraURL(),view:t,viewManager:this._controller.getViewManager()})}
        .entityRegistryManager=${this._controller.getEntityRegistryManager()}
      ></advanced-camera-card-menu>
    `}_renderStatusBar(e){if(this._config)return U`
      <advanced-camera-card-status-bar
        slot=${ve(e)}
        .items=${this._controller.getStatusBarItemManager().calculateItems({statusConfig:this._config.status_bar,cameraManager:this._controller.getCameraManager(),view:this._controller.getViewManager().getView(),mediaLoadedInfo:this._controller.getMediaLoadedInfoManager().get()})}
        .config=${this._config.status_bar}
      ></advanced-camera-card-status-bar>
    `}updated(){this._controller.getInitializationManager().isInitializedMandatory()&&this._controller.getQueryStringManager().executeIfNecessary()}_renderInDialogIfNecessary(e){return this._controller.getExpandManager().isExpanded()?U` <web-dialog
        open
        center
        @close=${()=>{this._controller.getExpandManager().setExpanded(!1)}}
      >
        ${e}
      </web-dialog>`:e}render(){if(!this._hass)return;const e="outside"===this._config?.menu.style||"outside"===this._config?.status_bar.style,t={main:!0,"curve-top":!e||"top"!==this._config?.menu.position&&"top"!==this._config?.status_bar.position,"curve-bottom":!e||"bottom"!==this._config?.menu.position&&"bottom"!==this._config?.status_bar.position},n=this._controller.getActionsManager().getMergedActions(),i=this._controller.getCameraManager(),a=!1!==this._config?.performance?.features.card_loading_indicator&&!this._controller.getMessageManager().hasMessage();return this._renderInDialogIfNecessary(U` <ha-card
        id="ha-card"
        .actionHandler=${Rd({hasHold:Id(n.hold_action),hasDoubleClick:Id(n.double_tap_action)})}
        style="${je(this._controller.getStyleManager().getAspectRatioStyle())}"
        @advanced-camera-card:message=${e=>this._controller.getMessageManager().setMessageIfHigherPriority(e.detail)}
        @advanced-camera-card:media:loaded=${e=>this._controller.getMediaLoadedInfoManager().set(e.detail)}
        @advanced-camera-card:media:unloaded=${()=>this._controller.getMediaLoadedInfoManager().clear()}
        @advanced-camera-card:media:volumechange=${()=>this.requestUpdate()}
        @advanced-camera-card:media:play=${()=>this.requestUpdate()}
        @advanced-camera-card:media:pause=${()=>this.requestUpdate()}
        @advanced-camera-card:focus=${()=>this.focus()}
      >
        ${a?U`<advanced-camera-card-loading
              ?loaded=${this._controller.getInitializationManager().wasEverInitialized()}
            ></advanced-camera-card-loading>`:""}
        ${this._renderMenuStatusContainer("top")}
        ${this._renderMenuStatusContainer("overlay")}
        <div ${Oe(this._refMain)} class="${_e(t)}">
          <advanced-camera-card-views
            ${Oe(this._refViews)}
            .hass=${this._hass}
            .viewManagerEpoch=${this._controller.getViewManager().getEpoch()}
            .cameraManager=${i}
            .viewItemManager=${this._controller.getViewItemManager()}
            .resolvedMediaCache=${this._controller.getResolvedMediaCache()}
            .config=${this._controller.getConfigManager().getConfig()}
            .cardWideConfig=${this._controller.getConfigManager().getCardWideConfig()}
            .rawConfig=${this._controller.getConfigManager().getRawConfig()}
            .configManager=${this._controller.getConfigManager()}
            .hide=${!!this._controller.getMessageManager().hasMessage()}
            .microphoneState=${this._controller.getMicrophoneManager().getState()}
            .triggeredCameraIDs=${this._config?.view.triggers.show_trigger_status?this._controller.getTriggersManager().getTriggeredCameraIDs():void 0}
            .deviceRegistryManager=${this._controller.getDeviceRegistryManager()}
          ></advanced-camera-card-views>
          ${this._controller.getMessageManager().hasMessage()?GI(this._controller.getMessageManager().getMessage()):""}
        </div>
        ${this._renderMenuStatusContainer("bottom")}
        ${this._config?.elements?U` <advanced-camera-card-elements
              ${Oe(this._refElements)}
              .hass=${this._hass}
              .elements=${this._config?.elements}
              @advanced-camera-card:menu:add=${e=>{this._menuButtonController.addDynamicMenuButton(e.detail),this.requestUpdate()}}
              @advanced-camera-card:menu:remove=${e=>{this._menuButtonController.removeDynamicMenuButton(e.detail),this.requestUpdate()}}
              @advanced-camera-card:status-bar:add=${e=>{this._controller.getStatusBarItemManager().addDynamicStatusBarItem(e.detail)}}
              @advanced-camera-card:status-bar:remove=${e=>{this._controller.getStatusBarItemManager().removeDynamicStatusBarItem(e.detail)}}
              @advanced-camera-card:condition-state-manager:get=${e=>{e.conditionStateManager=this._controller.getConditionStateManager()}}
            >
            </advanced-camera-card-elements>`:""}
      </ha-card>`)}static get styles(){return s(':host([themes~=dark]) {\n  --primary-background-color: #111111;\n  --secondary-background-color: #282828;\n  --primary-text-color: #e1e1e1;\n  --divider-color: rgba(225, 225, 225, 0.12);\n  --app-header-background-color: #101e24;\n  --app-header-text-color: #e1e1e1;\n}\n\n:host([themes~=light]) {\n  --primary-background-color: #fafafa;\n  --secondary-background-color: #e5e5e5;\n  --primary-text-color: #212121;\n  --divider-color: rgba(0, 0, 0, 0.12);\n  --app-header-text-color: #ffffff;\n  --app-header-background-color: #03a9f4;\n}\n\n:host([themes~=traditional]) {\n  /*********\n   * General\n   *********/\n  --advanced-camera-card-control-background: black;\n  /******\n   * Menu\n   ******/\n  --advanced-camera-card-menu-button-active-color: var(--primary-color, white);\n  --advanced-camera-card-menu-button-background: rgba(0, 0, 0, 0.6);\n  --advanced-camera-card-menu-position-left-alignment-top-background: linear-gradient(180deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-left-alignment-bottom-background: linear-gradient(0deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-right-alignment-top-background: linear-gradient(180deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-right-alignment-bottom-background: linear-gradient(0deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-left-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-right-background: linear-gradient(270deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-bottom-alignment-left-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-bottom-alignment-right-background: linear-gradient(270deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-left-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-top-alignment-right-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-bottom-alignment-left-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-bottom-alignment-right-style-outside-background: var(\n    --secondary-background-color\n  );\n  /************\n   * Status bar\n   ************/\n  --advanced-camera-card-status-bar-color: white;\n  --advanced-camera-card-status-bar-position-top-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-status-bar-position-bottom-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-status-bar-position-top-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-status-bar-position-bottom-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-status-bar-position-top-style-outside-color: var(\n    --secondary-text-color\n  );\n  --advanced-camera-card-status-bar-position-bottom-style-outside-color: var(\n    --secondary-text-color\n  );\n}\n\n:host {\n  /*********\n   * General\n   *********/\n  --advanced-camera-card-exterior: var(--secondary-background-color, black);\n  --advanced-camera-card-background: var(--primary-background-color, white);\n  --advanced-camera-card-foreground-primary: var(--primary-color, black);\n  --advanced-camera-card-active-color: var(--accent-color, orange);\n  --advanced-camera-card-warning-color: var(--error-color, red);\n  --advanced-camera-card-text-color: var(--primary-text-color);\n  --advanced-camera-card-divider-color: var(--divider-color);\n  --advanced-camera-card-control-background: var(--app-header-background-color);\n  --advanced-camera-card-control-background-transparent: color-mix(\n    in oklab,\n    var(--advanced-camera-card-control-background),\n    transparent 60%\n  );\n  --advanced-camera-card-control-foreground: var(--app-header-text-color);\n  /*********\n   * Buttons\n   *********/\n  --advanced-camera-card-button-color: var(--advanced-camera-card-control-foreground);\n  --advanced-camera-card-button-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  /******\n   * Menu\n   ******/\n  --advanced-camera-card-menu-button-active-color: var(\n    --advanced-camera-card-active-color\n  );\n  --advanced-camera-card-menu-button-inactive-color: var(\n    --advanced-camera-card-button-color\n  );\n  --advanced-camera-card-menu-button-critical-color: var(\n    --error-color,\n    var(--advanced-camera-card-warning-color)\n  );\n  --advanced-camera-card-menu-button-background: color-mix(\n    in oklab,\n    var(--advanced-camera-card-menu-button-inactive-color),\n    transparent 60%\n  );\n  --advanced-camera-card-menu-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-menu-style-outside-background: var(\n    --advanced-camera-card-control-background\n  );\n  --advanced-camera-card-menu-override-background: unset;\n  --advanced-camera-card-menu-override-button-inactive-color: unset;\n  --advanced-camera-card-menu-override-button-background: unset;\n  /************\n   * Status bar\n   ************/\n  --advanced-camera-card-status-bar-override-background: unset;\n  --advanced-camera-card-status-bar-override-color: unset;\n  --advanced-camera-card-status-bar-color: var(\n    --advanced-camera-card-control-foreground\n  );\n  --advanced-camera-card-status-bar-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-status-bar-style-outside-background: var(\n    --advanced-camera-card-control-background\n  );\n  /************\n   * Thumbnails\n   ************/\n  --advanced-camera-card-thumbnail-icon-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-thumbnail-border-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-thumbnail-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-thumbnail-icon-favorite-color: color-mix(\n    in oklab,\n    gold,\n    transparent 25%\n  );\n  --advanced-camera-card-thumbnail-text-color: var(--advanced-camera-card-text-color);\n  /**********\n   * Timeline\n   **********/\n  --advanced-camera-card-timeline-text-color: var(--advanced-camera-card-text-color);\n  --advanced-camera-card-timeline-item-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-timeline-tool-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-timeline-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-timeline-background-item-color: color-mix(\n    in oklab,\n    var(--advanced-camera-card-timeline-item-color),\n    transparent 90%\n  );\n  --advanced-camera-card-timeline-divider-color: var(\n    --advanced-camera-card-divider-color\n  );\n  --advanced-camera-card-timeline-target-bar-color: var(\n    --advanced-camera-card-active-color\n  );\n  /*******************\n   * Loading Indicator\n   *******************/\n  --advanced-camera-card-loading-background-color: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-loading-foreground-color: var(\n    --advanced-camera-card-control-foreground\n  );\n  /*********\n   * Message\n   *********/\n  --advanced-camera-card-message-color: var(--advanced-camera-card-text-color);\n  --advanced-camera-card-message-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-message-overlay-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-message-overlay-color: var(\n    --advanced-camera-card-control-foreground\n  );\n}\n\n/************\n * Managing z-indicies and stacking contexts is very challenging on the card,\n * due to the volume of different potentially overlapping surfaces. In\n * particular, care must be taken to not generate new stacking contexts\n * inadvertently which would make "z-index" weaving challenging (e.g. submenu\n * shown for PTZ presets, needs to render "over" the media drawer open/close\n * control).\n *************/\n:host {\n  display: block;\n  position: relative;\n  background-color: var(--card-background-color);\n  border-radius: var(--ha-card-border-radius, 4px);\n  overflow: auto;\n  height: var(--advanced-camera-card-height);\n  min-height: 100px;\n  pointer-events: all;\n  --advanced-camera-card-expand-max-height: calc((100vh - (2 * 56px)) * 0.85);\n  --advanced-camera-card-expand-max-width: 85vw;\n  --advanced-camera-card-expand-width: none;\n  --advanced-camera-card-expand-height: none;\n  --advanced-camera-card-expand-aspect-ratio: unset;\n  --advanced-camera-card-height: auto;\n}\n\n:host(:not(:hover)) {\n  z-index: 0;\n}\n\nadvanced-camera-card-loading {\n  position: absolute;\n  inset: 0;\n  z-index: 6;\n}\n\n:host([dimmable]:not([interaction])) {\n  filter: brightness(75%);\n}\n\n:host([panel]:not([casted])) {\n  height: calc(100vh - var(--kiosk-header-height, var(--header-height)));\n}\n\n:host([panel][casted]) {\n  height: 100%;\n}\n\ndiv.main {\n  position: relative;\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  display: block;\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n}\n\n/* Hide scrollbar for Chrome, Safari and Opera */\ndiv.main::-webkit-scrollbar {\n  display: none;\n}\n\nha-card {\n  display: flex;\n  flex-direction: column;\n  margin: auto;\n  border: 0px;\n  overflow: visible;\n  width: 100%;\n  height: 100%;\n  position: static;\n  color: var(--secondary-text-color, white);\n}\n\n/************\n * Fullscreen\n *************/\n:host(:fullscreen) #ha-card {\n  border-radius: 0px;\n  box-shadow: none;\n  margin: 0;\n}\n\n:host(:-webkit-full-screen) #ha-card {\n  border-radius: 0px;\n  box-shadow: none;\n  margin: 0;\n}\n\n:host(:fullscreen) div.main,\n:host(:fullscreen) advanced-camera-card-menu {\n  border-radius: 0px;\n}\n\n:host(:-webkit-full-screen) div.main,\n:host(:-webkit-full-screen) advanced-camera-card-menu {\n  border-radius: 0px;\n}\n\n/***************\n * Expanded mode\n ***************/\nweb-dialog {\n  --dialog-padding: 0px;\n  --dialog-container-padding: 0px;\n  --dialog-max-height: var(--advanced-camera-card-expand-max-height);\n  --dialog-max-width: var(--advanced-camera-card-expand-max-width);\n  --dialog-width: var(--advanced-camera-card-expand-width);\n  --dialog-height: var(--advanced-camera-card-expand-height);\n  --dialog-overflow-x: visible;\n  --dialog-overflow-y: visible;\n  max-height: 100vh;\n}\n\nweb-dialog::part(dialog) {\n  aspect-ratio: var(--advanced-camera-card-expand-aspect-ratio);\n  border-radius: 0px;\n  background: transparent;\n}\n\n/*******************\n * Menu hover styles\n *******************/\nadvanced-camera-card-menu {\n  z-index: 4;\n}\n\nadvanced-camera-card-menu[data-style*=hover] {\n  transition: opacity 0.5s ease;\n  opacity: 0;\n}\n\nadvanced-camera-card-menu[data-style*=hover]:hover,\nha-card:hover > advanced-camera-card-overlay > advanced-camera-card-menu[data-style=hover-card] {\n  opacity: 1;\n}\n\n/*************************\n * Status bar hover styles\n *************************/\nadvanced-camera-card-status-bar {\n  z-index: 2;\n}\n\nadvanced-camera-card-status-bar[data-style*=hover] {\n  transition: opacity 0.5s ease;\n  opacity: 0;\n}\n\nadvanced-camera-card-status-bar[data-style*=hover]:hover,\nha-card:hover > advanced-camera-card-overlay > advanced-camera-card-status-bar[data-style=hover-card] {\n  opacity: 1;\n}')}getCardSize(){return 6}};eD=e([le("advanced-camera-card")],eD);let tD=class extends eD{};tD=e([le("frigate-card")],tD);export{Jk as $,Up as A,qp as B,Dp as C,Wp as D,Zp as E,kp as F,Cp as G,Sp as H,Ep as I,Ap as J,Tp as K,$p as L,Ip as M,Op as N,og as O,Qf as P,mi as Q,jv as R,fi as S,Rf as T,Of as U,Lf as V,Df as W,zf as X,gi as Y,Dv as Z,e as _,oe as a,qm as a$,tC as a0,nd as a1,pp as a2,Gx as a3,GI as a4,ah as a5,Ug as a6,rh as a7,Ze as a8,Xx as a9,bf as aA,uf as aB,pf as aC,mf as aD,df as aE,hf as aF,Pm as aG,Nm as aH,Fm as aI,Ym as aJ,Gm as aK,Jm as aL,ef as aM,Xm as aN,Zm as aO,Km as aP,Qm as aQ,rf as aR,cf as aS,lf as aT,tf as aU,nf as aV,of as aW,af as aX,sf as aY,Um as aZ,Wm as a_,wg as aa,wp as ab,bp as ac,xp as ad,Mp as ae,Lp as af,Np as ag,Zf as ah,Wf as ai,qf as aj,Kf as ak,ag as al,ig as am,sg as an,IS as ao,rg as ap,vf as aq,ff as ar,kf as as,gf as at,_f as au,Dm as av,jm as aw,zm as ax,Rm as ay,yf as az,pe as b,bg as b$,Bm as b0,Hm as b1,Vm as b2,wf as b3,Mf as b4,xf as b5,em as b6,Yp as b7,Xp as b8,Jp as b9,$m as bA,Im as bB,km as bC,Cm as bD,Tm as bE,Sm as bF,Am as bG,Af as bH,$f as bI,Sf as bJ,Ef as bK,Tf as bL,jf as bM,Nf as bN,Ff as bO,Bf as bP,Hf as bQ,Vf as bR,Pf as bS,ug as bT,lg as bU,dg as bV,fg as bW,mg as bX,gg as bY,Mg as bZ,_g as b_,Gp as ba,Qp as bb,nm as bc,im as bd,am as be,rm as bf,dm as bg,Om as bh,hm as bi,mm as bj,pm as bk,sm as bl,lm as bm,um as bn,om as bo,cm as bp,fm as bq,gm as br,_m as bs,Mm as bt,ym as bu,wm as bv,xm as bw,bm as bx,vm as by,Em as bz,Yx as c,vg as c$,yg as c0,xg as c1,Qx as c2,Zx as c3,vp as c4,_p as c5,fp as c6,gp as c7,mp as c8,oh as c9,zh as cA,Nh as cB,Ph as cC,ip as cD,np as cE,ap as cF,rp as cG,dh as cH,hh as cI,ph as cJ,mh as cK,Fh as cL,Hh as cM,Uh as cN,qh as cO,Wh as cP,Zh as cQ,Kh as cR,Qh as cS,Vh as cT,Bh as cU,lh as cV,uh as cW,Gh as cX,Yh as cY,Jh as cZ,Xh as c_,Rh as ca,Dh as cb,xh as cc,Mh as cd,sh as ce,ch as cf,_h as cg,gh as ch,vh as ci,fh as cj,Lh as ck,Th as cl,$h as cm,Ih as cn,Oh as co,tp as cp,ep as cq,yh as cr,bh as cs,wh as ct,Sh as cu,Ah as cv,kh as cw,Ch as cx,Eh as cy,jh as cz,Jx as d,Uv as d$,QS as d0,UE as d1,Te as d2,qE as d3,yd as d4,Oe as d5,nh as d6,Lv as d7,sL as d8,Ld as d9,Dd as dA,Tu as dB,zL as dC,DL as dD,$d as dE,eT as dF,Ad as dG,Rd as dH,Id as dI,VE as dJ,kg as dK,fe as dL,ge as dM,q as dN,aO as dO,iO as dP,Mi as dQ,Ri as dR,c as dS,p_ as dT,Gu as dU,Mr as dV,Vu as dW,Ea as dX,ld as dY,kr as dZ,Wu as d_,av as da,ve as db,VL as dc,eC as dd,cA as de,sd as df,G_ as dg,X_ as dh,bA as di,HE as dj,WE as dk,ZE as dl,KE as dm,Xd as dn,z_ as dp,fE as dq,gE as dr,KA as ds,QA as dt,rA as du,ZA as dv,OL as dw,Qd as dx,rd as dy,gA as dz,_e as e,Nd as e0,Pd as e1,a_ as e2,r_ as e3,Ei as e4,c_ as e5,od as e6,cd as e7,vA as e8,Iv as e9,_E as eA,ty as eB,h_ as eC,vd as eD,me as eE,ye as eF,W as eG,we as eH,iT as eI,BE as eJ,Sv as eK,Ev as eL,Av as eM,xd as eN,$v as eO,Hu as eP,Tv as eQ,o as eR,GL as eS,Fv as eT,IL as eU,Vv as eV,uA as ea,Bi as eb,gd as ec,o_ as ed,Yu as ee,hi as ef,pd as eg,Zg as eh,Xu as ei,__ as ej,d_ as ek,Wg as el,Zu as em,Kd as en,Yd as eo,f_ as ep,ud as eq,hd as er,m_ as es,Jg as et,md as eu,pE as ev,n_ as ew,t_ as ex,e_ as ey,Td as ez,GS as f,fM as g,Kx as h,zu as i,CA as j,td as k,Hg as l,Pp as m,he as n,zp as o,ES as p,jp as q,s as r,fd as s,le as t,Rp as u,Fp as v,Bp as w,U as x,Vp as y,Hp as z};
