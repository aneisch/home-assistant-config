function e(e,t,n,i){var a,r=arguments.length,s=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(r<3?a(s):r>3?a(t,n,s):a(t,n))||s);return r>3&&s&&Object.defineProperty(t,n,s),s}"function"==typeof SuppressedError&&SuppressedError;
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t=globalThis,n=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,i=Symbol(),a=new WeakMap;let r=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==i)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(n&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=a.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&a.set(t,e))}return e}toString(){return this.cssText}};const s=e=>new r("string"==typeof e?e:e+"",void 0,i),o=(e,...t)=>{const n=1===e.length?e[0]:t.reduce(((t,n,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[i+1]),e[0]);return new r(n,e,i)},c=(e,i)=>{if(n)e.adoptedStyleSheets=i.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet));else for(const n of i){const i=document.createElement("style"),a=t.litNonce;void 0!==a&&i.setAttribute("nonce",a),i.textContent=n.cssText,e.appendChild(i)}},l=n?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return s(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,{is:u,defineProperty:d,getOwnPropertyDescriptor:h,getOwnPropertyNames:p,getOwnPropertySymbols:m,getPrototypeOf:f}=Object,g=globalThis,v=g.trustedTypes,_=v?v.emptyScript:"",y=g.reactiveElementPolyfillSupport,b=(e,t)=>e,w={toAttribute(e,t){switch(t){case Boolean:e=e?_:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},x=(e,t)=>!u(e,t),k={attribute:!0,type:String,converter:w,reflect:!1,hasChanged:x};Symbol.metadata??=Symbol("metadata"),g.litPropertyMetadata??=new WeakMap;class C extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=k){if(t.state&&(t.attribute=!1),this._$Ei(),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),i=this.getPropertyDescriptor(e,n,t);void 0!==i&&d(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){const{get:i,set:a}=h(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get(){return i?.call(this)},set(t){const r=i?.call(this);a.call(this,t),this.requestUpdate(e,r,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??k}static _$Ei(){if(this.hasOwnProperty(b("elementProperties")))return;const e=f(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(b("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(b("properties"))){const e=this.properties,t=[...p(e),...m(e)];for(const n of t)this.createProperty(n,e[n])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,n]of t)this.elementProperties.set(e,n)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const n=this._$Eu(e,t);void 0!==n&&this._$Eh.set(n,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(l(e))}else void 0!==e&&t.push(l(e));return t}static _$Eu(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((e=>e(this)))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return c(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((e=>e.hostConnected?.()))}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach((e=>e.hostDisconnected?.()))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EC(e,t){const n=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,n);if(void 0!==i&&!0===n.reflect){const a=(void 0!==n.converter?.toAttribute?n.converter:w).toAttribute(t,n.type);this._$Em=e,null==a?this.removeAttribute(i):this.setAttribute(i,a),this._$Em=null}}_$AK(e,t){const n=this.constructor,i=n._$Eh.get(e);if(void 0!==i&&this._$Em!==i){const e=n.getPropertyOptions(i),a="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:w;this._$Em=i,this[i]=a.fromAttribute(t,e.type),this._$Em=null}}requestUpdate(e,t,n){if(void 0!==e){if(n??=this.constructor.getPropertyOptions(e),!(n.hasChanged??x)(this[e],t))return;this.P(e,t,n)}!1===this.isUpdatePending&&(this._$ES=this._$ET())}P(e,t,n){this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$Em!==e&&(this._$Ej??=new Set).add(e)}async _$ET(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,n]of e)!0!==n.wrapped||this._$AL.has(t)||void 0===this[t]||this.P(t,this[t],n)}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach((e=>e.hostUpdate?.())),this.update(t)):this._$EU()}catch(t){throw e=!1,this._$EU(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach((e=>e.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Ej&&=this._$Ej.forEach((e=>this._$EC(e,this[e]))),this._$EU()}updated(e){}firstUpdated(e){}}C.elementStyles=[],C.shadowRootOptions={mode:"open"},C[b("elementProperties")]=new Map,C[b("finalized")]=new Map,y?.({ReactiveElement:C}),(g.reactiveElementVersions??=[]).push("2.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const M=globalThis,E=M.trustedTypes,S=E?E.createPolicy("lit-html",{createHTML:e=>e}):void 0,A="$lit$",T=`lit$${(Math.random()+"").slice(9)}$`,$="?"+T,O=`<${$}>`,I=document,L=()=>I.createComment(""),j=e=>null===e||"object"!=typeof e&&"function"!=typeof e,z=Array.isArray,D="[ \t\n\f\r]",R=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,N=/-->/g,P=/>/g,F=RegExp(`>|${D}(?:([^\\s"'>=/]+)(${D}*=${D}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),B=/'/g,V=/"/g,U=/^(?:script|style|textarea|title)$/i,H=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),q=Symbol.for("lit-noChange"),W=Symbol.for("lit-nothing"),Z=new WeakMap,K=I.createTreeWalker(I,129);function Y(e,t){if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==S?S.createHTML(t):t}const Q=(e,t)=>{const n=e.length-1,i=[];let a,r=2===t?"<svg>":"",s=R;for(let t=0;t<n;t++){const n=e[t];let o,c,l=-1,u=0;for(;u<n.length&&(s.lastIndex=u,c=s.exec(n),null!==c);)u=s.lastIndex,s===R?"!--"===c[1]?s=N:void 0!==c[1]?s=P:void 0!==c[2]?(U.test(c[2])&&(a=RegExp("</"+c[2],"g")),s=F):void 0!==c[3]&&(s=F):s===F?">"===c[0]?(s=a??R,l=-1):void 0===c[1]?l=-2:(l=s.lastIndex-c[2].length,o=c[1],s=void 0===c[3]?F:'"'===c[3]?V:B):s===V||s===B?s=F:s===N||s===P?s=R:(s=F,a=void 0);const d=s===F&&e[t+1].startsWith("/>")?" ":"";r+=s===R?n+O:l>=0?(i.push(o),n.slice(0,l)+A+n.slice(l)+T+d):n+T+(-2===l?t:d)}return[Y(e,r+(e[n]||"<?>")+(2===t?"</svg>":"")),i]};class G{constructor({strings:e,_$litType$:t},n){let i;this.parts=[];let a=0,r=0;const s=e.length-1,o=this.parts,[c,l]=Q(e,t);if(this.el=G.createElement(c,n),K.currentNode=this.el.content,2===t){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(i=K.nextNode())&&o.length<s;){if(1===i.nodeType){if(i.hasAttributes())for(const e of i.getAttributeNames())if(e.endsWith(A)){const t=l[r++],n=i.getAttribute(e).split(T),s=/([.?@])?(.*)/.exec(t);o.push({type:1,index:a,name:s[2],strings:n,ctor:"."===s[1]?ne:"?"===s[1]?ie:"@"===s[1]?ae:te}),i.removeAttribute(e)}else e.startsWith(T)&&(o.push({type:6,index:a}),i.removeAttribute(e));if(U.test(i.tagName)){const e=i.textContent.split(T),t=e.length-1;if(t>0){i.textContent=E?E.emptyScript:"";for(let n=0;n<t;n++)i.append(e[n],L()),K.nextNode(),o.push({type:2,index:++a});i.append(e[t],L())}}}else if(8===i.nodeType)if(i.data===$)o.push({type:2,index:a});else{let e=-1;for(;-1!==(e=i.data.indexOf(T,e+1));)o.push({type:7,index:a}),e+=T.length-1}a++}}static createElement(e,t){const n=I.createElement("template");return n.innerHTML=e,n}}function X(e,t,n=e,i){if(t===q)return t;let a=void 0!==i?n._$Co?.[i]:n._$Cl;const r=j(t)?void 0:t._$litDirective$;return a?.constructor!==r&&(a?._$AO?.(!1),void 0===r?a=void 0:(a=new r(e),a._$AT(e,n,i)),void 0!==i?(n._$Co??=[])[i]=a:n._$Cl=a),void 0!==a&&(t=X(e,a._$AS(e,t.values),a,i)),t}let J=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,i=(e?.creationScope??I).importNode(t,!0);K.currentNode=i;let a=K.nextNode(),r=0,s=0,o=n[0];for(;void 0!==o;){if(r===o.index){let t;2===o.type?t=new ee(a,a.nextSibling,this,e):1===o.type?t=new o.ctor(a,o.name,o.strings,this,e):6===o.type&&(t=new re(a,this,e)),this._$AV.push(t),o=n[++s]}r!==o?.index&&(a=K.nextNode(),r++)}return K.currentNode=I,i}p(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}};class ee{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,n,i){this.type=2,this._$AH=W,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=X(this,e,t),j(e)?e===W||null==e||""===e?(this._$AH!==W&&this._$AR(),this._$AH=W):e!==this._$AH&&e!==q&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>z(e)||"function"==typeof e?.[Symbol.iterator])(e)?this.k(e):this._(e)}S(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.S(e))}_(e){this._$AH!==W&&j(this._$AH)?this._$AA.nextSibling.data=e:this.T(I.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:n}=e,i="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=G.createElement(Y(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===i)this._$AH.p(t);else{const e=new J(i,this),n=e.u(this.options);e.p(t),this.T(n),this._$AH=e}}_$AC(e){let t=Z.get(e.strings);return void 0===t&&Z.set(e.strings,t=new G(e)),t}k(e){z(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,i=0;for(const a of e)i===t.length?t.push(n=new ee(this.S(L()),this.S(L()),this,this.options)):n=t[i],n._$AI(a),i++;i<t.length&&(this._$AR(n&&n._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class te{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,i,a){this.type=1,this._$AH=W,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=a,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=W}_$AI(e,t=this,n,i){const a=this.strings;let r=!1;if(void 0===a)e=X(this,e,t,0),r=!j(e)||e!==this._$AH&&e!==q,r&&(this._$AH=e);else{const i=e;let s,o;for(e=a[0],s=0;s<a.length-1;s++)o=X(this,i[n+s],t,s),o===q&&(o=this._$AH[s]),r||=!j(o)||o!==this._$AH[s],o===W?e=W:e!==W&&(e+=(o??"")+a[s+1]),this._$AH[s]=o}r&&!i&&this.j(e)}j(e){e===W?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class ne extends te{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===W?void 0:e}}class ie extends te{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==W)}}class ae extends te{constructor(e,t,n,i,a){super(e,t,n,i,a),this.type=5}_$AI(e,t=this){if((e=X(this,e,t,0)??W)===q)return;const n=this._$AH,i=e===W&&n!==W||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,a=e!==W&&(n===W||i);i&&this.element.removeEventListener(this.name,this,n),a&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class re{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){X(this,e)}}const se=M.litHtmlPolyfillSupport;se?.(G,ee),(M.litHtmlVersions??=[]).push("3.1.2");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
let oe=class extends C{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{const i=n?.renderBefore??t;let a=i._$litPart$;if(void 0===a){const e=n?.renderBefore??null;i._$litPart$=a=new ee(t.insertBefore(L(),e),e,void 0,n??{})}return a._$AI(e),a})(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return q}};oe._$litElement$=!0,oe.finalized=!0,globalThis.litElementHydrateSupport?.({LitElement:oe});const ce=globalThis.litElementPolyfillSupport;ce?.({LitElement:oe}),(globalThis.litElementVersions??=[]).push("4.0.4");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const le=e=>(t,n)=>{void 0!==n?n.addInitializer((()=>{customElements.define(e,t)})):customElements.define(e,t)}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,ue={attribute:!0,type:String,converter:w,reflect:!1,hasChanged:x},de=(e=ue,t,n)=>{const{kind:i,metadata:a}=n;let r=globalThis.litPropertyMetadata.get(a);if(void 0===r&&globalThis.litPropertyMetadata.set(a,r=new Map),r.set(n.name,e),"accessor"===i){const{name:i}=n;return{set(n){const a=t.get.call(this);t.set.call(this,n),this.requestUpdate(i,a,e)},init(t){return void 0!==t&&this.P(i,void 0,e),t}}}if("setter"===i){const{name:i}=n;return function(n){const a=this[i];t.call(this,n),this.requestUpdate(i,a,e)}}throw Error("Unsupported decorator location: "+i)};function he(e){return(t,n)=>"object"==typeof n?de(e,t,n):((e,t,n)=>{const i=t.hasOwnProperty(n);return t.constructor.createProperty(n,i?{...e,wrapped:!0}:e),i?Object.getOwnPropertyDescriptor(t,n):void 0})(e,t,n)
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */}function pe(e){return he({...e,state:!0,attribute:!1})}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const me={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},fe=e=>(...t)=>({_$litDirective$:e,values:t});let ge=class{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,t,n){this._$Ct=e,this._$AM=t,this._$Ci=n}_$AS(e,t){return this.update(e,t)}update(e,t){return this.render(...t)}};
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const ve=fe(class extends ge{constructor(e){if(super(e),e.type!==me.ATTRIBUTE||"class"!==e.name||e.strings?.length>2)throw Error("`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.")}render(e){return" "+Object.keys(e).filter((t=>e[t])).join(" ")+" "}update(e,[t]){if(void 0===this.st){this.st=new Set,void 0!==e.strings&&(this.nt=new Set(e.strings.join(" ").split(/\s/).filter((e=>""!==e))));for(const e in t)t[e]&&!this.nt?.has(e)&&this.st.add(e);return this.render(t)}const n=e.element.classList;for(const e of this.st)e in t||(n.remove(e),this.st.delete(e));for(const e in t){const i=!!t[e];i===this.st.has(e)||this.nt?.has(e)||(i?(n.add(e),this.st.add(e)):(n.remove(e),this.st.delete(e)))}return q}}),_e=e=>e??W
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,ye=e=>void 0===e.strings,be={},we=(e,t=be)=>e._$AH=t
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */,xe=(e,t)=>{const n=e._$AN;if(void 0===n)return!1;for(const e of n)e._$AO?.(t,!1),xe(e,t);return!0},ke=e=>{let t,n;do{if(void 0===(t=e._$AM))break;n=t._$AN,n.delete(e),e=t}while(0===n?.size)},Ce=e=>{for(let t;t=e._$AM;e=t){let n=t._$AN;if(void 0===n)t._$AN=n=new Set;else if(n.has(e))break;n.add(e),Se(t)}};
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function Me(e){void 0!==this._$AN?(ke(this),this._$AM=e,Ce(this)):this._$AM=e}function Ee(e,t=!1,n=0){const i=this._$AH,a=this._$AN;if(void 0!==a&&0!==a.size)if(t)if(Array.isArray(i))for(let e=n;e<i.length;e++)xe(i[e],!1),ke(i[e]);else null!=i&&(xe(i,!1),ke(i));else xe(this,e)}const Se=e=>{e.type==me.CHILD&&(e._$AP??=Ee,e._$AQ??=Me)};class Ae extends ge{constructor(){super(...arguments),this._$AN=void 0}_$AT(e,t,n){super._$AT(e,t,n),Ce(this),this.isConnected=e._$AU}_$AO(e,t=!0){e!==this.isConnected&&(this.isConnected=e,e?this.reconnected?.():this.disconnected?.()),t&&(xe(this,e),ke(this))}setValue(e){if(ye(this._$Ct))this._$Ct._$AI(e,this);else{const t=[...this._$Ct._$AH];t[this._$Ci]=e,this._$Ct._$AI(t,this,0)}}disconnected(){}reconnected(){}}
/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Te=()=>new $e;let $e=class{};const Oe=new WeakMap,Ie=fe(class extends Ae{render(e){return W}update(e,[t]){const n=t!==this.Y;return n&&void 0!==this.Y&&this.rt(void 0),(n||this.lt!==this.ct)&&(this.Y=t,this.ht=e.options?.host,this.rt(this.ct=e.element)),W}rt(e){if("function"==typeof this.Y){const t=this.ht??globalThis;let n=Oe.get(t);void 0===n&&(n=new WeakMap,Oe.set(t,n)),void 0!==n.get(this.Y)&&this.Y.call(this.ht,void 0),n.set(this.Y,e),void 0!==e&&this.Y.call(this.ht,e)}else this.Y.value=e}get lt(){return"function"==typeof this.Y?Oe.get(this.ht??globalThis)?.get(this.Y):this.Y?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}}),Le="important",je=" !"+Le,ze=fe(class extends ge{constructor(e){if(super(e),e.type!==me.ATTRIBUTE||"style"!==e.name||e.strings?.length>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,n)=>{const i=e[n];return null==i?t:t+`${n=n.includes("-")?n:n.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${i};`}),"")}update(e,[t]){const{style:n}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(t)),this.render(t);for(const e of this.ft)null==t[e]&&(this.ft.delete(e),e.includes("-")?n.removeProperty(e):n[e]=null);for(const e in t){const i=t[e];if(null!=i){this.ft.add(e);const t="string"==typeof i&&i.endsWith(je);e.includes("-")||t?n.setProperty(e,t?i.slice(0,-11):i,t?Le:""):n[e]=i}}return q}});
/**
 * @license
 * Copyright 2018 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */function De(e,t,n,i=20,a=0){let r=[];if(a>=i)return r;const s=e=>{const r=e.assignedNodes().filter((e=>1===e.nodeType));return r.length>0?De(r[0].parentElement,t,n,i,a+1):[]},o=Array.from(e.children||[]);for(const e of o)t(e)||(n(e)&&r.push(e),null!=e.shadowRoot?r.push(...De(e.shadowRoot,t,n,i,a+1)):"SLOT"===e.tagName?r.push(...s(e)):r.push(...De(e,t,n,i,a+1)));return r}function Re(e){return e.hasAttribute("hidden")||e.hasAttribute("aria-hidden")&&"false"!==e.getAttribute("aria-hidden")||"none"===e.style.display||"0"===e.style.opacity||"hidden"===e.style.visibility||"collapse"===e.style.visibility}function Ne(e){return"-1"!==e.getAttribute("tabindex")&&!Re(e)&&!function(e){return e.hasAttribute("disabled")||e.hasAttribute("aria-disabled")&&"false"!==e.getAttribute("aria-disabled")}(e)&&(e.hasAttribute("tabindex")||(e instanceof HTMLAnchorElement||e instanceof HTMLAreaElement)&&e.hasAttribute("href")||e instanceof HTMLButtonElement||e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement||e instanceof HTMLIFrameElement)}const Pe=new Map;const Fe=document.createElement("template");Fe.innerHTML='\n\t<div id="start"></div>\n\t<div id="backup"></div>\n\t<slot></slot>\n\t<div id="end"></div>\n';class Be extends HTMLElement{constructor(){super(),this.debounceId=Math.random().toString(),this._focused=!1;const e=this.attachShadow({mode:"open"});e.appendChild(Fe.content.cloneNode(!0)),this.$backup=e.querySelector("#backup"),this.$start=e.querySelector("#start"),this.$end=e.querySelector("#end"),this.focusLastElement=this.focusLastElement.bind(this),this.focusFirstElement=this.focusFirstElement.bind(this),this.onFocusIn=this.onFocusIn.bind(this),this.onFocusOut=this.onFocusOut.bind(this)}static get observedAttributes(){return["inactive"]}get inactive(){return this.hasAttribute("inactive")}set inactive(e){e?this.setAttribute("inactive",""):this.removeAttribute("inactive")}get focused(){return this._focused}connectedCallback(){this.$start.addEventListener("focus",this.focusLastElement),this.$end.addEventListener("focus",this.focusFirstElement),this.addEventListener("focusin",this.onFocusIn),this.addEventListener("focusout",this.onFocusOut),this.render()}disconnectedCallback(){this.$start.removeEventListener("focus",this.focusLastElement),this.$end.removeEventListener("focus",this.focusFirstElement),this.removeEventListener("focusin",this.onFocusIn),this.removeEventListener("focusout",this.onFocusOut)}attributeChangedCallback(){this.render()}focusFirstElement(){this.trapFocus()}focusLastElement(){this.trapFocus(!0)}getFocusableElements(){return De(this,Re,Ne)}trapFocus(e){if(this.inactive)return;let t=this.getFocusableElements();t.length>0?(e?t[t.length-1].focus():t[0].focus(),this.$backup.setAttribute("tabindex","-1")):(this.$backup.setAttribute("tabindex","0"),this.$backup.focus())}onFocusIn(){this.updateFocused(!0)}onFocusOut(){this.updateFocused(!1)}updateFocused(e){!function(e,t,n){const i=Pe.get(n);null!=i&&window.clearTimeout(i),Pe.set(n,window.setTimeout((()=>{e(),Pe.delete(n)}),t))}((()=>{this.focused!==e&&(this._focused=e,this.render())}),0,this.debounceId)}render(){this.$start.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.$end.setAttribute("tabindex",!this.focused||this.inactive?"-1":"0"),this.focused?this.setAttribute("focused",""):this.removeAttribute("focused")}}function Ve(e){return Number(e.getAttribute("data-dialog-count"))||0}function Ue(e,t){e.setAttribute("data-dialog-count",t.toString())}function He(e=document.activeElement){return null!=e&&null!=e.shadowRoot&&null!=e.shadowRoot.activeElement?He(e.shadowRoot.activeElement):e}window.customElements.define("focus-trap",Be);const qe=document.createElement("template");qe.innerHTML='\n  <style>*{box-sizing:border-box}:host{padding:var(--dialog-container-padding,5vw 24px);z-index:var(--dialog-z-index,12345678);outline:none}#backdrop,:host{position:fixed;top:0;left:0;bottom:0;right:0}:host,:host([center]) #dialog{overflow-x:var(--dialog-overflow-x,hidden);overflow-y:var(--dialog-overflow-y,auto);overscroll-behavior:contain;-webkit-overflow-scrolling:touch}:host([center]){display:flex;align-items:center;justify-content:center;overflow:hidden}:host([center]) #dialog{max-height:var(--dialog-max-height,100%)}:host(:not(:defined)),:host(:not([open])){display:none}#backdrop{background:var(--dialog-backdrop-bg,rgba(0,0,0,.6));animation:fadeIn var(--dialog-animation-duration,.1s) var(--dialog-animation-easing,ease-out);z-index:-1}#dialog{animation:scaleIn var(--dialog-animation-duration,.1s) var(--dialog-animation-easing,ease-out);border-radius:var(--dialog-border-radius,12px);box-shadow:var(--dialog-box-shadow,0 2px 10px -5px rgba(0,0,0,.6));max-width:var(--dialog-max-width,700px);width:var(--dialog-width,100%);padding:var(--dialog-padding,24px);max-height:var(--dialog-max-height,unset);height:var(--dialog-height,auto);color:var(--dialog-color,currentColor);background:var(--dialog-bg,#fff);z-index:1;position:relative;display:flex;flex-direction:column;margin:0 auto;border:none}::slotted(article),article{flex-grow:1;overflow-y:auto;-webkit-overflow-scrolling:touch}::slotted(footer),::slotted(header),footer,header{flex-shrink:0}@keyframes scaleIn{0%{transform:scale(.9) translateY(30px);opacity:0}to{transform:scale(1) translateY(0);opacity:1}}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}</style>\n  <div id="backdrop" part="backdrop"></div>\n  <focus-trap id="dialog" part="dialog">\n    <slot></slot>\n  </focus-trap>\n';class We extends HTMLElement{constructor(){super(),this.$scrollContainer=document.documentElement,this.$previousActiveElement=null;const e=this.attachShadow({mode:"open"});e.appendChild(qe.content.cloneNode(!0)),this.$dialog=e.querySelector("#dialog"),this.$backdrop=e.querySelector("#backdrop"),this.onBackdropClick=this.onBackdropClick.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.setAttribute("aria-modal","true"),this.$dialog.setAttribute("role","alertdialog")}static get observedAttributes(){return["open","center"]}get open(){return this.hasAttribute("open")}set open(e){e?this.setAttribute("open",""):this.removeAttribute("open")}get center(){return this.hasAttribute("center")}set center(e){e?this.setAttribute("center",""):this.removeAttribute("center")}connectedCallback(){this.$backdrop.addEventListener("click",this.onBackdropClick)}disconnectedCallback(){this.$backdrop.removeEventListener("click",this.onBackdropClick),this.open&&this.didClose()}show(){this.open=!0}close(e){this.result=e,this.open=!1}onBackdropClick(){this.assertClosing()&&this.close()}onKeyDown(e){if("Escape"===e.code)this.assertClosing()&&(this.close(),e.stopImmediatePropagation())}assertClosing(){return this.dispatchEvent(new CustomEvent("closing",{cancelable:!0}))}didOpen(){this.$previousActiveElement=He(document.activeElement),requestAnimationFrame((()=>{this.$dialog.focusFirstElement()})),this.tabIndex=0,this.$scrollContainer.style.overflow="hidden",this.addEventListener("keydown",this.onKeyDown,{capture:!0,passive:!0}),Ue(this.$scrollContainer,Ve(this.$scrollContainer)+1),this.dispatchEvent(new CustomEvent("open"))}didClose(){this.removeEventListener("keydown",this.onKeyDown,{capture:!0}),Ue(this.$scrollContainer,Math.max(0,Ve(this.$scrollContainer)-1)),Ve(this.$scrollContainer)<=0&&(this.$scrollContainer.style.overflow=""),this.tabIndex=-1,null!=this.$previousActiveElement&&(this.$previousActiveElement.focus(),this.$previousActiveElement=null),this.dispatchEvent(new CustomEvent("close",{detail:this.result}))}attributeChangedCallback(e,t,n){if("open"===e)this.open?this.didOpen():this.didClose()}}var Ze,Ke;function Ye(e){return e.substr(0,e.indexOf("."))}customElements.define("web-dialog",We),function(e){e.language="language",e.system="system",e.comma_decimal="comma_decimal",e.decimal_comma="decimal_comma",e.space_comma="space_comma",e.none="none"}(Ze||(Ze={})),function(e){e.language="language",e.system="system",e.am_pm="12",e.twenty_four="24"}(Ke||(Ke={}));var Qe,Ge,Xe=["closed","locked","off"],Je=function(e,t,n,i){i=i||{},n=null==n?{}:n;var a=new Event(t,{bubbles:void 0===i.bubbles||i.bubbles,cancelable:Boolean(i.cancelable),composed:void 0===i.composed||i.composed});return a.detail=n,e.dispatchEvent(a),a},et=function(e){Je(window,"haptic",e)},tt=function(e,t){return function(e,t,n){void 0===n&&(n=!0);var i,a=Ye(t),r="group"===a?"homeassistant":a;switch(a){case"lock":i=n?"unlock":"lock";break;case"cover":i=n?"open_cover":"close_cover";break;default:i=n?"turn_on":"turn_off"}return e.callService(r,i,{entity_id:t})}(e,t,Xe.includes(e.states[t].state))},nt=function(e,t,n,i){if(i||(i={action:"more-info"}),!i.confirmation||i.confirmation.exemptions&&i.confirmation.exemptions.some((function(e){return e.user===t.user.id}))||(et("warning"),confirm(i.confirmation.text||"Are you sure you want to "+i.action+"?")))switch(i.action){case"more-info":(n.entity||n.camera_image)&&Je(e,"hass-more-info",{entityId:n.entity?n.entity:n.camera_image});break;case"navigate":i.navigation_path&&function(e,t,n){void 0===n&&(n=!1),n?history.replaceState(null,"",t):history.pushState(null,"",t),Je(window,"location-changed",{replace:n})}(0,i.navigation_path);break;case"url":i.url_path&&window.open(i.url_path);break;case"toggle":n.entity&&(tt(t,n.entity),et("success"));break;case"perform-action":if(!i.perform_action)return void et("failure");var a=i.perform_action.split(".",2);t.callService(a[0],a[1],i.data,i.target),et("success");break;case"call-service":if(!i.service)return void et("failure");var r=i.service.split(".",2);t.callService(r[0],r[1],i.data,i.target),et("success");break;case"fire-dom-event":Je(e,"ll-custom",i)}};!function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),i={};for(const e of n)i[e]=t[e];return e.objectValues(i)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(Qe||(Qe={})),function(e){e.mergeShapes=(e,t)=>({...e,...t})}(Ge||(Ge={}));const it=Qe.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),at=e=>{switch(typeof e){case"undefined":return it.undefined;case"string":return it.string;case"number":return isNaN(e)?it.nan:it.number;case"boolean":return it.boolean;case"function":return it.function;case"bigint":return it.bigint;case"symbol":return it.symbol;case"object":return Array.isArray(e)?it.array:null===e?it.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?it.promise:"undefined"!=typeof Map&&e instanceof Map?it.map:"undefined"!=typeof Set&&e instanceof Set?it.set:"undefined"!=typeof Date&&e instanceof Date?it.date:it.object;default:return it.unknown}},rt=Qe.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class st extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},i=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(i);else if("invalid_return_type"===a.code)i(a.returnTypeError);else if("invalid_arguments"===a.code)i(a.argumentsError);else if(0===a.path.length)n._errors.push(t(a));else{let e=n,i=0;for(;i<a.path.length;){const n=a.path[i];i===a.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(a))):e[n]=e[n]||{_errors:[]},e=e[n],i++}}};return i(this),n}static assert(e){if(!(e instanceof st))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Qe.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},n=[];for(const i of this.issues)i.path.length>0?(t[i.path[0]]=t[i.path[0]]||[],t[i.path[0]].push(e(i))):n.push(e(i));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}st.create=e=>new st(e);const ot=(e,t)=>{let n;switch(e.code){case rt.invalid_type:n=e.received===it.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case rt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,Qe.jsonStringifyReplacer)}`;break;case rt.unrecognized_keys:n=`Unrecognized key(s) in object: ${Qe.joinValues(e.keys,", ")}`;break;case rt.invalid_union:n="Invalid input";break;case rt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Qe.joinValues(e.options)}`;break;case rt.invalid_enum_value:n=`Invalid enum value. Expected ${Qe.joinValues(e.options)}, received '${e.received}'`;break;case rt.invalid_arguments:n="Invalid function arguments";break;case rt.invalid_return_type:n="Invalid function return type";break;case rt.invalid_date:n="Invalid date";break;case rt.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:Qe.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case rt.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case rt.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case rt.custom:n="Invalid input";break;case rt.invalid_intersection_types:n="Intersection results could not be merged";break;case rt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case rt.not_finite:n="Number must be finite";break;default:n=t.defaultError,Qe.assertNever(e)}return{message:n}};let ct=ot;function lt(){return ct}const ut=e=>{const{data:t,path:n,errorMaps:i,issueData:a}=e,r=[...n,...a.path||[]],s={...a,path:r};if(void 0!==a.message)return{...a,path:r,message:a.message};let o="";const c=i.filter((e=>!!e)).slice().reverse();for(const e of c)o=e(s,{data:t,defaultError:o}).message;return{...a,path:r,message:o}};function dt(e,t){const n=lt(),i=ut({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===ot?void 0:ot].filter((e=>!!e))});e.common.issues.push(i)}class ht{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const n=[];for(const i of t){if("aborted"===i.status)return pt;"dirty"===i.status&&e.dirty(),n.push(i.value)}return{status:e.value,value:n}}static async mergeObjectAsync(e,t){const n=[];for(const e of t){const t=await e.key,i=await e.value;n.push({key:t,value:i})}return ht.mergeObjectSync(e,n)}static mergeObjectSync(e,t){const n={};for(const i of t){const{key:t,value:a}=i;if("aborted"===t.status)return pt;if("aborted"===a.status)return pt;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!i.alwaysSet||(n[t.value]=a.value)}return{status:e.value,value:n}}}const pt=Object.freeze({status:"aborted"}),mt=e=>({status:"dirty",value:e}),ft=e=>({status:"valid",value:e}),gt=e=>"aborted"===e.status,vt=e=>"dirty"===e.status,_t=e=>"valid"===e.status,yt=e=>"undefined"!=typeof Promise&&e instanceof Promise;function bt(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)}function wt(e,t,n,i,a){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?a.call(e,n):a?a.value=n:t.set(e,n),n}var xt,kt,Ct;"function"==typeof SuppressedError&&SuppressedError,function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:null==e?void 0:e.message}(xt||(xt={}));class Mt{constructor(e,t,n,i){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Et=(e,t)=>{if(_t(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new st(e.common.issues);return this._error=t,this._error}}};function St(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:i,description:a}=e;if(t&&(n||i))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{var r,s;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:a.defaultError}:void 0===a.data?{message:null!==(r=null!=o?o:i)&&void 0!==r?r:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(s=null!=o?o:n)&&void 0!==s?s:a.defaultError}},description:a}}class At{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return at(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:at(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ht,ctx:{common:e.parent.common,data:e.data,parsedType:at(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(yt(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const i={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:at(e)},a=this._parseSync({data:e,path:i.path,parent:i});return Et(i,a)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:at(e)},i=this._parse({data:e,path:n.path,parent:n}),a=await(yt(i)?i:Promise.resolve(i));return Et(n,a)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,i)=>{const a=e(t),r=()=>i.addIssue({code:rt.custom,...n(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(r(),!1))):!!a||(r(),!1)}))}refinement(e,t){return this._refinement(((n,i)=>!!e(n)||(i.addIssue("function"==typeof t?t(n,i):t),!1)))}_refinement(e){return new Cn({schema:this,typeName:Dn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Mn.create(this,this._def)}nullable(){return En.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return rn.create(this,this._def)}promise(){return kn.create(this,this._def)}or(e){return cn.create([this,e],this._def)}and(e){return hn.create(this,e,this._def)}transform(e){return new Cn({...St(this._def),schema:this,typeName:Dn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new Sn({...St(this._def),innerType:this,defaultValue:t,typeName:Dn.ZodDefault})}brand(){return new On({typeName:Dn.ZodBranded,type:this,...St(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new An({...St(this._def),innerType:this,catchValue:t,typeName:Dn.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return In.create(this,e)}readonly(){return Ln.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Tt=/^c[^\s-]{8,}$/i,$t=/^[0-9a-z]+$/,Ot=/^[0-9A-HJKMNP-TV-Z]{26}$/,It=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,Lt=/^[a-z0-9_-]{21}$/i,jt=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,zt=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let Dt;const Rt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,Nt=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Pt=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,Ft="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",Bt=new RegExp(`^${Ft}$`);function Vt(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function Ut(e){let t=`${Ft}T${Vt(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function Ht(e,t){return!("v4"!==t&&t||!Rt.test(e))||!("v6"!==t&&t||!Nt.test(e))}class qt extends At{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==it.string){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.string,received:t.parsedType}),pt}const t=new ht;let n;for(const i of this._def.checks)if("min"===i.kind)e.data.length<i.value&&(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("max"===i.kind)e.data.length>i.value&&(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),t.dirty());else if("length"===i.kind){const a=e.data.length>i.value,r=e.data.length<i.value;(a||r)&&(n=this._getOrReturnCtx(e,n),a?dt(n,{code:rt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):r&&dt(n,{code:rt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),t.dirty())}else if("email"===i.kind)zt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"email",code:rt.invalid_string,message:i.message}),t.dirty());else if("emoji"===i.kind)Dt||(Dt=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Dt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"emoji",code:rt.invalid_string,message:i.message}),t.dirty());else if("uuid"===i.kind)It.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"uuid",code:rt.invalid_string,message:i.message}),t.dirty());else if("nanoid"===i.kind)Lt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"nanoid",code:rt.invalid_string,message:i.message}),t.dirty());else if("cuid"===i.kind)Tt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"cuid",code:rt.invalid_string,message:i.message}),t.dirty());else if("cuid2"===i.kind)$t.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"cuid2",code:rt.invalid_string,message:i.message}),t.dirty());else if("ulid"===i.kind)Ot.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"ulid",code:rt.invalid_string,message:i.message}),t.dirty());else if("url"===i.kind)try{new URL(e.data)}catch(a){n=this._getOrReturnCtx(e,n),dt(n,{validation:"url",code:rt.invalid_string,message:i.message}),t.dirty()}else if("regex"===i.kind){i.regex.lastIndex=0;i.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"regex",code:rt.invalid_string,message:i.message}),t.dirty())}else if("trim"===i.kind)e.data=e.data.trim();else if("includes"===i.kind)e.data.includes(i.value,i.position)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),t.dirty());else if("toLowerCase"===i.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===i.kind)e.data=e.data.toUpperCase();else if("startsWith"===i.kind)e.data.startsWith(i.value)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:{startsWith:i.value},message:i.message}),t.dirty());else if("endsWith"===i.kind)e.data.endsWith(i.value)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:{endsWith:i.value},message:i.message}),t.dirty());else if("datetime"===i.kind){Ut(i).test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:"datetime",message:i.message}),t.dirty())}else if("date"===i.kind){Bt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:"date",message:i.message}),t.dirty())}else if("time"===i.kind){new RegExp(`^${Vt(i)}$`).test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.invalid_string,validation:"time",message:i.message}),t.dirty())}else"duration"===i.kind?jt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"duration",code:rt.invalid_string,message:i.message}),t.dirty()):"ip"===i.kind?Ht(e.data,i.version)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"ip",code:rt.invalid_string,message:i.message}),t.dirty()):"base64"===i.kind?Pt.test(e.data)||(n=this._getOrReturnCtx(e,n),dt(n,{validation:"base64",code:rt.invalid_string,message:i.message}),t.dirty()):Qe.assertNever(i);return{status:t.value,value:e.data}}_regex(e,t,n){return this.refinement((t=>e.test(t)),{validation:t,code:rt.invalid_string,...xt.errToObj(n)})}_addCheck(e){return new qt({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...xt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...xt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...xt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...xt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...xt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...xt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...xt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...xt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...xt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...xt.errToObj(e)})}datetime(e){var t,n;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(n=null==e?void 0:e.local)&&void 0!==n&&n,...xt.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...xt.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...xt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...xt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...xt.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...xt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...xt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...xt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...xt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...xt.errToObj(t)})}nonempty(e){return this.min(1,xt.errToObj(e))}trim(){return new qt({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new qt({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new qt({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function Wt(e,t){const n=(e.toString().split(".")[1]||"").length,i=(t.toString().split(".")[1]||"").length,a=n>i?n:i;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}qt.create=e=>{var t;return new qt({checks:[],typeName:Dn.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...St(e)})};class Zt extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==it.number){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.number,received:t.parsedType}),pt}let t;const n=new ht;for(const i of this._def.checks)if("int"===i.kind)Qe.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.invalid_type,expected:"integer",received:"float",message:i.message}),n.dirty());else if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),n.dirty())}else"multipleOf"===i.kind?0!==Wt(e.data,i.value)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):"finite"===i.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.not_finite,message:i.message}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,n,i){return new Zt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:xt.toString(i)}]})}_addCheck(e){return new Zt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:xt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:xt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:xt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:xt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&Qe.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Zt.create=e=>new Zt({checks:[],typeName:Dn.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...St(e)});class Kt extends At{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){this._def.coerce&&(e.data=BigInt(e.data));if(this._getType(e)!==it.bigint){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.bigint,received:t.parsedType}),pt}let t;const n=new ht;for(const i of this._def.checks)if("min"===i.kind){(i.inclusive?e.data<i.value:e.data<=i.value)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else if("max"===i.kind){(i.inclusive?e.data>i.value:e.data>=i.value)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),n.dirty())}else"multipleOf"===i.kind?e.data%i.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),dt(t,{code:rt.not_multiple_of,multipleOf:i.value,message:i.message}),n.dirty()):Qe.assertNever(i);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,xt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,xt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,xt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,xt.toString(t))}setLimit(e,t,n,i){return new Kt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:xt.toString(i)}]})}_addCheck(e){return new Kt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:xt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:xt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:xt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}Kt.create=e=>{var t;return new Kt({checks:[],typeName:Dn.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...St(e)})};class Yt extends At{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==it.boolean){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.boolean,received:t.parsedType}),pt}return ft(e.data)}}Yt.create=e=>new Yt({typeName:Dn.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...St(e)});class Qt extends At{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==it.date){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.date,received:t.parsedType}),pt}if(isNaN(e.data.getTime())){return dt(this._getOrReturnCtx(e),{code:rt.invalid_date}),pt}const t=new ht;let n;for(const i of this._def.checks)"min"===i.kind?e.data.getTime()<i.value&&(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),t.dirty()):"max"===i.kind?e.data.getTime()>i.value&&(n=this._getOrReturnCtx(e,n),dt(n,{code:rt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),t.dirty()):Qe.assertNever(i);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Qt({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:xt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:xt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Qt.create=e=>new Qt({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:Dn.ZodDate,...St(e)});class Gt extends At{_parse(e){if(this._getType(e)!==it.symbol){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.symbol,received:t.parsedType}),pt}return ft(e.data)}}Gt.create=e=>new Gt({typeName:Dn.ZodSymbol,...St(e)});class Xt extends At{_parse(e){if(this._getType(e)!==it.undefined){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.undefined,received:t.parsedType}),pt}return ft(e.data)}}Xt.create=e=>new Xt({typeName:Dn.ZodUndefined,...St(e)});class Jt extends At{_parse(e){if(this._getType(e)!==it.null){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.null,received:t.parsedType}),pt}return ft(e.data)}}Jt.create=e=>new Jt({typeName:Dn.ZodNull,...St(e)});class en extends At{constructor(){super(...arguments),this._any=!0}_parse(e){return ft(e.data)}}en.create=e=>new en({typeName:Dn.ZodAny,...St(e)});class tn extends At{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ft(e.data)}}tn.create=e=>new tn({typeName:Dn.ZodUnknown,...St(e)});class nn extends At{_parse(e){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.never,received:t.parsedType}),pt}}nn.create=e=>new nn({typeName:Dn.ZodNever,...St(e)});class an extends At{_parse(e){if(this._getType(e)!==it.undefined){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.void,received:t.parsedType}),pt}return ft(e.data)}}an.create=e=>new an({typeName:Dn.ZodVoid,...St(e)});class rn extends At{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),i=this._def;if(t.parsedType!==it.array)return dt(t,{code:rt.invalid_type,expected:it.array,received:t.parsedType}),pt;if(null!==i.exactLength){const e=t.data.length>i.exactLength.value,a=t.data.length<i.exactLength.value;(e||a)&&(dt(t,{code:e?rt.too_big:rt.too_small,minimum:a?i.exactLength.value:void 0,maximum:e?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),n.dirty())}if(null!==i.minLength&&t.data.length<i.minLength.value&&(dt(t,{code:rt.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),n.dirty()),null!==i.maxLength&&t.data.length>i.maxLength.value&&(dt(t,{code:rt.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>i.type._parseAsync(new Mt(t,e,t.path,n))))).then((e=>ht.mergeArray(n,e)));const a=[...t.data].map(((e,n)=>i.type._parseSync(new Mt(t,e,t.path,n))));return ht.mergeArray(n,a)}get element(){return this._def.type}min(e,t){return new rn({...this._def,minLength:{value:e,message:xt.toString(t)}})}max(e,t){return new rn({...this._def,maxLength:{value:e,message:xt.toString(t)}})}length(e,t){return new rn({...this._def,exactLength:{value:e,message:xt.toString(t)}})}nonempty(e){return this.min(1,e)}}function sn(e){if(e instanceof on){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=Mn.create(sn(i))}return new on({...e._def,shape:()=>t})}return e instanceof rn?new rn({...e._def,type:sn(e.element)}):e instanceof Mn?Mn.create(sn(e.unwrap())):e instanceof En?En.create(sn(e.unwrap())):e instanceof pn?pn.create(e.items.map((e=>sn(e)))):e}rn.create=(e,t)=>new rn({type:e,minLength:null,maxLength:null,exactLength:null,typeName:Dn.ZodArray,...St(t)});class on extends At{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=Qe.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==it.object){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.object,received:t.parsedType}),pt}const{status:t,ctx:n}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),r=[];if(!(this._def.catchall instanceof nn&&"strip"===this._def.unknownKeys))for(const e in n.data)a.includes(e)||r.push(e);const s=[];for(const e of a){const t=i[e],a=n.data[e];s.push({key:{status:"valid",value:e},value:t._parse(new Mt(n,a,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof nn){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of r)s.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)r.length>0&&(dt(n,{code:rt.unrecognized_keys,keys:r}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of r){const i=n.data[t];s.push({key:{status:"valid",value:t},value:e._parse(new Mt(n,i,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of s){const n=await t.key,i=await t.value;e.push({key:n,value:i,alwaysSet:t.alwaysSet})}return e})).then((e=>ht.mergeObjectSync(t,e))):ht.mergeObjectSync(t,s)}get shape(){return this._def.shape()}strict(e){return xt.errToObj,new on({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var i,a,r,s;const o=null!==(r=null===(a=(i=this._def).errorMap)||void 0===a?void 0:a.call(i,t,n).message)&&void 0!==r?r:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(s=xt.errToObj(e).message)&&void 0!==s?s:o}:{message:o}}}:{}})}strip(){return new on({...this._def,unknownKeys:"strip"})}passthrough(){return new on({...this._def,unknownKeys:"passthrough"})}extend(e){return new on({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new on({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Dn.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new on({...this._def,catchall:e})}pick(e){const t={};return Qe.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new on({...this._def,shape:()=>t})}omit(e){const t={};return Qe.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new on({...this._def,shape:()=>t})}deepPartial(){return sn(this)}partial(e){const t={};return Qe.objectKeys(this.shape).forEach((n=>{const i=this.shape[n];e&&!e[n]?t[n]=i:t[n]=i.optional()})),new on({...this._def,shape:()=>t})}required(e){const t={};return Qe.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof Mn;)e=e._def.innerType;t[n]=e}})),new on({...this._def,shape:()=>t})}keyof(){return bn(Qe.objectKeys(this.shape))}}on.create=(e,t)=>new on({shape:()=>e,unknownKeys:"strip",catchall:nn.create(),typeName:Dn.ZodObject,...St(t)}),on.strictCreate=(e,t)=>new on({shape:()=>e,unknownKeys:"strict",catchall:nn.create(),typeName:Dn.ZodObject,...St(t)}),on.lazycreate=(e,t)=>new on({shape:e,unknownKeys:"strip",catchall:nn.create(),typeName:Dn.ZodObject,...St(t)});class cn extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new st(e.ctx.common.issues)));return dt(t,{code:rt.invalid_union,unionErrors:n}),pt}));{let e;const i=[];for(const a of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=a._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&i.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=i.map((e=>new st(e)));return dt(t,{code:rt.invalid_union,unionErrors:a}),pt}}get options(){return this._def.options}}cn.create=(e,t)=>new cn({options:e,typeName:Dn.ZodUnion,...St(t)});const ln=e=>e instanceof _n?ln(e.schema):e instanceof Cn?ln(e.innerType()):e instanceof yn?[e.value]:e instanceof wn?e.options:e instanceof xn?Qe.objectValues(e.enum):e instanceof Sn?ln(e._def.innerType):e instanceof Xt?[void 0]:e instanceof Jt?[null]:e instanceof Mn?[void 0,...ln(e.unwrap())]:e instanceof En?[null,...ln(e.unwrap())]:e instanceof On||e instanceof Ln?ln(e.unwrap()):e instanceof An?ln(e._def.innerType):[];class un extends At{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==it.object)return dt(t,{code:rt.invalid_type,expected:it.object,received:t.parsedType}),pt;const n=this.discriminator,i=t.data[n],a=this.optionsMap.get(i);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(dt(t,{code:rt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),pt)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const i=new Map;for(const n of t){const t=ln(n.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const a of t){if(i.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);i.set(a,n)}}return new un({typeName:Dn.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:i,...St(n)})}}function dn(e,t){const n=at(e),i=at(t);if(e===t)return{valid:!0,data:e};if(n===it.object&&i===it.object){const n=Qe.objectKeys(t),i=Qe.objectKeys(e).filter((e=>-1!==n.indexOf(e))),a={...e,...t};for(const n of i){const i=dn(e[n],t[n]);if(!i.valid)return{valid:!1};a[n]=i.data}return{valid:!0,data:a}}if(n===it.array&&i===it.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let i=0;i<e.length;i++){const a=dn(e[i],t[i]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}return n===it.date&&i===it.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class hn extends At{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=(e,i)=>{if(gt(e)||gt(i))return pt;const a=dn(e.value,i.value);return a.valid?((vt(e)||vt(i))&&t.dirty(),{status:t.value,value:a.data}):(dt(n,{code:rt.invalid_intersection_types}),pt)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>i(e,t))):i(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}hn.create=(e,t,n)=>new hn({left:e,right:t,typeName:Dn.ZodIntersection,...St(n)});class pn extends At{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==it.array)return dt(n,{code:rt.invalid_type,expected:it.array,received:n.parsedType}),pt;if(n.data.length<this._def.items.length)return dt(n,{code:rt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),pt;!this._def.rest&&n.data.length>this._def.items.length&&(dt(n,{code:rt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...n.data].map(((e,t)=>{const i=this._def.items[t]||this._def.rest;return i?i._parse(new Mt(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(i).then((e=>ht.mergeArray(t,e))):ht.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new pn({...this._def,rest:e})}}pn.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new pn({items:e,typeName:Dn.ZodTuple,rest:null,...St(t)})};class mn extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==it.object)return dt(n,{code:rt.invalid_type,expected:it.object,received:n.parsedType}),pt;const i=[],a=this._def.keyType,r=this._def.valueType;for(const e in n.data)i.push({key:a._parse(new Mt(n,e,n.path,e)),value:r._parse(new Mt(n,n.data[e],n.path,e)),alwaysSet:e in n.data});return n.common.async?ht.mergeObjectAsync(t,i):ht.mergeObjectSync(t,i)}get element(){return this._def.valueType}static create(e,t,n){return new mn(t instanceof At?{keyType:e,valueType:t,typeName:Dn.ZodRecord,...St(n)}:{keyType:qt.create(),valueType:e,typeName:Dn.ZodRecord,...St(t)})}}class fn extends At{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==it.map)return dt(n,{code:rt.invalid_type,expected:it.map,received:n.parsedType}),pt;const i=this._def.keyType,a=this._def.valueType,r=[...n.data.entries()].map((([e,t],r)=>({key:i._parse(new Mt(n,e,n.path,[r,"key"])),value:a._parse(new Mt(n,t,n.path,[r,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of r){const i=await n.key,a=await n.value;if("aborted"===i.status||"aborted"===a.status)return pt;"dirty"!==i.status&&"dirty"!==a.status||t.dirty(),e.set(i.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of r){const i=n.key,a=n.value;if("aborted"===i.status||"aborted"===a.status)return pt;"dirty"!==i.status&&"dirty"!==a.status||t.dirty(),e.set(i.value,a.value)}return{status:t.value,value:e}}}}fn.create=(e,t,n)=>new fn({valueType:t,keyType:e,typeName:Dn.ZodMap,...St(n)});class gn extends At{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==it.set)return dt(n,{code:rt.invalid_type,expected:it.set,received:n.parsedType}),pt;const i=this._def;null!==i.minSize&&n.data.size<i.minSize.value&&(dt(n,{code:rt.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),t.dirty()),null!==i.maxSize&&n.data.size>i.maxSize.value&&(dt(n,{code:rt.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),t.dirty());const a=this._def.valueType;function r(e){const n=new Set;for(const i of e){if("aborted"===i.status)return pt;"dirty"===i.status&&t.dirty(),n.add(i.value)}return{status:t.value,value:n}}const s=[...n.data.values()].map(((e,t)=>a._parse(new Mt(n,e,n.path,t))));return n.common.async?Promise.all(s).then((e=>r(e))):r(s)}min(e,t){return new gn({...this._def,minSize:{value:e,message:xt.toString(t)}})}max(e,t){return new gn({...this._def,maxSize:{value:e,message:xt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}gn.create=(e,t)=>new gn({valueType:e,minSize:null,maxSize:null,typeName:Dn.ZodSet,...St(t)});class vn extends At{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==it.function)return dt(t,{code:rt.invalid_type,expected:it.function,received:t.parsedType}),pt;function n(e,n){return ut({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,lt(),ot].filter((e=>!!e)),issueData:{code:rt.invalid_arguments,argumentsError:n}})}function i(e,n){return ut({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,lt(),ot].filter((e=>!!e)),issueData:{code:rt.invalid_return_type,returnTypeError:n}})}const a={errorMap:t.common.contextualErrorMap},r=t.data;if(this._def.returns instanceof kn){const e=this;return ft((async function(...t){const s=new st([]),o=await e._def.args.parseAsync(t,a).catch((e=>{throw s.addIssue(n(t,e)),s})),c=await Reflect.apply(r,this,o),l=await e._def.returns._def.type.parseAsync(c,a).catch((e=>{throw s.addIssue(i(c,e)),s}));return l}))}{const e=this;return ft((function(...t){const s=e._def.args.safeParse(t,a);if(!s.success)throw new st([n(t,s.error)]);const o=Reflect.apply(r,this,s.data),c=e._def.returns.safeParse(o,a);if(!c.success)throw new st([i(o,c.error)]);return c.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new vn({...this._def,args:pn.create(e).rest(tn.create())})}returns(e){return new vn({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new vn({args:e||pn.create([]).rest(tn.create()),returns:t||tn.create(),typeName:Dn.ZodFunction,...St(n)})}}class _n extends At{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}_n.create=(e,t)=>new _n({getter:e,typeName:Dn.ZodLazy,...St(t)});class yn extends At{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return dt(t,{received:t.data,code:rt.invalid_literal,expected:this._def.value}),pt}return{status:"valid",value:e.data}}get value(){return this._def.value}}function bn(e,t){return new wn({values:e,typeName:Dn.ZodEnum,...St(t)})}yn.create=(e,t)=>new yn({value:e,typeName:Dn.ZodLiteral,...St(t)});class wn extends At{constructor(){super(...arguments),kt.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return dt(t,{expected:Qe.joinValues(n),received:t.parsedType,code:rt.invalid_type}),pt}if(bt(this,kt,"f")||wt(this,kt,new Set(this._def.values),"f"),!bt(this,kt,"f").has(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return dt(t,{received:t.data,code:rt.invalid_enum_value,options:n}),pt}return ft(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return wn.create(e,{...this._def,...t})}exclude(e,t=this._def){return wn.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}kt=new WeakMap,wn.create=bn;class xn extends At{constructor(){super(...arguments),Ct.set(this,void 0)}_parse(e){const t=Qe.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==it.string&&n.parsedType!==it.number){const e=Qe.objectValues(t);return dt(n,{expected:Qe.joinValues(e),received:n.parsedType,code:rt.invalid_type}),pt}if(bt(this,Ct,"f")||wt(this,Ct,new Set(Qe.getValidEnumValues(this._def.values)),"f"),!bt(this,Ct,"f").has(e.data)){const e=Qe.objectValues(t);return dt(n,{received:n.data,code:rt.invalid_enum_value,options:e}),pt}return ft(e.data)}get enum(){return this._def.values}}Ct=new WeakMap,xn.create=(e,t)=>new xn({values:e,typeName:Dn.ZodNativeEnum,...St(t)});class kn extends At{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==it.promise&&!1===t.common.async)return dt(t,{code:rt.invalid_type,expected:it.promise,received:t.parsedType}),pt;const n=t.parsedType===it.promise?t.data:Promise.resolve(t.data);return ft(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}kn.create=(e,t)=>new kn({type:e,typeName:Dn.ZodPromise,...St(t)});class Cn extends At{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Dn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),i=this._def.effect||null,a={addIssue:e=>{dt(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===i.type){const e=i.transform(n.data,a);if(n.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return pt;const i=await this._def.schema._parseAsync({data:e,path:n.path,parent:n});return"aborted"===i.status?pt:"dirty"===i.status||"dirty"===t.value?mt(i.value):i}));{if("aborted"===t.value)return pt;const i=this._def.schema._parseSync({data:e,path:n.path,parent:n});return"aborted"===i.status?pt:"dirty"===i.status||"dirty"===t.value?mt(i.value):i}}if("refinement"===i.type){const e=e=>{const t=i.refinement(e,a);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const i=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===i.status?pt:("dirty"===i.status&&t.dirty(),e(i.value),{status:t.value,value:i.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?pt:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===i.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!_t(e))return e;const r=i.transform(e.value,a);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:r}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>_t(e)?Promise.resolve(i.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}Qe.assertNever(i)}}Cn.create=(e,t,n)=>new Cn({schema:e,typeName:Dn.ZodEffects,effect:t,...St(n)}),Cn.createWithPreprocess=(e,t,n)=>new Cn({schema:t,effect:{type:"preprocess",transform:e},typeName:Dn.ZodEffects,...St(n)});class Mn extends At{_parse(e){return this._getType(e)===it.undefined?ft(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mn.create=(e,t)=>new Mn({innerType:e,typeName:Dn.ZodOptional,...St(t)});class En extends At{_parse(e){return this._getType(e)===it.null?ft(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}En.create=(e,t)=>new En({innerType:e,typeName:Dn.ZodNullable,...St(t)});class Sn extends At{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===it.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Sn.create=(e,t)=>new Sn({innerType:e,typeName:Dn.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...St(t)});class An extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},i=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return yt(i)?i.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new st(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===i.status?i.value:this._def.catchValue({get error(){return new st(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}An.create=(e,t)=>new An({innerType:e,typeName:Dn.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...St(t)});class Tn extends At{_parse(e){if(this._getType(e)!==it.nan){const t=this._getOrReturnCtx(e);return dt(t,{code:rt.invalid_type,expected:it.nan,received:t.parsedType}),pt}return{status:"valid",value:e.data}}}Tn.create=e=>new Tn({typeName:Dn.ZodNaN,...St(e)});const $n=Symbol("zod_brand");class On extends At{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}class In extends At{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?pt:"dirty"===e.status?(t.dirty(),mt(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})()}{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?pt:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new In({in:e,out:t,typeName:Dn.ZodPipeline})}}class Ln extends At{_parse(e){const t=this._def.innerType._parse(e),n=e=>(_t(e)&&(e.value=Object.freeze(e.value)),e);return yt(t)?t.then((e=>n(e))):n(t)}unwrap(){return this._def.innerType}}function jn(e,t={},n){return e?en.create().superRefine(((i,a)=>{var r,s;if(!e(i)){const e="function"==typeof t?t(i):"string"==typeof t?{message:t}:t,o=null===(s=null!==(r=e.fatal)&&void 0!==r?r:n)||void 0===s||s,c="string"==typeof e?{message:e}:e;a.addIssue({code:"custom",...c,fatal:o})}})):en.create()}Ln.create=(e,t)=>new Ln({innerType:e,typeName:Dn.ZodReadonly,...St(t)});const zn={object:on.lazycreate};var Dn;!function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(Dn||(Dn={}));const Rn=qt.create,Nn=Zt.create,Pn=Tn.create,Fn=Kt.create,Bn=Yt.create,Vn=Qt.create,Un=Gt.create,Hn=Xt.create,qn=Jt.create,Wn=en.create,Zn=tn.create,Kn=nn.create,Yn=an.create,Qn=rn.create,Gn=on.create,Xn=on.strictCreate,Jn=cn.create,ei=un.create,ti=hn.create,ni=pn.create,ii=mn.create,ai=fn.create,ri=gn.create,si=vn.create,oi=_n.create,ci=yn.create,li=wn.create,ui=xn.create,di=kn.create,hi=Cn.create,pi=Mn.create,mi=En.create,fi=Cn.createWithPreprocess,gi=In.create,vi={string:e=>qt.create({...e,coerce:!0}),number:e=>Zt.create({...e,coerce:!0}),boolean:e=>Yt.create({...e,coerce:!0}),bigint:e=>Kt.create({...e,coerce:!0}),date:e=>Qt.create({...e,coerce:!0})},_i=pt;var yi=Object.freeze({__proto__:null,defaultErrorMap:ot,setErrorMap:function(e){ct=e},getErrorMap:lt,makeIssue:ut,EMPTY_PATH:[],addIssueToContext:dt,ParseStatus:ht,INVALID:pt,DIRTY:mt,OK:ft,isAborted:gt,isDirty:vt,isValid:_t,isAsync:yt,get util(){return Qe},get objectUtil(){return Ge},ZodParsedType:it,getParsedType:at,ZodType:At,datetimeRegex:Ut,ZodString:qt,ZodNumber:Zt,ZodBigInt:Kt,ZodBoolean:Yt,ZodDate:Qt,ZodSymbol:Gt,ZodUndefined:Xt,ZodNull:Jt,ZodAny:en,ZodUnknown:tn,ZodNever:nn,ZodVoid:an,ZodArray:rn,ZodObject:on,ZodUnion:cn,ZodDiscriminatedUnion:un,ZodIntersection:hn,ZodTuple:pn,ZodRecord:mn,ZodMap:fn,ZodSet:gn,ZodFunction:vn,ZodLazy:_n,ZodLiteral:yn,ZodEnum:wn,ZodNativeEnum:xn,ZodPromise:kn,ZodEffects:Cn,ZodTransformer:Cn,ZodOptional:Mn,ZodNullable:En,ZodDefault:Sn,ZodCatch:An,ZodNaN:Tn,BRAND:$n,ZodBranded:On,ZodPipeline:In,ZodReadonly:Ln,custom:jn,Schema:At,ZodSchema:At,late:zn,get ZodFirstPartyTypeKind(){return Dn},coerce:vi,any:Wn,array:Qn,bigint:Fn,boolean:Bn,date:Vn,discriminatedUnion:ei,effect:hi,enum:li,function:si,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>jn((t=>t instanceof e),t),intersection:ti,lazy:oi,literal:ci,map:ai,nan:Pn,nativeEnum:ui,never:Kn,null:qn,nullable:mi,number:Nn,object:Gn,oboolean:()=>Bn().optional(),onumber:()=>Nn().optional(),optional:pi,ostring:()=>Rn().optional(),pipeline:gi,preprocess:fi,promise:di,record:ii,set:ri,strictObject:Xn,string:Rn,symbol:Un,transformer:hi,tuple:ni,undefined:Hn,union:Jn,unknown:Zn,void:Yn,NEVER:_i,ZodIssueCode:rt,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:st});const bi="https://card.camera/#/troubleshooting",wi=`${bi}?id=stream-does-not-load`,xi="cameras",ki=`${xi}.#.always_error_if_entity_unavailable`,Ci=`${xi}.#.camera_entity`,Mi=`${xi}.#.frigate.camera_name`,Ei=`${xi}.#.capabilities.disable`,Si=`${xi}.#.capabilities.disable_except`,Ai=`${xi}.#.cast.method`,Ti=`${xi}.#.cast.dashboard.dashboard_path`,$i=`${xi}.#.cast.dashboard.view_path`,Oi=`${xi}.#.dimensions.aspect_ratio`,Ii=`${xi}.#.frigate.client_id`,Li=`${xi}.#.frigate.labels`,ji=`${xi}.#.frigate.url`,zi=`${xi}.#.frigate.zones`,Di=`${xi}.#.go2rtc.modes`,Ri=`${xi}.#.go2rtc.stream`,Ni=`${xi}.#.go2rtc.url`,Pi=`${xi}.#.icon`,Fi=`${xi}.#.id`,Bi=`${xi}.#.image.entity`,Vi=`${xi}.#.image.entity_parameters`,Ui=`${xi}.#.image.mode`,Hi=`${xi}.#.image.refresh_seconds`,qi=`${xi}.#.image.url`,Wi=`${xi}.#.motioneye.images.directory_pattern`,Zi=`${xi}.#.motioneye.images.file_pattern`,Ki=`${xi}.#.motioneye.movies.directory_pattern`,Yi=`${xi}.#.motioneye.movies.file_pattern`,Qi=`${xi}.#.motioneye.url`,Gi=`${xi}.#.title`,Xi=`${xi}.#.webrtc_card.entity`,Ji=`${xi}.#.webrtc_card.url`,ea=`${xi}.#.live_provider`,ta=`${xi}.#.dependencies.cameras`,na=`${xi}.#.dependencies.all_cameras`,ia=`${xi}.#.dimensions.layout.fit`,aa=`${xi}.#.dimensions.layout.pan.x`,ra=`${xi}.#.dimensions.layout.pan.y`,sa=`${xi}.#.dimensions.layout.position.x`,oa=`${xi}.#.dimensions.layout.position.y`,ca=`${xi}.#.dimensions.layout.view_box.top`,la=`${xi}.#.dimensions.layout.view_box.bottom`,ua=`${xi}.#.dimensions.layout.view_box.left`,da=`${xi}.#.dimensions.layout.view_box.right`,ha=`${xi}.#.dimensions.layout.zoom`,pa=`${xi}.#.proxy.dynamic`,ma=`${xi}.#.proxy.media`,fa=`${xi}.#.proxy.ssl_ciphers`,ga=`${xi}.#.proxy.ssl_verification`,va=`${xi}.#.reolink.media_resolution`,_a=`${xi}.#.reolink.url`,ya=`${xi}.#.triggers.motion`,ba=`${xi}.#.triggers.occupancy`,wa=`${xi}.#.triggers.entities`,xa=`${xi}.#.triggers.events`,ka="cameras_global",Ca=`${ka}.live_provider`,Ma=`${ka}.triggers.occupancy`,Ea=`${ka}.image.refresh_seconds`,Sa=`${ka}.dimensions.layout`,Aa=`${ka}.ptz`,Ta="elements",$a="view",Oa=`${$a}.camera_select`,Ia=`${$a}.default`,La=`${$a}.dim`,ja=`${$a}.interaction_seconds`,za=`${$a}.keyboard_shortcuts`,Da=`${$a}.keyboard_shortcuts.enabled`,Ra=`${za}.ptz_left`,Na=`${za}.ptz_right`,Pa=`${za}.ptz_up`,Fa=`${za}.ptz_down`,Ba=`${za}.ptz_zoom_in`,Va=`${za}.ptz_zoom_out`,Ua=`${za}.ptz_home`,Ha=`${$a}.default_cycle_camera`,qa=`${$a}.default_reset`,Wa=`${qa}.interaction_mode`,Za=`${qa}.every_seconds`,Ka=`${qa}.entities`,Ya=`${qa}.after_interaction`,Qa=`${$a}.theme.themes`,Ga=`${$a}.triggers`,Xa=`${Ga}.show_trigger_status`,Ja=`${Ga}.filter_selected_camera`,er=`${Ga}.untrigger_seconds`,tr=`${Ga}.actions`,nr=`${tr}.trigger`,ir=`${tr}.untrigger`,ar=`${tr}.interaction_mode`,rr="media_gallery",sr=`${rr}.controls.filter.mode`,or=`${rr}.controls.thumbnails.show_details`,cr=`${rr}.controls.thumbnails.show_download_control`,lr=`${rr}.controls.thumbnails.show_favorite_control`,ur=`${rr}.controls.thumbnails.show_timeline_control`,dr=`${rr}.controls.thumbnails.size`,hr="media_viewer",pr=`${hr}.auto_play`,mr=`${hr}.auto_pause`,fr=`${hr}.auto_mute`,gr=`${hr}.auto_unmute`,vr=`${hr}.display.mode`,_r=`${hr}.display.grid_columns`,yr=`${hr}.display.grid_max_columns`,br=`${hr}.display.grid_selected_width_factor`,wr=`${hr}.draggable`,xr=`${hr}.lazy_load`,kr=`${hr}.snapshot_click_plays_clip`,Cr=`${hr}.transition_effect`,Mr=`${hr}.controls.builtin`,Er=`${hr}.controls.next_previous.style`,Sr=`${hr}.controls.next_previous.size`,Ar=`${hr}.controls.thumbnails.mode`,Tr=`${hr}.controls.thumbnails.show_details`,$r=`${hr}.controls.thumbnails.show_download_control`,Or=`${hr}.controls.thumbnails.show_favorite_control`,Ir=`${hr}.controls.thumbnails.show_timeline_control`,Lr=`${hr}.controls.thumbnails.size`,jr=`${hr}.controls.timeline.clustering_threshold`,zr=`${hr}.controls.timeline.events_media_type`,Dr=`${hr}.controls.timeline.format.24h`,Rr=`${hr}.controls.timeline.mode`,Nr=`${hr}.controls.timeline.pan_mode`,Pr=`${hr}.controls.timeline.show_recordings`,Fr=`${hr}.controls.timeline.style`,Br=`${hr}.controls.timeline.window_seconds`,Vr=`${hr}.zoomable`,Ur="live",Hr=`${Ur}.auto_play`,qr=`${Ur}.auto_pause`,Wr=`${Ur}.auto_mute`,Zr=`${Ur}.auto_unmute`,Kr=`${Ur}.controls.builtin`,Yr=`${Ur}.controls.next_previous.style`,Qr=`${Ur}.controls.next_previous.size`,Gr=`${Ur}.controls.ptz.hide_home`,Xr=`${Ur}.controls.ptz.hide_pan_tilt`,Jr=`${Ur}.controls.ptz.hide_zoom`,es=`${Ur}.controls.ptz.mode`,ts=`${Ur}.controls.ptz.orientation`,ns=`${Ur}.controls.ptz.position`,is=`${Ur}.controls.thumbnails.media_type`,as=`${Ur}.controls.thumbnails.events_media_type`,rs=`${Ur}.controls.thumbnails.mode`,ss=`${Ur}.controls.thumbnails.size`,os=`${Ur}.controls.thumbnails.show_details`,cs=`${Ur}.controls.thumbnails.show_download_control`,ls=`${Ur}.controls.thumbnails.show_favorite_control`,us=`${Ur}.controls.thumbnails.show_timeline_control`,ds=`${Ur}.controls.timeline.clustering_threshold`,hs=`${Ur}.controls.timeline.events_media_type`,ps=`${Ur}.controls.timeline.format.24h`,ms=`${Ur}.controls.timeline.mode`,fs=`${Ur}.controls.timeline.pan_mode`,gs=`${Ur}.controls.timeline.show_recordings`,vs=`${Ur}.controls.timeline.style`,_s=`${Ur}.controls.timeline.window_seconds`,ys=`${Ur}.display.mode`,bs=`${Ur}.display.grid_columns`,ws=`${Ur}.display.grid_max_columns`,xs=`${Ur}.display.grid_selected_width_factor`,ks=`${Ur}.draggable`,Cs=`${Ur}.lazy_load`,Ms=`${Ur}.lazy_unload`,Es=`${Ur}.preload`,Ss=`${Ur}.transition_effect`,As=`${Ur}.show_image_during_load`,Ts=`${Ur}.microphone.disconnect_seconds`,$s=`${Ur}.microphone.mute_after_microphone_mute_seconds`,Os=`${Ur}.microphone.always_connected`,Is=`${Ur}.zoomable`,Ls="image",js=`${Ls}.entity`,zs=`${Ls}.entity_parameters`,Ds=`${Ls}.mode`,Rs=`${Ls}.refresh_seconds`,Ns=`${Ls}.url`,Ps="timeline",Fs=`${Ps}.window_seconds`,Bs=`${Ps}.clustering_threshold`,Vs=`${Ps}.events_media_type`,Us=`${Ps}.format.24h`,Hs=`${Ps}.show_recordings`,qs=`${Ps}.style`,Ws=`${Ps}.controls.thumbnails.mode`,Zs=`${Ps}.controls.thumbnails.size`,Ks=`${Ps}.controls.thumbnails.show_details`,Ys=`${Ps}.controls.thumbnails.show_download_control`,Qs=`${Ps}.controls.thumbnails.show_favorite_control`,Gs=`${Ps}.controls.thumbnails.show_timeline_control`,Xs="menu",Js=`${Xs}.alignment`,eo=`${Xs}.position`,to=`${Xs}.style`,no=`${Xs}.button_size`,io=`${Xs}.buttons`,ao=`${io}.fullscreen`,ro=`${io}.iris`,so=`${io}.play`,oo=`${io}.mute`,co=`${io}.media_player`,lo=`${io}.timeline`,uo="status_bar",ho=`${uo}.position`,po=`${uo}.style`,mo=`${uo}.popup_seconds`,fo=`${uo}.height`,go=`${uo}.items`,vo="dimensions",_o=`${vo}.aspect_ratio`,yo=`${vo}.aspect_ratio_mode`,bo=`${vo}.height`,wo="overrides",xo="performance",ko=`${xo}.features.animated_progress_indicator`,Co=`${xo}.features.card_loading_indicator`,Mo=`${xo}.features.media_chunk_size`,Eo=`${xo}.features.max_simultaneous_engine_requests`,So=`${xo}.profile`,Ao=`${xo}.style.box_shadow`,To=`${xo}.style.border_radius`,$o="profiles",Oo=1e3,Io="__IMAGE_VIEW_ZOOM__";class Lo extends Error{constructor(e,t){super(e),this.context=t}}const jo=["clips","favorite-events","favorite-recordings","live","menu","ptz","recordings","seek","snapshots","substream","trigger"],zo=yi.object({url:yi.string(),mime_type:yi.string()}),Do=yi.object({path:yi.string()});function Ro(e){if(e instanceof yi.ZodDefault)return Ro(e.removeDefault());if(e instanceof yi.ZodObject){const t={};for(const n in e.shape){const i=e.shape[n];t[n]=yi.ZodOptional.create(Ro(i))}return new yi.ZodObject({...e._def,shape:()=>t})}return e instanceof yi.ZodArray?yi.ZodArray.create(Ro(e.element)).min(e._def.minLength?.value,e._def.minLength?.message).max(e._def.maxLength?.value,e._def.maxLength?.message).length(e._def.exactLength?.value,e._def.exactLength?.message):e instanceof yi.ZodOptional?yi.ZodOptional.create(Ro(e.unwrap())):e instanceof yi.ZodNullable?yi.ZodNullable.create(Ro(e.unwrap())):e instanceof yi.ZodTuple?yi.ZodTuple.create(e.items.map((e=>Ro(e)))):e}function No(e){const t=e.format();return Object.keys(t).filter((e=>!e.startsWith("_")))}const Po=e=>{const t=new Set;if(e.issues.length)for(const n of e.issues)if("invalid_union"===n.code){const e=n.unionErrors;for(const n of e)Po(n).forEach(t.add,t)}else t.add(Fo(n.path));return t},Fo=e=>{let t="";for(let n=0;n<e.length;n++){const i=e[n];"number"==typeof i?t+="["+i+"]":t?t+=" -> "+i:t=i}return t},Bo=yi.object({key:yi.string(),ctrl:yi.boolean().optional(),shift:yi.boolean().optional(),alt:yi.boolean().optional(),meta:yi.boolean().optional()}),Vo={enabled:!0,ptz_left:{key:"ArrowLeft"},ptz_right:{key:"ArrowRight"},ptz_up:{key:"ArrowUp"},ptz_down:{key:"ArrowDown"},ptz_zoom_in:{key:"+"},ptz_zoom_out:{key:"-"},ptz_home:{key:"h"}},Uo=yi.object({enabled:yi.boolean().default(Vo.enabled),ptz_left:Bo.nullable().default(Vo.ptz_left),ptz_right:Bo.nullable().default(Vo.ptz_right),ptz_up:Bo.nullable().default(Vo.ptz_up),ptz_down:Bo.nullable().default(Vo.ptz_down),ptz_zoom_in:Bo.nullable().default(Vo.ptz_zoom_in),ptz_zoom_out:Bo.nullable().default(Vo.ptz_zoom_out),ptz_home:Bo.nullable().default(Vo.ptz_home)}),Ho=[...["left","right","up","down","zoom_in","zoom_out"],"preset"],qo=20,Wo=20,Zo=100,Ko=Zo,Yo=["diagnostics","live","clip","clips","snapshot","snapshots","recording","recordings","image","timeline"],Qo="live",Go=["unselected","hidden"],Xo=["selected","visible"],Jo=[...Xo,"microphone"],ec=[...Go,"microphone"],tc=["start","stop"],nc=["events","clips","snapshots"],ic=/^[-\w]+$/,ac=1,rc=10,sc=yi.object({x:yi.number().min(0).max(100).optional(),y:yi.number().min(0).max(100).optional()}),oc=yi.number().min(1).max(10),cc=yi.enum(["single","grid"]),lc=yi.object({mode:cc.optional(),grid_selected_width_factor:yi.number().min(0).optional(),grid_max_columns:yi.number().min(0).optional(),grid_columns:yi.number().min(0).optional()}).optional(),uc=yi.object({confirmation:yi.boolean().or(yi.object({text:yi.string().optional(),exemptions:yi.object({user:yi.string()}).array().optional()})).optional()}),dc=uc.extend({action:yi.literal("toggle")}),hc=yi.object({entity_id:yi.string().optional(),device_id:yi.string().optional(),area_id:yi.string().optional()}),pc=uc.extend({action:yi.literal("perform-action"),perform_action:yi.string(),data:yi.object({}).passthrough().optional(),target:hc.optional()}),mc=uc.extend({action:yi.literal("call-service"),service:yi.string(),data:yi.object({}).passthrough().optional(),target:hc.optional()}),fc=uc.extend({action:yi.literal("navigate"),navigation_path:yi.string()}),gc=uc.extend({action:yi.literal("url"),url_path:yi.string()}),vc=uc.extend({action:yi.literal("more-info")}),_c=uc.extend({action:yi.literal("fire-dom-event")}).passthrough(),yc=uc.extend({action:yi.literal("none")}),bc=_c.extend({action:yi.literal("custom:advanced-camera-card-action").transform((()=>"fire-dom-event")).or(yi.literal("fire-dom-event")),card_id:yi.string().regex(ic,"card_id parameter can only contain [a-z][A-Z][0-9_]-").optional()}),wc=bc.extend({advanced_camera_card_action:yi.enum(Yo)}),xc=bc.extend({advanced_camera_card_action:yi.enum(["camera_ui","default","download","expand","fullscreen","live_substream_off","live_substream_on","menu_toggle","microphone_connect","microphone_disconnect","microphone_mute","microphone_unmute","mute","pause","play","screenshot","unmute"])}),kc=bc.extend({advanced_camera_card_action:yi.literal("camera_select"),camera:yi.string().optional(),triggered:yi.boolean().optional()}),Cc=bc.extend({advanced_camera_card_action:yi.literal("live_substream_select"),camera:yi.string()}),Mc=bc.extend({advanced_camera_card_action:yi.literal("media_player"),media_player:yi.string(),media_player_action:yi.enum(["play","stop"])}),Ec=bc.extend({advanced_camera_card_action:yi.literal("display_mode_select"),display_mode:cc}),Sc=bc.extend({advanced_camera_card_action:yi.literal("ptz"),camera:yi.string().optional(),ptz_action:yi.enum(Ho).optional(),ptz_phase:yi.enum(tc).optional(),ptz_preset:yi.string().optional()}),Ac=bc.extend({advanced_camera_card_action:yi.literal("ptz_digital"),target_id:yi.string().optional(),absolute:yi.object({zoom:oc.optional(),pan:sc.optional()}).optional(),ptz_action:yi.enum(Ho).optional(),ptz_phase:yi.enum(tc).optional()}),Tc=bc.extend({advanced_camera_card_action:yi.literal("ptz_multi"),target_id:yi.string().optional(),ptz_action:yi.enum(Ho).optional(),ptz_phase:yi.enum(tc).optional(),ptz_preset:yi.string().optional()}),$c=bc.extend({advanced_camera_card_action:yi.literal("ptz_controls"),enabled:yi.boolean()}),Oc=yi.object({ms:yi.number().optional(),s:yi.number().optional(),m:yi.number().optional(),h:yi.number().optional()}),Ic=bc.extend({advanced_camera_card_action:yi.literal("sleep"),duration:Oc.optional().default({s:1})}),Lc=bc.extend({advanced_camera_card_action:yi.literal("status_bar"),status_bar_action:yi.enum(["add","remove","reset"]),items:yi.lazy((()=>ul)).array().optional()}),jc=bc.extend({advanced_camera_card_action:yi.literal("log"),message:yi.string(),level:yi.enum(["debug","info","warn","error"]).default("info")}),zc=yi.union([kc,xc,Cc,jc,Mc,Sc,Ac,Tc,$c,wc,Ec,Ic,Lc]),Dc=yi.union([dc,mc,pc,fc,gc,vc,yc,_c,zc]),Rc=yi.object({tap_action:Dc.or(Dc.array()).optional(),hold_action:Dc.or(Dc.array()).optional(),double_tap_action:Dc.or(Dc.array()).optional(),start_tap_action:Dc.or(Dc.array()).optional(),end_tap_action:Dc.or(Dc.array()).optional()}).passthrough(),Nc=yi.object({actions:Rc.optional()}),Pc=Rc.extend({style:yi.record(yi.string().nullable().or(yi.undefined()).or(yi.number())).optional(),title:yi.string().nullable().optional()}),Fc=Pc.extend({type:yi.literal("state-badge"),entity:yi.string()}),Bc=Pc.extend({type:yi.literal("state-icon"),entity:yi.string(),icon:yi.string().optional(),state_color:yi.boolean().default(!0)}),Vc=Pc.extend({type:yi.literal("state-label"),entity:yi.string(),attribute:yi.string().optional(),prefix:yi.string().optional(),suffix:yi.string().optional()}),Uc=Pc.extend({type:yi.literal("service-button"),title:yi.string(),service:yi.string(),service_data:yi.object({}).passthrough().optional()}),Hc=Pc.extend({type:yi.literal("icon"),icon:yi.string(),entity:yi.string().optional()}),qc=Pc.extend({type:yi.literal("image"),entity:yi.string().optional(),image:yi.string().optional(),camera_image:yi.string().optional(),camera_view:yi.string().optional(),state_image:yi.object({}).passthrough().optional(),filter:yi.string().optional(),state_filter:yi.object({}).passthrough().optional(),aspect_ratio:yi.string().optional()}),Wc=yi.object({condition:yi.literal("state").optional(),entity:yi.string(),state:yi.string().or(yi.string().array()).optional(),state_not:yi.string().or(yi.string().array()).optional()}),Zc=yi.object({condition:yi.literal("numeric_state"),entity:yi.string(),above:yi.number().optional(),below:yi.number().optional()}),Kc=yi.object({condition:yi.literal("screen"),media_query:yi.string()}),Yc=yi.object({condition:yi.literal("user"),users:yi.string().array().min(1)}),Qc=yi.discriminatedUnion("condition",[Wc,Zc,Kc,Yc]),Gc=yi.object({type:yi.literal("conditional"),conditions:Qc.array(),elements:yi.lazy((()=>Cl))}),Xc=yi.object({type:yi.string().superRefine(((e,t)=>{e.match(/^custom:(?!advanced-camera-card).+/)||t.addIssue({code:yi.ZodIssueCode.custom,message:"advanced-camera-card custom elements must match specific schemas",fatal:!0})}))}).passthrough(),Jc=yi.object({enabled:yi.boolean().default(!0).optional(),priority:yi.number().min(0).max(Zo).default(50).optional(),alignment:yi.enum(["matching","opposing"]).default("matching").optional(),icon:yi.string().optional(),permanent:yi.boolean().default(!1).optional()}),el=Jc.merge(Hc).extend({type:yi.literal("custom:advanced-camera-card-menu-icon")}),tl=Jc.merge(Bc).extend({type:yi.literal("custom:advanced-camera-card-menu-state-icon")}).merge(Jc),nl=Pc.extend({entity:yi.string().optional(),icon:yi.string().optional(),state_color:yi.boolean().default(!0),selected:yi.boolean().default(!1),subtitle:yi.string().optional(),enabled:yi.boolean().default(!0)}),il=Jc.merge(Hc).extend({type:yi.literal("custom:advanced-camera-card-menu-submenu"),items:nl.array()}),al=Jc.merge(Bc).extend({type:yi.literal("custom:advanced-camera-card-menu-submenu-select"),options:yi.record(nl.deepPartial()).optional()}),rl=yi.object({enabled:yi.boolean().default(!0).optional(),priority:yi.number().min(0).max(100).default(50).optional()}),sl=rl.extend({sufficient:yi.boolean().default(!1).optional(),exclusive:yi.boolean().default(!1).optional(),expand:yi.boolean().default(!1).optional(),actions:Rc.optional()}),ol=sl.extend({type:yi.literal("custom:advanced-camera-card-status-bar-icon"),icon:yi.string()}),cl=sl.extend({type:yi.literal("custom:advanced-camera-card-status-bar-image"),image:yi.string()}),ll=sl.extend({type:yi.literal("custom:advanced-camera-card-status-bar-string"),string:yi.string()}),ul=yi.union([ol,cl,ll]),dl=yi.object({condition:yi.literal("view"),views:yi.string().array().optional()}),hl=yi.object({condition:yi.literal("fullscreen"),fullscreen:yi.boolean()}),pl=yi.object({condition:yi.literal("expand"),expand:yi.boolean()}),ml=yi.object({condition:yi.literal("camera"),cameras:yi.string().array().optional()}),fl=yi.object({condition:yi.literal("media_loaded"),media_loaded:yi.boolean()}),gl=yi.object({condition:yi.literal("display_mode"),display_mode:cc}),vl=yi.object({condition:yi.literal("triggered"),triggered:yi.string().array()}),_l=yi.object({condition:yi.literal("interaction"),interaction:yi.boolean()}),yl=yi.object({condition:yi.literal("microphone"),connected:yi.boolean().optional(),muted:yi.boolean().optional()}),bl=yi.object({condition:yi.literal("key"),key:yi.string(),state:yi.enum(["down","up"]).optional(),ctrl:yi.boolean().optional(),shift:yi.boolean().optional(),alt:yi.boolean().optional(),meta:yi.boolean().optional()}),wl=yi.object({condition:yi.literal("user_agent"),user_agent:yi.string().optional(),user_agent_re:yi.string().refine((e=>{try{new RegExp(e)}catch{return!1}return!0}),{message:"Invalid regular expression"}).optional(),companion:yi.boolean().optional()}),xl=yi.discriminatedUnion("condition",[Wc,Zc,Kc,Yc,dl,hl,pl,ml,fl,gl,vl,_l,yl,bl,wl]),kl=yi.object({type:yi.literal("custom:advanced-camera-card-conditional"),conditions:xl.array(),elements:yi.lazy((()=>Cl))}),Cl=yi.union([Gc,Xc,kl,Hc,qc,el,tl,il,al,Uc,Fc,Bc,Vc,ol,cl,ll]).array().optional(),Ml=yi.object({fit:yi.enum(["contain","cover","fill"]).optional(),position:yi.object({x:yi.number().min(0).max(100).optional(),y:yi.number().min(0).max(100).optional()}).optional(),view_box:yi.object({bottom:yi.number().min(0).max(100).optional().default(0),left:yi.number().min(0).max(100).optional().default(0),right:yi.number().min(0).max(100).optional().default(0),top:yi.number().min(0).max(100).optional().default(0)}).optional(),pan:sc.optional(),zoom:oc.optional()}),El=yi.number().array().length(2).or(yi.string().regex(/^\s*\d+\.?\d*\s*[:/]\s*\d+\.?\d*\s*$/).transform((e=>e.split(/[:\/]/).map((e=>Number(e)))))),Sl={r2c_delay_between_calls_seconds:.5,c2r_delay_between_calls_seconds:.2},Al=function(e){return t=>{if(!t||"object"!=typeof t||!t.service)return t;const n={...t};return Object.keys(t).forEach((i=>{const a=i.match(/^data_(.+)$/),r=a?.[1];r&&!(`${e}${r}`in t)&&(n[`${e}${r}`]={action:"perform-action",perform_action:t.service,data:t[i]},delete n[i],delete n.service)})),n}},Tl=yi.preprocess(Al("actions_"),yi.object({actions_left:pc.optional(),actions_left_start:pc.optional(),actions_left_stop:pc.optional(),actions_right:pc.optional(),actions_right_start:pc.optional(),actions_right_stop:pc.optional(),actions_up:pc.optional(),actions_up_start:pc.optional(),actions_up_stop:pc.optional(),actions_down:pc.optional(),actions_down_start:pc.optional(),actions_down_stop:pc.optional(),actions_zoom_in:pc.optional(),actions_zoom_in_start:pc.optional(),actions_zoom_in_stop:pc.optional(),actions_zoom_out:pc.optional(),actions_zoom_out_start:pc.optional(),actions_zoom_out_stop:pc.optional(),r2c_delay_between_calls_seconds:yi.number().default(Sl.r2c_delay_between_calls_seconds),c2r_delay_between_calls_seconds:yi.number().default(Sl.c2r_delay_between_calls_seconds),presets:yi.preprocess(Al(""),yi.union([yi.record(pc),yi.object({service:yi.string().optional()})])).optional(),service:yi.string().optional()}).passthrough()),$l={orientation:"horizontal",mode:"auto",hide_pan_tilt:!1,hide_zoom:!1,hide_home:!1,position:"bottom-right"},Ol=yi.object({mode:yi.enum(["off","auto","on"]).default($l.mode),position:yi.enum(["top-left","top-right","bottom-left","bottom-right"]).default($l.position),orientation:yi.enum(["vertical","horizontal"]).default($l.orientation),hide_pan_tilt:yi.boolean().default($l.hide_pan_tilt),hide_zoom:yi.boolean().default($l.hide_zoom),hide_home:yi.boolean().default($l.hide_home),style:yi.object({}).passthrough().optional()}),Il={mode:"auto",refresh_seconds:1,zoomable:!0},Ll=yi.object({mode:yi.enum(["auto","camera","entity","screensaver","url"]).default(Il.mode),refresh_seconds:yi.number().min(0).default(Il.refresh_seconds),url:yi.string().optional(),entity:yi.string().optional(),entity_parameters:yi.string().optional()}),jl=Ll.extend({zoomable:yi.boolean().default(Il.zoomable)}).merge(Nc).default(Il),zl=75,Dl=300,Rl={size:100,show_details:!0,show_favorite_control:!0,show_timeline_control:!0,show_download_control:!0},Nl=yi.object({size:yi.number().min(75).max(300).default(Rl.size),show_details:yi.boolean().default(Rl.show_details),show_favorite_control:yi.boolean().default(Rl.show_favorite_control),show_timeline_control:yi.boolean().default(Rl.show_timeline_control),show_download_control:yi.boolean().default(Rl.show_download_control)}),Pl={...Rl,mode:"right"},Fl=Nl.extend({mode:yi.enum(["none","above","below","left","right"]).default(Pl.mode)}),Bl=yi.enum(["all","clips","snapshots"]),Vl={clustering_threshold:3,events_media_type:"all",window_seconds:3600,show_recordings:!0,style:"stack",pan_mode:"pan",format:{"24h":!0}},Ul=yi.enum(["pan","seek","seek-in-media","seek-in-camera"]),Hl=yi.object({"24h":yi.boolean().optional().default(Vl.format["24h"])}),ql=yi.object({clustering_threshold:yi.number().optional().default(Vl.clustering_threshold),events_media_type:Bl.optional().default(Vl.events_media_type),window_seconds:yi.number().min(60).max(86400).optional().default(Vl.window_seconds),show_recordings:yi.boolean().optional().default(Vl.show_recordings),style:yi.enum(["stack","ribbon"]).optional().default(Vl.style),pan_mode:Ul.optional().default(Vl.pan_mode),format:Hl.optional().default(Vl.format)}),Wl={...Vl,mode:"none",style:"ribbon"},Zl=ql.extend({mode:yi.enum(["none","above","below"]).default(Wl.mode),style:ql.shape.style.default(Wl.style)}),Kl={...Vl,controls:{thumbnails:Pl}},Yl=ql.extend({controls:yi.object({thumbnails:Fl.default(Kl.controls.thumbnails)}).default(Kl.controls)}).default(Kl),Ql=yi.object({style:yi.enum(["none","chevrons","icons","thumbnails"]),size:yi.number().min(20)}),Gl=yi.enum(["none","slide"]),Xl={always_connected:!1,disconnect_seconds:90,mute_after_microphone_mute_seconds:60},Jl=yi.object({always_connected:yi.boolean().default(Xl.always_connected),disconnect_seconds:yi.number().min(0).default(Xl.disconnect_seconds),mute_after_microphone_mute_seconds:yi.number().min(0).default(Xl.mute_after_microphone_mute_seconds)}).default(Xl),eu=yi.object({url:yi.string().transform((e=>e.replace(/\/+$/,""))).optional(),host:yi.string().optional(),modes:yi.enum(["webrtc","mse","mp4","mjpeg"]).array().optional(),stream:yi.string().optional()}),tu=yi.object({entity:yi.string().optional(),url:yi.string().optional()}).passthrough(),nu=yi.object({options:yi.object({audio:yi.boolean().optional(),video:yi.boolean().optional(),pauseWhenHidden:yi.boolean().optional(),disableGl:yi.boolean().optional(),disableWebAssembly:yi.boolean().optional(),preserveDrawingBuffer:yi.boolean().optional(),progressive:yi.boolean().optional(),throttled:yi.boolean().optional(),chunkSize:yi.number().optional(),maxAudioLag:yi.number().optional(),videoBufferSize:yi.number().optional(),audioBufferSize:yi.number().optional()}).optional()}),iu={...Pl,media_type:"events",events_media_type:"all"},au={auto_play:[...Xo],auto_pause:[],auto_mute:[...ec],auto_unmute:["microphone"],preload:!1,lazy_load:!0,lazy_unload:[],draggable:!0,zoomable:!0,transition_effect:"slide",show_image_during_load:!0,mode:"single",controls:{builtin:!0,next_previous:{size:48,style:"chevrons"},ptz:$l,thumbnails:iu,timeline:Wl},microphone:{...Xl}},ru=Fl.extend({media_type:yi.enum(["events","recordings"]).default(au.controls.thumbnails.media_type),events_media_type:Bl.default(au.controls.thumbnails.events_media_type)}),su=yi.object({auto_pause:yi.enum(Go).array().default(au.auto_pause),auto_play:yi.enum(Xo).array().default(au.auto_play),auto_mute:yi.enum(ec).array().default(au.auto_mute),auto_unmute:yi.enum(Jo).array().default(au.auto_unmute),controls:yi.object({builtin:yi.boolean().default(au.controls.builtin),next_previous:Ql.extend({style:yi.enum(["none","chevrons","icons"]).default(au.controls.next_previous.style),size:Ql.shape.size.default(au.controls.next_previous.size)}).default(au.controls.next_previous),ptz:Ol.default(au.controls.ptz),thumbnails:ru.default(au.controls.thumbnails),timeline:Zl.default(au.controls.timeline)}).default(au.controls),display:lc,draggable:yi.boolean().default(au.draggable),lazy_load:yi.boolean().default(au.lazy_load),lazy_unload:yi.enum(Go).array().default(au.lazy_unload),microphone:Jl.default(au.microphone),preload:yi.boolean().default(au.preload),show_image_during_load:yi.boolean().default(au.show_image_during_load),transition_effect:Gl.default(au.transition_effect),zoomable:yi.boolean().default(au.zoomable)}).merge(Nc).default(au),ou=yi.object({method:yi.enum(["standard","dashboard"]).default("standard").optional(),dashboard:yi.object({dashboard_path:yi.string().optional(),view_path:yi.string().optional()}).optional()}),cu={dependencies:{all_cameras:!1,cameras:[]},engine:"auto",frigate:{client_id:"frigate"},live_provider:"auto",motioneye:{images:{directory_pattern:"%Y-%m-%d",file_pattern:"%H-%M-%S"},movies:{directory_pattern:"%Y-%m-%d",file_pattern:"%H-%M-%S"}},reolink:{media_resolution:"low"},ptz:Sl,triggers:{motion:!1,occupancy:!1,events:[...nc],entities:[]},proxy:{media:"auto",dynamic:!0,ssl_verification:"auto",ssl_ciphers:"auto"},always_error_if_entity_unavailable:!1},lu=yi.object({media:yi.boolean().or(yi.literal("auto")).default(cu.proxy.media),dynamic:yi.boolean().default(cu.proxy.dynamic),ssl_verification:yi.boolean().or(yi.literal("auto")).default(cu.proxy.ssl_verification),ssl_ciphers:yi.enum(["default","insecure","intermediate","modern"]).or(yi.literal("auto")).default(cu.proxy.ssl_ciphers)}),uu=yi.object({camera_entity:yi.string().optional(),icon:yi.string().optional(),title:yi.string().optional(),capabilities:yi.object({disable:yi.enum(jo).array().optional(),disable_except:yi.enum(jo).array().optional()}).optional(),id:yi.string().optional(),dependencies:yi.object({all_cameras:yi.boolean().default(cu.dependencies.all_cameras),cameras:yi.string().array().default(cu.dependencies.cameras)}).default(cu.dependencies),triggers:yi.object({motion:yi.boolean().default(cu.triggers.motion),occupancy:yi.boolean().default(cu.triggers.occupancy),entities:yi.string().array().default(cu.triggers.entities),events:yi.enum(nc).array().default(cu.triggers.events)}).default(cu.triggers),engine:yi.enum(["auto","frigate","generic","motioneye","reolink"]).default("auto"),frigate:yi.object({url:yi.string().optional(),client_id:yi.string().default(cu.frigate.client_id),camera_name:yi.string().optional(),labels:yi.string().array().optional(),zones:yi.string().array().optional()}).default(cu.frigate),motioneye:yi.object({url:yi.string().optional(),images:yi.object({directory_pattern:yi.string().includes("%").default(cu.motioneye.images.directory_pattern),file_pattern:yi.string().includes("%").default(cu.motioneye.images.file_pattern)}).default(cu.motioneye.images),movies:yi.object({directory_pattern:yi.string().includes("%").default(cu.motioneye.movies.directory_pattern),file_pattern:yi.string().includes("%").default(cu.motioneye.movies.file_pattern)}).default(cu.motioneye.movies)}).default(cu.motioneye),reolink:yi.object({url:yi.string().optional(),media_resolution:yi.enum(["high","low"]).default(cu.reolink.media_resolution)}).default(cu.reolink),live_provider:yi.enum(["auto","image","ha","jsmpeg","go2rtc","webrtc-card"]).default(cu.live_provider),go2rtc:eu.optional(),image:Ll.optional().default(Il),jsmpeg:nu.optional(),webrtc_card:tu.optional(),cast:ou.optional(),ptz:Tl.default(cu.ptz),dimensions:yi.object({aspect_ratio:El.optional(),layout:Ml.optional()}).optional(),proxy:lu.default(cu.proxy),always_error_if_entity_unavailable:yi.boolean().default(cu.always_error_if_entity_unavailable)}).default(cu),du=uu.array().min(1),hu={default:Qo,camera_select:"current",interaction_seconds:300,default_reset:{every_seconds:0,after_interaction:!1,entities:[],interaction_mode:"inactive"},default_cycle_camera:!1,dim:!1,theme:{themes:["traditional"]},triggers:{show_trigger_status:!1,filter_selected_camera:!0,actions:{trigger:"update",untrigger:"none"},untrigger_seconds:0},keyboard_shortcuts:Vo},pu=yi.enum(["all","inactive","active"]).default("inactive"),mu=yi.object({actions:yi.object({interaction_mode:pu,trigger:yi.enum(["default","live","media","none","update"]).default(hu.triggers.actions.trigger),untrigger:yi.enum(["default","none"]).default(hu.triggers.actions.untrigger)}).default(hu.triggers.actions),filter_selected_camera:yi.boolean().default(hu.triggers.filter_selected_camera),show_trigger_status:yi.boolean().default(hu.triggers.show_trigger_status),untrigger_seconds:yi.number().default(hu.triggers.untrigger_seconds)}),fu=yi.enum(["ha","dark","light","traditional"]),gu=yi.object({themes:fu.array().default(hu.theme.themes),overrides:yi.record(yi.string()).optional()}),vu=yi.object({default:yi.enum(Yo).default(hu.default),camera_select:yi.enum([...Yo,"current"]).default(hu.camera_select),interaction_seconds:yi.number().default(hu.interaction_seconds),default_cycle_camera:yi.boolean().default(hu.default_cycle_camera),default_reset:yi.object({after_interaction:yi.boolean().default(hu.default_reset.after_interaction),every_seconds:yi.number().default(hu.default_reset.every_seconds),entities:yi.string().array().default(hu.default_reset.entities),interaction_mode:pu.default(hu.default_reset.interaction_mode)}).default(hu.default_reset),render_entities:yi.string().array().optional(),theme:gu.default(hu.theme),dim:yi.boolean().default(hu.dim),triggers:mu.default(hu.triggers),keyboard_shortcuts:Uo.default(hu.keyboard_shortcuts)}).merge(Nc).default(hu),_u=["left","right","top","bottom"],yu=_u,bu={priority:50,enabled:!0},wu={priority:50,enabled:!1},xu={alignment:"left",button_size:40,buttons:{camera_ui:bu,cameras:bu,clips:bu,ptz_home:wu,display_mode:bu,download:bu,expand:wu,iris:bu,fullscreen:bu,image:wu,live:bu,media_player:bu,microphone:{...wu,type:"momentary"},mute:wu,play:wu,ptz_controls:wu,recordings:wu,screenshot:wu,snapshots:bu,substreams:bu,timeline:bu},position:"top",style:"hidden"},ku=Jc.extend({enabled:Jc.shape.enabled.default(bu.enabled),priority:Jc.shape.priority.default(bu.priority)}),Cu=Jc.extend({enabled:Jc.shape.enabled.default(wu.enabled),priority:Jc.shape.priority.default(wu.priority)}),Mu=yi.object({style:yi.enum(["none","hidden","overlay","hover","hover-card","outside"]).default(xu.style),position:yi.enum(_u).default(xu.position),alignment:yi.enum(yu).default(xu.alignment),buttons:yi.object({camera_ui:ku.default(xu.buttons.camera_ui),cameras:ku.default(xu.buttons.cameras),clips:ku.default(xu.buttons.clips),ptz_home:Cu.default(xu.buttons.ptz_home),display_mode:ku.default(xu.buttons.display_mode),download:ku.default(xu.buttons.download),expand:Cu.default(xu.buttons.expand),iris:ku.default(xu.buttons.iris),fullscreen:ku.default(xu.buttons.fullscreen),image:Cu.default(xu.buttons.image),live:ku.default(xu.buttons.live),media_player:ku.default(xu.buttons.media_player),microphone:Cu.extend({type:yi.enum(["momentary","toggle"]).default(xu.buttons.microphone.type)}).default(xu.buttons.microphone),mute:Cu.default(xu.buttons.mute),play:Cu.default(xu.buttons.play),ptz_controls:Cu.default(xu.buttons.ptz_controls),recordings:Cu.default(xu.buttons.recordings),screenshot:Cu.default(xu.buttons.screenshot),snapshots:ku.default(xu.buttons.snapshots),substreams:ku.default(xu.buttons.substreams),timeline:ku.default(xu.buttons.timeline)}).default(xu.buttons),button_size:yi.number().min(20).default(xu.button_size)}).default(xu),Eu={priority:50,enabled:!0},Su={height:40,items:{engine:Eu,resolution:Eu,technology:Eu,title:Eu},position:"bottom",style:"popup",popup_seconds:3},Au=yi.object({position:yi.enum(["top","bottom"]).default(Su.position),style:yi.enum(["none","overlay","hover","hover-card","outside","popup"]).default(Su.style),popup_seconds:yi.number().min(0).max(60).default(Su.popup_seconds),height:yi.number().min(20).default(Su.height),items:yi.object({engine:rl.default(Su.items.engine),technology:rl.default(Su.items.technology),resolution:rl.default(Su.items.resolution),title:rl.default(Su.items.title)}).default(Su.items)}).default(Su),Tu={auto_play:[...Xo],auto_pause:[...Go],auto_mute:[...Go],auto_unmute:[],lazy_load:!0,draggable:!0,zoomable:!0,transition_effect:"slide",snapshot_click_plays_clip:!0,display_mode:"single",controls:{builtin:!0,next_previous:{size:48,style:"thumbnails"},thumbnails:Pl,timeline:Wl,ptz:{...$l,mode:"off"}}},$u=Ql.extend({style:yi.enum(["none","thumbnails","chevrons"]).default(Tu.controls.next_previous.style),size:Ql.shape.size.default(Tu.controls.next_previous.size)}),Ou=yi.object({auto_play:yi.enum(Xo).array().default(Tu.auto_play),auto_pause:yi.enum(Go).array().default(Tu.auto_pause),auto_mute:yi.enum(Go).array().default(Tu.auto_mute),auto_unmute:yi.enum(Xo).array().default(Tu.auto_unmute),lazy_load:yi.boolean().default(Tu.lazy_load),draggable:yi.boolean().default(Tu.draggable),zoomable:yi.boolean().default(Tu.zoomable),transition_effect:Gl.default(Tu.transition_effect),snapshot_click_plays_clip:yi.boolean().default(Tu.snapshot_click_plays_clip),display:lc,controls:yi.object({builtin:yi.boolean().default(Tu.controls.builtin),next_previous:$u.default(Tu.controls.next_previous),ptz:Ol.extend({mode:yi.enum(["off","on"]).default(Tu.controls.ptz.mode)}).default(Tu.controls.ptz),thumbnails:Fl.default(Tu.controls.thumbnails),timeline:Zl.default(Tu.controls.timeline)}).default(Tu.controls)}).merge(Nc).default(Tu),Iu={...Pl,show_details:!1},Lu={controls:{thumbnails:Iu,filter:{mode:"right"}}},ju=Fl.extend({show_details:yi.boolean().default(Iu.show_details)}),zu=yi.object({controls:yi.object({thumbnails:ju.default(Lu.controls.thumbnails),filter:yi.object({mode:yi.enum(["none","left","right"]).default(Lu.controls.filter.mode)}).default(Lu.controls.filter)}).default(Lu.controls)}).merge(Nc).default(Lu),Du={aspect_ratio_mode:"dynamic",aspect_ratio:[16,9],height:"auto"},Ru=yi.object({aspect_ratio_mode:yi.enum(["dynamic","static","unconstrained"]).default(Du.aspect_ratio_mode),aspect_ratio:El.default(Du.aspect_ratio),height:yi.string().default(Du.height)}).default(Du),Nu=yi.object({conditions:xl.array(),merge:yi.object({}).passthrough().optional(),set:yi.object({}).passthrough().optional(),delete:yi.string().array().optional()}).array().optional(),Pu=Dc.array(),Fu=yi.object({conditions:xl.array(),actions:Pu.optional(),actions_not:Pu.optional()}).refine((e=>e.actions?.length||e.actions_not?.length),"Automations must include at least one action").array(),Bu={features:{animated_progress_indicator:!0,card_loading_indicator:!0,media_chunk_size:50},style:{border_radius:!0,box_shadow:!0}},Vu=yi.object({features:yi.object({animated_progress_indicator:yi.boolean().default(Bu.features.animated_progress_indicator),card_loading_indicator:yi.boolean().default(Bu.features.card_loading_indicator),media_chunk_size:yi.number().min(0).max(1e3).default(Bu.features.media_chunk_size),max_simultaneous_engine_requests:yi.number().min(1).optional()}).default(Bu.features),style:yi.object({border_radius:yi.boolean().default(Bu.style.border_radius),box_shadow:yi.boolean().default(Bu.style.box_shadow)}).default(Bu.style)}).default(Bu),Uu={logging:!1},Hu=yi.object({logging:yi.boolean().default(Uu.logging)}).default(Uu),qu=yi.enum(["casting","low-performance","scrubbing"]).array().optional(),Wu=yi.object({cameras:Ro(du),cameras_global:uu,view:vu,menu:Mu,status_bar:Au,live:su,media_gallery:zu,media_viewer:Ou,image:jl,elements:Cl,dimensions:Ru,timeline:Yl,performance:Vu,debug:Hu,automations:Fu.optional(),profiles:qu,overrides:Nu,card_mod:yi.unknown(),card_id:yi.string().regex(ic).optional(),type:yi.string()}),Zu={cameras:cu,view:hu,menu:xu,status_bar:Su,live:au,media_gallery:Lu,media_viewer:Tu,image:Il,timeline:Kl,performance:Bu,debug:Uu};function Ku(e){const t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):"number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?new Date(e):new Date(NaN)}function Yu(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function Qu(e,t){const n=Ku(e);return isNaN(t)?Yu(e,NaN):t?(n.setDate(n.getDate()+t),n):n}function Gu(e,t){const n=Ku(e);if(isNaN(t))return Yu(e,NaN);if(!t)return n;const i=n.getDate(),a=Yu(e,n.getTime());a.setMonth(n.getMonth()+t+1,0);return i>=a.getDate()?a:(n.setFullYear(a.getFullYear(),a.getMonth(),i),n)}function Xu(e,t){const{years:n=0,months:i=0,weeks:a=0,days:r=0,hours:s=0,minutes:o=0,seconds:c=0}=t,l=Ku(e),u=i||n?Gu(l,i+12*n):l,d=1e3*(c+60*(o+60*s));return Yu(e,(r||a?Qu(u,r+7*a):u).getTime()+d)}const Ju=6048e5,ed=864e5,td=6e4,nd=36e5,id=1e3;let ad={};function rd(){return ad}function sd(e,t){const n=rd(),i=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Ku(e),r=a.getDay(),s=(r<i?7:0)+r-i;return a.setDate(a.getDate()-s),a.setHours(0,0,0,0),a}function od(e){return sd(e,{weekStartsOn:1})}function cd(e){const t=Ku(e),n=t.getFullYear(),i=Yu(e,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const a=od(i),r=Yu(e,0);r.setFullYear(n,0,4),r.setHours(0,0,0,0);const s=od(r);return t.getTime()>=a.getTime()?n+1:t.getTime()>=s.getTime()?n:n-1}function ld(e){const t=Ku(e);return t.setHours(0,0,0,0),t}function ud(e){const t=Ku(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function dd(e){if(!(t=e,t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)||"number"==typeof e))return!1;var t;const n=Ku(e);return!isNaN(Number(n))}function hd(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return 0===n?0:n}}function pd(e,t){return+Ku(e)-+Ku(t)}function md(e,t,n){const i=pd(e,t)/1e3;return hd(n?.roundingMethod)(i)}const fd={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function gd(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const vd={date:gd({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:gd({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:gd({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},_d={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function yd(e){return(t,n)=>{let i;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,a=n?.width?String(n.width):t;i=e.formattingValues[a]||e.formattingValues[t]}else{const t=e.defaultWidth,a=n?.width?String(n.width):e.defaultWidth;i=e.values[a]||e.values[t]}return i[e.argumentCallback?e.argumentCallback(t):t]}}function bd(e){return(t,n={})=>{const i=n.width,a=i&&e.matchPatterns[i]||e.matchPatterns[e.defaultMatchWidth],r=t.match(a);if(!r)return null;const s=r[0],o=i&&e.parsePatterns[i]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n;return}(o,(e=>e.test(s))):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n;return}(o,(e=>e.test(s)));let l;l=e.valueCallback?e.valueCallback(c):c,l=n.valueCallback?n.valueCallback(l):l;return{value:l,rest:t.slice(s.length)}}}var wd;const xd={code:"en-US",formatDistance:(e,t,n)=>{let i;const a=fd[e];return i="string"==typeof a?a:1===t?a.one:a.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i},formatLong:vd,formatRelative:(e,t,n,i)=>_d[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:yd({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:yd({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:yd({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:yd({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:yd({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(wd={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(wd.matchPattern);if(!n)return null;const i=n[0],a=e.match(wd.parsePattern);if(!a)return null;let r=wd.valueCallback?wd.valueCallback(a[0]):a[0];return r=t.valueCallback?t.valueCallback(r):r,{value:r,rest:e.slice(i.length)}}),era:bd({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:bd({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:bd({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:bd({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:bd({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function kd(e){const t=Ku(e),n=function(e,t){const n=ld(e),i=ld(t),a=+n-ud(n),r=+i-ud(i);return Math.round((a-r)/ed)}(t,function(e){const t=Ku(e),n=Yu(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}(t));return n+1}function Cd(e){const t=Ku(e),n=+od(t)-+function(e){const t=cd(e),n=Yu(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),od(n)}(t);return Math.round(n/Ju)+1}function Md(e,t){const n=Ku(e),i=n.getFullYear(),a=rd(),r=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,s=Yu(e,0);s.setFullYear(i+1,0,r),s.setHours(0,0,0,0);const o=sd(s,t),c=Yu(e,0);c.setFullYear(i,0,r),c.setHours(0,0,0,0);const l=sd(c,t);return n.getTime()>=o.getTime()?i+1:n.getTime()>=l.getTime()?i:i-1}function Ed(e,t){const n=Ku(e),i=+sd(n,t)-+function(e,t){const n=rd(),i=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,a=Md(e,t),r=Yu(e,0);return r.setFullYear(a,0,i),r.setHours(0,0,0,0),sd(r,t)}(n,t);return Math.round(i/Ju)+1}function Sd(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Ad={y(e,t){const n=e.getFullYear(),i=n>0?n:1-n;return Sd("yy"===t?i%100:i,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):Sd(n+1,2)},d:(e,t)=>Sd(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>Sd(e.getHours()%12||12,t.length),H:(e,t)=>Sd(e.getHours(),t.length),m:(e,t)=>Sd(e.getMinutes(),t.length),s:(e,t)=>Sd(e.getSeconds(),t.length),S(e,t){const n=t.length,i=e.getMilliseconds();return Sd(Math.trunc(i*Math.pow(10,n-3)),t.length)}},Td="midnight",$d="noon",Od="morning",Id="afternoon",Ld="evening",jd="night",zd={G:function(e,t,n){const i=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(i,{width:"abbreviated"});case"GGGGG":return n.era(i,{width:"narrow"});default:return n.era(i,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),i=t>0?t:1-t;return n.ordinalNumber(i,{unit:"year"})}return Ad.y(e,t)},Y:function(e,t,n,i){const a=Md(e,i),r=a>0?a:1-a;if("YY"===t){return Sd(r%100,2)}return"Yo"===t?n.ordinalNumber(r,{unit:"year"}):Sd(r,t.length)},R:function(e,t){return Sd(cd(e),t.length)},u:function(e,t){return Sd(e.getFullYear(),t.length)},Q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(i);case"QQ":return Sd(i,2);case"Qo":return n.ordinalNumber(i,{unit:"quarter"});case"QQQ":return n.quarter(i,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(i,{width:"narrow",context:"formatting"});default:return n.quarter(i,{width:"wide",context:"formatting"})}},q:function(e,t,n){const i=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(i);case"qq":return Sd(i,2);case"qo":return n.ordinalNumber(i,{unit:"quarter"});case"qqq":return n.quarter(i,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(i,{width:"narrow",context:"standalone"});default:return n.quarter(i,{width:"wide",context:"standalone"})}},M:function(e,t,n){const i=e.getMonth();switch(t){case"M":case"MM":return Ad.M(e,t);case"Mo":return n.ordinalNumber(i+1,{unit:"month"});case"MMM":return n.month(i,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(i,{width:"narrow",context:"formatting"});default:return n.month(i,{width:"wide",context:"formatting"})}},L:function(e,t,n){const i=e.getMonth();switch(t){case"L":return String(i+1);case"LL":return Sd(i+1,2);case"Lo":return n.ordinalNumber(i+1,{unit:"month"});case"LLL":return n.month(i,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(i,{width:"narrow",context:"standalone"});default:return n.month(i,{width:"wide",context:"standalone"})}},w:function(e,t,n,i){const a=Ed(e,i);return"wo"===t?n.ordinalNumber(a,{unit:"week"}):Sd(a,t.length)},I:function(e,t,n){const i=Cd(e);return"Io"===t?n.ordinalNumber(i,{unit:"week"}):Sd(i,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):Ad.d(e,t)},D:function(e,t,n){const i=kd(e);return"Do"===t?n.ordinalNumber(i,{unit:"dayOfYear"}):Sd(i,t.length)},E:function(e,t,n){const i=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(i,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(i,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},e:function(e,t,n,i){const a=e.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(t){case"e":return String(r);case"ee":return Sd(r,2);case"eo":return n.ordinalNumber(r,{unit:"day"});case"eee":return n.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},c:function(e,t,n,i){const a=e.getDay(),r=(a-i.weekStartsOn+8)%7||7;switch(t){case"c":return String(r);case"cc":return Sd(r,t.length);case"co":return n.ordinalNumber(r,{unit:"day"});case"ccc":return n.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(a,{width:"narrow",context:"standalone"});case"cccccc":return n.day(a,{width:"short",context:"standalone"});default:return n.day(a,{width:"wide",context:"standalone"})}},i:function(e,t,n){const i=e.getDay(),a=0===i?7:i;switch(t){case"i":return String(a);case"ii":return Sd(a,t.length);case"io":return n.ordinalNumber(a,{unit:"day"});case"iii":return n.day(i,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(i,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(i,{width:"short",context:"formatting"});default:return n.day(i,{width:"wide",context:"formatting"})}},a:function(e,t,n){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(i,{width:"narrow",context:"formatting"});default:return n.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,n){const i=e.getHours();let a;switch(a=12===i?$d:0===i?Td:i/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(e,t,n){const i=e.getHours();let a;switch(a=i>=17?Ld:i>=12?Id:i>=4?Od:jd,t){case"B":case"BB":case"BBB":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return Ad.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):Ad.H(e,t)},K:function(e,t,n){const i=e.getHours()%12;return"Ko"===t?n.ordinalNumber(i,{unit:"hour"}):Sd(i,t.length)},k:function(e,t,n){let i=e.getHours();return 0===i&&(i=24),"ko"===t?n.ordinalNumber(i,{unit:"hour"}):Sd(i,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ad.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Ad.s(e,t)},S:function(e,t){return Ad.S(e,t)},X:function(e,t,n){const i=e.getTimezoneOffset();if(0===i)return"Z";switch(t){case"X":return Rd(i);case"XXXX":case"XX":return Nd(i);default:return Nd(i,":")}},x:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"x":return Rd(i);case"xxxx":case"xx":return Nd(i);default:return Nd(i,":")}},O:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Dd(i,":");default:return"GMT"+Nd(i,":")}},z:function(e,t,n){const i=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Dd(i,":");default:return"GMT"+Nd(i,":")}},t:function(e,t,n){return Sd(Math.trunc(e.getTime()/1e3),t.length)},T:function(e,t,n){return Sd(e.getTime(),t.length)}};function Dd(e,t=""){const n=e>0?"-":"+",i=Math.abs(e),a=Math.trunc(i/60),r=i%60;return 0===r?n+String(a):n+String(a)+t+Sd(r,2)}function Rd(e,t){if(e%60==0){return(e>0?"-":"+")+Sd(Math.abs(e)/60,2)}return Nd(e,t)}function Nd(e,t=""){const n=e>0?"-":"+",i=Math.abs(e);return n+Sd(Math.trunc(i/60),2)+t+Sd(i%60,2)}const Pd=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Fd=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Bd={p:Fd,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],i=n[1],a=n[2];if(!a)return Pd(e,t);let r;switch(i){case"P":r=t.dateTime({width:"short"});break;case"PP":r=t.dateTime({width:"medium"});break;case"PPP":r=t.dateTime({width:"long"});break;default:r=t.dateTime({width:"full"})}return r.replace("{{date}}",Pd(i,t)).replace("{{time}}",Fd(a,t))}},Vd=/^D+$/,Ud=/^Y+$/,Hd=["D","DD","YY","YYYY"];function qd(e){return Vd.test(e)}function Wd(e){return Ud.test(e)}function Zd(e,t,n){const i=function(e,t,n){const i="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${i} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(i),Hd.includes(e))throw new RangeError(i)}const Kd=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Yd=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Qd=/^'([^]*?)'?$/,Gd=/''/g,Xd=/[a-zA-Z]/;function Jd(e,t,n){const i=rd(),a=n?.locale??i.locale??xd,r=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,s=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??i.weekStartsOn??i.locale?.options?.weekStartsOn??0,o=Ku(e);if(!dd(o))throw new RangeError("Invalid time value");let c=t.match(Yd).map((e=>{const t=e[0];if("p"===t||"P"===t){return(0,Bd[t])(e,a.formatLong)}return e})).join("").match(Kd).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:eh(e)};if(zd[t])return{isToken:!0,value:e};if(t.match(Xd))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));a.localize.preprocessor&&(c=a.localize.preprocessor(o,c));const l={firstWeekContainsDate:r,weekStartsOn:s,locale:a};return c.map((i=>{if(!i.isToken)return i.value;const r=i.value;(!n?.useAdditionalWeekYearTokens&&Wd(r)||!n?.useAdditionalDayOfYearTokens&&qd(r))&&Zd(r,t,String(e));return(0,zd[r[0]])(o,r,a.localize,l)})).join("")}function eh(e){const t=e.match(Qd);return t?t[1].replace(Gd,"'"):e}function th(e,t){const{years:n=0,months:i=0,weeks:a=0,days:r=0,hours:s=0,minutes:o=0,seconds:c=0}=t,l=function(e,t){return Gu(e,-t)}(e,i+12*n),u=function(e,t){return Qu(e,-t)}(l,r+7*a),d=1e3*(c+60*(o+60*s));return Yu(e,u.getTime()-d)}function nh(e,t){return e===t||e!=e&&t!=t}function ih(e,t){for(var n=e.length;n--;)if(nh(e[n][0],t))return n;return-1}var ah=Array.prototype.splice;function rh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}rh.prototype.clear=function(){this.__data__=[],this.size=0},rh.prototype.delete=function(e){var t=this.__data__,n=ih(t,e);return!(n<0)&&(n==t.length-1?t.pop():ah.call(t,n,1),--this.size,!0)},rh.prototype.get=function(e){var t=this.__data__,n=ih(t,e);return n<0?void 0:t[n][1]},rh.prototype.has=function(e){return ih(this.__data__,e)>-1},rh.prototype.set=function(e,t){var n=this.__data__,i=ih(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this};var sh="object"==typeof global&&global&&global.Object===Object&&global,oh="object"==typeof self&&self&&self.Object===Object&&self,ch=sh||oh||Function("return this")(),lh=ch.Symbol,uh=Object.prototype,dh=uh.hasOwnProperty,hh=uh.toString,ph=lh?lh.toStringTag:void 0;var mh=Object.prototype.toString;var fh="[object Null]",gh="[object Undefined]",vh=lh?lh.toStringTag:void 0;function _h(e){return null==e?void 0===e?gh:fh:vh&&vh in Object(e)?function(e){var t=dh.call(e,ph),n=e[ph];try{e[ph]=void 0;var i=!0}catch(e){}var a=hh.call(e);return i&&(t?e[ph]=n:delete e[ph]),a}(e):function(e){return mh.call(e)}(e)}function yh(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var bh="[object AsyncFunction]",wh="[object Function]",xh="[object GeneratorFunction]",kh="[object Proxy]";function Ch(e){if(!yh(e))return!1;var t=_h(e);return t==wh||t==xh||t==bh||t==kh}var Mh,Eh=ch["__core-js_shared__"],Sh=(Mh=/[^.]+$/.exec(Eh&&Eh.keys&&Eh.keys.IE_PROTO||""))?"Symbol(src)_1."+Mh:"";var Ah=Function.prototype.toString;function Th(e){if(null!=e){try{return Ah.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var $h=/^\[object .+?Constructor\]$/,Oh=Function.prototype,Ih=Object.prototype,Lh=Oh.toString,jh=Ih.hasOwnProperty,zh=RegExp("^"+Lh.call(jh).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Dh(e){return!(!yh(e)||(t=e,Sh&&Sh in t))&&(Ch(e)?zh:$h).test(Th(e));var t}function Rh(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return Dh(n)?n:void 0}var Nh=Rh(ch,"Map"),Ph=Rh(Object,"create");var Fh=Object.prototype.hasOwnProperty;var Bh=Object.prototype.hasOwnProperty;function Vh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function Uh(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Hh(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Vh.prototype.clear=function(){this.__data__=Ph?Ph(null):{},this.size=0},Vh.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Vh.prototype.get=function(e){var t=this.__data__;if(Ph){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Fh.call(t,e)?t[e]:void 0},Vh.prototype.has=function(e){var t=this.__data__;return Ph?void 0!==t[e]:Bh.call(t,e)},Vh.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Ph&&void 0===t?"__lodash_hash_undefined__":t,this},Hh.prototype.clear=function(){this.size=0,this.__data__={hash:new Vh,map:new(Nh||rh),string:new Vh}},Hh.prototype.delete=function(e){var t=Uh(this,e).delete(e);return this.size-=t?1:0,t},Hh.prototype.get=function(e){return Uh(this,e).get(e)},Hh.prototype.has=function(e){return Uh(this,e).has(e)},Hh.prototype.set=function(e,t){var n=Uh(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this};function qh(e){var t=this.__data__=new rh(e);this.size=t.size}qh.prototype.clear=function(){this.__data__=new rh,this.size=0},qh.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},qh.prototype.get=function(e){return this.__data__.get(e)},qh.prototype.has=function(e){return this.__data__.has(e)},qh.prototype.set=function(e,t){var n=this.__data__;if(n instanceof rh){var i=n.__data__;if(!Nh||i.length<199)return i.push([e,t]),this.size=++n.size,this;n=this.__data__=new Hh(i)}return n.set(e,t),this.size=n.size,this};function Wh(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Hh;++t<n;)this.add(e[t])}function Zh(e,t){for(var n=-1,i=null==e?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function Kh(e,t){return e.has(t)}Wh.prototype.add=Wh.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},Wh.prototype.has=function(e){return this.__data__.has(e)};var Yh=1,Qh=2;function Gh(e,t,n,i,a,r){var s=n&Yh,o=e.length,c=t.length;if(o!=c&&!(s&&c>o))return!1;var l=r.get(e),u=r.get(t);if(l&&u)return l==t&&u==e;var d=-1,h=!0,p=n&Qh?new Wh:void 0;for(r.set(e,t),r.set(t,e);++d<o;){var m=e[d],f=t[d];if(i)var g=s?i(f,m,d,t,e,r):i(m,f,d,e,t,r);if(void 0!==g){if(g)continue;h=!1;break}if(p){if(!Zh(t,(function(e,t){if(!Kh(p,t)&&(m===e||a(m,e,n,i,r)))return p.push(t)}))){h=!1;break}}else if(m!==f&&!a(m,f,n,i,r)){h=!1;break}}return r.delete(e),r.delete(t),h}var Xh=ch.Uint8Array;function Jh(e){var t=-1,n=Array(e.size);return e.forEach((function(e,i){n[++t]=[i,e]})),n}function ep(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}var tp=1,np=2,ip="[object Boolean]",ap="[object Date]",rp="[object Error]",sp="[object Map]",op="[object Number]",cp="[object RegExp]",lp="[object Set]",up="[object String]",dp="[object Symbol]",hp="[object ArrayBuffer]",pp="[object DataView]",mp=lh?lh.prototype:void 0,fp=mp?mp.valueOf:void 0;function gp(e,t){for(var n=-1,i=t.length,a=e.length;++n<i;)e[a+n]=t[n];return e}var vp=Array.isArray;function _p(e,t,n){var i=t(e);return vp(e)?i:gp(i,n(e))}function yp(){return[]}var bp=Object.prototype.propertyIsEnumerable,wp=Object.getOwnPropertySymbols,xp=wp?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,i=null==e?0:e.length,a=0,r=[];++n<i;){var s=e[n];t(s,n,e)&&(r[a++]=s)}return r}(wp(e),(function(t){return bp.call(e,t)})))}:yp;function kp(e){return null!=e&&"object"==typeof e}function Cp(e){return kp(e)&&"[object Arguments]"==_h(e)}var Mp=Object.prototype,Ep=Mp.hasOwnProperty,Sp=Mp.propertyIsEnumerable,Ap=Cp(function(){return arguments}())?Cp:function(e){return kp(e)&&Ep.call(e,"callee")&&!Sp.call(e,"callee")};var Tp="object"==typeof exports&&exports&&!exports.nodeType&&exports,$p=Tp&&"object"==typeof module&&module&&!module.nodeType&&module,Op=$p&&$p.exports===Tp?ch.Buffer:void 0,Ip=(Op?Op.isBuffer:void 0)||function(){return!1},Lp=9007199254740991,jp=/^(?:0|[1-9]\d*)$/;function zp(e,t){var n=typeof e;return!!(t=null==t?Lp:t)&&("number"==n||"symbol"!=n&&jp.test(e))&&e>-1&&e%1==0&&e<t}var Dp=9007199254740991;function Rp(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Dp}var Np={};function Pp(e){return function(t){return e(t)}}Np["[object Float32Array]"]=Np["[object Float64Array]"]=Np["[object Int8Array]"]=Np["[object Int16Array]"]=Np["[object Int32Array]"]=Np["[object Uint8Array]"]=Np["[object Uint8ClampedArray]"]=Np["[object Uint16Array]"]=Np["[object Uint32Array]"]=!0,Np["[object Arguments]"]=Np["[object Array]"]=Np["[object ArrayBuffer]"]=Np["[object Boolean]"]=Np["[object DataView]"]=Np["[object Date]"]=Np["[object Error]"]=Np["[object Function]"]=Np["[object Map]"]=Np["[object Number]"]=Np["[object Object]"]=Np["[object RegExp]"]=Np["[object Set]"]=Np["[object String]"]=Np["[object WeakMap]"]=!1;var Fp="object"==typeof exports&&exports&&!exports.nodeType&&exports,Bp=Fp&&"object"==typeof module&&module&&!module.nodeType&&module,Vp=Bp&&Bp.exports===Fp&&sh.process,Up=function(){try{var e=Bp&&Bp.require&&Bp.require("util").types;return e||Vp&&Vp.binding&&Vp.binding("util")}catch(e){}}(),Hp=Up,qp=Hp&&Hp.isTypedArray,Wp=qp?Pp(qp):function(e){return kp(e)&&Rp(e.length)&&!!Np[_h(e)]},Zp=Object.prototype.hasOwnProperty;function Kp(e,t){var n=vp(e),i=!n&&Ap(e),a=!n&&!i&&Ip(e),r=!n&&!i&&!a&&Wp(e),s=n||i||a||r,o=s?function(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}(e.length,String):[],c=o.length;for(var l in e)!t&&!Zp.call(e,l)||s&&("length"==l||a&&("offset"==l||"parent"==l)||r&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||zp(l,c))||o.push(l);return o}var Yp=Object.prototype;function Qp(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Yp)}function Gp(e,t){return function(n){return e(t(n))}}var Xp=Gp(Object.keys,Object),Jp=Object.prototype.hasOwnProperty;function em(e){return null!=e&&Rp(e.length)&&!Ch(e)}function tm(e){return em(e)?Kp(e):function(e){if(!Qp(e))return Xp(e);var t=[];for(var n in Object(e))Jp.call(e,n)&&"constructor"!=n&&t.push(n);return t}(e)}function nm(e){return _p(e,tm,xp)}var im=1,am=Object.prototype.hasOwnProperty;var rm=Rh(ch,"DataView"),sm=Rh(ch,"Promise"),om=Rh(ch,"Set"),cm=Rh(ch,"WeakMap"),lm="[object Map]",um="[object Promise]",dm="[object Set]",hm="[object WeakMap]",pm="[object DataView]",mm=Th(rm),fm=Th(Nh),gm=Th(sm),vm=Th(om),_m=Th(cm),ym=_h;(rm&&ym(new rm(new ArrayBuffer(1)))!=pm||Nh&&ym(new Nh)!=lm||sm&&ym(sm.resolve())!=um||om&&ym(new om)!=dm||cm&&ym(new cm)!=hm)&&(ym=function(e){var t=_h(e),n="[object Object]"==t?e.constructor:void 0,i=n?Th(n):"";if(i)switch(i){case mm:return pm;case fm:return lm;case gm:return um;case vm:return dm;case _m:return hm}return t});var bm=ym,wm=1,xm="[object Arguments]",km="[object Array]",Cm="[object Object]",Mm=Object.prototype.hasOwnProperty;function Em(e,t,n,i,a,r){var s=vp(e),o=vp(t),c=s?km:bm(e),l=o?km:bm(t),u=(c=c==xm?Cm:c)==Cm,d=(l=l==xm?Cm:l)==Cm,h=c==l;if(h&&Ip(e)){if(!Ip(t))return!1;s=!0,u=!1}if(h&&!u)return r||(r=new qh),s||Wp(e)?Gh(e,t,n,i,a,r):function(e,t,n,i,a,r,s){switch(n){case pp:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case hp:return!(e.byteLength!=t.byteLength||!r(new Xh(e),new Xh(t)));case ip:case ap:case op:return nh(+e,+t);case rp:return e.name==t.name&&e.message==t.message;case cp:case up:return e==t+"";case sp:var o=Jh;case lp:var c=i&tp;if(o||(o=ep),e.size!=t.size&&!c)return!1;var l=s.get(e);if(l)return l==t;i|=np,s.set(e,t);var u=Gh(o(e),o(t),i,a,r,s);return s.delete(e),u;case dp:if(fp)return fp.call(e)==fp.call(t)}return!1}(e,t,c,n,i,a,r);if(!(n&wm)){var p=u&&Mm.call(e,"__wrapped__"),m=d&&Mm.call(t,"__wrapped__");if(p||m){var f=p?e.value():e,g=m?t.value():t;return r||(r=new qh),a(f,g,n,i,r)}}return!!h&&(r||(r=new qh),function(e,t,n,i,a,r){var s=n&im,o=nm(e),c=o.length;if(c!=nm(t).length&&!s)return!1;for(var l=c;l--;){var u=o[l];if(!(s?u in t:am.call(t,u)))return!1}var d=r.get(e),h=r.get(t);if(d&&h)return d==t&&h==e;var p=!0;r.set(e,t),r.set(t,e);for(var m=s;++l<c;){var f=e[u=o[l]],g=t[u];if(i)var v=s?i(g,f,u,t,e,r):i(f,g,u,e,t,r);if(!(void 0===v?f===g||a(f,g,n,i,r):v)){p=!1;break}m||(m="constructor"==u)}if(p&&!m){var _=e.constructor,y=t.constructor;_==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof _&&_ instanceof _&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(e),r.delete(t),p}(e,t,n,i,a,r))}function Sm(e,t,n,i,a){return e===t||(null==e||null==t||!kp(e)&&!kp(t)?e!=e&&t!=t:Em(e,t,n,i,Sm,a))}var Am=function(){try{var e=Rh(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Tm=Am;function $m(e,t,n){"__proto__"==t&&Tm?Tm(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Om(e,t,n){(void 0!==n&&!nh(e[t],n)||void 0===n&&!(t in e))&&$m(e,t,n)}var Im,Lm=function(e,t,n){for(var i=-1,a=Object(e),r=n(e),s=r.length;s--;){var o=r[Im?s:++i];if(!1===t(a[o],o,a))break}return e},jm="object"==typeof exports&&exports&&!exports.nodeType&&exports,zm=jm&&"object"==typeof module&&module&&!module.nodeType&&module,Dm=zm&&zm.exports===jm?ch.Buffer:void 0,Rm=Dm?Dm.allocUnsafe:void 0;function Nm(e,t){if(t)return e.slice();var n=e.length,i=Rm?Rm(n):new e.constructor(n);return e.copy(i),i}function Pm(e){var t=new e.constructor(e.byteLength);return new Xh(t).set(new Xh(e)),t}function Fm(e,t){var n=t?Pm(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Bm(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}var Vm=Object.create,Um=function(){function e(){}return function(t){if(!yh(t))return{};if(Vm)return Vm(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}(),Hm=Gp(Object.getPrototypeOf,Object);function qm(e){return"function"!=typeof e.constructor||Qp(e)?{}:Um(Hm(e))}var Wm="[object Object]",Zm=Function.prototype,Km=Object.prototype,Ym=Zm.toString,Qm=Km.hasOwnProperty,Gm=Ym.call(Object);function Xm(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}var Jm=Object.prototype.hasOwnProperty;function ef(e,t,n){var i=e[t];Jm.call(e,t)&&nh(i,n)&&(void 0!==n||t in e)||$m(e,t,n)}function tf(e,t,n,i){var a=!n;n||(n={});for(var r=-1,s=t.length;++r<s;){var o=t[r],c=i?i(n[o],e[o],o,n,e):void 0;void 0===c&&(c=e[o]),a?$m(n,o,c):ef(n,o,c)}return n}var nf=Object.prototype.hasOwnProperty;function af(e){if(!yh(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Qp(e),n=[];for(var i in e)("constructor"!=i||!t&&nf.call(e,i))&&n.push(i);return n}function rf(e){return em(e)?Kp(e,!0):af(e)}function sf(e,t,n,i,a,r,s){var o=Xm(e,n),c=Xm(t,n),l=s.get(c);if(l)Om(e,n,l);else{var u,d=r?r(o,c,n+"",e,t,s):void 0,h=void 0===d;if(h){var p=vp(c),m=!p&&Ip(c),f=!p&&!m&&Wp(c);d=c,p||m||f?vp(o)?d=o:kp(u=o)&&em(u)?d=Bm(o):m?(h=!1,d=Nm(c,!0)):f?(h=!1,d=Fm(c,!0)):d=[]:function(e){if(!kp(e)||_h(e)!=Wm)return!1;var t=Hm(e);if(null===t)return!0;var n=Qm.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Ym.call(n)==Gm}(c)||Ap(c)?(d=o,Ap(o)?d=function(e){return tf(e,rf(e))}(o):yh(o)&&!Ch(o)||(d=qm(c))):h=!1}h&&(s.set(c,d),a(d,c,i,r,s),s.delete(c)),Om(e,n,d)}}function of(e,t,n,i,a){e!==t&&Lm(t,(function(r,s){if(a||(a=new qh),yh(r))sf(e,t,s,n,of,i,a);else{var o=i?i(Xm(e,s),r,s+"",e,t,a):void 0;void 0===o&&(o=r),Om(e,s,o)}}),rf)}function cf(e){return e}var lf=Math.max;var uf=Tm?function(e,t){return Tm(e,"toString",{configurable:!0,enumerable:!1,value:(n=t,function(){return n}),writable:!0});var n}:cf,df=uf,hf=Date.now;var pf,mf,ff,gf=(pf=df,mf=0,ff=0,function(){var e=hf(),t=16-(e-ff);if(ff=e,t>0){if(++mf>=800)return arguments[0]}else mf=0;return pf.apply(void 0,arguments)});function vf(e,t){return gf(function(e,t,n){return t=lf(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,r=lf(i.length-t,0),s=Array(r);++a<r;)s[a]=i[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=i[a];return o[t]=n(s),function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}(e,this,o)}}(e,t,cf),e+"")}function _f(e,t,n){if(!yh(n))return!1;var i=typeof t;return!!("number"==i?em(n)&&zp(t,n.length):"string"==i&&t in n)&&nh(n[t],e)}function yf(e){return vf((function(t,n){var i=-1,a=n.length,r=a>1?n[a-1]:void 0,s=a>2?n[2]:void 0;for(r=e.length>3&&"function"==typeof r?(a--,r):void 0,s&&_f(n[0],n[1],s)&&(r=a<3?void 0:r,a=1),t=Object(t);++i<a;){var o=n[i];o&&e(t,o,i,r)}return t}))}var bf=yf((function(e,t,n,i){of(e,t,n,i)})),wf=/\s/;var xf=/^\s+/;function kf(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&wf.test(e.charAt(t)););return t}(e)+1).replace(xf,""):e}var Cf="[object Symbol]";function Mf(e){return"symbol"==typeof e||kp(e)&&_h(e)==Cf}var Ef=NaN,Sf=/^[-+]0x[0-9a-f]+$/i,Af=/^0b[01]+$/i,Tf=/^0o[0-7]+$/i,$f=parseInt;function Of(e){if("number"==typeof e)return e;if(Mf(e))return Ef;if(yh(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=yh(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=kf(e);var n=Af.test(e);return n||Tf.test(e)?$f(e.slice(2),n?2:8):Sf.test(e)?Ef:+e}var If=1/0,Lf=17976931348623157e292;function jf(e){var t=function(e){return e?(e=Of(e))===If||e===-If?(e<0?-1:1)*Lf:e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}function zf(e,t){for(var n=-1,i=null==e?0:e.length,a=Array(i);++n<i;)a[n]=t(e[n],n,e);return a}var Df=1/0,Rf=lh?lh.prototype:void 0,Nf=Rf?Rf.toString:void 0;function Pf(e){if("string"==typeof e)return e;if(vp(e))return zf(e,Pf)+"";if(Mf(e))return Nf?Nf.call(e):"";var t=e+"";return"0"==t&&1/e==-Df?"-0":t}function Ff(e){return null==e?"":Pf(e)}var Bf=ch.isFinite,Vf=Math.min;var Uf=function(e){var t=Math[e];return function(e,n){if(e=Of(e),(n=null==n?0:Vf(jf(n),292))&&Bf(e)){var i=(Ff(e)+"e").split("e");return+((i=(Ff(t(i[0]+"e"+(+i[1]+n)))+"e").split("e"))[0]+"e"+(+i[1]-n))}return t(e)}}("round"),Hf=Uf;function qf(e){return e!=e}function Wf(e,t){return!!(null==e?0:e.length)&&function(e,t,n){return t==t?function(e,t,n){for(var i=n-1,a=e.length;++i<a;)if(e[i]===t)return i;return-1}(e,t,n):function(e,t,n,i){for(var a=e.length,r=n+(i?1:-1);i?r--:++r<a;)if(t(e[r],r,e))return r;return-1}(e,qf,n)}(e,t,0)>-1}function Zf(e,t,n){for(var i=-1,a=null==e?0:e.length;++i<a;)if(n(t,e[i]))return!0;return!1}var Kf=om&&1/ep(new om([,-0]))[1]==1/0?function(e){return new om(e)}:function(){},Yf=200;function Qf(e,t,n){var i=-1,a=Wf,r=e.length,s=!0,o=[],c=o;if(n)s=!1,a=Zf;else if(r>=Yf){var l=t?null:Kf(e);if(l)return ep(l);s=!1,a=Kh,c=new Wh}else c=t?[]:o;e:for(;++i<r;){var u=e[i],d=t?t(u):u;if(u=n||0!==u?u:0,s&&d==d){for(var h=c.length;h--;)if(c[h]===d)continue e;t&&c.push(d),o.push(u)}else a(c,d,n)||(c!==o&&c.push(d),o.push(u))}return o}function Gf(e,t,n){e.dispatchEvent(new CustomEvent(`advanced-camera-card:${t}`,{bubbles:!0,composed:!0,detail:n}))}function Xf(e){if(!e)return;return e.split(/[_\s]+/).map((e=>e[0].toUpperCase()+e.substring(1))).join(" ")}function Jf(e,t,n){const i=e[t];return e.splice(t,1),e.splice(n,0,i),e}const eg=e=>Array.isArray(e)?e:[e],tg=e=>e instanceof Set?e:new Set(eg(e));function ng(e,t,n){return!function(e,t,n){var i=(n="function"==typeof n?n:void 0)?n(e,t):void 0;return void 0===i?Sm(e,t,void 0,n):!!i}(e,t,n)}function ig(e,t=console.warn){e instanceof Lo&&e.context?t(e,e.context):t("object"==typeof e&&"message"in e?e.message:e)}const ag=()=>window.matchMedia("(hover: hover) and (pointer: fine)").matches,rg=(e,t)=>Jd(e,"yyyy-MM-dd HH:mm"+(t?":ss":"")),sg=e=>Jd(e,"yyyy-MM-dd"),og=(e,t)=>{window.requestIdleCallback?window.requestIdleCallback(e,{...t&&{timeout:t}}):e()};function cg(e,t){const n=function(e,t,n){const i=pd(e,t)/nd;return hd(n?.roundingMethod)(i)}(t,e),i=function(e,t,n){const i=pd(e,t)/td;return hd(n?.roundingMethod)(i)}(t,e)-60*n;let a="";return n&&(a+=`${n}h `),i&&(a+=`${i}m `),a+=`${md(t,e)-60*n*60-60*i}s`,a}const lg=async(e,t)=>await Promise.all(Array.from(e).map((e=>t(e)))),ug=e=>new Date(`${e}T00:00:00`),dg=async e=>{await new Promise((t=>setTimeout(t,1e3*e)))},hg=e=>!isNaN(e.getTime()),pg=(e,t,n,i)=>{t?e.setAttribute(n,i??""):e.removeAttribute(n)},mg=e=>!!e,fg=e=>e instanceof HTMLElement,gg=e=>(e instanceof HTMLSlotElement?e.assignedElements({flatten:!0}):[...e.children]).filter(fg),vg=e=>e?.ratio&&2===e.ratio.length?`${e.ratio[0]} / ${e.ratio[1]}`:e?.defaultStatic?"16 / 9":"auto",_g=e=>({"aspect-ratio":vg(e)}),yg=e=>{if(Array.isArray(e))return e.filter((e=>void 0!==e)).map((e=>yg(e)));if("object"==typeof e&&null!==e){const t={};for(const n in e)t[n]=yg(e[n]);return t}return e},bg=(e,t,n)=>Hf(e,n)===Hf(t,n);function wg(e){if(!e)return null;const t=zc.safeParse(e);return t.success?t.data:null}function xg(e,t){return{action:"fire-dom-event",advanced_camera_card_action:e,...t?.cardID&&{card_id:t.cardID}}}function kg(e,t,n){return{action:"fire-dom-event",advanced_camera_card_action:e,camera:t,...n?.cardID&&{card_id:n.cardID}}}function Cg(e,t,n){return{action:"fire-dom-event",advanced_camera_card_action:"media_player",media_player:e,media_player_action:t,...n?.cardID&&{card_id:n.cardID}}}function Mg(e){return{action:"fire-dom-event",advanced_camera_card_action:"ptz_multi",...e?.cardID&&{card_id:e.cardID},...e?.ptzAction&&{ptz_action:e.ptzAction},...e?.ptzPhase&&{ptz_phase:e.ptzPhase},...e?.ptzPreset&&{ptz_preset:e.ptzPreset},...e?.targetID&&{target_id:e.targetID}}}function Eg(e,t){return e&&t?"tap"===e&&t.tap_action?t.tap_action:"hold"===e&&t.hold_action?t.hold_action:"double_tap"===e&&t.double_tap_action?t.double_tap_action:"end_tap"===e&&t.end_tap_action?t.end_tap_action:"start_tap"===e&&t.start_tap_action?t.start_tap_action:null:null}const Sg=e=>eg(e).some((e=>function(e){return void 0!==e&&"none"!==e.action}(e))),Ag=e=>{e.stopPropagation()};class Tg{constructor(){this._timer=null,this._repeated=!1}stop(){this._timer&&(this._repeated?window.clearInterval(this._timer):window.clearTimeout(this._timer),this._timer=null)}isRunning(){return null!==this._timer}start(e,t){this.stop(),this._timer=window.setTimeout((()=>{this._timer=null,t()}),1e3*e),this._repeated=!1}startRepeated(e,t){this.stop(),this._timer=window.setInterval((()=>{t()}),1e3*e),this._repeated=!0}}class $g extends HTMLElement{constructor(){super(...arguments),this.holdTime=.4,this.holdTimer=new Tg,this.doubleClickTimer=new Tg,this.held=!1,this.started=!1}connectedCallback(){["touchcancel","mouseout","mouseup","touchmove","mousewheel","wheel","scroll"].forEach((e=>{document.addEventListener(e,(()=>{this.holdTimer.stop()}),{passive:!0})}))}bind(e,t){if(e.actionHandlerOptions)return void(e.actionHandlerOptions=t);e.actionHandlerOptions=t,e.addEventListener("contextmenu",(e=>{const t=e||window.event;return t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0,t.returnValue=!1,!1}));const n=()=>{this.held=!1,this.holdTimer.start(this.holdTime,(()=>{this.held=!0})),this.started||(this.started=!0,Je(e,"action",{action:"start_tap"}))},i=t=>{this.holdTimer.stop(),this.started&&(this.started=!1,Je(e,"action",{action:"end_tap"}))},a=t=>{const n=e.actionHandlerOptions;n?.allowPropagation||Ag(t),["touchend","touchcancel"].includes(t.type)&&!this.held||(i(),n?.hasHold&&this.held?Je(e,"action",{action:"hold"}):n?.hasDoubleClick?"click"===t.type&&t.detail<2||!this.doubleClickTimer.isRunning()?this.doubleClickTimer.start(.25,(()=>Je(e,"action",{action:"tap"}))):(this.doubleClickTimer.stop(),Je(e,"action",{action:"double_tap"})):Je(e,"action",{action:"tap"}))};e.addEventListener("touchstart",n,{passive:!0}),e.addEventListener("touchend",a),e.addEventListener("touchcancel",a),e.addEventListener("mousedown",n,{passive:!0}),e.addEventListener("click",a),e.addEventListener("keyup",(e=>{"Enter"===e.key&&a(e)})),e.addEventListener("mouseleave",i)}}customElements.define("action-handler-advanced-camera-card",$g);const Og=(e,t)=>{const n=(()=>{const e=document.body;if(e.querySelector("action-handler-advanced-camera-card"))return e.querySelector("action-handler-advanced-camera-card");const t=document.createElement("action-handler-advanced-camera-card");return e.appendChild(t),t})();n&&n.bind(e,t)},Ig=fe(class extends ge{update(e,[t]){return Og(e.element,t),q}render(e){}});var Lg=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)gp(t,xp(e)),e=Hm(e);return t}:yp;function jg(e){return _p(e,rf,Lg)}var zg=Object.prototype.hasOwnProperty;var Dg=/\w*$/;var Rg=lh?lh.prototype:void 0,Ng=Rg?Rg.valueOf:void 0;var Pg="[object Boolean]",Fg="[object Date]",Bg="[object Map]",Vg="[object Number]",Ug="[object RegExp]",Hg="[object Set]",qg="[object String]",Wg="[object Symbol]",Zg="[object ArrayBuffer]",Kg="[object DataView]",Yg="[object Float32Array]",Qg="[object Float64Array]",Gg="[object Int8Array]",Xg="[object Int16Array]",Jg="[object Int32Array]",ev="[object Uint8Array]",tv="[object Uint8ClampedArray]",nv="[object Uint16Array]",iv="[object Uint32Array]";function av(e,t,n){var i,a,r,s=e.constructor;switch(t){case Zg:return Pm(e);case Pg:case Fg:return new s(+e);case Kg:return function(e,t){var n=t?Pm(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case Yg:case Qg:case Gg:case Xg:case Jg:case ev:case tv:case nv:case iv:return Fm(e,n);case Bg:return new s;case Vg:case qg:return new s(e);case Ug:return(r=new(a=e).constructor(a.source,Dg.exec(a))).lastIndex=a.lastIndex,r;case Hg:return new s;case Wg:return i=e,Ng?Object(Ng.call(i)):{}}}var rv=Hp&&Hp.isMap,sv=rv?Pp(rv):function(e){return kp(e)&&"[object Map]"==bm(e)};var ov=Hp&&Hp.isSet,cv=ov?Pp(ov):function(e){return kp(e)&&"[object Set]"==bm(e)},lv=1,uv=2,dv=4,hv="[object Arguments]",pv="[object Function]",mv="[object GeneratorFunction]",fv="[object Object]",gv={};function vv(e,t,n,i,a,r){var s,o=t&lv,c=t&uv,l=t&dv;if(n&&(s=a?n(e,i,a,r):n(e)),void 0!==s)return s;if(!yh(e))return e;var u=vp(e);if(u){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&zg.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!o)return Bm(e,s)}else{var d=bm(e),h=d==pv||d==mv;if(Ip(e))return Nm(e,o);if(d==fv||d==hv||h&&!a){if(s=c||h?{}:qm(e),!o)return c?function(e,t){return tf(e,Lg(e),t)}(e,function(e,t){return e&&tf(t,rf(t),e)}(s,e)):function(e,t){return tf(e,xp(e),t)}(e,function(e,t){return e&&tf(t,tm(t),e)}(s,e))}else{if(!gv[d])return a?e:{};s=av(e,d,o)}}r||(r=new qh);var p=r.get(e);if(p)return p;r.set(e,s),cv(e)?e.forEach((function(i){s.add(vv(i,t,n,i,e,r))})):sv(e)&&e.forEach((function(i,a){s.set(a,vv(i,t,n,a,e,r))}));var m=u?void 0:(l?c?jg:nm:c?rf:tm)(e);return function(e,t){for(var n=-1,i=null==e?0:e.length;++n<i&&!1!==t(e[n],n,e););}(m||e,(function(i,a){m&&(i=e[a=i]),ef(s,a,vv(i,t,n,a,e,r))})),s}gv[hv]=gv["[object Array]"]=gv["[object ArrayBuffer]"]=gv["[object DataView]"]=gv["[object Boolean]"]=gv["[object Date]"]=gv["[object Float32Array]"]=gv["[object Float64Array]"]=gv["[object Int8Array]"]=gv["[object Int16Array]"]=gv["[object Int32Array]"]=gv["[object Map]"]=gv["[object Number]"]=gv[fv]=gv["[object RegExp]"]=gv["[object Set]"]=gv["[object String]"]=gv["[object Symbol]"]=gv["[object Uint8Array]"]=gv["[object Uint8ClampedArray]"]=gv["[object Uint16Array]"]=gv["[object Uint32Array]"]=!0,gv["[object Error]"]=gv[pv]=gv["[object WeakMap]"]=!1;function _v(e){return vv(e,5)}var yv="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function bv(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wv={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function r(e,t,i,r,s){if("function"!=typeof i)throw new TypeError("The listener must be a function");var o=new a(i,r||e,s),c=n?n+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],o]:e._events[c].push(o):(e._events[c]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function o(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),(new i).__proto__||(n=!1)),o.prototype.eventNames=function(){var e,i,a=[];if(0===this._eventsCount)return a;for(i in e=this._events)t.call(e,i)&&a.push(n?i.slice(1):i);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},o.prototype.listeners=function(e){var t=n?n+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var a=0,r=i.length,s=new Array(r);a<r;a++)s[a]=i[a].fn;return s},o.prototype.listenerCount=function(e){var t=n?n+e:e,i=this._events[t];return i?i.fn?1:i.length:0},o.prototype.emit=function(e,t,i,a,r,s){var o=n?n+e:e;if(!this._events[o])return!1;var c,l,u=this._events[o],d=arguments.length;if(u.fn){switch(u.once&&this.removeListener(e,u.fn,void 0,!0),d){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,t),!0;case 3:return u.fn.call(u.context,t,i),!0;case 4:return u.fn.call(u.context,t,i,a),!0;case 5:return u.fn.call(u.context,t,i,a,r),!0;case 6:return u.fn.call(u.context,t,i,a,r,s),!0}for(l=1,c=new Array(d-1);l<d;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var h,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(e,u[l].fn,void 0,!0),d){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,t);break;case 3:u[l].fn.call(u[l].context,t,i);break;case 4:u[l].fn.call(u[l].context,t,i,a);break;default:if(!c)for(h=1,c=new Array(d-1);h<d;h++)c[h-1]=arguments[h];u[l].fn.apply(u[l].context,c)}}return!0},o.prototype.on=function(e,t,n){return r(this,e,t,n,!1)},o.prototype.once=function(e,t,n){return r(this,e,t,n,!0)},o.prototype.removeListener=function(e,t,i,a){var r=n?n+e:e;if(!this._events[r])return this;if(!t)return s(this,r),this;var o=this._events[r];if(o.fn)o.fn!==t||a&&!o.once||i&&o.context!==i||s(this,r);else{for(var c=0,l=[],u=o.length;c<u;c++)(o[c].fn!==t||a&&!o[c].once||i&&o[c].context!==i)&&l.push(o[c]);l.length?this._events[r]=1===l.length?l[0]:l:s(this,r)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=n?n+e:e,this._events[t]&&s(this,t)):(this._events=new i,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(wv);var xv=bv(wv.exports);class kv extends Error{constructor(e){super(e),this.name="TimeoutError"}}class Cv extends Error{constructor(e){super(),this.name="AbortError",this.message=e}}const Mv=e=>void 0===globalThis.DOMException?new Cv(e):new DOMException(e),Ev=e=>{const t=void 0===e.reason?Mv("This operation was aborted."):e.reason;return t instanceof Error?t:Mv(t)};class Sv{#e=[];enqueue(e,t){const n={priority:(t={priority:0,...t}).priority,run:e};if(this.size&&this.#e[this.size-1].priority>=t.priority)return void this.#e.push(n);const i=function(e,t,n){let i=0,a=e.length;for(;a>0;){const r=Math.trunc(a/2);let s=i+r;n(e[s],t)<=0?(i=++s,a-=r+1):a=r}return i}(this.#e,n,((e,t)=>t.priority-e.priority));this.#e.splice(i,0,n)}dequeue(){const e=this.#e.shift();return e?.run}filter(e){return this.#e.filter((t=>t.priority===e.priority)).map((e=>e.run))}get size(){return this.#e.length}}class Av extends xv{#t;#n;#i=0;#a;#r;#s=0;#o;#c;#e;#l;#u=0;#d;#h;#p;timeout;constructor(e){if(super(),!("number"==typeof(e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Sv,...e}).intervalCap&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${e.intervalCap?.toString()??""}\` (${typeof e.intervalCap})`);if(void 0===e.interval||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${e.interval?.toString()??""}\` (${typeof e.interval})`);this.#t=e.carryoverConcurrencyCount,this.#n=e.intervalCap===Number.POSITIVE_INFINITY||0===e.interval,this.#a=e.intervalCap,this.#r=e.interval,this.#e=new e.queueClass,this.#l=e.queueClass,this.concurrency=e.concurrency,this.timeout=e.timeout,this.#p=!0===e.throwOnTimeout,this.#h=!1===e.autoStart}get#m(){return this.#n||this.#i<this.#a}get#f(){return this.#u<this.#d}#g(){this.#u--,this.#v(),this.emit("next")}#_(){this.#y(),this.#b(),this.#c=void 0}get#w(){const e=Date.now();if(void 0===this.#o){const t=this.#s-e;if(!(t<0))return void 0===this.#c&&(this.#c=setTimeout((()=>{this.#_()}),t)),!0;this.#i=this.#t?this.#u:0}return!1}#v(){if(0===this.#e.size)return this.#o&&clearInterval(this.#o),this.#o=void 0,this.emit("empty"),0===this.#u&&this.emit("idle"),!1;if(!this.#h){const e=!this.#w;if(this.#m&&this.#f){const t=this.#e.dequeue();return!!t&&(this.emit("active"),t(),e&&this.#b(),!0)}}return!1}#b(){this.#n||void 0!==this.#o||(this.#o=setInterval((()=>{this.#y()}),this.#r),this.#s=Date.now()+this.#r)}#y(){0===this.#i&&0===this.#u&&this.#o&&(clearInterval(this.#o),this.#o=void 0),this.#i=this.#t?this.#u:0,this.#x()}#x(){for(;this.#v(););}get concurrency(){return this.#d}set concurrency(e){if(!("number"==typeof e&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this.#d=e,this.#x()}async#k(e){return new Promise(((t,n)=>{e.addEventListener("abort",(()=>{n(e.reason)}),{once:!0})}))}async add(e,t={}){return t={timeout:this.timeout,throwOnTimeout:this.#p,...t},new Promise(((n,i)=>{this.#e.enqueue((async()=>{this.#u++,this.#i++;try{t.signal?.throwIfAborted();let i=e({signal:t.signal});t.timeout&&(i=function(e,t){const{milliseconds:n,fallback:i,message:a,customTimers:r={setTimeout:setTimeout,clearTimeout:clearTimeout}}=t;let s;const o=new Promise(((o,c)=>{if("number"!=typeof n||1!==Math.sign(n))throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${n}\``);if(t.signal){const{signal:e}=t;e.aborted&&c(Ev(e)),e.addEventListener("abort",(()=>{c(Ev(e))}))}if(n===Number.POSITIVE_INFINITY)return void e.then(o,c);const l=new kv;s=r.setTimeout.call(void 0,(()=>{if(i)try{o(i())}catch(e){c(e)}else"function"==typeof e.cancel&&e.cancel(),!1===a?o():a instanceof Error?c(a):(l.message=a??`Promise timed out after ${n} milliseconds`,c(l))}),n),(async()=>{try{o(await e)}catch(e){c(e)}})()})),c=o.finally((()=>{c.clear()}));return c.clear=()=>{r.clearTimeout.call(void 0,s),s=void 0},c}(Promise.resolve(i),{milliseconds:t.timeout})),t.signal&&(i=Promise.race([i,this.#k(t.signal)]));const a=await i;n(a),this.emit("completed",a)}catch(e){if(e instanceof kv&&!t.throwOnTimeout)return void n();i(e),this.emit("error",e)}finally{this.#g()}}),t),this.emit("add"),this.#v()}))}async addAll(e,t){return Promise.all(e.map((async e=>this.add(e,t))))}start(){return this.#h?(this.#h=!1,this.#x(),this):this}pause(){this.#h=!0}clear(){this.#e=new this.#l}async onEmpty(){0!==this.#e.size&&await this.#C("empty")}async onSizeLessThan(e){this.#e.size<e||await this.#C("next",(()=>this.#e.size<e))}async onIdle(){0===this.#u&&0===this.#e.size||await this.#C("idle")}async#C(e,t){return new Promise((n=>{const i=()=>{t&&!t()||(this.off(e,i),n())};this.on(e,i)}))}get size(){return this.#e.size}sizeBy(e){return this.#e.filter(e).length}get pending(){return this.#u}get isPaused(){return this.#h}}var Tv={advanced_camera_card:"Advanced Camera Card",advanced_camera_card_description:"An Advanced Camera Card",live:"Live",no_media:"No media to display",recordings:"Recordings",version:"Version"},$v={cameras:{always_error_if_entity_unavailable:"Always treat entity unavailability as error",camera_entity:"Camera Entity",capabilities:{capabilities:{clips:"Clips","favorite-events":"Favorite Events","favorite-recordings":"Favorite Recordings",live:"Live",menu:"Menu",ptz:"PTZ",recordings:"Recordings",seek:"Seeking",snapshots:"Snapshots",substream:"Substream"},disable:"Disable",disable_except:"Disable except",editor_label:"Camera capabilities"},cast:{dashboard:{dashboard_path:"Dashboard path",view_path:"View path"},editor_label:"Cast options",method:"Cast method",methods:{dashboard:"Dashboard",standard:"Standard"}},dependencies:{all_cameras:"Show events for all cameras with this camera",cameras:"Show events for specific cameras with this camera",editor_label:"Dependency options"},dimensions:{aspect_ratio:"Static aspect ratio",editor_label:"Camera dimensions",layout:{editor_label:"Camera Layout",fit:"Layout fit",fits:{contain:"Media is contained/letterboxed",cover:"Media expands proportionally to cover the card",fill:"Media is stretched to fill the card"},pan:{x:"Pan horizontal percentage",y:"Pan vertical percentage"},position:{editor_label:"Layout Cover Position",x:"Horizontal placement percentage",y:"Vertical placement percentage"},view_box:{bottom:"Bottom inset percentage",editor_label:"Layout View Box",left:"Left inset percentage",right:"Right inset percentage",top:"Top inset percentage"},zoom:"Zoom factor"}},engines:{editor_label:"Camera engine options"},frigate:{camera_name:"Frigate camera name (Autodetected from entity)",client_id:"Frigate client id (For >1 Frigate server)",editor_label:"Frigate options",labels:"Frigate labels/object filters",url:"Frigate server URL",zones:"Frigate zones"},go2rtc:{editor_label:"go2rtc Options",modes:{editor_label:"go2rtc Modes",mjpeg:"Motion JPEG (MJPEG)",mp4:"MPEG-4 (MP4)",mse:"Media Source Extensions (MSE)",webrtc:"Web Real-Time Communication (WebRTC)"},stream:"go2rtc stream name",url:"go2rtc URL"},icon:"Icon for this camera (Autodetected from entity)",id:"Unique id for this camera in this card",image:{editor_label:"Image Options",refresh_seconds:"Number of seconds after which to refresh live image (0=never)",url:"Image URL to use instead of camera entity snapshot"},live_provider:"Live view provider for this camera",live_provider_options:{editor_label:"Live provider options"},live_providers:{auto:"Automatic",go2rtc:"go2rtc",ha:"Home Assistant video stream (i.e. HLS, LL-HLS, WebRTC via HA)",image:"Home Assistant images",jsmpeg:"JSMpeg","webrtc-card":"WebRTC Card (i.e. AlexxIT's WebRTC Card)"},motioneye:{editor_label:"MotionEye options",images:{directory_pattern:"Images directory pattern",file_pattern:"Images file pattern"},movies:{directory_pattern:"Movies directory pattern",file_pattern:"Movies file pattern"},url:"MotionEye UI URL"},proxy:{dynamic:"Dynamic proxying",editor_label:"Camera proxying",media:{auto:"Media proxying automatically configured",editor_label:"Media proxying",false:"Media proxying disabled",true:"Media proxying enabled"},ssl_ciphers:{auto:"SSL ciphers automatically configured",default:"Default SSL ciphers",editor_label:"SSL ciphers",insecure:"Insecure SSL ciphers",intermediate:"Intermediate SSL ciphers",modern:"Modern SSL ciphers"},ssl_verification:{auto:"SSL verification automatically configured",editor_label:"SSL verification",false:"SSL verification disabled",true:"SSL verification enabled"}},reolink:{editor_label:"Reolink options",media_resolution:{editor_label:"Media Resolution",high:"High Resolution",low:"Low Resolution"},url:"Reolink UI URL"},title:"Title for this camera (Autodetected from entity)",triggers:{editor_label:"Trigger options",entities:"Trigger from other entities",events:{clips:"Events with new clips",editor_label:"Trigger Events",events:"All events",snapshots:"Events with new snapshots"},motion:"Trigger by auto-detecting the motion sensor",occupancy:"Trigger by auto-detecting the occupancy sensor"},webrtc_card:{editor_label:"WebRTC Card Options",entity:"WebRTC Card Camera Entity",url:"WebRTC Card Camera URL"}},common:{controls:{builtin:"Built-in video controls",filter:{editor_label:"Media Filter",mode:"Filter mode",modes:{left:"Media filter in a drawer to the left",none:"No media filter",right:"Media filter in a drawer to the right"}},next_previous:{editor_label:"Next & Previous",size:"Next & previous control size in pixels",style:"Next & previous control style",styles:{chevrons:"Chevrons",icons:"Icons",none:"None",thumbnails:"Thumbnails"}},thumbnails:{editor_label:"Thumbnails",events_media_type:"Whether to show event thumbnails of clips or snapshots",events_media_types:{clips:"Clip thumbnails",snapshots:"Snapshot thumbnails"},media_type:"Whether to show thumnails of events or recordings",media_types:{events:"Events",recordings:"Recordings"},mode:"Thumbnails mode",modes:{above:"Thumbnails above",below:"Thumbnails below",left:"Thumbnails in a drawer to the left",none:"No thumbnails",right:"Thumbnails in a drawer to the right"},show_details:"Show details with thumbnails",show_download_control:"Show download control on thumbnails",show_favorite_control:"Show favorite control on thumbnails",show_timeline_control:"Show timeline control on thumbnails",size:"Thumbnails size in pixels"},timeline:{editor_label:"Mini Timeline",format:{editor_label:"Time & date format","24h":"Use 24-hour clock"},mode:"Mode",modes:{above:"Above",below:"Below",none:"None"},pan_mode:"Default pan mode",pan_modes:{pan:"Pan",seek:"Pan seeks across all media","seek-in-camera":"Pan seeks within selected camera only","seek-in-media":"Pan seeks within selected media item only"}}},display:{editor_label:"Display",grid_columns:"Exact number of grid columns",grid_max_columns:"Maximum number of grid columns",grid_selected_width_factor:"Increase selected media width by this factor",mode:"Mode"},image:{entity:"Entity for use with entity mode",entity_parameters:"Query parameters added to the entity-based picture URLs (e.g. width=1920&height=1080)",mode:"Image mode",modes:{camera:"Home Assistant camera snapshot of camera entity",entity:"Entity with entity_picture attribute",screensaver:"Embedded screensaver image",url:"Arbitrary image specified by URL"},refresh_seconds:"Number of seconds after which to refresh (0=never)",url:"Static image URL"},media_action_conditions:{all:"All opportunities",hidden:"On browser/tab hiding",microphone_mute:"On microphone mute",microphone_unmute:"On microphone unmute",never:"Never",selected:"On selection",unselected:"On unselection",visible:"On browser/tab visibility"},timeline:{clustering_threshold:"The count of events at which they are clustered (0=no clustering)",events_media_type:"The events media the timeline displays",events_media_types:{all:"All event media types",clips:"Clips",snapshots:"Snapshots"},show_recordings:"Show recordings",style:"Timeline style",styles:{ribbon:"Events on a single ribbon",stack:"Stacked & clustered events"},window_seconds:"The default length of the timeline view in seconds"}},dimensions:{aspect_ratio:"Default aspect ratio (e.g. '16:9')",aspect_ratio_mode:"Aspect ratio mode",aspect_ratio_modes:{dynamic:"Aspect ratio adjusts to media",static:"Static aspect ratio",unconstrained:"Unconstrained aspect ratio"},height:"Card height in CSS units (e.g. '500px')"},live:{auto_mute:"Automatically mute live cameras",auto_pause:"Automatically pause live cameras",auto_play:"Automatically play live cameras",auto_unmute:"Automatically unmute live cameras",controls:{editor_label:"Live Controls",ptz:{editor_label:"PTZ",hide_home:"Hide home control",hide_pan_tilt:"Hide pan & tilt control",hide_zoom:"Hide zoom control",mode:"Mode",modes:{off:"Off",on:"On"},orientation:"Orientation",orientations:{horizontal:"Horizontal",vertical:"Vertical"},position:"Position",positions:{"bottom-left":"Bottom left","bottom-right":"Bottom right","top-left":"Top left","top-right":"Top right"}}},draggable:"Live cameras view can be dragged/swiped",lazy_load:"Live cameras are lazily loaded",lazy_unload:"Live cameras are lazily unloaded",microphone:{always_connected:"Always keep the microphone connected",disconnect_seconds:"Seconds after which to disconnect microphone (0=never)",editor_label:"Microphone",enabled:"Microphone enabled",mute_after_microphone_mute_seconds:"Seconds after microphone mute to mute inbound audio"},preload:"Preload live view in the background",show_image_during_load:"Show still image while the live stream is loading",transition_effect:"Live camera transition effect",zoomable:"Live cameras can be zoomed/panned"},media_viewer:{auto_mute:"Automatically mute media",auto_pause:"Automatically pause media",auto_play:"Automatically play media",auto_unmute:"Automatically unmute media",controls:{editor_label:"Media Viewer Controls"},draggable:"Media Viewer can be dragged/swiped",lazy_load:"Media Viewer media is lazily loaded in carousel",snapshot_click_plays_clip:"Clicking on a snapshot plays a related clip",transition_effect:"Media Viewer transition effect",transition_effects:{none:"No transition",slide:"Slide transition"},zoomable:"Media Viewer can be zoomed/panned"},menu:{alignment:"Menu alignment",alignments:{bottom:"Aligned to the bottom",left:"Aligned to the left",right:"Aligned to the right",top:"Aligned to the top"},button_size:"Menu button size in pixels",buttons:{alignment:"Button alignment",alignments:{matching:"Matching the menu alignment",opposing:"Opposing the menu alignment"},camera_ui:"Camera user interface",cameras:"Cameras",clips:"Clips",display_mode:"Display mode",download:"Download",enabled:"Button enabled",expand:"Expand",fullscreen:"Fullscreen",icon:"Icon",image:"Image",iris:"Iris / Default View / Unhide menu",live:"Live",media_player:"Send to media player",microphone:"Microphone",mute:"Mute / Unmute",permanent:"Show when the menu is hidden",play:"Play / Pause",priority:"Priority",ptz_controls:"Show PTZ controls",ptz_home:"PTZ Home",recordings:"Recordings",screenshot:"Screenshot",snapshots:"Snapshots",substreams:"Substream(s)",timeline:"Timeline",type:"Button type",types:{momentary:"Momentary",toggle:"Toggle"}},position:"Menu position",positions:{bottom:"Positioned on the bottom",left:"Positioned on the left",right:"Positioned on the right",top:"Positioned on the top"},style:"Menu style",styles:{hidden:"Hidden menu",hover:"Hover menu","hover-card":"Hover menu (card-wide)",none:"No menu",outside:"Outside menu",overlay:"Overlay menu"}},overrides:{info:"This card configuration has manually specified overrides configured which may override values shown in the visual editor, please consult the code editor to view/modify these overrides"},performance:{features:{animated_progress_indicator:"Animated Progress Indicator",card_loading_indicator:"Card Loading Indicator",editor_label:"Feature Options",max_simultaneous_engine_requests:"Max simultaneous camera engine requests",media_chunk_size:"Media chunk size"},style:{border_radius:"Curves",box_shadow:"Shadows",editor_label:"Style Options"},warning:"This card is in low profile mode so defaults have changed to optimize performance"},profiles:{casting:"Casting",editor_label:"Configuration profiles","low-performance":"Low performance",scrubbing:"Video scrubbing"},status_bar:{height:"Status bar height in pixels",items:{enabled:"Item enabled",engine:"Camera engine",live_provider:"Live provider",priority:"Item priority",resolution:"Resolution",technology:"Technology",title:"Title"},popup_seconds:"Status bar popup seconds",position:"Status bar position",positions:{bottom:"Positioned on the bottom",top:"Positioned on the top"},style:"Status bar style",styles:{hover:"Hover status bar","hover-card":"Hover status bar (card-wide)",none:"No status bar",outside:"Outside status bar",overlay:"Overlay status bar",popup:"Popup status bar"}},view:{camera_select:"View for newly selected cameras",default:"Default view",default_cycle_camera:"Cycle through cameras when default view updates",default_reset:{after_interaction:"Reset to the default view after user interaction ends",editor_label:"Default view reset behavior",entities:"Reset to the default view on entity state change",every_seconds:"Reset to default view every X seconds (0=never)",interaction_mode:"How default reset behaves when the card has human interaction",interaction_modes:{active:"Only allow reset when card has active human interaction",all:"Reset regardless of human interaction",inactive:"Only reset when card has no human interaction"}},dim:"Dim when no interaction",interaction_seconds:"Seconds after user action to remain interacted with (0=never)",keyboard_shortcuts:{editor_label:"Keyboard shortcuts",enabled:"Keyboard shortcuts enabled",ptz_down:"PTZ Down",ptz_home:"PTZ Home",ptz_left:"PTZ Left",ptz_right:"PTZ Right",ptz_up:"PTZ Up",ptz_zoom_in:"PTZ Zoom In",ptz_zoom_out:"PTZ Zoom Out"},theme:{themes:{dark:"Dark",ha:"Home Assistant",editor_label:"Themes",light:"Light",traditional:"Traditional"}},triggers:{actions:{editor_label:"Trigger actions",interaction_mode:"How to handle actions when the card has human interaction",interaction_modes:{active:"Only trigger actions when card has human interaction",all:"Trigger actions regardless of human interaction",inactive:"Only trigger actions when card has no human interaction"},trigger:"Trigger action",triggers:{default:"Change to or update default view",live:"Change to or update live view",media:"Change to the relevant media view for new media",none:"No action"},untrigger:"Untrigger action",untriggers:{default:"Change to default view/camera",none:"No action"}},editor_label:"Trigger behavior",filter_selected_camera:"Only trigger on selected camera",show_trigger_status:"Show pulsing border when triggered",untrigger_seconds:"Seconds after inactive state change to untrigger"},views:{clip:"Most recent clip",clips:"Clips gallery",current:"Current view",image:"Static image",live:"Live view",recording:"Most recent recording",recordings:"Recordings gallery",snapshot:"Most recent snapshot",snapshots:"Snapshots gallery",timeline:"Timeline view"}}},Ov={grid:"Show media viewer for each camera in a grid",single:"Show single media viewer"},Iv={add_new_camera:"Add new camera",button:"Button",camera:"Camera",cameras:"Cameras",cameras_secondary:"What cameras to render on this card",delete:"Delete",dimensions:"Card dimensions",dimensions_secondary:"Card dimensions & shape options",image:"Image",image_secondary:"Static image view options",live:"Live",live_secondary:"Live camera view options",media_gallery:"Media gallery",media_gallery_secondary:"Media gallery options",media_viewer:"Media viewer",media_viewer_secondary:"Viewer for static media (clips, snapshots or recordings)",menu:"Menu",menu_secondary:"Menu look & feel options",move_down:"Move down",move_up:"Move up",overrides:"Overrides are active",overrides_secondary:"Dynamic configuration overrides detected",performance:"Performance",performance_secondary:"Card performance options",profiles:"Configuration profiles",profiles_secondary:"Choose pre-configured sets of defaults",status_bar:"Status bar",status_bar_secondary:"Status bar look & feel options",timeline:"Timeline",timeline_secondary:"Event timeline options",upgrade:"Upgrade",upgrade_available:"An automatic card configuration upgrade is available",view:"View",view_secondary:"What the card should show and how to show it"},Lv={ptz:{down:"Down",home:"Home",left:"Left",right:"Right",up:"Up",zoom_in:"Zoom In",zoom_out:"Zoom Out"}},jv={awaiting_live:"Waiting for live stream to load ...",awaiting_media:"Waiting for media to load",camera_initialization:"Camera initialization failed",camera_initialization_reolink:"Could not initialize Reolink camera",could_not_render_elements:"Could not render picture elements",could_not_resolve:"Could not resolve media URL",diagnostics:"Card diagnostics. Please review for confidential information prior to sharing",download_no_media:"No media to download",download_sign_failed:"Could not sign media URL for download",duplicate_camera_id:"Duplicate camera id for the following camera, use the 'id' parameter to uniquely identify cameras",empty_response:"Received empty response from Home Assistant for request",failed_response:"Failed to receive response from Home Assistant for request",failed_retain:"Could not retain event",failed_sign:"Could not sign Home Assistant URL",fetching_diagnostics:"Fetching diagnostics",image_load_error:"The image could not be loaded",invalid_configuration:"Invalid configuration",invalid_configuration_no_hint:"No location hint available (bad or missing type?)",invalid_configuration_override:"Invalid override configuration",invalid_elements_config:"Invalid picture elements configuration",invalid_response:"Received invalid response from Home Assistant for request",jsmpeg_no_player:"Could not start JSMPEG player",live_camera_no_endpoint:"Could not get camera endpoint for this live provider (incomplete configuration?)",live_camera_not_found:"The configured camera_entity was not found",live_camera_unavailable:"Camera unavailable",no_camera_engine:"Could not determine suitable engine for camera",no_camera_entity:"Could not find camera entity",no_camera_entity_for_triggers:"A camera entity is required in order to autodetect triggers",no_camera_id:"Could not determine camera id for the following camera, may need to set 'id' parameter manually",no_dashboard_or_view:"Both 'dashboard_path' and 'view_path' parameters are required for the 'dashboard' cast method",no_live_camera:"The camera_entity parameter must be set and valid for this live provider",no_supported_camera:"The selected camera does not support this view",no_supported_cameras:"No cameras support this view",reconnecting:"Reconnecting",stream_not_loading:"The video stream has not yet loaded. This is could for any number of reasons. If configured (and by default), there will be an image refreshing every second until the stream loads correctly",too_many_automations:"Too many nested automation calls, please check your configuration for loops",troubleshooting:"Check troubleshooting",unknown:"Unknown error",upgrade_available:"An automated card configuration upgrade is available, please visit the visual card editor",webrtc_card_reported_error:"WebRTC Card reported an error",webrtc_card_waiting:"Waiting for WebRTC Card to load ..."},zv={camera:"Camera",duration:"Duration",in_progress:"In Progress",score:"Score",seek:"Seek",start:"Start",tag:"Tag",what:"What",where:"Where"},Dv={assign:"Assign",modifiers:{alt:"Alt",ctrl:"Ctrl",meta:"Meta",shift:"Shift"},unassign:"Unassign"},Rv={all:"All",camera:"Camera",favorite:"Favorite",media_type:"Media Type",media_types:{clips:"Clips",recordings:"Recordings",snapshots:"Snapshots"},not_favorite:"Not Favorite",select_camera:"Select camera...",select_favorite:"Select favorite...",select_media_type:"Select media type...",select_tag:"Select tag...",select_what:"Select what...",select_when:"Select when...",select_where:"Select where...",tag:"Tag",what:"What",when:"When",whens:{custom:"Custom",past_month:"Past Month",past_week:"Past Week",today:"Today",yesterday:"Yesterday"},where:"Where"},Nv={unseekable:"Seek time not found in media"},Pv={camera:"Camera",duration:"Duration",events:"Events",in_progress:"In Progress",seek:"Seek",start:"Start"},Fv={download:"Download media",no_thumbnail:"No thumbnail available",retain_indefinitely:"Media will be indefinitely retained",timeline:"See media in timeline"},Bv={select_date:"Choose date"},Vv={common:Tv,config:$v,display_modes:Ov,editor:Iv,elements:Lv,error:jv,event:zv,key_assigner:Dv,media_filter:Rv,media_viewer:Nv,recording:Pv,thumbnail:Fv,timeline:Bv},Uv=Object.freeze({__proto__:null,common:Tv,config:$v,default:Vv,display_modes:Ov,editor:Iv,elements:Lv,error:jv,event:zv,key_assigner:Dv,media_filter:Rv,media_viewer:Nv,recording:Pv,thumbnail:Fv,timeline:Bv});const Hv="en",qv={[Hv]:Uv};let Wv;function Zv(e){const t=e=>e.replace("-","_"),n=e?.language??e?.selectedLanguage;if(n)return t(n);const i=localStorage.getItem("selectedLanguage");if(i){const e=JSON.parse(i);if(e)return t(e)}for(const e of navigator.languages){const n=t(e);if(n&&n in qv)return n}return Hv}function Kv(e,t="",n=""){let i="";try{i=e.split(".").reduce(((e,t)=>e[t]),qv[Wv??Hv])}catch(e){}return i||(i=e.split(".").reduce(((e,t)=>e[t]),qv[Hv])),""!==t&&""!==n&&(i=i.replace(t,n)),i}function Yv(e){return"string"==typeof e?.id&&e.id||"string"==typeof e?.camera_entity&&e.camera_entity||"object"==typeof e?.webrtc_card&&e.webrtc_card&&("string"==typeof e.webrtc_card.entity&&e.webrtc_card.entity||"string"==typeof e.webrtc_card.url&&e.webrtc_card.url)||"object"==typeof e?.go2rtc&&e.go2rtc&&"string"==typeof e.go2rtc.url&&"string"==typeof e.go2rtc.stream&&`${e.go2rtc.url}#${e.go2rtc.stream}`||"object"==typeof e?.frigate&&e.frigate&&"string"==typeof e?.frigate.camera_name&&e.frigate.camera_name||""}const Qv=(e,...t)=>{e?.debug?.logging&&console.debug(...t)},Gv=(e,t,n)=>"preset"===t?(n?.preset?e.ptz.presets?.[n.preset]:null)??null:n?.phase?e.ptz[`actions_${t}_${n.phase}`]??null:e.ptz[`actions_${t}`]??null,Xv=(e,t,n)=>!!Gv(e,t,n),Jv=(e,t)=>{const n=Xv(e,t,{phase:"start"})&&Xv(e,t,{phase:"stop"}),i=Xv(e,t);return n||i?[...n?["continuous"]:[],...i?["relative"]:[]]:null},e_=e=>{const t=Jv(e,"left"),n=Jv(e,"right"),i=Jv(e,"up"),a=Jv(e,"down"),r=Jv(e,"zoom_in"),s=Jv(e,"zoom_out"),o=e.ptz.presets?Object.keys(e.ptz.presets):void 0;return t?.length||n?.length||i?.length||a?.length||r?.length||s?.length||o?.length?{...t?{left:t}:{},...n?{right:n}:{},...i?{up:i}:{},...a?{down:a}:{},...r?{zoomIn:r}:{},...s?{zoomOut:s}:{},...o?{presets:o}:{}}:null};class t_{constructor(e,t){this._capabilities=e;for(const e of t?.disable??[])this._disable(e);for(const e of jo)t?.disableExcept?.length&&!t.disableExcept.includes(e)&&this._disable(e)}_disable(e){delete this._capabilities[e]}matches(e){let t=!0;return"string"==typeof e&&(t&&=this.has(e)),"object"==typeof e&&e.allCapabilities&&(t&&=e.allCapabilities.every((e=>this.has(e)))),"object"==typeof e&&e.anyCapabilities&&(t&&=e.anyCapabilities.some((e=>this.has(e)))),t}has(e){return!!this._capabilities[e]}getPTZCapabilities(){return this._capabilities.ptz??null}hasPTZCapability(){return!!(this._capabilities.ptz?.down?.length||this._capabilities.ptz?.up?.length||this._capabilities.ptz?.left?.length||this._capabilities.ptz?.right?.length||this._capabilities.ptz?.zoomIn?.length||this._capabilities.ptz?.zoomOut?.length||this._capabilities.ptz?.presets?.length)}getRawCapabilities(){return this._capabilities}}function n_(e,t,n){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(n=n>a?a:n)<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var r=Array(a);++i<a;)r[i]=e[i+t];return r}var i_=Math.ceil,a_=Math.max;var r_=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s_=/^\w*$/;function o_(e,t){if(vp(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Mf(e))||(s_.test(e)||!r_.test(e)||null!=t&&e in Object(t))}var c_="Expected a function";function l_(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(c_);var n=function(){var i=arguments,a=t?t.apply(this,i):i[0],r=n.cache;if(r.has(a))return r.get(a);var s=e.apply(this,i);return n.cache=r.set(a,s)||r,s};return n.cache=new(l_.Cache||Hh),n}l_.Cache=Hh;var u_=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,d_=/\\(\\)?/g,h_=function(e){var t=l_(e,(function(e){return 500===n.size&&n.clear(),e})),n=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(u_,(function(e,n,i,a){t.push(i?a.replace(d_,"$1"):n||e)})),t})),p_=h_;function m_(e,t){return vp(e)?e:o_(e,t)?[e]:p_(Ff(e))}var f_=1/0;function g_(e){if("string"==typeof e||Mf(e))return e;var t=e+"";return"0"==t&&1/e==-f_?"-0":t}function v_(e,t){for(var n=0,i=(t=m_(t,e)).length;null!=e&&n<i;)e=e[g_(t[n++])];return n&&n==i?e:void 0}var __=1,y_=2;function b_(e){return e==e&&!yh(e)}function w_(e,t){return function(n){return null!=n&&(n[e]===t&&(void 0!==t||e in Object(n)))}}function x_(e){var t=function(e){for(var t=tm(e),n=t.length;n--;){var i=t[n],a=e[i];t[n]=[i,a,b_(a)]}return t}(e);return 1==t.length&&t[0][2]?w_(t[0][0],t[0][1]):function(n){return n===e||function(e,t,n,i){var a=n.length,r=a,s=!i;if(null==e)return!r;for(e=Object(e);a--;){var o=n[a];if(s&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<r;){var c=(o=n[a])[0],l=e[c],u=o[1];if(s&&o[2]){if(void 0===l&&!(c in e))return!1}else{var d=new qh;if(i)var h=i(l,u,c,e,t,d);if(!(void 0===h?Sm(u,l,__|y_,i,d):h))return!1}}return!0}(n,e,t)}}function k_(e,t,n){var i=null==e?void 0:v_(e,t);return void 0===i?n:i}function C_(e,t){return null!=e&&t in Object(e)}function M_(e,t){return null!=e&&function(e,t,n){for(var i=-1,a=(t=m_(t,e)).length,r=!1;++i<a;){var s=g_(t[i]);if(!(r=null!=e&&n(e,s)))break;e=e[s]}return r||++i!=a?r:!!(a=null==e?0:e.length)&&Rp(a)&&zp(s,a)&&(vp(e)||Ap(e))}(e,t,C_)}var E_=1,S_=2;function A_(e){return o_(e)?(t=g_(e),function(e){return null==e?void 0:e[t]}):function(e){return function(t){return v_(t,e)}}(e);var t}function T_(e){return"function"==typeof e?e:null==e?cf:"object"==typeof e?vp(e)?(t=e[0],n=e[1],o_(t)&&b_(n)?w_(g_(t),n):function(e){var i=k_(e,t);return void 0===i&&i===n?M_(e,t):Sm(n,i,E_|S_)}):x_(e):A_(e);var t,n}var $_=function(e,t){return function(n,i){if(null==n)return n;if(!em(n))return e(n,i);for(var a=n.length,r=t?a:-1,s=Object(n);(t?r--:++r<a)&&!1!==i(s[r],r,s););return n}}((function(e,t){return e&&Lm(e,t,tm)})),O_=$_;function I_(e,t){if(e!==t){var n=void 0!==e,i=null===e,a=e==e,r=Mf(e),s=void 0!==t,o=null===t,c=t==t,l=Mf(t);if(!o&&!l&&!r&&e>t||r&&s&&c&&!o&&!l||i&&s&&c||!n&&c||!a)return 1;if(!i&&!r&&!l&&e<t||l&&n&&a&&!i&&!r||o&&n&&a||!s&&a||!c)return-1}return 0}function L_(e,t,n){t=t.length?zf(t,(function(e){return vp(e)?function(t){return v_(t,1===e.length?e[0]:e)}:e})):[cf];var i=-1;t=zf(t,Pp(T_));var a=function(e,t){var n=-1,i=em(e)?Array(e.length):[];return O_(e,(function(e,a,r){i[++n]=t(e,a,r)})),i}(e,(function(e,n,a){return{criteria:zf(t,(function(t){return t(e)})),index:++i,value:e}}));return function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(a,(function(e,t){return function(e,t,n){for(var i=-1,a=e.criteria,r=t.criteria,s=a.length,o=n.length;++i<s;){var c=I_(a[i],r[i]);if(c)return i>=o?c:c*("desc"==n[i]?-1:1)}return e.index-t.index}(e,t,n)}))}function j_(e,t,n,i){return null==e?[]:(vp(t)||(t=null==t?[]:[t]),vp(n=i?void 0:n)||(n=null==n?[]:[n]),L_(e,t,n))}async function z_(e,t,n,i=!1){let a;try{a=await e.callWS(n)}catch(e){if(!(e instanceof Error))throw new Lo(Kv("error.failed_response"),{request:n,response:e});throw e}if(!a)throw new Lo(Kv("error.empty_response"),{request:n});const r=i?t.safeParse(JSON.parse(a)):t.safeParse(a);if(!r.success)throw new Lo(Kv("error.invalid_response"),{request:n,response:a,invalid_keys:No(r.error)});return r.data}const D_=yi.lazy((()=>yi.object({title:yi.string(),media_class:yi.string(),media_content_type:yi.string(),media_content_id:yi.string(),can_play:yi.boolean(),can_expand:yi.boolean(),children_media_class:yi.string().nullable().optional(),thumbnail:yi.string().nullable(),children:yi.array(D_).nullable().optional()}))),R_="video",N_="image",P_=60,F_=e=>j_(e,(e=>e._metadata?.startDate),"desc");class B_{async walkBrowseMedias(e,t,n){return t&&t.length?(await lg(t,(async t=>await this._walkBrowseMedia(e,t,n)))).flat():[]}async _walkBrowseMedia(e,t,n){let i=[];for(const a of function(e,t,n){t=(n?_f(e,t,n):void 0===t)?1:a_(jf(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var a=0,r=0,s=Array(i_(i/t));a<i;)s[r++]=n_(e,a,a+=t);return s}(t.targets,t.concurrency??1/0)){const r=await lg(a,(async i=>await this._browseMedia(e,i,{cache:n?.cache,metadataGenerator:t.metadataGenerator})));for(const e of r)for(const n of e.children??[])t.matcher(n)&&i.push(n);if(t.sorter&&(i=t.sorter(i)),t.earlyExit&&t.earlyExit(i))break}const a=t.advance?t.advance(i):null;return a?.length?await this.walkBrowseMedias(e,a,n):i}async _browseMedia(e,t,n){const i="object"==typeof t?t.media_content_id:t,a=n?.cache?n.cache.get(i):null;if(a)return a;const r={type:"media_source/browse_media",media_content_id:i},s=await z_(e,D_,r);if(n?.metadataGenerator)for(const e of s.children??[])e._metadata=n.metadataGenerator(e,"object"==typeof t?t:void 0)??void 0;return n?.cache&&n.cache.set(i,s,Xu(new Date,{seconds:60})),s}}function V_(e,t){return Sm(e,t)}function U_(e,t){return e&&e.length?function(e,t){for(var n=-1,i=e.length,a=0,r=[];++n<i;){var s=e[n],o=t?t(s):s;if(!n||!nh(o,c)){var c=o;r[a++]=0===s?0:s}}return r}(e,T_(t)):[]}class H_{constructor(e){this._ranges=e??[]}hasCoverage(e){return this._ranges.some((t=>W_(t,e)))}add(e){this._ranges.push(e),this._ranges=K_(this._ranges)}clear(){this._ranges=[]}}class q_{constructor(e){this._ranges=e??[]}hasCoverage(e){const t=new Date;return this._ranges.some((n=>t<n.expires&&W_(n,e)))}add(e){this._ranges.push(e),this._expireOldRanges()}_expireOldRanges(){const e=new Date;this._ranges=this._ranges.filter((t=>e<t.expires))}clear(){this._ranges=[]}}const W_=(e,t)=>t.start>=e.start&&t.end<=e.end,Z_=(e,t)=>e.start>=t.start&&e.start<=t.end||e.end>=t.start&&e.end<=t.end||e.start<=t.start&&e.end>=t.end,K_=(e,t=0)=>{const n=[];e=j_(e,(e=>e.start),"asc");let i=null;for(const a of e){const e=a.start instanceof Date?a.start.getTime():a.start;if(!i){i={...a};continue}(i.end instanceof Date?i.end.getTime():i.end)+1e3*t>=e?a.end>i.end&&(i.end=a.end):(n.push(i),i={...a})}return i&&n.push(i),n};class Y_{constructor(){this._data=[]}get(e){const t=new Date;for(const n of this._data)if((!n.expires||t<=n.expires)&&this._contains(e,n.request))return n.response;return null}clear(){this._data=[]}has(e){return!!this.get(e)}set(e,t,n){this._data.push({request:e,response:t,expires:n}),this._expireOldRequests()}_contains(e,t){return V_(e,t)}_expireOldRequests(){const e=new Date;this._data=this._data.filter((t=>!t.expires||e<t.expires))}}class Q_ extends Y_{}class G_{constructor(e,t){this._ranges=new H_,this._data=[],this._timeFunc=e,this._idFunc=t}add(e,t){this._ranges.add(e),this._data=U_(j_(this._data.concat(t),this._timeFunc,"asc"),this._idFunc)}hasCoverage(e){return this._ranges.hasCoverage(e)}get(e){if(!this.hasCoverage(e))return null;const t=[];for(const n of this._data){const i=this._timeFunc(n);if(i>=e.start.getTime()){if(i>e.end.getTime())break;t.push(n)}}return t}getSize(){return this._data.length}expireMatches(e){this._data=this._data.filter((t=>!e(t)))}}class X_{constructor(){this._segments=new Map}add(e,t,n){let i=this._segments.get(e);i||(i=new G_((e=>1e3*e.start_time),(e=>e.id)),this._segments.set(e,i)),i.add(t,n)}clear(){this._segments.clear()}hasCoverage(e,t){return!!this._segments.get(e)?.hasCoverage(t)}get(e,t){return this._segments.get(e)?.get(t)??null}getSize(e){return this._segments.get(e)?.getSize()??null}getCameraIDs(){return[...this._segments.keys()]}expireMatches(e,t){this._segments.get(e)?.expireMatches(t)}}class J_ extends Lo{}class ey extends Lo{}var ty,ny,iy;!function(e){e.Event="event-query",e.Recording="recording-query",e.RecordingSegments="recording-segments-query",e.MediaMetadata="media-metadata"}(ty||(ty={})),function(e){e.Event="event-results",e.Recording="recording-results",e.RecordingSegments="recording-segments-results",e.MediaMetadata="media-metadata-results"}(ny||(ny={})),function(e){e.Frigate="frigate",e.Generic="generic",e.MotionEye="motioneye",e.Reolink="reolink"}(iy||(iy={}));const ay=e=>e?.camera_entity??e?.webrtc_card?.entity??null;class ry{constructor(e){this._entityRegistryManager=e}async createEngine(e,t){let n;switch(e){case iy.Generic:const{GenericCameraManagerEngine:e}=await import("./engine-generic-6ee7c382.js").then((function(e){return e.e}));n=new e(t.stateWatcher,t.eventCallback);break;case iy.Frigate:const{FrigateCameraManagerEngine:i}=await import("./engine-frigate-44279fd3.js");n=new i(this._entityRegistryManager,t.stateWatcher,new X_,new Q_,t.eventCallback);break;case iy.MotionEye:const{MotionEyeCameraManagerEngine:a}=await import("./engine-motioneye-0a1361bc.js");n=new a(this._entityRegistryManager,t.stateWatcher,new B_,t.resolvedMediaCache,new Q_,t.eventCallback);break;case iy.Reolink:const{ReolinkCameraManagerEngine:r}=await import("./engine-reolink-aac435e8.js");n=new r(this._entityRegistryManager,t.stateWatcher,new B_,t.resolvedMediaCache,new Q_,t.eventCallback)}return n}async getEngineForCamera(e,t){let n=null;if("frigate"===t.engine)n=iy.Frigate;else if("motioneye"===t.engine)n=iy.MotionEye;else if("generic"===t.engine)n=iy.Generic;else if("reolink"===t.engine)n=iy.Reolink;else{const i=ay(t);if(i){const a=await this._entityRegistryManager.getEntity(e,i);if(!a){if(e.states[i])return iy.Generic;throw new J_(Kv("error.no_camera_entity"),t)}switch(a?.platform){case"frigate":n=iy.Frigate;break;case"motioneye":n=iy.MotionEye;break;case"reolink":n=iy.Reolink;break;default:n=iy.Generic}}else t.frigate.camera_name?n=iy.Frigate:(t.webrtc_card?.url||t.go2rtc?.url&&t.go2rtc?.stream)&&(n=iy.Generic)}return n}}class sy{constructor(){this._cameras=new Map,this._enginesByType=new Map}addCamera(e){this._cameras.set(e.getID(),e),this._enginesByType.set(e.getEngine().getEngineType(),e.getEngine())}async setCameras(e){for(const t of e){const e=this._cameras.get(t.getID());e!==t&&(this.addCamera(t),await(e?.destroy()))}for(const t of this._cameras.values())e.includes(t)||(await t.destroy(),this._cameras.delete(t.getID()))}async reset(){await lg(this._cameras.values(),(e=>e.destroy())),this._cameras.clear(),this._enginesByType.clear()}getCamera(e){return this._cameras.get(e)??null}getCameras(){return this._cameras}getCameraConfig(e){return this._cameras.get(e)?.getConfig()??null}hasCameraID(e){return this._cameras.has(e)}getCameraCount(){return this._cameras.size}getDefaultCameraID(){return this._cameras.keys().next().value??null}*getCameraConfigs(e){for(const[t,n]of this.getCameraConfigEntries(e))yield n}*getCameraConfigEntries(e){for(const t of e??this._cameras.keys()){const e=this.getCameraConfig(t);e&&(yield[t,e])}}getCameraIDs(){return new Set(this._cameras.keys())}getCameraIDsWithCapability(e){const t=new Set;for(const n of this._cameras.values())n.getCapabilities()?.matches(e)&&t.add(n.getID());return t}getCameraConfigForMedia(e){return this.getCameraConfig(e.getCameraID())}getEngineOfType(e){return this._enginesByType.get(e)??null}getEngineForCameraID(e){return this._cameras.get(e)?.getEngine()??null}getEnginesForCameraIDs(e){const t=new Map;for(const n of e){const e=this.getEngineForCameraID(n);e&&(t.has(e)||t.set(e,new Set),t.get(e)?.add(n))}return t.size?t:null}getEngineForMedia(e){return this.getEngineForCameraID(e.getCameraID())}getAllDependentCameras(e,t){const n=new Set,i=new Set,a=e=>{n.add(e);const r=this.getCamera(e),s=r?.getConfig();if(r&&s){t&&!r.getCapabilities()?.matches(t)||i.add(e);const o=new Set;s.dependencies.cameras.forEach((e=>o.add(e))),s.dependencies.all_cameras&&this.getCameraIDs().forEach((e=>o.add(e)));for(const e of o)n.has(e)||a(e)}};return a(e),i}}const oy=e=>{return j_((n=e=>e.getID()??e,(t=e)&&t.length?Qf(t,T_(n)):[]),(e=>e.getStartTime()??e.getID()),"asc");var t,n};class cy{static isEventQuery(e){return e.type===ty.Event}static isRecordingQuery(e){return e.type===ty.Recording}static isRecordingSegmentsQuery(e){return e.type===ty.RecordingSegments}static isMediaMetadataQuery(e){return e.type===ty.MediaMetadata}}class ly{static isEventQueryResult(e){return e.type===ny.Event}static isRecordingQueryResult(e){return e.type===ny.Recording}static isRecordingSegmentsQueryResult(e){return e.type===ny.RecordingSegments}static isMediaMetadataQueryResult(e){return e.type===ny.MediaMetadata}}class uy{constructor(e,t){this._requestLimit=new Av,this._api=e,this._engineFactory=t?.factory??new ry(this._api.getEntityRegistryManager()),this._store=t?.store??new sy}async initializeCamerasFromConfig(){const e=this._api.getConfigManager().getConfig(),t=this._api.getHASSManager().getHASS();if(!e||!t)return!1;this._requestLimit.concurrency=e.performance.features.max_simultaneous_engine_requests??1/0;const n=e.cameras.map((t=>{return n={},i=_v(e?.cameras_global),bf(n,i,t,((e,t)=>Array.isArray(t)?t:void 0));var n,i}));try{await this._initializeCameras(n)}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e,Kv("error.camera_initialization")),!1}return!0}async destroy(){await this._store.reset()}async _getEnginesForCameras(e){const t=new Map,n=new Map,i=this._api.getHASSManager().getHASS();
/* istanbul ignore if: the if path cannot be reached -- @preserve */
if(!i)return t;const a=await(async e=>await lg(e,(e=>this._engineFactory.getEngineForCamera(i,e))))(e);for(const[i,r]of e.entries()){const e=a[i],s=e?n.get(e)??await this._engineFactory.createEngine(e,{eventCallback:e=>this._api.getTriggersManager().handleCameraEvent(e),stateWatcher:this._api.getHASSManager().getStateWatcher(),resolvedMediaCache:this._api.getResolvedMediaCache()}):null;if(!s||!e)throw new J_(Kv("error.no_camera_engine"),_v(r));n.set(e,s),t.set(r,s)}return t}async _initializeCameras(e){const t=new Date,n=this._api.getHASSManager().getHASS();
/* istanbul ignore if: the if path cannot be reached -- @preserve */
if(!n)return;e.some((e=>(e=>e.triggers.motion||e.triggers.occupancy)(e)))&&await this._api.getEntityRegistryManager().fetchEntityList(n);const i=await this._getEnginesForCameras(e),a=await lg(i.entries(),(async([e,t])=>await t.createCamera(n,e))),r=async()=>{a.forEach((e=>e.destroy()))},s=new Set;for(const e of a){const t=Yv(e.getConfig());if(!t)throw await r(),new J_(Kv("error.no_camera_id"),e.getConfig());if(s.has(t))throw await r(),new J_(Kv("error.duplicate_camera_id"),e.getConfig());e.setID(t),s.add(t)}await this._store.setCameras(a),Qv(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager initialized (Cameras: ",this._store.getCameras(),`, Duration: ${((new Date).getTime()-t.getTime())/1e3}s,`,")")}isInitialized(){return this._store.getCameraCount()>0}getStore(){return this._store}generateDefaultEventQueries(e,t){return this._generateDefaultQueries(e,{type:ty.Event,...t})}generateDefaultRecordingQueries(e,t){return this._generateDefaultQueries(e,{type:ty.Recording,...t})}generateDefaultRecordingSegmentsQueries(e,t){return this._generateDefaultQueries(e,{type:ty.RecordingSegments,...t})}_generateDefaultQueries(e,t){const n=[],i=tg(e),a=this._store.getEnginesForCameraIDs(i);if(!a)return null;for(const[e,i]of a){let a=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */cy.isEventQuery(t)?a=e.generateDefaultEventQuery(this._store,i,t):cy.isRecordingQuery(t)?a=e.generateDefaultRecordingQuery(this._store,i,t):cy.isRecordingSegmentsQuery(t)&&(a=e.generateDefaultRecordingSegmentsQuery(this._store,i,t));for(const e of a??[])n.push(e)}return n.length?n:null}async getMediaMetadata(){const e=new Set,t=new Set,n=new Set,i=new Set,a={type:ty.MediaMetadata,cameraIDs:this._store.getCameraIDs()},r=await this._handleQuery(a);for(const a of r.values())a.metadata.tags&&a.metadata.tags.forEach(e.add,e),a.metadata.what&&a.metadata.what.forEach(t.add,t),a.metadata.where&&a.metadata.where.forEach(n.add,n),a.metadata.days&&a.metadata.days.forEach(i.add,i);return t.size||n.size||i.size||e.size?{...e.size&&{tags:e},...t.size&&{what:t},...n.size&&{where:n},...i.size&&{days:i}}:null}async getEvents(e,t){return await this._handleQuery(e,t)}async getRecordings(e,t){return await this._handleQuery(e,t)}async getRecordingSegments(e,t){return await this._handleQuery(e,t)}async executeMediaQueries(e,t){return this._convertQueryResultsToMedia(await this._handleQuery(e,t))}async extendMediaQueries(e,t,n,i){if(!this._api.getHASSManager().getHASS())return null;const a=e=>{let n=null;for(const i of t){const t=i.getStartTime();t&&(!n||"earliest"===e&&t<n||"latest"===e&&t>n)&&(n=t)}return n},r=this._api.getConfigManager().getCardWideConfig()?.performance?.features.media_chunk_size??50,s=[],o=[];for(const t of e){const e={...t};
/* istanbul ignore else: the else path cannot be reached -- @preserve */if("later"===n){const t=a("latest");t&&(e.start=t,delete e.end)}else if("earlier"===n){const t=a("earliest");t&&(e.end=t,delete e.start)}e.limit=r,o.push({...t,limit:(t.limit??0)+r}),s.push(e)}const c=this._convertQueryResultsToMedia(await this._handleQuery(s,i));if(!c.length)return null;const l=oy(t.concat(c));return l.length===t.length?null:{queries:o,results:l}}async getMediaDownloadPath(e){const t=this._store.getCameraConfigForMedia(e),n=this._store.getEngineForMedia(e),i=this._api.getHASSManager().getHASS();return t&&n&&i?await n.getMediaDownloadPath(i,t,e):null}getMediaCapabilities(e){const t=this._store.getEngineForMedia(e);return t?t.getMediaCapabilities(e):null}async favoriteMedia(e,t){const n=this._store.getCameraConfigForMedia(e),i=this._store.getEngineForMedia(e),a=this._api.getHASSManager().getHASS();if(!n||!i||!a)return;const r=new Date;await this._requestLimit.add((()=>i.favoriteMedia(a,n,e,t))),Qv(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager favorite request (",`Duration: ${((new Date).getTime()-r.getTime())/1e3}s,`,"Media:",e.getID(),", Favorite:",t,")")}areMediaQueriesResultsFresh(e,t){const n=new Date;for(const i of e){const e=this._store.getEnginesForCameraIDs(i.cameraIDs);for(const[a,r]of e??[]){const e=a.getQueryResultMaxAge({...i,cameraIDs:r});if(null!==e&&Xu(t,{seconds:e})<n)return!1}}return!0}async getMediaSeekTime(e,t){const n=e.getStartTime(),i=e.getEndTime(),a=this._store.getEngineForMedia(e),r=this._api.getHASSManager().getHASS();return!r||!a||!n||!i||t<n||t>i?null:await this._requestLimit.add((()=>a.getMediaSeekTime(r,this._store,e,t)))??null}async _handleQuery(e,t){const n=eg(e),i=new Map,a=new Date,r=this._api.getHASSManager().getHASS();if(!r)return i;const s=async(e,n)=>{let a=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */cy.isEventQuery(n)?a=await e.getEvents(r,this._store,n,t):cy.isRecordingQuery(n)?a=await e.getRecordings(r,this._store,n,t):cy.isRecordingSegmentsQuery(n)?a=await e.getRecordingSegments(r,this._store,n,t):cy.isMediaMetadataQuery(n)&&(a=await e.getMediaMetadata(r,this._store,n,t)),a?.forEach(((e,t)=>i.set(t,e)))},o=async e=>{const t=this._store.getEnginesForCameraIDs(e.cameraIDs);t&&await Promise.all(Array.from(t.keys()).map((n=>this._requestLimit.add((()=>s(n,{...e,cameraIDs:t.get(n)}))))))};await Promise.all(n.map((e=>o(e))));const c=(l=Array.from(i.values()).map((e=>Number(e.cached??0))))&&l.length?function(e,t){for(var n,i=-1,a=e.length;++i<a;){var r=t(e[i]);void 0!==r&&(n=void 0===n?r:n+r)}return n}(l,cf):0;var l;return Qv(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card CameraManager request [Input queries:",n.length,", Cached output queries:",c,", Total output queries:",i.size,", Duration:",((new Date).getTime()-a.getTime())/1e3+"s,",", Queries:",n,", Results:",i,", Options:",t??{},"]"),i}_convertQueryResultsToMedia(e){const t=[],n=this._api.getHASSManager().getHASS();if(!n)return t;for(const[i,a]of e.entries()){const e=this._store.getEngineOfType(a.engine);if(e){let r=null;
/* istanbul ignore else: the else path cannot be reached -- @preserve */cy.isEventQuery(i)&&ly.isEventQueryResult(a)?r=e.generateMediaFromEvents(n,this._store,i,a):cy.isRecordingQuery(i)&&ly.isRecordingQueryResult(a)&&(r=e.generateMediaFromRecordings(n,this._store,i,a)),r&&t.push(...r)}}return oy(t)}getCameraEndpoints(e,t){const n=this._store.getCameraConfig(e),i=this._store.getEngineForCameraID(e);return n&&i?i.getCameraEndpoints(n,t):null}getCameraMetadata(e){const t=this._store.getCameraConfig(e),n=this._store.getEngineForCameraID(e),i=this._api.getHASSManager().getHASS();return t&&n&&i?n.getCameraMetadata(i,t):null}getCameraCapabilities(e){return this._store.getCamera(e)?.getCapabilities()??null}getAggregateCameraCapabilities(e){const t=[...e??this._store.getCameraIDs()].map((e=>this._store.getCamera(e))).filter(mg);return new t_({live:t.some((e=>e.getCapabilities()?.has("live"))),clips:t.some((e=>e.getCapabilities()?.has("clips"))),recordings:t.some((e=>e.getCapabilities()?.has("recordings"))),snapshots:t.some((e=>e.getCapabilities()?.has("snapshots"))),"favorite-events":t.some((e=>e.getCapabilities()?.has("favorite-events"))),"favorite-recordings":t.some((e=>e.getCapabilities()?.has("favorite-recordings"))),seek:t.some((e=>e.getCapabilities()?.has("seek"))),menu:t.some((e=>e.getCapabilities()?.has("menu")))})}async executePTZAction(e,t,n){const i=this._store.getCameraConfig(e);if(!i)return;const a=Gv(i,t,n);if(a)return await this._api.getActionsManager().executeActions(a);const r=this._api.getHASSManager().getHASS(),s=this._store.getEngineForCameraID(e);return s&&r?await this._requestLimit.add((()=>s.executePTZAction(r,i,t,n))):void 0}}function dy(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=Of(n))==n?n:0),void 0!==t&&(t=(t=Of(t))==t?t:0),function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}(Of(e),t,n)}var hy=function(){return ch.Date.now()},py="Expected a function",my=Math.max,fy=Math.min;function gy(e,t,n){var i,a,r,s,o,c,l=0,u=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError(py);function p(t){var n=i,r=a;return i=a=void 0,l=t,s=e.apply(r,n)}function m(e){var n=e-c;return void 0===c||n>=t||n<0||d&&e-l>=r}function f(){var e=hy();if(m(e))return g(e);o=setTimeout(f,function(e){var n=t-(e-c);return d?fy(n,r-(e-l)):n}(e))}function g(e){return o=void 0,h&&i?p(e):(i=a=void 0,s)}function v(){var e=hy(),n=m(e);if(i=arguments,a=this,c=e,n){if(void 0===o)return function(e){return l=e,o=setTimeout(f,t),u?p(e):s}(c);if(d)return clearTimeout(o),o=setTimeout(f,t),p(c)}return void 0===o&&(o=setTimeout(f,t)),s}return t=Of(t)||0,yh(n)&&(u=!!n.leading,r=(d="maxWait"in n)?my(Of(n.maxWait)||0,t):r,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==o&&clearTimeout(o),l=0,i=c=a=o=void 0},v.flush=function(){return void 0===o?s:g(hy())},v}var vy=yf((function(e,t,n){of(e,t,n)}));function _y(e,t){return null==(e=function(e,t){return t.length<2?e:v_(e,n_(t,0,-1))}(e,t=m_(t,e)))||delete e[g_((n=t,i=null==n?0:n.length,i?n[i-1]:void 0))];var n,i}function yy(e,t,n){return null==e?e:function(e,t,n,i){if(!yh(e))return e;for(var a=-1,r=(t=m_(t,e)).length,s=r-1,o=e;null!=o&&++a<r;){var c=g_(t[a]),l=n;if("__proto__"===c||"constructor"===c||"prototype"===c)return e;if(a!=s){var u=o[c];void 0===(l=i?i(u,c,o):void 0)&&(l=yh(u)?u:zp(t[a+1])?[]:{})}ef(o,c,l),o=o[c]}return e}(e,t,n)}function by(e,t,n){var i=!0,a=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return yh(n)&&(i="leading"in n?!!n.leading:i,a="trailing"in n?!!n.trailing:a),gy(e,t,{leading:i,maxWait:t,trailing:a})}function wy(e,t){return t="function"==typeof t?t:void 0,e&&e.length?Qf(e,void 0,t):[]}class xy{constructor(){this._listeners=[],this._state={},this._callListeners=e=>{this._listeners.forEach((t=>t(e)))}}addListener(e){this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter((t=>t!==e))}getState(){return this._state}setState(e){this._processStateChange(this._calculateTrueChange(e))}_processStateChange(e){if(!Object.keys(e).length)return;const t=this._state;this._state={...t,...e},this._callListeners({old:t,change:e,new:this._state})}_calculateTrueChange(e){const t={};for(const n of Object.keys(e))V_(e[n],this._state[n])||(t[n]=e[n]);return t}}class ky{constructor(e){this._cache=new Map,this._keyCallback=e}has(e){return this._cache.has(e)}getMatches(e){return[...this._cache.values()].filter(e)}get(e){return this._cache.get(e)??null}add(e){const t=e=>this._cache.set(this._keyCallback(e),e);Array.isArray(e)?e.forEach(t):t(e)}}const Cy=yi.object({id:yi.string(),model:yi.string().nullable(),config_entries:yi.string().array(),manufacturer:yi.string().nullable()}).array();class My{constructor(e){this._fetchedDeviceList=!1,this._cache=e}async getDevice(e,t){return this._cache.has(t)?this._cache.get(t):(await this._fetchDeviceList(e),this._cache.get(t)??null)}async getMatchingDevices(e,t){return await this._fetchDeviceList(e),this._cache.getMatches(t)}async _fetchDeviceList(e){if(this._fetchedDeviceList)return;let t=null;try{t=await z_(e,Cy,{type:"config/device_registry/list"})}catch(e){return void ig(e)}this._cache.add(t),this._fetchedDeviceList=!0}}const Ey=yi.object({config_entry_id:yi.string().nullable(),device_id:yi.string().nullable(),disabled_by:yi.string().nullable(),entity_id:yi.string(),hidden_by:yi.string().nullable(),platform:yi.string(),translation_key:yi.string().nullable(),unique_id:yi.string().or(yi.number()).optional()}),Sy=Ey.array();class Ay{constructor(e){this._fetchedEntityList=!1,this._cache=e}async getEntity(e,t){const n=this._cache.get(t);if(n)return n;let i=null;try{i=await z_(e,Ey,{type:"config/entity_registry/get",entity_id:t})}catch(e){return ig(e),null}return this._cache.add(i),i}async getMatchingEntities(e,t){return await this.fetchEntityList(e),this._cache.getMatches(t)}async getEntities(e,t){const n=new Map;return await Promise.all(t.map((async t=>{const i=await this.getEntity(e,t);i&&n.set(t,i)}))),n}async fetchEntityList(e){if(this._fetchedEntityList)return;let t=null;try{t=await z_(e,Sy,{type:"config/entity_registry/list"})}catch(e){return void ig(e)}this._cache.add(t),this._fetchedEntityList=!0}}class Ty extends Map{constructor(e={}){if(super(),!(e.maxSize&&e.maxSize>0))throw new TypeError("`maxSize` must be a number greater than 0");if("number"==typeof e.maxAge&&0===e.maxAge)throw new TypeError("`maxAge` must be a number greater than 0");this.maxSize=e.maxSize,this.maxAge=e.maxAge||Number.POSITIVE_INFINITY,this.onEviction=e.onEviction,this.cache=new Map,this.oldCache=new Map,this._size=0}_emitEvictions(e){if("function"==typeof this.onEviction)for(const[t,n]of e)this.onEviction(t,n.value)}_deleteIfExpired(e,t){return"number"==typeof t.expiry&&t.expiry<=Date.now()&&("function"==typeof this.onEviction&&this.onEviction(e,t.value),this.delete(e))}_getOrDeleteIfExpired(e,t){if(!1===this._deleteIfExpired(e,t))return t.value}_getItemValue(e,t){return t.expiry?this._getOrDeleteIfExpired(e,t):t.value}_peek(e,t){const n=t.get(e);return this._getItemValue(e,n)}_set(e,t){this.cache.set(e,t),this._size++,this._size>=this.maxSize&&(this._size=0,this._emitEvictions(this.oldCache),this.oldCache=this.cache,this.cache=new Map)}_moveToRecent(e,t){this.oldCache.delete(e),this._set(e,t)}*_entriesAscending(){for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield e)}}for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield e)}}get(e){if(this.cache.has(e)){const t=this.cache.get(e);return this._getItemValue(e,t)}if(this.oldCache.has(e)){const t=this.oldCache.get(e);if(!1===this._deleteIfExpired(e,t))return this._moveToRecent(e,t),t.value}}set(e,t,{maxAge:n=this.maxAge}={}){const i="number"==typeof n&&n!==Number.POSITIVE_INFINITY?Date.now()+n:void 0;return this.cache.has(e)?this.cache.set(e,{value:t,expiry:i}):this._set(e,{value:t,expiry:i}),this}has(e){return this.cache.has(e)?!this._deleteIfExpired(e,this.cache.get(e)):!!this.oldCache.has(e)&&!this._deleteIfExpired(e,this.oldCache.get(e))}peek(e){return this.cache.has(e)?this._peek(e,this.cache):this.oldCache.has(e)?this._peek(e,this.oldCache):void 0}delete(e){const t=this.cache.delete(e);return t&&this._size--,this.oldCache.delete(e)||t}clear(){this.cache.clear(),this.oldCache.clear(),this._size=0}resize(e){if(!(e&&e>0))throw new TypeError("`maxSize` must be a number greater than 0");const t=[...this._entriesAscending()],n=t.length-e;n<0?(this.cache=new Map(t),this.oldCache=new Map,this._size=t.length):(n>0&&this._emitEvictions(t.slice(0,n)),this.oldCache=new Map(t.slice(n)),this.cache=new Map,this._size=0),this.maxSize=e}*keys(){for(const[e]of this)yield e}*values(){for(const[,e]of this)yield e}*[Symbol.iterator](){for(const e of this.cache){const[t,n]=e;!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}for(const e of this.oldCache){const[t,n]=e;if(!this.cache.has(t)){!1===this._deleteIfExpired(t,n)&&(yield[t,n.value])}}}*entriesDescending(){let e=[...this.cache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;!1===this._deleteIfExpired(i,a)&&(yield[i,a.value])}e=[...this.oldCache];for(let t=e.length-1;t>=0;--t){const n=e[t],[i,a]=n;if(!this.cache.has(i)){!1===this._deleteIfExpired(i,a)&&(yield[i,a.value])}}}*entriesAscending(){for(const[e,t]of this._entriesAscending())yield[e,t.value]}get size(){if(!this._size)return this.oldCache.size;let e=0;for(const t of this.oldCache.keys())this.cache.has(t)||e++;return Math.min(this._size+e,this.maxSize)}entries(){return this.entriesAscending()}forEach(e,t=this){for(const[n,i]of this.entriesAscending())e.call(t,i,n,this)}get[Symbol.toStringTag](){return JSON.stringify([...this.entriesAscending()])}}class $y{constructor(){this._cache=new Ty({maxSize:1e3})}has(e){return this._cache.has(e)}get(e){return this._cache.get(e)}set(e,t){this._cache.set(e,t)}}const Oy=async(e,t,n)=>{const i=n?n.get(t):void 0;if(i)return i;const a={type:"media_source/resolve_media",media_content_id:t};let r=null;try{r=await z_(e,zo,a)}catch(e){ig(e)}return n&&r&&n.set(t,r),r};class Iy{constructor(e,t,n){this._context=e,this._action=t,this._config=n}async execute(e){}async stop(){}}class Ly extends Iy{}class jy extends Ly{async execute(e){const t=this._action.camera??(this._action.triggered?e.getTriggersManager().getMostRecentlyTriggeredCameraID():null),n=e.getViewManager().getView(),i=e.getConfigManager().getConfig();if(t&&n){const a=i?.view.camera_select??"current",r="current"===a?n.view:a;await e.getViewManager().setViewByParametersWithNewQuery({params:{view:r,camera:t},failSafe:!0})}}}class zy extends Ly{async execute(e){e.getCameraURLManager().openURL()}}class Dy extends Ly{async execute(e){await e.getViewManager().setViewDefaultWithNewQuery()}}class Ry extends Ly{async execute(e){await e.getViewManager().setViewByParametersWithNewQuery({params:{displayMode:this._action.display_mode}})}}class Ny extends Ly{async execute(e){await e.getDownloadManager().downloadViewerMedia()}}class Py extends Ly{async execute(e){e.getExpandManager().toggleExpanded()}}class Fy extends Ly{async execute(e){e.getFullscreenManager().toggleFullscreen()}}class By extends Iy{async execute(e){const t=e.getHASSManager().getHASS();t&&nt(e.getCardElementManager().getElement(),t,this._config??{},this._action)}}class Vy extends Ly{async execute(e){console[this._action.level](this._action.message)}}const Uy=(e,t)=>e.context?.live?.overrides?.get(t??e.camera)??t??e.camera,Hy=e=>Uy(e)!==e.camera,qy=(e,t)=>{const n=e.context?.live?.overrides??new Map;n.set(e.camera,t),e.mergeInContext({live:{overrides:n}})};class Wy extends Ly{async execute(e){const t=this._action.media_player,n=e.getMediaPlayerManager(),i=e.getViewManager().getView(),a=i?.queryResults?.getSelectedResult()??null;"stop"===this._action.media_player_action?await n.stop(t):i?.is("live")?await n.playLive(t,Uy(i)):i?.isViewerView()&&a&&await n.playMedia(t,a)}}class Zy extends Ly{async execute(e){e.getCardElementManager().toggleMenu()}}class Ky extends Ly{async execute(e){await e.getMicrophoneManager().connect()}}class Yy extends Ly{async execute(e){e.getMicrophoneManager().disconnect()}}class Qy extends Ly{async execute(e){e.getMicrophoneManager().mute()}}class Gy extends Ly{async execute(e){await e.getMicrophoneManager().unmute()}}class Xy extends Ly{async execute(e){await(e.getMediaLoadedInfoManager().get()?.player?.mute())}}class Jy extends Ly{async execute(e){await(e.getMediaLoadedInfoManager().get()?.player?.pause())}}class eb extends Ly{async execute(e){await(e.getMediaLoadedInfoManager().get()?.player?.play())}}const tb=(e,t)=>{if(e.isViewerView()){const n=e.queryResults?.getSelectedResult()?.getID()??null;return"ptz"!==t?.type&&n?{targetID:n,type:"digital"}:null}if(e.is("live")){const n=Uy(e);let i="digital";return"digital"!==t?.type&&t?.cameraManager&&(nb(t.cameraManager,n)&&(i="ptz"),"ptz"!==i&&"ptz"===t?.type)?null:{targetID:n,type:i}}return e.is("image")?{targetID:Io,type:"digital"}:null},nb=(e,t)=>!!e.getStore().getCamera(t)?.getCapabilities()?.hasPTZCapability(),ib=(e,t)=>{t?.[e]?.inProgressAction?.stop()},ab=(e,t,n,i)=>{vy(t,{[n]:{[e]:{inProgressAction:i}}})};class rb extends Ly{constructor(){super(...arguments),this._timer=new Tg}async stop(){this._timer.stop()}async execute(e){const t=e.getViewManager().getView();if(!t)return;const n=this._action.camera??tb(t,{type:"ptz",cameraManager:e.getCameraManager()})?.targetID??null,i=n?e.getCameraManager().getCameraCapabilities(n)?.getPTZCapabilities():null,a=n?e.getCameraManager().getStore().getCameraConfig(n)?.ptz:null;if(!n||!i||!a)return;if(!this._action.ptz_action)return void(i.presets&&i.presets.length>=1&&await e.getCameraManager().executePTZAction(n,"preset",{phase:this._action.ptz_phase,preset:i.presets[0]}));const r=(e=>{switch(e){case"left":case"right":case"up":case"down":return e;case"zoom_in":return"zoomIn";case"zoom_out":return"zoomOut"}return null})(this._action.ptz_action);if(r&&i[r]?.includes(this._action.ptz_phase?"continuous":"relative")||"preset"===this._action.ptz_action)return await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{phase:this._action.ptz_phase,preset:this._action.ptz_preset});if("start"===this._action.ptz_phase){ib(n,this._context.ptz),ab(n,this._context,"ptz",this);const t=async()=>{this._action.ptz_action&&await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset}),this._timer.start(a.r2c_delay_between_calls_seconds,t)};await t()}else"stop"===this._action.ptz_phase?ib(n,this._context.ptz):(await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset,phase:"start"}),this._timer.start(a.c2r_delay_between_calls_seconds,(async()=>{this._action.ptz_action&&await e.getCameraManager().executePTZAction(n,this._action.ptz_action,{preset:this._action.ptz_preset,phase:"stop"})})))}}class sb extends Ly{async execute(e){e.getViewManager().setViewWithMergedContext({ptzControls:{enabled:this._action.enabled}})}}const ob=50,cb=50,lb=1,ub=4,db=e=>void 0===e?.pan?.x&&void 0===e?.pan?.y&&void 0===e?.zoom;class hb{constructor(e){this._context=e}modify(e){e.mergeInContext(this._context)}}const pb=(e,t)=>({zoom:{[e]:{observed:t?.observed??void 0,requested:t?.requested??null}}}),mb=(e,t,n)=>{t&&n&&t.setViewByParameters({modifiers:[new hb(pb(n,{observed:e.detail}))]})};class fb extends Ly{constructor(){super(...arguments),this._timer=new Tg}async _stepChange(e,t){e.getViewManager().setViewWithMergedContext(pb(t,{requested:this._convertActionToZoomSettings(e.getViewManager().getView()?.context?.zoom?.[t]?.observed)}))}async stop(){this._timer.stop()}async execute(e){const t=e.getViewManager().getView();if(!t)return;const n=this._action.target_id??tb(t,{type:"digital",cameraManager:e.getCameraManager()})?.targetID;return n?this._action.absolute||!this._action.ptz_phase?await this._stepChange(e,n):
/* istanbul ignore else: the else path cannot be reached -- @preserve */
void("start"===this._action.ptz_phase?(ib(n,this._context.ptzDigital),ab(n,this._context,"ptzDigital",this),await this._stepChange(e,n),this._timer.startRepeated(.1,(()=>this._stepChange(e,n)))):"stop"===this._action.ptz_phase&&(ib(n,this._context.ptzDigital),delete this._context.ptzDigital?.[n])):void 0}_convertActionToZoomSettings(e){if(!this._action.absolute&&!this._action.ptz_action)return{};if(this._action.absolute)return this._action.absolute;const t=e?.zoom??1,n=e?.pan?.x??50,i=e?.pan?.y??50,a="zoom_in"===this._action.ptz_action?.1:"zoom_out"===this._action.ptz_action?-.1:0,r="left"===this._action.ptz_action?-5:"right"===this._action.ptz_action?5:0,s="up"===this._action.ptz_action?-5:"down"===this._action.ptz_action?5:0;return{zoom:dy(t+a,1,10),pan:{x:dy(n+r,0,100),y:dy(i+s,0,100)}}}}class gb extends Ly{async execute(e){const t=e.getViewManager().getView();let n=null,i=null;if(this._action.target_id)n=this._action.target_id,i=nb(e.getCameraManager(),n)?"ptz":"digital";else if(t){const a=tb(t,{cameraManager:e.getCameraManager()});n=a?.targetID??null,i=a?.type??null}n&&null!==i&&("ptz"===i?this._toPTZAction(n):this._toPTZDigitalAction(n)).execute(e)}_toPTZAction(e){return new rb(this._context,(t={cardID:this._action.card_id,cameraID:e,ptzAction:this._action.ptz_action,ptzPhase:this._action.ptz_phase,ptzPreset:this._action.ptz_preset},{action:"fire-dom-event",advanced_camera_card_action:"ptz",...t?.cardID&&{card_id:t.cardID},...t?.ptzAction&&{ptz_action:t.ptzAction},...t?.ptzPhase&&{ptz_phase:t.ptzPhase},...t?.ptzPreset&&{ptz_preset:t.ptzPreset},...t?.cameraID&&{camera:t.cameraID}}),this._config);var t}_toPTZDigitalAction(e){return new fb(this._context,(t={cardID:this._action.card_id,ptzPhase:this._action.ptz_phase,ptzAction:this._action.ptz_action,targetID:e},{action:"fire-dom-event",advanced_camera_card_action:"ptz_digital",...t?.cardID&&{card_id:t.cardID},...t?.ptzAction&&{ptz_action:t.ptzAction},...t?.ptzPhase&&{ptz_phase:t.ptzPhase},...t?.absolute&&{absolute:t.absolute},...t?.targetID&&{target_id:t.targetID}}),this._config);var t}}class vb extends Ly{async execute(e){await e.getDownloadManager().downloadScreenshot()}}class _b extends Ly{async execute(e){var t;await dg((t=this._action.duration,3600*(t.h??0)+60*(t.m??0)+(t.s??0)+(t.ms??0)/1e3))}}class yb extends Ly{async execute(e){switch(this._action.status_bar_action){case"reset":e.getStatusBarItemManager().removeAllDynamicStatusBarItems();break;case"add":this._action.items?.forEach((t=>e.getStatusBarItemManager().addDynamicStatusBarItem(t)));break;case"remove":this._action.items?.forEach((t=>e.getStatusBarItemManager().removeDynamicStatusBarItem(t)))}}}class bb{modify(e){(e=>{const t=e.context?.live?.overrides;t&&t.has(e.camera)&&e.context?.live?.overrides?.delete(e.camera)})(e)}}class wb extends Ly{async execute(e){e.getViewManager().setViewByParameters({modifiers:[new bb]})}}class xb{constructor(e){this._api=e}modify(e){const t=[...this._api.getCameraManager().getStore().getAllDependentCameras(e.camera,"substream")];if(t.length<=1)return;const n=Uy(e),i=t.indexOf(n),a=i<0?0:(i+1)%t.length;qy(e,t[a])}}class kb extends Ly{async execute(e){e.getViewManager().setViewByParameters({modifiers:[new xb(e)]})}}class Cb{constructor(e){this._substreamID=e}modify(e){qy(e,this._substreamID)}}class Mb extends Ly{async execute(e){e.getViewManager().setViewByParameters({modifiers:[new Cb(this._action.camera)]})}}class Eb extends Ly{async execute(e){await(e.getMediaLoadedInfoManager().get()?.player?.unmute())}}class Sb extends Ly{async execute(e){await e.getViewManager().setViewByParametersWithNewQuery({params:{view:this._action.advanced_camera_card_action}})}}class Ab{createAction(e,t,n){const i=wg(t);if("fire-dom-event"!==t.action||!i)return new By(e,t,n?.config);if(i.card_id&&i.card_id!==n?.cardID)return null;switch(i.advanced_camera_card_action){case"default":return new Dy(e,i,n?.config);case"clip":case"clips":case"image":case"live":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":case"diagnostics":return new Sb(e,i,n?.config);case"sleep":return new _b(e,i,n?.config);case"download":return new Ny(e,i,n?.config);case"camera_ui":return new zy(e,i,n?.config);case"expand":return new Py(e,i,n?.config);case"fullscreen":return new Fy(e,i,n?.config);case"menu_toggle":return new Zy(e,i,n?.config);case"camera_select":return new jy(e,i,n?.config);case"live_substream_select":return new Mb(e,i,n?.config);case"live_substream_off":return new wb(e,i,n?.config);case"live_substream_on":return new kb(e,i,n?.config);case"media_player":return new Wy(e,i,n?.config);case"microphone_connect":return new Ky(e,i,n?.config);case"microphone_disconnect":return new Yy(e,i,n?.config);case"microphone_mute":return new Qy(e,i,n?.config);case"microphone_unmute":return new Gy(e,i,n?.config);case"mute":return new Xy(e,i,n?.config);case"unmute":return new Eb(e,i,n?.config);case"play":return new eb(e,i,n?.config);case"pause":return new Jy(e,i,n?.config);case"screenshot":return new vb(e,i,n?.config);case"display_mode_select":return new Ry(e,i,n?.config);case"ptz":return new rb(e,i,n?.config);case"ptz_digital":return new fb(e,i,n?.config);case"ptz_multi":return new gb(e,i,n?.config);case"ptz_controls":return new sb(e,i,n?.config);case"log":return new Vy(e,i,n?.config);case"status_bar":return new yb(e,i,n?.config)}
/* istanbul ignore next: this path cannot be reached -- @preserve */
/* istanbul ignore next: this path cannot be reached -- @preserve */
return console.warn(`Advanced Camera Card received unknown card action: ${i.advanced_camera_card_action}`),null}}class Tb{constructor(e,t,n){this._actions=[],this._factory=new Ab,this._stopped=!1,this._context=e;for(const i of eg(t)){const t=this._factory.createAction(e,i,n);t&&this._actions.push(t)}}async execute(e){for(const t of this._actions){if(this._stopped)break;await t.execute(e)}}async stop(){this._stopped=!0}}const $b=yi.object({action:yi.enum(["tap","double_tap","hold","start_tap","end_tap"])}),Ob=yi.object({detail:$b});class Ib{constructor(e,t){this._actionsInFlight=[],this._actionContext={},this.handleInteractionEvent=e=>{const t=Ob.safeParse(e);if(!t.success)return;const n=t.data.detail.action,i=this.getMergedActions(),a=Eg(n,i);i&&n&&a&&this.executeActions(a,{config:i})},this.handleCustomActionEvent=e=>{"detail"in e&&this.executeActions(e.detail)},this.handleActionExecutionRequestEvent=async e=>{await this.executeActions(e.detail.action,{config:e.detail.config})},this._api=e,this._templateRenderer=t??null}getMergedActions(){const e=this._api.getViewManager().getView();if(this._api.getMessageManager().hasMessage())return{};const t=this._api.getConfigManager().getConfig();let n;if(e?.is("live"))n=t?.live.actions;else if(e?.isGalleryView())n=t?.media_gallery?.actions;else if(e?.isViewerView())n=t?.media_viewer.actions;else{if(!e?.is("image"))return{};n=t?.image?.actions}return{...t?.view.actions,...n}}uninitialize(){this._actionsInFlight.forEach((e=>e.stop()))}async executeActions(e,t){const n=this._api.getHASSManager().getHASS(),i=n&&this._templateRenderer?this._templateRenderer.renderRecursively(n,e,{conditionState:this._api.getConditionStateManager().getState(),triggerData:t?.triggerData}):e,a=new Tb(this._actionContext,i,{config:t?.config,cardID:this._api.getConfigManager().getConfig()?.card_id});this._actionsInFlight.push(a),await a.execute(this._api),this._actionsInFlight=this._actionsInFlight.filter((e=>e!==a))}}class Lb{constructor(e,t){this._listeners=[],this._mediaQueries=[],this._hasHAStateConditions=!1,this._evaluation={result:!1},this._mediaQueryHandler=()=>this._evaluate(),this._stateManagerHandler=e=>{1===Object.keys(e.change).length&&"state"in e.change&&!this._hasHAStateConditions||this._evaluate({stateChange:e})},this._conditions=e,this._hasHAStateConditions=e.some((e=>!e.condition||["state","numeric_state","user"].includes(e.condition))),e.forEach((e=>{if("screen"===e.condition){const t=window.matchMedia(e.media_query);t.addEventListener("change",this._mediaQueryHandler),this._mediaQueries.push(t)}})),this._stateManager=t??null,this._evaluate({callListeners:!1}),this._stateManager?.addListener(this._stateManagerHandler)}destroy(){this._stateManager?.removeListener(this._stateManagerHandler),this._listeners.forEach((e=>this.removeListener(e))),this._mediaQueries.forEach((e=>e.removeEventListener("change",this._mediaQueryHandler))),this._mediaQueries=[],this._conditions=[]}addListener(e){this._listeners.includes(e)||this._listeners.push(e)}removeListener(e){this._listeners=this._listeners.filter((t=>t!==e))}getEvaluation(){return this._evaluation}_evaluate(e){const t=e?.stateChange?.new??this._stateManager?.getState();let n=!0,i={};for(const a of this._conditions){const r=this._evaluateCondition(a,t,e?.stateChange?.old);if(!r.result){n=!1;break}i={...i,...r.data}}const a=n?{result:n,data:i}:{result:n};V_(a,this._evaluation)||(this._evaluation=a,(e?.callListeners??1)&&this._listeners.forEach((e=>this._evaluation&&e(this._evaluation))))}_evaluateCondition(e,t,n){switch(e.condition){case void 0:case"state":return{result:!!t?.state&&(!e.state&&!e.state_not||e.entity in t.state&&(!e.state||(Array.isArray(e.state)?e.state.includes(t.state[e.entity].state):e.state===t.state[e.entity].state))&&(!e.state_not||(Array.isArray(e.state_not)?!e.state_not.includes(t.state[e.entity].state):e.state_not!==t.state[e.entity].state))),data:{state:{entity:e.entity,...n?.state?.[e.entity]?.state&&{from:n?.state?.[e.entity]?.state},...t?.state?.[e.entity]?.state&&{to:t?.state?.[e.entity]?.state}}}};case"view":return{result:!!t?.view&&e.views?.includes(t.view)||t?.view!==n?.view&&!e.views?.length,data:{...(n?.view||t?.view)&&{view:{...n?.view&&{from:n.view},...t?.view&&{to:t.view}}}}};case"fullscreen":return{result:void 0!==t?.fullscreen&&e.fullscreen===t.fullscreen};case"expand":return{result:void 0!==t?.expand&&e.expand===t.expand};case"camera":return{result:!!t?.camera&&!!e.cameras?.includes(t.camera)||t?.camera!==n?.camera&&!e.cameras?.length,data:{...(n?.camera||t?.camera)&&{camera:{...n?.camera&&{from:n?.camera},...t?.camera&&{to:t?.camera}}}}};case"numeric_state":return{result:!!t?.state&&e.entity in t.state&&void 0!==t.state[e.entity].state&&(void 0===e.above||Number(t.state[e.entity].state)>e.above)&&(void 0===e.below||Number(t.state[e.entity].state)<e.below)};case"user":return{result:!!t?.user&&e.users.includes(t.user.id)};case"media_loaded":return{result:void 0!==t?.mediaLoadedInfo&&e.media_loaded===!!t.mediaLoadedInfo};case"screen":return{result:window.matchMedia(e.media_query).matches};case"display_mode":return{result:!!t?.displayMode&&e.display_mode===t.displayMode};case"triggered":return{result:e.triggered.some((e=>t?.triggered?.has(e)))};case"interaction":return{result:void 0!==t?.interaction&&e.interaction===t.interaction};case"microphone":return{result:!(void 0!==e.connected&&t?.microphone?.connected!==e.connected||void 0!==e.muted&&t?.microphone?.muted!==e.muted)};case"key":return{result:!(!t?.keys||!(e.key in t.keys)||(e.state??"down")!==t.keys[e.key].state||void 0!==e.ctrl&&e.ctrl!==!!t.keys[e.key].ctrl||void 0!==e.alt&&e.alt!==!!t.keys[e.key].alt||void 0!==e.meta&&e.meta!==!!t.keys[e.key].meta||void 0!==e.shift&&e.shift!==!!t.keys[e.key].shift)};case"user_agent":return{result:!!t?.userAgent&&(!e.user_agent||e.user_agent===t.userAgent)&&(void 0===e.companion||e.companion===(i=t.userAgent,!!i.match(/Home ?Assistant/)))&&(void 0===e.user_agent_re||new RegExp(e.user_agent_re).test(t.userAgent))}}var i}}class jb{constructor(e){this._automations=new Map,this._nestedAutomationExecutions=0,this._api=e}deleteAutomations(e){for(const[t,n]of this._automations)t.tag===e&&(this._automations.delete(t),n.destroy())}addAutomations(e){for(const t of e){const e=new Lb(t.conditions,this._api.getConditionStateManager());e.addListener((e=>this._execute(t,e))),this._automations.set(t,e)}}_execute(e,t){if(!this._api.getHASSManager().hasHASS()||!this._api.getInitializationManager().isInitializedMandatory()||this._api.getMessageManager().hasErrorMessage())return;const n=t.result?e.actions:e.actions_not;if(!n?.length)return;(async e=>{++this._nestedAutomationExecutions,this._nestedAutomationExecutions>10?this._api.getMessageManager().setMessageIfHigherPriority({type:"error",message:Kv("error.too_many_automations")}):(await this._api.getActionsManager().executeActions(e,{triggerData:t.data}),--this._nestedAutomationExecutions)})(n)}}class zb{constructor(e){this._api=e}openURL(){const e=this.getCameraURL();e&&window.open(e)}hasCameraURL(){return!!this.getCameraURL()}getCameraURL(){const e=this._api.getViewManager().getView(),t=e?.queryResults?.getSelectedResult()??null,n=e?.camera?this._api.getCameraManager().getCameraEndpoints(e.camera,{view:e.view,...t&&{media:t}})??null:null;return n?.ui?.endpoint??null}}const Db=()=>!!navigator.userAgent.match(/CrKey\//);async function Rb(e,t,n){const i={type:"auth/sign_path",path:t,expires:n},a=await z_(e,Do,i);return a?e.hassUrl(a.path):null}function Nb(e,t,n,i){if(!e||!n||!n.length)return[];const a=[];for(const r of n){const n=t?.states[r],s=e.states[r];if((i?.stateOnly&&n?.state!==s?.state||!i?.stateOnly&&n!==s)&&(a.push({entityID:r,oldState:n,newState:s}),i?.firstOnly))break}return a}function Pb(e,t,n,i){return!!Nb(e,t,n,{...i,firstOnly:!0}).length}function Fb(e,t){return t?e?.states[t]?.attributes?.friendly_name??null:null}const Bb=async()=>{if(["ha-button-menu","ha-button","ha-camera-stream","ha-card","ha-circular-progress","ha-combo-box","ha-hls-player","ha-icon-button","ha-icon","ha-menu-button","ha-selector","ha-state-icon","ha-web-rtc-player","mwc-button","mwc-list-item","state-badge"].every((e=>customElements.get(e))))return!0;const e=await window.loadCardHelpers();await e.createCardElement({type:"picture-glance",entities:[],camera_image:"dummy-to-load-editor-components"}),await customElements.whenDefined("hui-picture-glance-card");const t=customElements.get("hui-picture-glance-card");if(!t)return!1;const n=new t;return await n.constructor.getConfigElement(),!0},Vb=e=>!!e&&["on","open"].includes(e),Ub=(e,t)=>{if(!e)return[];const n=Object.keys(e.states).filter((e=>!t||e.substr(0,e.indexOf("."))===t));return n.sort(),n};function Hb(e){return!!e?.startsWith("/")}function qb(e,t){return Hb(t)?e.hassUrl(t):t??null}const Wb=(e,t)=>!!((e.attributes.supported_features??0)&t);class Zb{constructor(){this._initialized=new Set}async initializeMultipleIfNecessary(e){return(await lg(Object.entries(e),(async([e,t])=>await this.initializeIfNecessary(e,t)))).every(Boolean)}async initializeIfNecessary(e,t){return!!this._initialized.has(e)||(t?!!await t()&&(this._initialized.add(e),!0):(this._initialized.add(e),!0))}uninitialize(e){this._initialized.delete(e)}isInitialized(e){return this._initialized.has(e)}isInitializedMultiple(e){return e.every((e=>this.isInitialized(e)))}}var Kb;!function(e){e.LANGUAGES="languages",e.SIDE_LOAD_ELEMENTS="side-load-elements",e.CAMERAS="cameras",e.MICROPHONE_CONNECT="microphone-connect",e.VIEW="view"}(Kb||(Kb={}));class Yb{constructor(e,t){this._initializationQueue=new Av({concurrency:1}),this._everInitialized=!1,this._api=e,this._initializer=t??new Zb}wasEverInitialized(){return this._everInitialized}isInitializedMandatory(){return!!this._api.getConfigManager().getConfig()&&this._initializer.isInitializedMultiple([Kb.LANGUAGES,Kb.SIDE_LOAD_ELEMENTS,Kb.CAMERAS,...this._api.getMicrophoneManager().shouldConnectOnInitialization()?[Kb.MICROPHONE_CONNECT]:[],Kb.VIEW])}async initializeMandatory(){await this._initializationQueue.add((()=>this._initializeMandatory()))}async _initializeMandatory(){const e=this._api.getHASSManager().getHASS();if(!e||this.isInitializedMandatory())return;if(!await this._initializer.initializeMultipleIfNecessary({[Kb.LANGUAGES]:async()=>await(async e=>{const t=Zv(e);return"ca"===t?qv[t]=await import("./lang-ca-fa11ff49.js"):"it"===t?qv[t]=await import("./lang-it-32dff42e.js"):"pt"===t?qv[t]=await import("./lang-pt-PT-ee20d920.js"):"pt_BR"===t?qv[t]=await import("./lang-pt-BR-4b00e70c.js"):"fr"===t&&(qv[t]=await import("./lang-fr-f4373d96.js")),t&&(Wv=t),!0})(e),[Kb.SIDE_LOAD_ELEMENTS]:async()=>await Bb()}))return;this._api.getConfigManager().getConfig()&&await this._initializer.initializeMultipleIfNecessary({[Kb.CAMERAS]:async()=>(this._api.createCameraManager(),await this._api.getCameraManager().initializeCamerasFromConfig()),...this._api.getMicrophoneManager().shouldConnectOnInitialization()&&{[Kb.MICROPHONE_CONNECT]:async()=>(this._api.createMicrophoneManager(),await this._api.getMicrophoneManager().connect())}})&&!this._api.getMessageManager().hasMessage()&&await this._initializer.initializeIfNecessary(Kb.VIEW,this._api.getViewManager().initialize)&&(this._everInitialized=!0,this._api.getCardElementManager().update())}uninitialize(e){this._initializer.uninitialize(e)}}class Qb{constructor(e,t,n,i){this.update=()=>{this._element.requestUpdate()},this._api=e,this._element=t,this._scrollCallback=n,this._menuToggleCallback=i}getElement(){return this._element}scrollReset(){this._scrollCallback()}toggleMenu(){this._menuToggleCallback()}hasUpdated(){return this._element.hasUpdated}elementConnected(){this._api.getInteractionManager().initialize(),this._api.getFullscreenManager().initialize(),this._api.getExpandManager().initialize(),this._api.getMediaLoadedInfoManager().initialize(),this._api.getMicrophoneManager().initialize(),this._api.getKeyboardStateManager().initialize(),this._api.getDefaultManager().initialize(),this._api.getMediaPlayerManager().initialize(),this._api.getHASSManager().getStateWatcher()?.subscribe(this.update,[...this._api.getConfigManager().getConfig()?.view.render_entities??[],...this._api.getMediaPlayerManager().getMediaPlayers()??[]]),pg(this._element,(e=>{const t=e.getRootNode();return!!(t&&t instanceof ShadowRoot&&"HUI-PANEL-VIEW"===t.host.tagName)})(this._element),"panel"),pg(this._element,Db(),"casted"),this._api.getFullscreenManager().connect(),this._element.addEventListener("mousemove",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("wheel",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("ll-custom",this._api.getActionsManager().handleCustomActionEvent),this._element.addEventListener("action",this._api.getActionsManager().handleInteractionEvent),this._element.addEventListener("action",this._api.getInteractionManager().reportInteraction),this._element.addEventListener("advanced-camera-card:action:execution-request",this._api.getActionsManager().handleActionExecutionRequestEvent),window.addEventListener("location-changed",this._api.getQueryStringManager().requestExecution),window.addEventListener("popstate",this._api.getQueryStringManager().requestExecution),this._api.getConditionStateManager()?.setState({userAgent:navigator.userAgent}),this._api.getQueryStringManager().requestExecution(),this._element.requestUpdate()}elementDisconnected(){pg(this._element,!1,"panel"),pg(this._element,!1,"tabindex"),pg(this._element,!1,"casted"),this._api.getMediaLoadedInfoManager().clear(),this._api.getFullscreenManager().disconnect(),this._api.getKeyboardStateManager().uninitialize(),this._api.getActionsManager().uninitialize(),this._api.getDefaultManager().uninitialize(),this._api.getHASSManager().getStateWatcher()?.unsubscribe(this.update),this._api.getInitializationManager().uninitialize(Kb.CAMERAS),this._api.getCameraManager().destroy(),this._element.removeEventListener("mousemove",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("wheel",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("ll-custom",this._api.getActionsManager().handleCustomActionEvent),this._element.removeEventListener("action",this._api.getActionsManager().handleInteractionEvent),this._element.removeEventListener("action",this._api.getInteractionManager().reportInteraction),this._element.removeEventListener("advanced-camera-card:action:execution-request",this._api.getActionsManager().handleActionExecutionRequestEvent),window.removeEventListener("location-changed",this._api.getQueryStringManager().requestExecution),window.removeEventListener("popstate",this._api.getQueryStringManager().requestExecution)}}const Gb=(e,t,n)=>{yy(e,t,n)},Xb=(e,t,n)=>k_(e,t,n),Jb=(e,t)=>{!function(e,t){null==e||_y(e,t)}(e,t)},ew=e=>_v(e),tw=(e,t)=>e.replace("#",`[${t.toString()}]`),nw=function(e){let t=!1;for(let n=0;n<mw.length;n++)t=mw[n](e)||t;return t},iw=function(e){return nw(ew(e))},aw=function(e,t,n){return function(i){return((e,t,n,i)=>{const a=Xb(e,t);if(void 0===a)return!1;const r=i?.transform?i.transform(a):a;return!(t===n&&V_(a,r)||(null===r?i?.keepOriginal||(Jb(e,t),0):void 0===r||(i?.keepOriginal||Jb(e,t),Gb(e,n,r),0)))})(i,e,t,n)}},rw=function(e,t,n){return function(i){let a=aw(e,t,n)(i);return a=cw(wo,aw(e,t,n),(e=>e.merge&&"object"==typeof e.merge?e.merge:void 0))(i)||a,a=cw(wo,aw(e,t,n),(e=>e.set&&"object"==typeof e.set?e.set:void 0))(i)||a,a}},sw=function(e,t){return rw(e,e,{transform:t})},ow=function(e){return rw(e,e,{transform:e=>null})},cw=function(e,t,n){return function(i){let a=!1;const r=Xb(i,e);return Array.isArray(r)&&r.forEach((e=>{const i=n?n(e):e;i&&"object"==typeof i&&(a=t(i)||a)})),a}},lw=(e,t)=>{const n=i=>{let a=!1;if(i&&"object"==typeof i){const r=t?t(i):i;r&&(a=e(r)||a),Array.isArray(i)?i.forEach((e=>{a=n(e)||a})):Object.keys(i).forEach((e=>{a=n(i[e])||a}))}return a};return n},uw=e=>{if("object"!=typeof e||!e||"object"!=typeof e.conditions||!e.conditions)return!1;const t=e.conditions,n=[];if(void 0!==t.view&&n.push({condition:"view",views:t.view}),void 0!==t.fullscreen&&n.push({condition:"fullscreen",fullscreen:t.fullscreen}),void 0!==t.expand&&n.push({condition:"expand",expand:t.expand}),void 0!==t.camera&&n.push({condition:"camera",cameras:t.camera}),void 0!==t.media_loaded&&n.push({condition:"media_loaded",media_loaded:t.media_loaded}),void 0!==t.state&&Array.isArray(t.state))for(const e of t.state)"object"!=typeof e||!e||void 0===e.state&&void 0===e.state_not&&void 0===e.entity||n.push({condition:"state",...e.state&&{state:e.state},...e.state_not&&{state_not:e.state_not},...e.entity&&{entity:e.entity}});return void 0!==t.media_query&&n.push({condition:"screen",media_query:t.media_query}),!!n.length&&(e.conditions=n,!0)},dw=e=>!("object"!=typeof e||!e||"call-service"!==e.action||"string"!=typeof e.service)&&(e.action="perform-action",e.perform_action=e.service,delete e.service,!0),hw=e=>!("object"!=typeof e||!e||"call-service"!==e.action||void 0===e.service||void 0===e.service_data||void 0!==e.data)&&(e.data=e.service_data,delete e.service_data,!0),pw=e=>{const t=[{oldKey:"type",oldValue:"custom:frigate-card",newValue:"custom:advanced-camera-card"},{oldKey:"action",oldValue:"custom:frigate-card-action",newValue:"custom:advanced-camera-card-action"},{oldKey:"type",oldValue:"custom:frigate-card-menu-icon",newValue:"custom:advanced-camera-card-menu-icon"},{oldKey:"type",oldValue:"custom:frigate-card-menu-state-icon",newValue:"custom:advanced-camera-card-menu-state-icon"},{oldKey:"type",oldValue:"custom:frigate-card-menu-submenu",newValue:"custom:advanced-camera-card-menu-submenu"},{oldKey:"type",oldValue:"custom:frigate-card-menu-submenu-select",newValue:"custom:advanced-camera-card-menu-submenu-select"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-icon",newValue:"custom:advanced-camera-card-status-bar-icon"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-image",newValue:"custom:advanced-camera-card-status-bar-image"},{oldKey:"type",oldValue:"custom:frigate-card-status-bar-string",newValue:"custom:advanced-camera-card-status-bar-string"},{oldKey:"type",oldValue:"custom:frigate-card-conditional",newValue:"custom:advanced-camera-card-conditional"},{oldKey:"type",oldValue:"custom:frigate-card-conditional",newValue:"custom:advanced-camera-card-conditional"},{oldKey:"frigate_card_action",newKey:"advanced_camera_card_action"}];let n=!1;for(const i of t)i.oldValue&&i.newValue&&e[i.oldKey]===i.oldValue&&(e[i.newKey??i.oldKey]=i.newValue,n=!0),i.oldKey in e&&i.newKey&&(e[i.newKey]=e[i.oldKey],delete e[i.oldKey],n=!0);return n},mw=[e=>lw(hw)("object"==typeof e&&e?e:{}),function(e){if("object"!=typeof e||!e||!(Ta in e)||!Array.isArray(e[Ta]))return!1;let t=!1;const n=n=>{if(!t){if(!k_(e,"live.controls.ptz")){const{type:t,...i}=n;yy(e,"live.controls.ptz",i)}t=!0}},i=e=>{const t=[];for(const a of e)if("custom:advanced-camera-card-ptz"===a.type)n(a);else if("conditional"!==a.type&&"custom:advanced-camera-card-conditional"!==a.type||!Array.isArray(a.elements))t.push(a);else{const e=i(a.elements);e.length&&(a.elements=e,t.push(a))}return t},a=i(e[Ta]);return t&&(a.length?e[Ta]=a:delete e[Ta]),t},rw("view.timeout_seconds",ja),sw("live.lazy_unload",(e=>"all"===e?["unselected","hidden"]:"never"===e?null:eg(e))),sw("live.auto_play",(e=>"all"===e?null:"never"===e?[]:eg(e))),sw("live.auto_pause",(e=>"all"===e?["unselected","hidden"]:"never"===e?null:eg(e))),sw("live.auto_mute",(e=>"all"===e?null:"never"===e?[]:eg(e))),sw("live.auto_unmute",(e=>"all"===e?["selected","visible","microphone"]:"never"===e?null:eg(e))),sw("media_viewer.auto_play",(e=>"all"===e?null:"never"===e?[]:eg(e))),sw("media_viewer.auto_pause",(e=>"all"===e?null:"never"===e?[]:eg(e))),sw("media_viewer.auto_mute",(e=>"all"===e?null:"never"===e?[]:eg(e))),sw("media_viewer.auto_unmute",(e=>"all"===e?["selected","visible"]:"never"===e?null:eg(e))),rw("live.controls.thumbnails.media",as),rw("timeline.media",Vs),rw("live.controls.timeline.media",hs),rw("media_viewer.controls.timeline.media",zr),rw("view.scan",Ga),rw("view.triggers.enabled",nr,{transform:e=>!0===e?"live":null,keepOriginal:!0}),rw("view.triggers.enabled",Ja,{transform:e=>!0!==e&&null}),rw("view.triggers.untrigger_reset",ir,{transform:e=>e?"default":null}),rw("live.layout",Sa),ow("media_viewer.layout"),ow("image.layout"),cw(wo,uw),e=>lw(uw)("object"==typeof e&&e?e[Ta]:{}),e=>lw(uw)("object"==typeof e&&e?e.automations:{}),cw(xi,rw("hide","capabilities",{transform:e=>!0===e?{disable_except:["substream"]}:null})),rw("performance.profile",$o,{transform:e=>"low"===e?["low-performance"]:null}),cw(wo,aw("overrides","merge")),rw("live.controls.ptz",Aa,{transform:e=>{if("object"!=typeof e||!e)return;const t=["data_left","data_right","data_up","data_down","data_zoom_in","data_zoom_out","service"],n=["actions_left","actions_right","actions_up","actions_down","actions_zoom_in","actions_zoom_out"],i=[...t,...n,"data_home","actions_home"];if(!Object.keys(e).some((e=>i.includes(e))))return;const a={};t.filter((t=>t in e)).reduce(((t,n)=>(t[n]=e[n],t)),a),n.filter((t=>t in e)).reduce(((t,n)=>("object"==typeof e[n]&&"tap_action"in e[n]&&(t[n]=e[n].tap_action),t)),a);const r=()=>{a.presets="presets"in e&&"object"==typeof e.presets&&e.presets?e.presets:{}};return"actions_home"in e&&"object"==typeof e.actions_home&&e.actions_home&&"tap_action"in e.actions_home?(r(),a.presets.home=e.actions_home.tap_action):"data_home"in e&&"object"==typeof e.data_home&&e.data_home&&"string"==typeof e.service&&(r(),a.presets.service=e.service,a.presets.data_home=e.data_home),a},keepOriginal:!0}),sw("live.controls.ptz",(e=>{if("object"!=typeof e||!e)return e;const t=["mode","position","orientation","hide_pan_tilt","hide_zoom","hide_home","style"],n=Object.keys(e);return n.some((e=>!t.includes(e)))?n.filter((e=>t.includes(e))).reduce(((t,n)=>(t[n]=e[n],t)),{}):void 0})),rw("view.update_cycle_camera",Ha),rw("view.update_force",Wa,{transform:e=>!0===e?"all":null}),rw("view.update_seconds",Za),rw("view.update_entities",Ka),aw("live.controls.title",uo,{transform:e=>"object"==typeof e&&e&&"string"==typeof e.mode?"none"===e.mode?{style:"none"}:e.mode.includes("bottom")?{position:"bottom"}:e.mode.includes("top")?{position:"top"}:null:null}),ow("live.controls.title"),ow("media_viewer.controls.title"),e=>lw(dw)("object"==typeof e&&e?e:{}),rw("dimensions.max_height",bo),ow("dimensions.min_height"),rw("view.dark_mode",La,{transform:e=>"on"===e}),e=>lw(pw)("object"==typeof e&&e?e:{}),sw("view.theme.overrides",(e=>{if("object"!=typeof e||!e||Array.isArray(e))return e;const t={...e},n=new RegExp(/^--frigate-card-/);for(const i of Object.keys(e))if(i.match(n)){t[i.replace(n,"--advanced-camera-card-")]=e[i],delete t[i]}return t})),rw("menu.buttons.frigate","menu.buttons.iris")],fw={casting:{[Kr]:!1,[Mr]:!1,[to]:"none",[`${so}.enabled`]:!0,[`${oo}.enabled`]:!0,[`${ao}.enabled`]:!1,[`${co}.enabled`]:!1,[Zr]:["selected","visible"],[yo]:"static",[_o]:"16:9",[Ea]:1,[As]:!0},"low-performance":{[rs]:"none",[Ar]:"none",[Ws]:"none",[gs]:!1,[Pr]:!1,[Hs]:!1,[Wr]:[],[pr]:[],[mr]:[],[fr]:[],[Ms]:["unselected","hidden"],[ks]:!1,[wr]:!1,[Ss]:"none",[Cr]:"none",[As]:!1,[Er]:"chevrons",[po]:"none",[to]:"outside",[`${ro}.enabled`]:!1,[`${lo}.enabled`]:!1,[`${lo}.enabled`]:!1,[`${co}.enabled`]:!1,[cr]:!1,[lr]:!1,[ur]:!1,[or]:!1,[cs]:!1,[ls]:!1,[us]:!1,[os]:!1,[$r]:!1,[Or]:!1,[Ir]:!1,[Tr]:!1,[Ys]:!1,[Qs]:!1,[Gs]:!1,[Ks]:!1,[ko]:!1,[Co]:!1,[Mo]:10,[To]:!1,[Ao]:!1,[kr]:!1,[Ma]:!1,[Ca]:"image",[Ea]:10,[nr]:"none",[Eo]:1},scrubbing:{[ms]:"below",[vs]:"ribbon",[fs]:"seek",[Rr]:"below",[Fr]:"ribbon",[Nr]:"seek"}},gw=(e,t,n)=>{const i=Ro(Wu).safeParse(e);if(!i.success)return t;const a=i.data;for(const e of n??[])e in fw&&Object.entries(fw[e]).forEach((([e,n])=>{return r=n,void(void 0===Xb(a,i=e)&&Gb(t,i,r));var i,r}));return t};class vw extends Lo{}const _w=e=>{switch(e){case"ptz_left":return"left";case"ptz_right":return"right";case"ptz_up":return"up";case"ptz_down":return"down";case"ptz_zoom_in":return"zoom_in";case"ptz_zoom_out":return"zoom_out"}
/* istanbul ignore next: No (current) way to reach this code -- @preserve */return null},yw=(e,t)=>{if(!t.enabled)return[];const n=[];for(const i of["ptz_down","ptz_left","ptz_right","ptz_up","ptz_zoom_in","ptz_zoom_out"]){const a=t[i],r=_w(i);a&&r&&(n.push({conditions:[{condition:"key",key:a.key,state:"down",shift:a.shift,ctrl:a.ctrl,alt:a.alt,meta:a.meta}],actions:[Mg({ptzAction:r,ptzPhase:"start"})],tag:e}),n.push({conditions:[{condition:"key",key:a.key,state:"up"}],actions:[Mg({ptzAction:r,ptzPhase:"stop"})],tag:e}))}const i=t.ptz_home;return i&&n.push({conditions:[{condition:"key",key:i.key,state:"down",shift:i.shift,ctrl:i.ctrl,alt:i.alt,meta:i.meta}],actions:[Mg()],tag:e}),n};class bw{constructor(e){this._config=null,this._overriddenConfig=null,this._rawConfig=null,this._cardWideConfig=null,this._overridesConditionsManager=null,this._api=e}hasConfig(){return!!this.getConfig()}getConfig(){return this._overriddenConfig??this._config}getCardWideConfig(){return this._cardWideConfig}getNonOverriddenConfig(){return this._config}getRawConfig(){return this._rawConfig}setConfig(e){if(!e)throw new Error(Kv("error.invalid_configuration"));const t=Wu.safeParse(e);if(!t.success){const n=iw(e),i=Po(t.error);let a="";throw n&&(a=`${Kv("error.upgrade_available")}. `),new Error(a+`${Kv("error.invalid_configuration")}: `+(i&&i.size?JSON.stringify([...i],null," "):Kv("error.invalid_configuration_no_hint")))}const n=gw(e,t.data,t.data.profiles);var i;(this._rawConfig=e,V_(this._config,n))||(this._config=n,this._cardWideConfig={performance:n.performance,debug:n.debug},this._overridesConditionsManager?.destroy(),this._overridesConditionsManager=this._config.overrides?.length?new Lb(this._config.overrides.map((e=>e.conditions)).flat(),this._api.getConditionStateManager()):null,this._overridesConditionsManager?.addListener((()=>this._processOverrideConfig())),this._api.getConditionStateManager().setState({view:void 0,displayMode:void 0,camera:void 0}),this._api.getMediaLoadedInfoManager().clear(),this._api.getInitializationManager().uninitialize(Kb.VIEW),this._api.getViewManager().reset(),this._api.getMessageManager().reset(),this._api.getStatusBarItemManager().removeAllDynamicStatusBarItems(),((e,t)=>{e.getAutomationsManager().deleteAutomations(t);const n=e.getConfigManager().getConfig()?.view.keyboard_shortcuts;if(!n)return;const i=yw(t,n);i.length&&e.getAutomationsManager().addAutomations(i)})(this._api,this),(i=this._api).getAutomationsManager().deleteAutomations(),i.getAutomationsManager().addAutomations(i.getConfigManager().getNonOverriddenConfig()?.automations??[]),this._processOverrideConfig(),this._api.getCardElementManager().update())}_processOverrideConfig(){
/* istanbul ignore if: No (current) way to reach this code -- @preserve */
if(!this._config)return;const e=this._getOverriddenConfig();if(!e||V_(e,this._overriddenConfig))return;const t=this._overriddenConfig;this._overriddenConfig=e,this._api.getStyleManager().updateFromConfig(),!t||V_(t?.cameras,this._overriddenConfig?.cameras)&&V_(t?.cameras_global,this._overriddenConfig?.cameras_global)||(this._api.getInitializationManager().uninitialize(Kb.CAMERAS),this._api.getCameraManager().destroy()),t&&t?.live.microphone.always_connected!==this._overriddenConfig?.live.microphone.always_connected&&this._api.getInitializationManager().uninitialize(Kb.MICROPHONE_CONNECT),this._initializeBackgroundAndUpdate(t)}_getOverriddenConfig(){if(!this._overridesConditionsManager||!this._config)return this._config;try{return function(e,t,n){if(!n?.configOverrides)return t;let i=ew(t),a=!1;for(const t of n.configOverrides)e.getEvaluation()?.result&&(t.delete?.forEach((e=>{Jb(i,e)})),Object.keys(t.set??{}).forEach((e=>{Gb(i,e,t.set?.[e])})),Object.keys(t.merge??{}).forEach((e=>{Gb(i,e,vy({},Xb(i,e),t.merge?.[e]))})),a=!0);if(!a)return t;if(n?.configOverrides?.some((e=>e.delete?.length))&&(i=yg(i)),n?.schema){const e=n.schema.safeParse(i);if(!e.success)throw new vw(Kv("error.invalid_configuration_override"),[e.error.errors,i]);return e.data}return i}(this._overridesConditionsManager,this._config,{configOverrides:this._config.overrides,schema:Wu})}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e),null}}async _initializeBackgroundAndUpdate(e){await this._api.getDefaultManager().initializeIfNecessary(e),await this._api.getMediaPlayerManager().initializeIfNecessary(e),this._api.getCardElementManager().update()}}class ww{constructor(e){this._timer=new Tg,this._stateChangeHandler=()=>{this._setToDefaultIfAllowed()},this._api=e}async initializeIfNecessary(e){V_(e?.view.default_reset,this._api.getConfigManager().getConfig()?.view.default_reset)||await this.initialize()}async initialize(){this.uninitialize();const e=this._api.getConfigManager().getConfig()?.view.default_reset;e?.entities.length&&this._api.getHASSManager().getStateWatcher().subscribe(this._stateChangeHandler,e.entities);const t=this._api.getConfigManager().getConfig()?.view.default_reset.every_seconds;return t&&this._timer.startRepeated(t,(()=>this._setToDefaultIfAllowed())),this._api.getConfigManager().getConfig()?.view.default_reset.after_interaction&&this._api.getAutomationsManager().addAutomations([{actions:[xg("default")],conditions:[{condition:"interaction",interaction:!1}],tag:this}]),!0}uninitialize(){this._timer.stop(),this._api.getHASSManager().getStateWatcher().unsubscribe(this._stateChangeHandler),this._api.getAutomationsManager().deleteAutomations(this)}_setToDefaultIfAllowed(){this._isAutomatedUpdateAllowed()&&this._api.getViewManager().setViewDefault()}_isAutomatedUpdateAllowed(){const e=this._api.getConfigManager().getConfig()?.view.default_reset.interaction_mode;return!!e&&((e,t)=>{switch(e){case"all":return!0;case"active":return t;case"inactive":return!t}})(e,this._api.getInteractionManager().hasInteraction())}}const xw=(e,t="download")=>{const n=new URL(e).origin===window.location.origin,i=e.startsWith("data:");if(!n&&!i)return void window.open(e,"_blank");const a=document.createElement("a");a.setAttribute("download",t),a.href=e,a.click(),a.remove()},kw=async(e,t,n)=>{const i=await t.getMediaDownloadPath(n);if(!i)throw new Lo(Kv("error.download_no_media"));let a=i.endpoint;if(i.sign){let t;try{t=await Rb(e,i.endpoint)}catch(e){ig(e)}if(!t)throw new Lo(Kv("error.download_sign_failed"));a=t}xw(a)},Cw=e=>{const t=document.createElement("canvas");t.width=e.videoWidth,t.height=e.videoHeight;const n=t.getContext("2d");return n?(n.drawImage(e,0,0,t.width,t.height),t.toDataURL("image/jpeg")):null};class Mw{constructor(e){this._api=e}async downloadViewerMedia(){const e=this._api.getViewManager().getView()?.queryResults?.getSelectedResult(),t=this._api.getHASSManager().getHASS();if(!e||!t)return!1;try{await kw(t,this._api.getCameraManager(),e)}catch(e){return this._api.getMessageManager().setErrorIfHigherPriority(e),!1}return!0}async downloadScreenshot(){const e=await(this._api.getMediaLoadedInfoManager().get()?.player?.getScreenshotURL());e&&xw(e,(e=>{if(e?.is("live")||e?.is("image"))return`${e.view}-${e.camera}-${Jd(new Date,"yyyy-MM-dd-HH-mm-ss")}.jpg`;if(e?.isViewerView()){const t=e.queryResults?.getSelectedResult(),n=t?.getID()??null;return`${e.view}-${e.camera}${n?`-${n}`:""}.jpg`}return"screenshot.jpg"})(this._api.getViewManager().getView()))}}class Ew{constructor(e){this._expanded=!1,this._api=e}initialize(){this._setConditionState()}isExpanded(){return this._expanded}toggleExpanded(){this.setExpanded(!this._expanded)}setExpanded(e){e&&this._api.getFullscreenManager().isInFullscreen()&&this._api.getFullscreenManager().setFullscreen(!1),this._expanded=e,this._setConditionState(),this._api.getCardElementManager().update()}_setConditionState(){this._api.getConditionStateManager()?.setState({expand:this._expanded})}}const Sw=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],Aw=(()=>{if("undefined"==typeof document)return!1;const e=Sw[0],t={};for(const n of Sw){const i=n?.[1];if(i in document){for(const[i,a]of n.entries())t[e[i]]=a;return t}}return!1})(),Tw={change:Aw.fullscreenchange,error:Aw.fullscreenerror};let $w={request:(e=document.documentElement,t)=>new Promise(((n,i)=>{const a=()=>{$w.off("change",a),n()};$w.on("change",a);const r=e[Aw.requestFullscreen](t);r instanceof Promise&&r.then(a).catch(i)})),exit:()=>new Promise(((e,t)=>{if(!$w.isFullscreen)return void e();const n=()=>{$w.off("change",n),e()};$w.on("change",n);const i=document[Aw.exitFullscreen]();i instanceof Promise&&i.then(n).catch(t)})),toggle:(e,t)=>$w.isFullscreen?$w.exit():$w.request(e,t),onchange(e){$w.on("change",e)},onerror(e){$w.on("error",e)},on(e,t){const n=Tw[e];n&&document.addEventListener(n,t,!1)},off(e,t){const n=Tw[e];n&&document.removeEventListener(n,t,!1)},raw:Aw};Object.defineProperties($w,{isFullscreen:{get:()=>Boolean(document[Aw.fullscreenElement])},element:{enumerable:!0,get:()=>document[Aw.fullscreenElement]??void 0},isEnabled:{enumerable:!0,get:()=>Boolean(document[Aw.fullscreenEnabled])}}),Aw||($w={isEnabled:!1});var Ow=$w;class Iw{constructor(e,t){this._api=e,this._handler=t}}class Lw extends Iw{connect(){Ow.isEnabled&&Ow.on("change",this._handler)}disconnect(){Ow.isEnabled&&Ow.off("change",this._handler)}isInFullscreen(){return Ow.isEnabled&&Ow.isFullscreen}isSupported(){return Ow.isEnabled}setFullscreen(e){this.isSupported()&&(e?Ow.request(this._api.getCardElementManager().getElement()):Ow.exit())}}class jw extends Iw{constructor(){super(...arguments),this._playTimer=new Tg,this._stateChangeHandler=e=>{if(e.old.mediaLoadedInfo?.player?.getFullscreenElement()!==e.new.mediaLoadedInfo?.player?.getFullscreenElement()){const t=e.old.mediaLoadedInfo?.player?.getFullscreenElement();t?.removeEventListener("webkitbeginfullscreen",this._handler),t?.removeEventListener("webkitendfullscreen",this._endHandler);const n=e.new.mediaLoadedInfo?.player?.getFullscreenElement();n?.addEventListener("webkitbeginfullscreen",this._handler),n?.addEventListener("webkitendfullscreen",this._endHandler)}},this._endHandler=()=>{this._handler(),this._playTimer.start(.5,(()=>{this._getVideoElement()?.play()}))}}connect(){this._api.getConditionStateManager().addListener(this._stateChangeHandler)}disconnect(){this._api.getConditionStateManager().removeListener(this._stateChangeHandler)}_getVideoElement(){const e=this._api.getMediaLoadedInfoManager().get()?.player?.getFullscreenElement();return e instanceof HTMLVideoElement?e:null}isInFullscreen(){return!!this._getVideoElement()?.webkitDisplayingFullscreen}isSupported(){return!!this._getVideoElement()?.webkitSupportsFullscreen}setFullscreen(e){if(!this.isSupported())return;const t=this._getVideoElement();e?t?.webkitEnterFullscreen?.():t?.webkitExitFullscreen?.()}}class zw{static create(e,t){if(Ow.isEnabled)return new Lw(e,t);return document.createElement("video").webkitEnterFullscreen?new jw(e,t):null}}class Dw{constructor(e,t){this._fullscreenHandler=()=>{this._api.getExpandManager().setExpanded(!1),this._setConditionState(),this._api.getCardElementManager().update()},this._api=e,this._provider=t??zw.create(e,this._fullscreenHandler)}connect(){this._provider?.connect()}disconnect(){this._provider?.disconnect()}setFullscreen(e){this._provider?.setFullscreen(e)}isInFullscreen(){return this._provider?.isInFullscreen()??!1}isSupported(){return!Db()&&(this._provider?.isSupported()??!1)}initialize(){this._setConditionState()}toggleFullscreen(){this._provider?.isInFullscreen()?this._provider.setFullscreen(!1):this._provider?.setFullscreen(!0)}_setConditionState(){this._api.getConditionStateManager()?.setState({fullscreen:this.isInFullscreen()})}}class Rw{constructor(){this._watcherCallbacks=new Map}setHASS(e,t){if(e)for(const[n,i]of this._watcherCallbacks.entries()){const a=Nb(t,e,i,{stateOnly:!0,firstOnly:!0});a.length&&n(a[0])}}subscribe(e,t){return!!t.length&&(this._watcherCallbacks.has(e)?this._watcherCallbacks.get(e)?.push(...t):this._watcherCallbacks.set(e,t),!0)}unsubscribe(e){this._watcherCallbacks.delete(e)}}class Nw{constructor(e){this._hass=null,this._stateWatcher=new Rw,this._api=e}getHASS(){return this._hass}hasHASS(){return!!this._hass}getStateWatcher(){return this._stateWatcher}setHASS(e){if(((e,t)=>e?.connected!==t?.connected)(this._hass,e)&&(e?.connected?this._api.getMessageManager().resetType("connection"):this._api.getMessageManager().setMessageIfHigherPriority({message:Kv("error.reconnecting"),icon:"mdi:lan-disconnect",type:"connection",dotdotdot:!0})),!e)return;const t=this._hass;this._hass=e,this._api.getConditionStateManager().setState({state:this._hass.states,user:this._hass.user}),this._api.getStyleManager().applyTheme(),this._stateWatcher.setHASS(t,e)}}class Pw{constructor(e){this._timer=new Tg,this._interacted=!1,this.reportInteraction=by((()=>{this._reportInteraction()}),1e3),this._api=e}initialize(){this._setInteraction(!1)}hasInteraction(){return this._interacted}_setInteraction(e){this._interacted=e,pg(this._api.getCardElementManager().getElement(),e,"interaction"),this._api.getConditionStateManager().setState({interaction:e})}_reportInteraction(){this._timer.stop(),this._setInteraction(!0);const e=this._api.getConfigManager().getConfig()?.view.interaction_seconds;e&&this._timer.start(e,(()=>{this._setInteraction(!1)}))}}class Fw{constructor(e){this._state={},this._handleKeydown=e=>{const t={state:"down",ctrl:e.ctrlKey,alt:e.altKey,meta:e.metaKey,shift:e.shiftKey};V_(this._state[e.key],t)||(this._state[e.key]=t,this._processStateChange())},this._handleKeyup=e=>{e.key in this._state&&"down"===this._state[e.key].state&&(this._state[e.key].state="up",this._processStateChange())},this._handleBlur=()=>{Object.keys(this._state).length&&(this._state={},this._processStateChange())},this._api=e}initialize(){const e=this._api.getCardElementManager().getElement();e.addEventListener("keydown",this._handleKeydown),e.addEventListener("keyup",this._handleKeyup),e.addEventListener("blur",this._handleBlur)}uninitialize(){const e=this._api.getCardElementManager().getElement();e.removeEventListener("keydown",this._handleKeydown),e.removeEventListener("keyup",this._handleKeyup),e.removeEventListener("blur",this._handleBlur)}_processStateChange(){this._api.getConditionStateManager().setState({keys:this._state})}}function Bw(e,t){let n;return n=e instanceof Event?e.composedPath()[0]:e,n instanceof HTMLImageElement?{width:n.naturalWidth,height:n.naturalHeight,...t}:n instanceof HTMLVideoElement?{width:n.videoWidth,height:n.videoHeight,...t}:n instanceof HTMLCanvasElement?{width:n.width,height:n.height,player:t?.player,...t}:null}function Vw(e,t,n){const i=Bw(t,n);i&&Uw(e,i)}function Uw(e,t){Gf(e,"media:loaded",t)}function Hw(e){Gf(e,"media:unloaded")}function qw(e){Gf(e,"media:volumechange")}function Ww(e){Gf(e,"media:play")}function Zw(e){Gf(e,"media:pause")}class Kw{constructor(e){this._current=null,this._lastKnown=null,this._api=e}initialize(){this.clear()}set(e){var t;(t=e).height>=50&&t.width>=50&&(Qv(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card media load: ",e),this._current=e,this._lastKnown=e,this._api.getConditionStateManager().setState({mediaLoadedInfo:e}),this._api.getStyleManager().setExpandedMode(),this._api.getCardElementManager().update())}get(){return this._current}getLastKnown(){return this._lastKnown}clear(){this._current=null,this._api.getConditionStateManager().setState({mediaLoadedInfo:null})}has(){return!!this._current}}class Yw{static isEvent(e){return this.isClip(e)||this.isSnapshot(e)}static isRecording(e){return"recording"===e.getMediaType()}static isClip(e){return"clip"===e.getMediaType()}static isSnapshot(e){return"snapshot"===e.getMediaType()}static isVideo(e){return this.isClip(e)||this.isRecording(e)}}class Qw{constructor(e){this._mediaPlayers=[],this._api=e}getMediaPlayers(){return this._mediaPlayers}hasMediaPlayers(){return this._mediaPlayers.length>0}async initializeIfNecessary(e){e?.menu.buttons.media_player.enabled!==this._api.getConfigManager().getConfig()?.menu.buttons.media_player.enabled&&await this.initialize()}async initialize(){const e=this._api.getHASSManager().getHASS();if(!e||!this._api.getConfigManager().getConfig()?.menu.buttons.media_player.enabled)return!1;const t=Object.keys(e.states).filter((t=>{if(t.startsWith("media_player.")){const n=e.states[t];if(n&&"unavailable"!==n.state&&Wb(n,131072))return!0}return!1}));let n=null;try{n=await this._api.getEntityRegistryManager().getEntities(e,t)}catch(e){ig(e)}return this._mediaPlayers=t.filter((e=>{const t=n?.get(e);return!t||!t.hidden_by})),!0}async stop(e){const t=this._api.getHASSManager().getHASS(),n=t?.states[e];if(!n)return;let i;if(Wb(n,4096))i="media_stop";else{if(!Wb(n,256))return;i="turn_off"}await t.callService("media_player",i,{entity_id:e})}async playLive(e,t){const n=this._api.getCameraManager().getStore().getCameraConfig(t);n&&("dashboard"===n.cast?.method?await this._playLiveDashboard(e,n):await this._playLiveStandard(e,t,n))}async _playLiveStandard(e,t,n){const i=this._api.getHASSManager().getHASS(),a=n?.camera_entity??null;if(!i||!a)return;const r=this._api.getCameraManager().getCameraMetadata(t)?.title??null,s=i.states[a]?.attributes?.entity_picture??null;await i.callService("media_player","play_media",{entity_id:e,media_content_id:`media-source://camera/${a}`,media_content_type:"application/vnd.apple.mpegurl",extra:{...r&&{title:r},...s&&{thumb:s}}})}async _playLiveDashboard(e,t){const n=this._api.getHASSManager().getHASS();if(!n)return;const i=t.cast?.dashboard;i?.dashboard_path&&i?.view_path?await n.callService("cast","show_lovelace_view",{entity_id:e,dashboard_path:i.dashboard_path,view_path:i.view_path}):this._api.getMessageManager().setMessageIfHigherPriority({type:"error",icon:"mdi:cast",message:Kv("error.no_dashboard_or_view")})}async playMedia(e,t){const n=this._api.getHASSManager().getHASS();if(!n||!t)return;const i=t.getTitle(),a=t.getThumbnail();await n.callService("media_player","play_media",{entity_id:e,media_content_id:t.getContentID(),media_content_type:Yw.isVideo(t)?"video":"image",extra:{...i&&{title:i},...a&&{thumb:a}}})}}const Gw={info:10,error:20,connection:30,diagnostics:40};class Xw{constructor(e){this._message=null,this._api=e}getMessage(){return this._message}hasMessage(){return!!this._message}hasErrorMessage(){return"error"===this._message?.type}reset(){const e=this.hasMessage();this._message=null,e&&this._api.getCardElementManager().update()}resetType(e){this._message?.type===e&&this.reset()}setErrorIfHigherPriority(e,t){e&&"object"==typeof e&&"message"in e&&(ig(e),this.setMessageIfHigherPriority({message:t?`${t}: ${e.message}`:String(e.message),type:"error",...e instanceof Lo&&{context:e.context}}))}setMessageIfHigherPriority(e){const t=e=>e.type??"info",n=this._message?Gw[t(this._message)]:0,i=Gw[t(e)];return!(this._message&&i<n)&&(this._message=e,this._api.getMediaLoadedInfoManager().clear(),this._api.getCardElementManager().scrollReset(),this._api.getCardElementManager().update(),!0)}}class Jw{constructor(e){this._timer=new Tg,this._state={connected:!1,muted:!0,forbidden:!1},this._desireMute=!0,this._api=e}getState(){return this._state}initialize(){this._setState()}shouldConnectOnInitialization(){return!!this._api.getConfigManager().getConfig()?.live.microphone?.always_connected&&this.isSupported()}isSupported(){return!!navigator.mediaDevices?.getUserMedia}async connect(){if(!this.isSupported())return!1;try{this._stream=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1})}catch(e){return ig(e),this._stream=null,this._setState(),!1}return this._setDesiredMuteOnStream(),this._setState(),!0}disconnect(){this._stream?.getTracks().forEach((e=>e.stop())),this._stream=void 0,this._setState()}getStream(){return this._stream??void 0}mute(){this._desireMute=!0,this._setDesiredMuteOnStream(),this._setState()}async unmute(){this.isSupported()&&(this._desireMute=!1,this.isConnected()||this.isForbidden()?this.isConnected()&&(this._setDesiredMuteOnStream(),this._setState()):await this.connect())}isConnected(){return!!this._stream}isForbidden(){return null===this._stream}isMuted(){return!this._stream||this._stream.getTracks().every((e=>!e.enabled))}_setDesiredMuteOnStream(){this._stream?.getTracks().forEach((e=>{e.enabled=!this._desireMute})),this._startDisconnectTimer()}_startDisconnectTimer(){const e=this._api.getConfigManager().getConfig()?.live.microphone;if(e?.always_connected)return;const t=e?.disconnect_seconds??0;t&&this._timer.start(t,(()=>{this.disconnect()}))}_setState(){this._state={stream:this._stream,connected:this.isConnected(),muted:this.isMuted(),forbidden:this.isForbidden()},this._api.getConditionStateManager().setState({microphone:this._state}),this._api.getCardElementManager().update()}}class ex{constructor(e){this._shouldRun=!0,this.requestExecution=()=>{this._shouldRun=!0,this._api.getCardElementManager().update()},this.executeIfNecessary=async()=>{this._shouldRun&&(this._shouldRun=!1,await this._executeViewRelated(this._calculateIntent()),await this._executeNonViewRelated(this._calculateIntent()))},this._isViewAction=e=>{switch(e.advanced_camera_card_action){case"clip":case"clips":case"diagnostics":case"image":case"live":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":return!0}return!1},this._api=e}hasViewRelatedActionsToRun(){return!!this._calculateIntent().view&&this._shouldRun}async _executeViewRelated(e){e.view&&(e.view.default?await this._api.getViewManager().setViewDefaultWithNewQuery({params:{camera:e.view.camera},...e.view.substream&&{modifiers:[new Cb(e.view.substream)]}}):await this._api.getViewManager().setViewByParametersWithNewQuery({params:{...e.view.view&&{view:e.view.view},...e.view.camera&&{camera:e.view.camera}},...e.view.substream&&{modifiers:[new Cb(e.view.substream)]}}))}async _executeNonViewRelated(e){e.other&&await this._api.getActionsManager().executeActions(e.other)}_calculateIntent(){const e={};for(const t of this._getActions())this._isViewAction(t)?((e.view??={}).view=t.advanced_camera_card_action,(e.view??={}).default=void 0):"default"===t.advanced_camera_card_action?((e.view??={}).default=!0,(e.view??={}).view=void 0):"camera_select"===t.advanced_camera_card_action?(e.view??={}).camera=t.camera:"live_substream_select"===t.advanced_camera_card_action?(e.view??={}).substream=t.camera:(e.other??=[]).push(t);return e}_getActions(){const e=new URLSearchParams(window.location.search),t=[],n=new RegExp(/^(advanced-camera-card|frigate-card)-action([.:](?<cardID>\w+))?[.:](?<action>\w+)/);for(const[i,a]of e.entries()){const e=i.match(n);if(!e||!e.groups)continue;const r=e.groups.cardID,s=e.groups.action;let o=null;switch(s){case"camera_select":case"live_substream_select":a&&(o=kg(s,a,{cardID:r}));break;case"camera_ui":case"clip":case"clips":case"default":case"diagnostics":case"download":case"expand":case"image":case"live":case"menu_toggle":case"recording":case"recordings":case"snapshot":case"snapshots":case"timeline":o=xg(s,{cardID:r});break;default:console.warn(`Advanced Camera Card received unknown card action in query string: ${s}`)}o&&t.push(o)}return t}}class tx{constructor(e){this._items=[],this._dynamicItems=[],this._api=e}addDynamicStatusBarItem(e){this._dynamicItems.includes(e)||this._dynamicItems.push(e),this._api.getCardElementManager().update()}removeDynamicStatusBarItem(e){this._dynamicItems=this._dynamicItems.filter((t=>!V_(t,e))),this._api.getCardElementManager().update()}removeAllDynamicStatusBarItems(){this._dynamicItems=[],this._api.getCardElementManager().update()}calculateItems(e){const t=e?.view?e?.cameraManager?.getCameraMetadata(e?.view?.camera):null,n=t?.engineIcon??null,i=e?.view?.is("live")?t?.title??null:e?.view?.isViewerView()?e?.view.queryResults?.getSelectedResult()?.getTitle()??null:null,a=e?.mediaLoadedInfo?this._calculateResolution(e?.mediaLoadedInfo):null,r=e?.mediaLoadedInfo?.technology?.length?e?.mediaLoadedInfo.technology[0]:null;return[...i?[{type:"custom:advanced-camera-card-status-bar-string",string:i,expand:!0,sufficient:!0,...e?.statusConfig?.items.title}]:[],...a?[{type:"custom:advanced-camera-card-status-bar-string",string:a,...e?.statusConfig?.items.resolution}]:[],...r&&"webrtc"===r?[{type:"custom:advanced-camera-card-status-bar-icon",icon:"mdi:webrtc",...e?.statusConfig?.items.technology}]:r?[{type:"custom:advanced-camera-card-status-bar-string",string:r.toUpperCase(),...e?.statusConfig?.items.technology}]:[],...n?[{type:"custom:advanced-camera-card-status-bar-icon",icon:n,...e?.statusConfig?.items.engine}]:[],...this._dynamicItems]}_matchesWidthHeight(e,t,n){const i=.99*t,a=1.01*t,r=.99*n,s=1.01*n,o=(e,t,n)=>e>=t&&e<=n;return!!e&&(o(e.width,i,a)&&o(e.height,r,s)||o(e.height,i,a)&&o(e.width,r,s))}_calculateResolution(e){return this._matchesWidthHeight(e,1920,1080)?"1080p":this._matchesWidthHeight(e,1280,720)?"720p":this._matchesWidthHeight(e,640,480)?"VGA":this._matchesWidthHeight(e,3840,2160)?"4K":this._matchesWidthHeight(e,720,480)?"480p":this._matchesWidthHeight(e,720,576)?"576p":this._matchesWidthHeight(e,7680,4320)?"8K":`${e.width}x${e.height}`}}class nx{constructor(e){this._api=e}setExpandedMode(){const e=this._api.getCardElementManager().getElement(),t=this._api.getViewManager().getView(),n=this._api.getMediaLoadedInfoManager().getLastKnown();e.style.setProperty("--advanced-camera-card-expand-aspect-ratio",t?.isAnyMediaView()&&n?`${n.width} / ${n.height}`:"unset");const i=t?.isGrid();e.style.setProperty("--advanced-camera-card-expand-width",!i&&t?.isAnyMediaView()?"none":"var(--advanced-camera-card-expand-max-width)"),e.style.setProperty("--advanced-camera-card-expand-height",!i&&t?.isAnyMediaView()?"none":"var(--advanced-camera-card-expand-max-height)")}updateFromConfig(){this.applyTheme(),this._setMinMaxHeight(),this._setPerformance(),this._setDimmable()}applyTheme(){const e=this._api.getConfigManager().getConfig()?.view.theme;if(!e)return;const t=this._api.getCardElementManager().getElement(),n=this._getThemeNames(e);if(pg(t,!!n,"themes",n?.join(" ")),e.overrides)for(const[n,i]of Object.entries(e.overrides))t.style.setProperty(n,i)}_getThemeNames(e){return e.themes.length?e.themes:Zu.view.theme.themes}_setDimmable(){const e=this._api.getConfigManager().getConfig();pg(this._api.getCardElementManager().getElement(),!!e?.view.dim,"dimmable")}_setMinMaxHeight(){const e=this._api.getConfigManager().getConfig();if(e){this._api.getCardElementManager().getElement().style.setProperty("--advanced-camera-card-height",e.dimensions.height)}}_setPerformance(){const e={box_shadow:"none",border_radius:"0px"},t=this._api.getCardElementManager().getElement(),n=this._api.getConfigManager().getCardWideConfig()?.performance,i=n?.style??{};for(const n of Object.keys(i)){const a=`--advanced-camera-card-css-${n.replaceAll("_","-")}`;!1===i[n]?t.style.setProperty(a,e[n]):t.style.removeProperty(a)}}_isAspectRatioEnforced(e,t){const n=e.dimensions.aspect_ratio_mode;return!(this._api.getFullscreenManager().isInFullscreen()||this._api.getExpandManager().isExpanded()||"unconstrained"===n||"dynamic"===n&&(!t||t?.isAnyMediaView()||t?.is("timeline")||t?.is("diagnostics")))}getAspectRatioStyle(){const e=this._api.getConfigManager().getConfig(),t=this._api.getViewManager().getView();if(e){if(!this._isAspectRatioEnforced(e,t))return _g();const n=e.dimensions.aspect_ratio_mode,i=this._api.getMediaLoadedInfoManager().getLastKnown();return _g(i&&"dynamic"===n?{ratio:[i.width,i.height]}:{ratio:e.dimensions.aspect_ratio})}return _g({defaultStatic:!0})}}var ix,ax={exports:{}};
/*! Browser bundle of nunjucks 3.2.4  */"undefined"!=typeof self&&self,ix=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:i})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=11)}([function(e,t,n){var i=Array.prototype,a=Object.prototype,r={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","\\":"&#92;"},s=/[&"'<>\\]/g;function o(e,t){return a.hasOwnProperty.call(e,t)}function c(e){return r[e]}function l(e,t,n){var i,a,r;if(e instanceof Error&&(e=(a=e).name+": "+a.message),Object.setPrototypeOf?(i=new Error(e),Object.setPrototypeOf(i,l.prototype)):(i=this,Object.defineProperty(i,"message",{enumerable:!1,writable:!0,value:e})),Object.defineProperty(i,"name",{value:"Template render error"}),Error.captureStackTrace&&Error.captureStackTrace(i,this.constructor),a){var s=Object.getOwnPropertyDescriptor(a,"stack");(r=s&&(s.get||function(){return s.value}))||(r=function(){return a.stack})}else{var o=new Error(e).stack;r=function(){return o}}return Object.defineProperty(i,"stack",{get:function(){return r.call(i)}}),Object.defineProperty(i,"cause",{value:a}),i.lineno=t,i.colno=n,i.firstUpdate=!0,i.Update=function(e){var t="("+(e||"unknown path")+")";return this.firstUpdate&&(this.lineno&&this.colno?t+=" [Line "+this.lineno+", Column "+this.colno+"]":this.lineno&&(t+=" [Line "+this.lineno+"]")),t+="\n ",this.firstUpdate&&(t+=" "),this.message=t+(this.message||""),this.firstUpdate=!1,this},i}function u(e){return"[object Function]"===a.toString.call(e)}function d(e){return"[object Array]"===a.toString.call(e)}function h(e){return"[object String]"===a.toString.call(e)}function p(e){return"[object Object]"===a.toString.call(e)}function m(e){var t,n=(t=e)?"string"==typeof t?t.split("."):[t]:[];return function(e){for(var t=e,i=0;i<n.length;i++){var a=n[i];if(!o(t,a))return;t=t[a]}return t}}function f(e){return Array.prototype.slice.call(e)}function g(e,t,n){return Array.prototype.indexOf.call(e||[],t,n)}function v(e){var t=[];for(var n in e)o(e,n)&&t.push(n);return t}(t=e.exports={}).hasOwnProp=o,t._prettifyError=function(e,n,i){if(i.Update||(i=new t.TemplateError(i)),i.Update(e),!n){var a=i;(i=new Error(a.message)).name=a.name}return i},Object.setPrototypeOf?Object.setPrototypeOf(l.prototype,Error.prototype):l.prototype=Object.create(Error.prototype,{constructor:{value:l}}),t.TemplateError=l,t.escape=function(e){return e.replace(s,c)},t.isFunction=u,t.isArray=d,t.isString=h,t.isObject=p,t.getAttrGetter=m,t.groupBy=function(e,t,n){for(var i={},a=u(t)?t:m(t),r=0;r<e.length;r++){var s=e[r],o=a(s,r);if(void 0===o&&!0===n)throw new TypeError('groupby: attribute "'+t+'" resolved to undefined');(i[o]||(i[o]=[])).push(s)}return i},t.toArray=f,t.without=function(e){var t=[];if(!e)return t;for(var n=e.length,i=f(arguments).slice(1),a=-1;++a<n;)-1===g(i,e[a])&&t.push(e[a]);return t},t.repeat=function(e,t){for(var n="",i=0;i<t;i++)n+=e;return n},t.each=function(e,t,n){if(null!=e)if(i.forEach&&e.forEach===i.forEach)e.forEach(t,n);else if(e.length===+e.length)for(var a=0,r=e.length;a<r;a++)t.call(n,e[a],a,e)},t.map=function(e,t){var n=[];if(null==e)return n;if(i.map&&e.map===i.map)return e.map(t);for(var a=0;a<e.length;a++)n[n.length]=t(e[a],a);return e.length===+e.length&&(n.length=e.length),n},t.asyncIter=function(e,t,n){var i=-1;!function a(){++i<e.length?t(e[i],i,a,n):n()}()},t.asyncFor=function(e,t,n){var i=v(e||{}),a=i.length,r=-1;!function s(){r++;var o=i[r];r<a?t(o,e[o],r,a,s):n()}()},t.indexOf=g,t.keys=v,t._entries=function(e){return v(e).map((function(t){return[t,e[t]]}))},t._values=function(e){return v(e).map((function(t){return e[t]}))},t._assign=t.extend=function(e,t){return e=e||{},v(t).forEach((function(n){e[n]=t[n]})),e},t.inOperator=function(e,t){if(d(t)||h(t))return-1!==t.indexOf(e);if(p(t))return e in t;throw new Error('Cannot use "in" operator to search for "'+e+'" in unexpected types.')}},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?r:String(r)),i)}var a,r}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}var o=n(16),c=n(0);function l(e,t,n){n=n||{},c.keys(n).forEach((function(t){n[t]=function(e,t){return"function"!=typeof e||"function"!=typeof t?t:function(){var n=this.parent;this.parent=e;var i=t.apply(this,arguments);return this.parent=n,i}}(e.prototype[t],n[t])}));var i=function(e){function n(){return e.apply(this,arguments)||this}return r(n,e),a(n,[{key:"typename",get:function(){return t}}]),n}(e);return c._assign(i.prototype,n),i}var u=function(){function e(){this.init.apply(this,arguments)}return e.prototype.init=function(){},e.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),l(this,e,t)},a(e,[{key:"typename",get:function(){return this.constructor.name}}]),e}(),d=function(e){function t(){var t,n;return(t=n=e.call(this)||this).init.apply(t,arguments),n}return r(t,e),t.prototype.init=function(){},t.extend=function(e,t){return"object"==typeof e&&(t=e,e="anonymous"),l(this,e,t)},a(t,[{key:"typename",get:function(){return this.constructor.name}}]),t}(o);e.exports={Obj:u,EmitterObj:d}},function(e,t,n){var i=n(0),a=Array.from,r="function"==typeof Symbol&&Symbol.iterator&&"function"==typeof a,s=function(){function e(e,t){this.variables=Object.create(null),this.parent=e,this.topLevel=!1,this.isolateWrites=t}var t=e.prototype;return t.set=function(e,t,n){var i=e.split("."),a=this.variables,r=this;if(n&&(r=this.resolve(i[0],!0)))r.set(e,t);else{for(var s=0;s<i.length-1;s++){var o=i[s];a[o]||(a[o]={}),a=a[o]}a[i[i.length-1]]=t}},t.get=function(e){var t=this.variables[e];return void 0!==t?t:null},t.lookup=function(e){var t=this.parent,n=this.variables[e];return void 0!==n?n:t&&t.lookup(e)},t.resolve=function(e,t){var n=t&&this.isolateWrites?void 0:this.parent;return void 0!==this.variables[e]?this:n&&n.resolve(e)},t.push=function(t){return new e(this,t)},t.pop=function(){return this.parent},e}();function o(e){return e&&Object.prototype.hasOwnProperty.call(e,"__keywords")}function c(e){var t=e.length;return 0===t?0:o(e[t-1])?t-1:t}function l(e){if("string"!=typeof e)return e;this.val=e,this.length=e.length}l.prototype=Object.create(String.prototype,{length:{writable:!0,configurable:!0,value:0}}),l.prototype.valueOf=function(){return this.val},l.prototype.toString=function(){return this.val},e.exports={Frame:s,makeMacro:function(e,t,n){return function(){for(var i=arguments.length,a=new Array(i),r=0;r<i;r++)a[r]=arguments[r];var s,l=c(a),u=function(e){var t=e.length;if(t){var n=e[t-1];if(o(n))return n}return{}}(a);if(l>e.length)s=a.slice(0,e.length),a.slice(s.length,l).forEach((function(e,n){n<t.length&&(u[t[n]]=e)})),s.push(u);else if(l<e.length){s=a.slice(0,l);for(var d=l;d<e.length;d++){var h=e[d];s.push(u[h]),delete u[h]}s.push(u)}else s=a;return n.apply(this,s)}},makeKeywordArgs:function(e){return e.__keywords=!0,e},numArgs:c,suppressValue:function(e,t){return e=null!=e?e:"",!t||e instanceof l||(e=i.escape(e.toString())),e},ensureDefined:function(e,t,n){if(null==e)throw new i.TemplateError("attempted to output null or undefined value",t+1,n+1);return e},memberLookup:function(e,t){if(null!=e)return"function"==typeof e[t]?function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return e[t].apply(e,i)}:e[t]},contextOrFrameLookup:function(e,t,n){var i=t.lookup(n);return void 0!==i?i:e.lookup(n)},callWrap:function(e,t,n,i){if(!e)throw new Error("Unable to call `"+t+"`, which is undefined or falsey");if("function"!=typeof e)throw new Error("Unable to call `"+t+"`, which is not a function");return e.apply(n,i)},handleError:function(e,t,n){return e.lineno?e:new i.TemplateError(e,t,n)},isArray:i.isArray,keys:i.keys,SafeString:l,copySafeness:function(e,t){return e instanceof l?new l(t):t.toString()},markSafe:function(e){var t=typeof e;return"string"===t?new l(e):"function"!==t?e:function(t){var n=e.apply(this,arguments);return"string"==typeof n?new l(n):n}},asyncEach:function(e,t,n,a){if(i.isArray(e)){var r=e.length;i.asyncIter(e,(function(e,i,a){switch(t){case 1:n(e,i,r,a);break;case 2:n(e[0],e[1],i,r,a);break;case 3:n(e[0],e[1],e[2],i,r,a);break;default:e.push(i,r,a),n.apply(this,e)}}),a)}else i.asyncFor(e,(function(e,t,i,a,r){n(e,t,i,a,r)}),a)},asyncAll:function(e,t,n,a){var r,s,o=0;function c(e,t){o++,s[e]=t,o===r&&a(null,s.join(""))}if(i.isArray(e))if(r=e.length,s=new Array(r),0===r)a(null,"");else for(var l=0;l<e.length;l++){var u=e[l];switch(t){case 1:n(u,l,r,c);break;case 2:n(u[0],u[1],l,r,c);break;case 3:n(u[0],u[1],u[2],l,r,c);break;default:u.push(l,r,c),n.apply(this,u)}}else{var d=i.keys(e||{});if(r=d.length,s=new Array(r),0===r)a(null,"");else for(var h=0;h<d.length;h++){var p=d[h];n(p,e[p],h,r,c)}}},inOperator:i.inOperator,fromIterator:function(e){return"object"!=typeof e||null===e||i.isArray(e)?e:r&&Symbol.iterator in e?a(e):e}}},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(a=i.key,r=void 0,"symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(a,"string"))?r:String(r)),i)}var a,r}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,s(e,t)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}function o(e,t,n){e instanceof t&&n.push(e),e instanceof c&&e.findAll(t,n)}var c=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(e,t){for(var n=arguments,i=this,a=arguments.length,r=new Array(a>2?a-2:0),s=2;s<a;s++)r[s-2]=arguments[s];this.lineno=e,this.colno=t,this.fields.forEach((function(e,t){var a=n[t+2];void 0===a&&(a=null),i[e]=a}))},n.findAll=function(e,t){var n=this;return t=t||[],this instanceof u?this.children.forEach((function(n){return o(n,e,t)})):this.fields.forEach((function(i){return o(n[i],e,t)})),t},n.iterFields=function(e){var t=this;this.fields.forEach((function(n){e(t[n],n)}))},t}(n(1).Obj),l=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),a(t,[{key:"typename",get:function(){return"Value"}},{key:"fields",get:function(){return["value"]}}]),t}(c),u=function(e){function t(){return e.apply(this,arguments)||this}r(t,e);var n=t.prototype;return n.init=function(t,n,i){e.prototype.init.call(this,t,n,i||[])},n.addChild=function(e){this.children.push(e)},a(t,[{key:"typename",get:function(){return"NodeList"}},{key:"fields",get:function(){return["children"]}}]),t}(c),d=u.extend("Root"),h=l.extend("Literal"),p=l.extend("Symbol"),m=u.extend("Group"),f=u.extend("Array"),g=c.extend("Pair",{fields:["key","value"]}),v=u.extend("Dict"),_=c.extend("LookupVal",{fields:["target","val"]}),y=c.extend("If",{fields:["cond","body","else_"]}),b=y.extend("IfAsync"),w=c.extend("InlineIf",{fields:["cond","body","else_"]}),x=c.extend("For",{fields:["arr","name","body","else_"]}),k=x.extend("AsyncEach"),C=x.extend("AsyncAll"),M=c.extend("Macro",{fields:["name","args","body"]}),E=M.extend("Caller"),S=c.extend("Import",{fields:["template","target","withContext"]}),A=function(e){function t(){return e.apply(this,arguments)||this}return r(t,e),t.prototype.init=function(t,n,i,a,r){e.prototype.init.call(this,t,n,i,a||new u,r)},a(t,[{key:"typename",get:function(){return"FromImport"}},{key:"fields",get:function(){return["template","names","withContext"]}}]),t}(c),T=c.extend("FunCall",{fields:["name","args"]}),$=T.extend("Filter"),O=$.extend("FilterAsync",{fields:["name","args","symbol"]}),I=v.extend("KeywordArgs"),L=c.extend("Block",{fields:["name","body"]}),j=c.extend("Super",{fields:["blockName","symbol"]}),z=c.extend("TemplateRef",{fields:["template"]}).extend("Extends"),D=c.extend("Include",{fields:["template","ignoreMissing"]}),R=c.extend("Set",{fields:["targets","value"]}),N=c.extend("Switch",{fields:["expr","cases","default"]}),P=c.extend("Case",{fields:["cond","body"]}),F=u.extend("Output"),B=c.extend("Capture",{fields:["body"]}),V=h.extend("TemplateData"),U=c.extend("UnaryOp",{fields:["target"]}),H=c.extend("BinOp",{fields:["left","right"]}),q=H.extend("In"),W=H.extend("Is"),Z=H.extend("Or"),K=H.extend("And"),Y=U.extend("Not"),Q=H.extend("Add"),G=H.extend("Concat"),X=H.extend("Sub"),J=H.extend("Mul"),ee=H.extend("Div"),te=H.extend("FloorDiv"),ne=H.extend("Mod"),ie=H.extend("Pow"),ae=U.extend("Neg"),re=U.extend("Pos"),se=c.extend("Compare",{fields:["expr","ops"]}),oe=c.extend("CompareOperand",{fields:["expr","type"]}),ce=c.extend("CallExtension",{init:function(e,t,n,i){this.parent(),this.extName=e.__name||e,this.prop=t,this.args=n||new u,this.contentArgs=i||[],this.autoescape=e.autoescape},fields:["extName","prop","args","contentArgs"]}),le=ce.extend("CallExtensionAsync");function ue(e,t,n){var i=e.split("\n");i.forEach((function(e,a){e&&(n&&a>0||!n)&&process.stdout.write(" ".repeat(t));var r=a===i.length-1?"":"\n";process.stdout.write(""+e+r)}))}e.exports={Node:c,Root:d,NodeList:u,Value:l,Literal:h,Symbol:p,Group:m,Array:f,Pair:g,Dict:v,Output:F,Capture:B,TemplateData:V,If:y,IfAsync:b,InlineIf:w,For:x,AsyncEach:k,AsyncAll:C,Macro:M,Caller:E,Import:S,FromImport:A,FunCall:T,Filter:$,FilterAsync:O,KeywordArgs:I,Block:L,Super:j,Extends:z,Include:D,Set:R,Switch:N,Case:P,LookupVal:_,BinOp:H,In:q,Is:W,Or:Z,And:K,Not:Y,Add:Q,Concat:G,Sub:X,Mul:J,Div:ee,FloorDiv:te,Mod:ne,Pow:ie,Neg:ae,Pos:re,Compare:se,CompareOperand:oe,CallExtension:ce,CallExtensionAsync:le,printNodes:function e(t,n){if(n=n||0,ue(t.typename+": ",n),t instanceof u)ue("\n"),t.children.forEach((function(t){e(t,n+2)}));else if(t instanceof ce)ue(t.extName+"."+t.prop+"\n"),t.args&&e(t.args,n+2),t.contentArgs&&t.contentArgs.forEach((function(t){e(t,n+2)}));else{var i=[],a=null;t.iterFields((function(e,t){e instanceof c?i.push([t,e]):(a=a||{})[t]=e})),a?ue(JSON.stringify(a,null,2)+"\n",null,!0):ue("\n"),i.forEach((function(t){var i=t[0],a=t[1];ue("["+i+"] =>",n+2),e(a,n+4)}))}}}},function(e,t){},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(8),r=n(17),s=n(3),o=n(0).TemplateError,c=n(2).Frame,l=n(1).Obj,u={"==":"==","===":"===","!=":"!=","!==":"!==","<":"<",">":">","<=":"<=",">=":">="},d=function(e){var t,n;function a(){return e.apply(this,arguments)||this}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var r=a.prototype;return r.init=function(e,t){this.templateName=e,this.codebuf=[],this.lastId=0,this.buffer=null,this.bufferStack=[],this._scopeClosers="",this.inBlock=!1,this.throwOnUndefined=t},r.fail=function(e,t,n){throw void 0!==t&&(t+=1),void 0!==n&&(n+=1),new o(e,t,n)},r._pushBuffer=function(){var e=this._tmpid();return this.bufferStack.push(this.buffer),this.buffer=e,this._emit("var "+this.buffer+' = "";'),e},r._popBuffer=function(){this.buffer=this.bufferStack.pop()},r._emit=function(e){this.codebuf.push(e)},r._emitLine=function(e){this._emit(e+"\n")},r._emitLines=function(){for(var e=this,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];n.forEach((function(t){return e._emitLine(t)}))},r._emitFuncBegin=function(e,t){this.buffer="output",this._scopeClosers="",this._emitLine("function "+t+"(env, context, frame, runtime, cb) {"),this._emitLine("var lineno = "+e.lineno+";"),this._emitLine("var colno = "+e.colno+";"),this._emitLine("var "+this.buffer+' = "";'),this._emitLine("try {")},r._emitFuncEnd=function(e){e||this._emitLine("cb(null, "+this.buffer+");"),this._closeScopeLevels(),this._emitLine("} catch (e) {"),this._emitLine("  cb(runtime.handleError(e, lineno, colno));"),this._emitLine("}"),this._emitLine("}"),this.buffer=null},r._addScopeLevel=function(){this._scopeClosers+="})"},r._closeScopeLevels=function(){this._emitLine(this._scopeClosers+";"),this._scopeClosers=""},r._withScopedSyntax=function(e){var t=this._scopeClosers;this._scopeClosers="",e.call(this),this._closeScopeLevels(),this._scopeClosers=t},r._makeCallback=function(e){var t=this._tmpid();return"function("+t+(e?","+e:"")+") {\nif("+t+") { cb("+t+"); return; }"},r._tmpid=function(){return this.lastId++,"t_"+this.lastId},r._templateName=function(){return null==this.templateName?"undefined":JSON.stringify(this.templateName)},r._compileChildren=function(e,t){var n=this;e.children.forEach((function(e){n.compile(e,t)}))},r._compileAggregate=function(e,t,n,i){var a=this;n&&this._emit(n),e.children.forEach((function(e,n){n>0&&a._emit(","),a.compile(e,t)})),i&&this._emit(i)},r._compileExpression=function(e,t){this.assertType(e,s.Literal,s.Symbol,s.Group,s.Array,s.Dict,s.FunCall,s.Caller,s.Filter,s.LookupVal,s.Compare,s.InlineIf,s.In,s.Is,s.And,s.Or,s.Not,s.Add,s.Concat,s.Sub,s.Mul,s.Div,s.FloorDiv,s.Mod,s.Pow,s.Neg,s.Pos,s.Compare,s.NodeList),this.compile(e,t)},r.assertType=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.some((function(t){return e instanceof t}))||this.fail("assertType: invalid type: "+e.typename,e.lineno,e.colno)},r.compileCallExtension=function(e,t,n){var i=this,a=e.args,r=e.contentArgs,o="boolean"!=typeof e.autoescape||e.autoescape;if(n||this._emit(this.buffer+" += runtime.suppressValue("),this._emit('env.getExtension("'+e.extName+'")["'+e.prop+'"]('),this._emit("context"),(a||r)&&this._emit(","),a&&(a instanceof s.NodeList||this.fail("compileCallExtension: arguments must be a NodeList, use `parser.parseSignature`"),a.children.forEach((function(e,n){i._compileExpression(e,t),(n!==a.children.length-1||r.length)&&i._emit(",")}))),r.length&&r.forEach((function(e,n){if(n>0&&i._emit(","),e){i._emitLine("function(cb) {"),i._emitLine("if(!cb) { cb = function(err) { if(err) { throw err; }}}");var a=i._pushBuffer();i._withScopedSyntax((function(){i.compile(e,t),i._emitLine("cb(null, "+a+");")})),i._popBuffer(),i._emitLine("return "+a+";"),i._emitLine("}")}else i._emit("null")})),n){var c=this._tmpid();this._emitLine(", "+this._makeCallback(c)),this._emitLine(this.buffer+" += runtime.suppressValue("+c+", "+o+" && env.opts.autoescape);"),this._addScopeLevel()}else this._emit(")"),this._emit(", "+o+" && env.opts.autoescape);\n")},r.compileCallExtensionAsync=function(e,t){this.compileCallExtension(e,t,!0)},r.compileNodeList=function(e,t){this._compileChildren(e,t)},r.compileLiteral=function(e){if("string"==typeof e.value){var t=e.value.replace(/\\/g,"\\\\");t=(t=(t=(t=(t=t.replace(/"/g,'\\"')).replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace(/\t/g,"\\t")).replace(/\u2028/g,"\\u2028"),this._emit('"'+t+'"')}else null===e.value?this._emit("null"):this._emit(e.value.toString())},r.compileSymbol=function(e,t){var n=e.value,i=t.lookup(n);i?this._emit(i):this._emit('runtime.contextOrFrameLookup(context, frame, "'+n+'")')},r.compileGroup=function(e,t){this._compileAggregate(e,t,"(",")")},r.compileArray=function(e,t){this._compileAggregate(e,t,"[","]")},r.compileDict=function(e,t){this._compileAggregate(e,t,"{","}")},r.compilePair=function(e,t){var n=e.key,i=e.value;n instanceof s.Symbol?n=new s.Literal(n.lineno,n.colno,n.value):n instanceof s.Literal&&"string"==typeof n.value||this.fail("compilePair: Dict keys must be strings or names",n.lineno,n.colno),this.compile(n,t),this._emit(": "),this._compileExpression(i,t)},r.compileInlineIf=function(e,t){this._emit("("),this.compile(e.cond,t),this._emit("?"),this.compile(e.body,t),this._emit(":"),null!==e.else_?this.compile(e.else_,t):this._emit('""'),this._emit(")")},r.compileIn=function(e,t){this._emit("runtime.inOperator("),this.compile(e.left,t),this._emit(","),this.compile(e.right,t),this._emit(")")},r.compileIs=function(e,t){var n=e.right.name?e.right.name.value:e.right.value;this._emit('env.getTest("'+n+'").call(context, '),this.compile(e.left,t),e.right.args&&(this._emit(","),this.compile(e.right.args,t)),this._emit(") === true")},r._binOpEmitter=function(e,t,n){this.compile(e.left,t),this._emit(n),this.compile(e.right,t)},r.compileOr=function(e,t){return this._binOpEmitter(e,t," || ")},r.compileAnd=function(e,t){return this._binOpEmitter(e,t," && ")},r.compileAdd=function(e,t){return this._binOpEmitter(e,t," + ")},r.compileConcat=function(e,t){return this._binOpEmitter(e,t,' + "" + ')},r.compileSub=function(e,t){return this._binOpEmitter(e,t," - ")},r.compileMul=function(e,t){return this._binOpEmitter(e,t," * ")},r.compileDiv=function(e,t){return this._binOpEmitter(e,t," / ")},r.compileMod=function(e,t){return this._binOpEmitter(e,t," % ")},r.compileNot=function(e,t){this._emit("!"),this.compile(e.target,t)},r.compileFloorDiv=function(e,t){this._emit("Math.floor("),this.compile(e.left,t),this._emit(" / "),this.compile(e.right,t),this._emit(")")},r.compilePow=function(e,t){this._emit("Math.pow("),this.compile(e.left,t),this._emit(", "),this.compile(e.right,t),this._emit(")")},r.compileNeg=function(e,t){this._emit("-"),this.compile(e.target,t)},r.compilePos=function(e,t){this._emit("+"),this.compile(e.target,t)},r.compileCompare=function(e,t){var n=this;this.compile(e.expr,t),e.ops.forEach((function(e){n._emit(" "+u[e.type]+" "),n.compile(e.expr,t)}))},r.compileLookupVal=function(e,t){this._emit("runtime.memberLookup(("),this._compileExpression(e.target,t),this._emit("),"),this._compileExpression(e.val,t),this._emit(")")},r._getNodeName=function(e){switch(e.typename){case"Symbol":return e.value;case"FunCall":return"the return value of ("+this._getNodeName(e.name)+")";case"LookupVal":return this._getNodeName(e.target)+'["'+this._getNodeName(e.val)+'"]';case"Literal":return e.value.toString();default:return"--expression--"}},r.compileFunCall=function(e,t){this._emit("(lineno = "+e.lineno+", colno = "+e.colno+", "),this._emit("runtime.callWrap("),this._compileExpression(e.name,t),this._emit(', "'+this._getNodeName(e.name).replace(/"/g,'\\"')+'", context, '),this._compileAggregate(e.args,t,"[","])"),this._emit(")")},r.compileFilter=function(e,t){var n=e.name;this.assertType(n,s.Symbol),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emit(")")},r.compileFilterAsync=function(e,t){var n=e.name,i=e.symbol.value;this.assertType(n,s.Symbol),t.set(i,i),this._emit('env.getFilter("'+n.value+'").call(context, '),this._compileAggregate(e.args,t),this._emitLine(", "+this._makeCallback(i)),this._addScopeLevel()},r.compileKeywordArgs=function(e,t){this._emit("runtime.makeKeywordArgs("),this.compileDict(e,t),this._emit(")")},r.compileSet=function(e,t){var n=this,i=[];e.targets.forEach((function(e){var a=e.value,r=t.lookup(a);null==r&&(r=n._tmpid(),n._emitLine("var "+r+";")),i.push(r)})),e.value?(this._emit(i.join(" = ")+" = "),this._compileExpression(e.value,t),this._emitLine(";")):(this._emit(i.join(" = ")+" = "),this.compile(e.body,t),this._emitLine(";")),e.targets.forEach((function(e,t){var a=i[t],r=e.value;n._emitLine('frame.set("'+r+'", '+a+", true);"),n._emitLine("if(frame.topLevel) {"),n._emitLine('context.setVariable("'+r+'", '+a+");"),n._emitLine("}"),"_"!==r.charAt(0)&&(n._emitLine("if(frame.topLevel) {"),n._emitLine('context.addExport("'+r+'", '+a+");"),n._emitLine("}"))}))},r.compileSwitch=function(e,t){var n=this;this._emit("switch ("),this.compile(e.expr,t),this._emit(") {"),e.cases.forEach((function(e,i){n._emit("case "),n.compile(e.cond,t),n._emit(": "),n.compile(e.body,t),e.body.children.length&&n._emitLine("break;")})),e.default&&(this._emit("default:"),this.compile(e.default,t)),this._emit("}")},r.compileIf=function(e,t,n){var i=this;this._emit("if("),this._compileExpression(e.cond,t),this._emitLine(") {"),this._withScopedSyntax((function(){i.compile(e.body,t),n&&i._emit("cb()")})),e.else_?(this._emitLine("}\nelse {"),this._withScopedSyntax((function(){i.compile(e.else_,t),n&&i._emit("cb()")}))):n&&(this._emitLine("}\nelse {"),this._emit("cb()")),this._emitLine("}")},r.compileIfAsync=function(e,t){this._emit("(function(cb) {"),this.compileIf(e,t,!0),this._emit("})("+this._makeCallback()),this._addScopeLevel()},r._emitLoopBindings=function(e,t,n,i){var a=this;[{name:"index",val:n+" + 1"},{name:"index0",val:n},{name:"revindex",val:i+" - "+n},{name:"revindex0",val:i+" - "+n+" - 1"},{name:"first",val:n+" === 0"},{name:"last",val:n+" === "+i+" - 1"},{name:"length",val:i}].forEach((function(e){a._emitLine('frame.set("loop.'+e.name+'", '+e.val+");")}))},r.compileFor=function(e,t){var n=this,i=this._tmpid(),a=this._tmpid(),r=this._tmpid();if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+r+" = "),this._compileExpression(e.arr,t),this._emitLine(";"),this._emit("if("+r+") {"),this._emitLine(r+" = runtime.fromIterator("+r+");"),e.name instanceof s.Array){this._emitLine("var "+i+";"),this._emitLine("if(runtime.isArray("+r+")) {"),this._emitLine("var "+a+" = "+r+".length;"),this._emitLine("for("+i+"=0; "+i+" < "+r+".length; "+i+"++) {"),e.name.children.forEach((function(a,s){var o=n._tmpid();n._emitLine("var "+o+" = "+r+"["+i+"]["+s+"];"),n._emitLine('frame.set("'+a+'", '+r+"["+i+"]["+s+"]);"),t.set(e.name.children[s].value,o)})),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("} else {");var o=e.name.children,c=o[0],l=o[1],u=this._tmpid(),d=this._tmpid();t.set(c.value,u),t.set(l.value,d),this._emitLine(i+" = -1;"),this._emitLine("var "+a+" = runtime.keys("+r+").length;"),this._emitLine("for(var "+u+" in "+r+") {"),this._emitLine(i+"++;"),this._emitLine("var "+d+" = "+r+"["+u+"];"),this._emitLine('frame.set("'+c.value+'", '+u+");"),this._emitLine('frame.set("'+l.value+'", '+d+");"),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}"),this._emitLine("}")}else{var h=this._tmpid();t.set(e.name.value,h),this._emitLine("var "+a+" = "+r+".length;"),this._emitLine("for(var "+i+"=0; "+i+" < "+r+".length; "+i+"++) {"),this._emitLine("var "+h+" = "+r+"["+i+"];"),this._emitLine('frame.set("'+e.name.value+'", '+h+");"),this._emitLoopBindings(e,r,i,a),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("}")}this._emitLine("}"),e.else_&&(this._emitLine("if (!"+a+") {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},r._compileAsyncLoop=function(e,t,n){var i=this,a=this._tmpid(),r=this._tmpid(),o=this._tmpid(),c=n?"asyncAll":"asyncEach";if(t=t.push(),this._emitLine("frame = frame.push();"),this._emit("var "+o+" = runtime.fromIterator("),this._compileExpression(e.arr,t),this._emitLine(");"),e.name instanceof s.Array){var l=e.name.children.length;this._emit("runtime."+c+"("+o+", "+l+", function("),e.name.children.forEach((function(e){i._emit(e.value+",")})),this._emit(a+","+r+",next) {"),e.name.children.forEach((function(e){var n=e.value;t.set(n,n),i._emitLine('frame.set("'+n+'", '+n+");")}))}else{var u=e.name.value;this._emitLine("runtime."+c+"("+o+", 1, function("+u+", "+a+", "+r+",next) {"),this._emitLine('frame.set("'+u+'", '+u+");"),t.set(u,u)}this._emitLoopBindings(e,o,a,r),this._withScopedSyntax((function(){var r;n&&(r=i._pushBuffer()),i.compile(e.body,t),i._emitLine("next("+a+(r?","+r:"")+");"),n&&i._popBuffer()}));var d=this._tmpid();this._emitLine("}, "+this._makeCallback(d)),this._addScopeLevel(),n&&this._emitLine(this.buffer+" += "+d+";"),e.else_&&(this._emitLine("if (!"+o+".length) {"),this.compile(e.else_,t),this._emitLine("}")),this._emitLine("frame = frame.pop();")},r.compileAsyncEach=function(e,t){this._compileAsyncLoop(e,t)},r.compileAsyncAll=function(e,t){this._compileAsyncLoop(e,t,!0)},r._compileMacro=function(e,t){var n=this,i=[],a=null,r="macro_"+this._tmpid(),o=void 0!==t;e.args.children.forEach((function(t,r){r===e.args.children.length-1&&t instanceof s.Dict?a=t:(n.assertType(t,s.Symbol),i.push(t))}));var l,u=[].concat(i.map((function(e){return"l_"+e.value})),["kwargs"]),d=i.map((function(e){return'"'+e.value+'"'})),h=(a&&a.children||[]).map((function(e){return'"'+e.key.value+'"'}));l=o?t.push(!0):new c,this._emitLines("var "+r+" = runtime.makeMacro(","["+d.join(", ")+"], ","["+h.join(", ")+"], ","function ("+u.join(", ")+") {","var callerFrame = frame;","frame = "+(o?"frame.push(true);":"new runtime.Frame();"),"kwargs = kwargs || {};",'if (Object.prototype.hasOwnProperty.call(kwargs, "caller")) {','frame.set("caller", kwargs.caller); }'),i.forEach((function(e){n._emitLine('frame.set("'+e.value+'", l_'+e.value+");"),l.set(e.value,"l_"+e.value)})),a&&a.children.forEach((function(e){var t=e.key.value;n._emit('frame.set("'+t+'", '),n._emit('Object.prototype.hasOwnProperty.call(kwargs, "'+t+'")'),n._emit(' ? kwargs["'+t+'"] : '),n._compileExpression(e.value,l),n._emit(");")}));var p=this._pushBuffer();return this._withScopedSyntax((function(){n.compile(e.body,l)})),this._emitLine("frame = "+(o?"frame.pop();":"callerFrame;")),this._emitLine("return new runtime.SafeString("+p+");"),this._emitLine("});"),this._popBuffer(),r},r.compileMacro=function(e,t){var n=this._compileMacro(e),i=e.name.value;t.set(i,n),t.parent?this._emitLine('frame.set("'+i+'", '+n+");"):("_"!==e.name.value.charAt(0)&&this._emitLine('context.addExport("'+i+'");'),this._emitLine('context.setVariable("'+i+'", '+n+");"))},r.compileCaller=function(e,t){this._emit("(function (){");var n=this._compileMacro(e,t);this._emit("return "+n+";})()")},r._compileGetTemplate=function(e,t,n,i){var a=this._tmpid(),r=this._templateName(),s=this._makeCallback(a),o=n?"true":"false",c=i?"true":"false";return this._emit("env.getTemplate("),this._compileExpression(e.template,t),this._emitLine(", "+o+", "+r+", "+c+", "+s),a},r.compileImport=function(e,t){var n=e.target.value,i=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(i+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(i)),this._addScopeLevel(),t.set(n,i),t.parent?this._emitLine('frame.set("'+n+'", '+i+");"):this._emitLine('context.setVariable("'+n+'", '+i+");")},r.compileFromImport=function(e,t){var n=this,i=this._compileGetTemplate(e,t,!1,!1);this._addScopeLevel(),this._emitLine(i+".getExported("+(e.withContext?"context.getVariables(), frame, ":"")+this._makeCallback(i)),this._addScopeLevel(),e.names.children.forEach((function(e){var a,r,o=n._tmpid();e instanceof s.Pair?(a=e.key.value,r=e.value.value):r=a=e.value,n._emitLine("if(Object.prototype.hasOwnProperty.call("+i+', "'+a+'")) {'),n._emitLine("var "+o+" = "+i+"."+a+";"),n._emitLine("} else {"),n._emitLine("cb(new Error(\"cannot import '"+a+"'\")); return;"),n._emitLine("}"),t.set(r,o),t.parent?n._emitLine('frame.set("'+r+'", '+o+");"):n._emitLine('context.setVariable("'+r+'", '+o+");")}))},r.compileBlock=function(e){var t=this._tmpid();this.inBlock||this._emit('(parentTemplate ? function(e, c, f, r, cb) { cb(""); } : '),this._emit('context.getBlock("'+e.name.value+'")'),this.inBlock||this._emit(")"),this._emitLine("(env, context, frame, runtime, "+this._makeCallback(t)),this._emitLine(this.buffer+" += "+t+";"),this._addScopeLevel()},r.compileSuper=function(e,t){var n=e.blockName.value,i=e.symbol.value,a=this._makeCallback(i);this._emitLine('context.getSuper(env, "'+n+'", b_'+n+", frame, runtime, "+a),this._emitLine(i+" = runtime.markSafe("+i+");"),this._addScopeLevel(),t.set(i,i)},r.compileExtends=function(e,t){var n=this._tmpid(),i=this._compileGetTemplate(e,t,!0,!1);this._emitLine("parentTemplate = "+i),this._emitLine("for(var "+n+" in parentTemplate.blocks) {"),this._emitLine("context.addBlock("+n+", parentTemplate.blocks["+n+"]);"),this._emitLine("}"),this._addScopeLevel()},r.compileInclude=function(e,t){this._emitLine("var tasks = [];"),this._emitLine("tasks.push("),this._emitLine("function(callback) {");var n=this._compileGetTemplate(e,t,!1,e.ignoreMissing);this._emitLine("callback(null,"+n+");});"),this._emitLine("});");var i=this._tmpid();this._emitLine("tasks.push("),this._emitLine("function(template, callback){"),this._emitLine("template.render(context.getVariables(), frame, "+this._makeCallback(i)),this._emitLine("callback(null,"+i+");});"),this._emitLine("});"),this._emitLine("tasks.push("),this._emitLine("function(result, callback){"),this._emitLine(this.buffer+" += result;"),this._emitLine("callback(null);"),this._emitLine("});"),this._emitLine("env.waterfall(tasks, function(){"),this._addScopeLevel()},r.compileTemplateData=function(e,t){this.compileLiteral(e,t)},r.compileCapture=function(e,t){var n=this,i=this.buffer;this.buffer="output",this._emitLine("(function() {"),this._emitLine('var output = "";'),this._withScopedSyntax((function(){n.compile(e.body,t)})),this._emitLine("return output;"),this._emitLine("})()"),this.buffer=i},r.compileOutput=function(e,t){var n=this;e.children.forEach((function(i){i instanceof s.TemplateData?i.value&&(n._emit(n.buffer+" += "),n.compileLiteral(i,t),n._emitLine(";")):(n._emit(n.buffer+" += runtime.suppressValue("),n.throwOnUndefined&&n._emit("runtime.ensureDefined("),n.compile(i,t),n.throwOnUndefined&&n._emit(","+e.lineno+","+e.colno+")"),n._emit(", env.opts.autoescape);\n"))}))},r.compileRoot=function(e,t){var n=this;t&&this.fail("compileRoot: root node can't have frame"),t=new c,this._emitFuncBegin(e,"root"),this._emitLine("var parentTemplate = null;"),this._compileChildren(e,t),this._emitLine("if(parentTemplate) {"),this._emitLine("parentTemplate.rootRenderFunc(env, context, frame, runtime, cb);"),this._emitLine("} else {"),this._emitLine("cb(null, "+this.buffer+");"),this._emitLine("}"),this._emitFuncEnd(!0),this.inBlock=!0;var i=[],a=e.findAll(s.Block);a.forEach((function(e,t){var a=e.name.value;if(-1!==i.indexOf(a))throw new Error('Block "'+a+'" defined more than once.');i.push(a),n._emitFuncBegin(e,"b_"+a);var r=new c;n._emitLine("var frame = frame.push(true);"),n.compile(e.body,r),n._emitFuncEnd()})),this._emitLine("return {"),a.forEach((function(e,t){var i="b_"+e.name.value;n._emitLine(i+": "+i+",")})),this._emitLine("root: root\n};")},r.compile=function(e,t){var n=this["compile"+e.typename];n?n.call(this,e,t):this.fail("compile: Cannot compile node: "+e.typename,e.lineno,e.colno)},r.getCode=function(){return this.codebuf.join("")},a}(l);e.exports={compile:function(e,t,n,i,s){void 0===s&&(s={});var o=new d(i,s.throwOnUndefined),c=(n||[]).map((function(e){return e.preprocess})).filter((function(e){return!!e})),l=c.reduce((function(e,t){return t(e)}),e);return o.compile(r.transform(a.parse(l,n,s),t,i)),o.getCode()},Compiler:d}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(4),r=n(1).EmitterObj;e.exports=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var s=r.prototype;return s.resolve=function(e,t){return a.resolve(a.dirname(e),t)},s.isRelative=function(e){return 0===e.indexOf("./")||0===e.indexOf("../")},r}(r)},function(e,t,n){function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)}function a(e,t){return a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},a(e,t)}var r=n(12),s=n(15),o=n(0),c=n(5),l=n(18),u=n(10),d=u.FileSystemLoader,h=u.WebLoader,p=u.PrecompiledLoader,m=n(20),f=n(21),g=n(1),v=g.Obj,_=g.EmitterObj,y=n(2),b=y.handleError,w=y.Frame,x=n(22);function k(e,t,n){r((function(){e(t,n)}))}var C={type:"code",obj:{root:function(e,t,n,i,a){try{a(null,"")}catch(e){a(b(e,null,null))}}}},M=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t){var n=this;t=this.opts=t||{},this.opts.dev=!!t.dev,this.opts.autoescape=null==t.autoescape||t.autoescape,this.opts.throwOnUndefined=!!t.throwOnUndefined,this.opts.trimBlocks=!!t.trimBlocks,this.opts.lstripBlocks=!!t.lstripBlocks,this.loaders=[],e?this.loaders=o.isArray(e)?e:[e]:d?this.loaders=[new d("views")]:h&&(this.loaders=[new h("/views")]),"undefined"!=typeof window&&window.nunjucksPrecompiled&&this.loaders.unshift(new p(window.nunjucksPrecompiled)),this._initLoaders(),this.globals=f(),this.filters={},this.tests={},this.asyncFilters=[],this.extensions={},this.extensionsList=[],o._entries(l).forEach((function(e){var t=e[0],i=e[1];return n.addFilter(t,i)})),o._entries(m).forEach((function(e){var t=e[0],i=e[1];return n.addTest(t,i)}))},n._initLoaders=function(){var e=this;this.loaders.forEach((function(t){t.cache={},"function"==typeof t.on&&(t.on("update",(function(n,i){t.cache[n]=null,e.emit("update",n,i,t)})),t.on("load",(function(n,i){e.emit("load",n,i,t)})))}))},n.invalidateCache=function(){this.loaders.forEach((function(e){e.cache={}}))},n.addExtension=function(e,t){return t.__name=e,this.extensions[e]=t,this.extensionsList.push(t),this},n.removeExtension=function(e){var t=this.getExtension(e);t&&(this.extensionsList=o.without(this.extensionsList,t),delete this.extensions[e])},n.getExtension=function(e){return this.extensions[e]},n.hasExtension=function(e){return!!this.extensions[e]},n.addGlobal=function(e,t){return this.globals[e]=t,this},n.getGlobal=function(e){if(void 0===this.globals[e])throw new Error("global not found: "+e);return this.globals[e]},n.addFilter=function(e,t,n){var i=t;return n&&this.asyncFilters.push(e),this.filters[e]=i,this},n.getFilter=function(e){if(!this.filters[e])throw new Error("filter not found: "+e);return this.filters[e]},n.addTest=function(e,t){return this.tests[e]=t,this},n.getTest=function(e){if(!this.tests[e])throw new Error("test not found: "+e);return this.tests[e]},n.resolveTemplate=function(e,t,n){return e.isRelative&&t&&e.isRelative(n)&&e.resolve?e.resolve(t,n):n},n.getTemplate=function(e,t,n,i,a){var r,s=this,c=this,l=null;if(e&&e.raw&&(e=e.raw),o.isFunction(n)&&(a=n,n=null,t=t||!1),o.isFunction(t)&&(a=t,t=!1),e instanceof S)l=e;else{if("string"!=typeof e)throw new Error("template names must be a string: "+e);for(var u=0;u<this.loaders.length;u++){var d=this.loaders[u];if(l=d.cache[this.resolveTemplate(d,n,e)])break}}return l?(t&&l.compile(),a?void a(null,l):l):(o.asyncIter(this.loaders,(function(t,i,a,r){function s(e,n){e?r(e):n?(n.loader=t,r(null,n)):a()}e=c.resolveTemplate(t,n,e),t.async?t.getSource(e,s):s(null,t.getSource(e))}),(function(n,o){if(o||n||i||(n=new Error("template not found: "+e)),n){if(a)return void a(n);throw n}var c;o?(c=new S(o.src,s,o.path,t),o.noCache||(o.loader.cache[e]=c)):c=new S(C,s,"",t),a?a(null,c):r=c})),r)},n.express=function(e){return x(this,e)},n.render=function(e,t,n){o.isFunction(t)&&(n=t,t=null);var i=null;return this.getTemplate(e,(function(e,a){if(e&&n)k(n,e);else{if(e)throw e;i=a.render(t,n)}})),i},n.renderString=function(e,t,n,i){return o.isFunction(n)&&(i=n,n={}),new S(e,this,(n=n||{}).path).render(t,i)},n.waterfall=function(e,t,n){return s(e,t,n)},t}(_),E=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t,n){var i=this;this.env=n||new M,this.ctx=o.extend({},e),this.blocks={},this.exported=[],o.keys(t).forEach((function(e){i.addBlock(e,t[e])}))},n.lookup=function(e){return e in this.env.globals&&!(e in this.ctx)?this.env.globals[e]:this.ctx[e]},n.setVariable=function(e,t){this.ctx[e]=t},n.getVariables=function(){return this.ctx},n.addBlock=function(e,t){return this.blocks[e]=this.blocks[e]||[],this.blocks[e].push(t),this},n.getBlock=function(e){if(!this.blocks[e])throw new Error('unknown block "'+e+'"');return this.blocks[e][0]},n.getSuper=function(e,t,n,i,a,r){var s=o.indexOf(this.blocks[t]||[],n),c=this.blocks[t][s+1];if(-1===s||!c)throw new Error('no super block available for "'+t+'"');c(e,this,i,a,r)},n.addExport=function(e){this.exported.push(e)},n.getExported=function(){var e=this,t={};return this.exported.forEach((function(n){t[n]=e.ctx[n]})),t},t}(v),S=function(e){function t(){return e.apply(this,arguments)||this}i(t,e);var n=t.prototype;return n.init=function(e,t,n,i){if(this.env=t||new M,o.isObject(e))switch(e.type){case"code":this.tmplProps=e.obj;break;case"string":this.tmplStr=e.obj;break;default:throw new Error("Unexpected template object type "+e.type+"; expected 'code', or 'string'")}else{if(!o.isString(e))throw new Error("src must be a string or an object describing the source");this.tmplStr=e}if(this.path=n,i)try{this._compile()}catch(e){throw o._prettifyError(this.path,this.env.opts.dev,e)}else this.compiled=!1},n.render=function(e,t,n){var i=this;"function"==typeof e?(n=e,e={}):"function"==typeof t&&(n=t,t=null);var a=!t;try{this.compile()}catch(e){var r=o._prettifyError(this.path,this.env.opts.dev,e);if(n)return k(n,r);throw r}var s=new E(e||{},this.blocks,this.env),c=t?t.push(!0):new w;c.topLevel=!0;var l=null,u=!1;return this.rootRenderFunc(this.env,s,c,y,(function(e,t){if(!u||!n||void 0===t)if(e&&(e=o._prettifyError(i.path,i.env.opts.dev,e),u=!0),n)a?k(n,e,t):n(e,t);else{if(e)throw e;l=t}})),l},n.getExported=function(e,t,n){"function"==typeof e&&(n=e,e={}),"function"==typeof t&&(n=t,t=null);try{this.compile()}catch(e){if(n)return n(e);throw e}var i=t?t.push():new w;i.topLevel=!0;var a=new E(e||{},this.blocks,this.env);this.rootRenderFunc(this.env,a,i,y,(function(e){e?n(e,null):n(null,a.getExported())}))},n.compile=function(){this.compiled||this._compile()},n._compile=function(){var e;if(this.tmplProps)e=this.tmplProps;else{var t=c.compile(this.tmplStr,this.env.asyncFilters,this.env.extensionsList,this.path,this.env.opts);e=new Function(t)()}this.blocks=this._getBlocks(e),this.rootRenderFunc=e.root,this.compiled=!0},n._getBlocks=function(e){var t={};return o.keys(e).forEach((function(n){"b_"===n.slice(0,2)&&(t[n.slice(2)]=e[n])})),t},t}(v);e.exports={Environment:M,Template:S}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(9),r=n(3),s=n(1).Obj,o=n(0),c=function(e){var t,n;function s(){return e.apply(this,arguments)||this}n=e,(t=s).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var c=s.prototype;return c.init=function(e){this.tokens=e,this.peeked=null,this.breakOnBlocks=null,this.dropLeadingWhitespace=!1,this.extensions=[]},c.nextToken=function(e){var t;if(this.peeked){if(e||this.peeked.type!==a.TOKEN_WHITESPACE)return t=this.peeked,this.peeked=null,t;this.peeked=null}if(t=this.tokens.nextToken(),!e)for(;t&&t.type===a.TOKEN_WHITESPACE;)t=this.tokens.nextToken();return t},c.peekToken=function(){return this.peeked=this.peeked||this.nextToken(),this.peeked},c.pushToken=function(e){if(this.peeked)throw new Error("pushToken: can only push one token on between reads");this.peeked=e},c.error=function(e,t,n){if(void 0===t||void 0===n){var i=this.peekToken()||{};t=i.lineno,n=i.colno}return void 0!==t&&(t+=1),void 0!==n&&(n+=1),new o.TemplateError(e,t,n)},c.fail=function(e,t,n){throw this.error(e,t,n)},c.skip=function(e){var t=this.nextToken();return!(!t||t.type!==e)||(this.pushToken(t),!1)},c.expect=function(e){var t=this.nextToken();return t.type!==e&&this.fail("expected "+e+", got "+t.type,t.lineno,t.colno),t},c.skipValue=function(e,t){var n=this.nextToken();return!(!n||n.type!==e||n.value!==t)||(this.pushToken(n),!1)},c.skipSymbol=function(e){return this.skipValue(a.TOKEN_SYMBOL,e)},c.advanceAfterBlockEnd=function(e){var t;return e||((t=this.peekToken())||this.fail("unexpected end of file"),t.type!==a.TOKEN_SYMBOL&&this.fail("advanceAfterBlockEnd: expected symbol token or explicit name to be passed"),e=this.nextToken().value),(t=this.nextToken())&&t.type===a.TOKEN_BLOCK_END?"-"===t.value.charAt(0)&&(this.dropLeadingWhitespace=!0):this.fail("expected block end in "+e+" statement"),t},c.advanceAfterVariableEnd=function(){var e=this.nextToken();e&&e.type===a.TOKEN_VARIABLE_END?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.VARIABLE_END.length-1):(this.pushToken(e),this.fail("expected variable end"))},c.parseFor=function(){var e,t,n=this.peekToken();if(this.skipSymbol("for")?(e=new r.For(n.lineno,n.colno),t="endfor"):this.skipSymbol("asyncEach")?(e=new r.AsyncEach(n.lineno,n.colno),t="endeach"):this.skipSymbol("asyncAll")?(e=new r.AsyncAll(n.lineno,n.colno),t="endall"):this.fail("parseFor: expected for{Async}",n.lineno,n.colno),e.name=this.parsePrimary(),e.name instanceof r.Symbol||this.fail("parseFor: variable name expected for loop"),this.peekToken().type===a.TOKEN_COMMA){var i=e.name;for(e.name=new r.Array(i.lineno,i.colno),e.name.addChild(i);this.skip(a.TOKEN_COMMA);){var s=this.parsePrimary();e.name.addChild(s)}}return this.skipSymbol("in")||this.fail('parseFor: expected "in" keyword for loop',n.lineno,n.colno),e.arr=this.parseExpression(),this.advanceAfterBlockEnd(n.value),e.body=this.parseUntilBlocks(t,"else"),this.skipSymbol("else")&&(this.advanceAfterBlockEnd("else"),e.else_=this.parseUntilBlocks(t)),this.advanceAfterBlockEnd(),e},c.parseMacro=function(){var e=this.peekToken();this.skipSymbol("macro")||this.fail("expected macro");var t=this.parsePrimary(!0),n=this.parseSignature(),i=new r.Macro(e.lineno,e.colno,t,n);return this.advanceAfterBlockEnd(e.value),i.body=this.parseUntilBlocks("endmacro"),this.advanceAfterBlockEnd(),i},c.parseCall=function(){var e=this.peekToken();this.skipSymbol("call")||this.fail("expected call");var t=this.parseSignature(!0)||new r.NodeList,n=this.parsePrimary();this.advanceAfterBlockEnd(e.value);var i=this.parseUntilBlocks("endcall");this.advanceAfterBlockEnd();var a=new r.Symbol(e.lineno,e.colno,"caller"),s=new r.Caller(e.lineno,e.colno,a,t,i),o=n.args.children;return o[o.length-1]instanceof r.KeywordArgs||o.push(new r.KeywordArgs),o[o.length-1].addChild(new r.Pair(e.lineno,e.colno,a,s)),new r.Output(e.lineno,e.colno,[n])},c.parseWithContext=function(){var e=this.peekToken(),t=null;return this.skipSymbol("with")?t=!0:this.skipSymbol("without")&&(t=!1),null!==t&&(this.skipSymbol("context")||this.fail("parseFrom: expected context after with/without",e.lineno,e.colno)),t},c.parseImport=function(){var e=this.peekToken();this.skipSymbol("import")||this.fail("parseImport: expected import",e.lineno,e.colno);var t=this.parseExpression();this.skipSymbol("as")||this.fail('parseImport: expected "as" keyword',e.lineno,e.colno);var n=this.parseExpression(),i=this.parseWithContext(),a=new r.Import(e.lineno,e.colno,t,n,i);return this.advanceAfterBlockEnd(e.value),a},c.parseFrom=function(){var e=this.peekToken();this.skipSymbol("from")||this.fail("parseFrom: expected from");var t=this.parseExpression();this.skipSymbol("import")||this.fail("parseFrom: expected import",e.lineno,e.colno);for(var n,i=new r.NodeList;;){var s=this.peekToken();if(s.type===a.TOKEN_BLOCK_END){i.children.length||this.fail("parseFrom: Expected at least one import name",e.lineno,e.colno),"-"===s.value.charAt(0)&&(this.dropLeadingWhitespace=!0),this.nextToken();break}i.children.length>0&&!this.skip(a.TOKEN_COMMA)&&this.fail("parseFrom: expected comma",e.lineno,e.colno);var o=this.parsePrimary();if("_"===o.value.charAt(0)&&this.fail("parseFrom: names starting with an underscore cannot be imported",o.lineno,o.colno),this.skipSymbol("as")){var c=this.parsePrimary();i.addChild(new r.Pair(o.lineno,o.colno,o,c))}else i.addChild(o);n=this.parseWithContext()}return new r.FromImport(e.lineno,e.colno,t,i,n)},c.parseBlock=function(){var e=this.peekToken();this.skipSymbol("block")||this.fail("parseBlock: expected block",e.lineno,e.colno);var t=new r.Block(e.lineno,e.colno);t.name=this.parsePrimary(),t.name instanceof r.Symbol||this.fail("parseBlock: variable name expected",e.lineno,e.colno),this.advanceAfterBlockEnd(e.value),t.body=this.parseUntilBlocks("endblock"),this.skipSymbol("endblock"),this.skipSymbol(t.name.value);var n=this.peekToken();return n||this.fail("parseBlock: expected endblock, got end of file"),this.advanceAfterBlockEnd(n.value),t},c.parseExtends=function(){var e="extends",t=this.peekToken();this.skipSymbol(e)||this.fail("parseTemplateRef: expected "+e);var n=new r.Extends(t.lineno,t.colno);return n.template=this.parseExpression(),this.advanceAfterBlockEnd(t.value),n},c.parseInclude=function(){var e="include",t=this.peekToken();this.skipSymbol(e)||this.fail("parseInclude: expected "+e);var n=new r.Include(t.lineno,t.colno);return n.template=this.parseExpression(),this.skipSymbol("ignore")&&this.skipSymbol("missing")&&(n.ignoreMissing=!0),this.advanceAfterBlockEnd(t.value),n},c.parseIf=function(){var e,t=this.peekToken();this.skipSymbol("if")||this.skipSymbol("elif")||this.skipSymbol("elseif")?e=new r.If(t.lineno,t.colno):this.skipSymbol("ifAsync")?e=new r.IfAsync(t.lineno,t.colno):this.fail("parseIf: expected if, elif, or elseif",t.lineno,t.colno),e.cond=this.parseExpression(),this.advanceAfterBlockEnd(t.value),e.body=this.parseUntilBlocks("elif","elseif","else","endif");var n=this.peekToken();switch(n&&n.value){case"elseif":case"elif":e.else_=this.parseIf();break;case"else":this.advanceAfterBlockEnd(),e.else_=this.parseUntilBlocks("endif"),this.advanceAfterBlockEnd();break;case"endif":e.else_=null,this.advanceAfterBlockEnd();break;default:this.fail("parseIf: expected elif, else, or endif, got end of file")}return e},c.parseSet=function(){var e=this.peekToken();this.skipSymbol("set")||this.fail("parseSet: expected set",e.lineno,e.colno);for(var t,n=new r.Set(e.lineno,e.colno,[]);(t=this.parsePrimary())&&(n.targets.push(t),this.skip(a.TOKEN_COMMA)););return this.skipValue(a.TOKEN_OPERATOR,"=")?(n.value=this.parseExpression(),this.advanceAfterBlockEnd(e.value)):this.skip(a.TOKEN_BLOCK_END)?(n.body=new r.Capture(e.lineno,e.colno,this.parseUntilBlocks("endset")),n.value=null,this.advanceAfterBlockEnd()):this.fail("parseSet: expected = or block end in set tag",e.lineno,e.colno),n},c.parseSwitch=function(){var e="switch",t="endswitch",n="case",i="default",a=this.peekToken();this.skipSymbol(e)||this.skipSymbol(n)||this.skipSymbol(i)||this.fail('parseSwitch: expected "switch," "case" or "default"',a.lineno,a.colno);var s=this.parseExpression();this.advanceAfterBlockEnd(e),this.parseUntilBlocks(n,i,t);var o,c=this.peekToken(),l=[];do{this.skipSymbol(n);var u=this.parseExpression();this.advanceAfterBlockEnd(e);var d=this.parseUntilBlocks(n,i,t);l.push(new r.Case(c.line,c.col,u,d)),c=this.peekToken()}while(c&&c.value===n);switch(c.value){case i:this.advanceAfterBlockEnd(),o=this.parseUntilBlocks(t),this.advanceAfterBlockEnd();break;case t:this.advanceAfterBlockEnd();break;default:this.fail('parseSwitch: expected "case," "default" or "endswitch," got EOF.')}return new r.Switch(a.lineno,a.colno,s,l,o)},c.parseStatement=function(){var e=this.peekToken();if(e.type!==a.TOKEN_SYMBOL&&this.fail("tag name expected",e.lineno,e.colno),this.breakOnBlocks&&-1!==o.indexOf(this.breakOnBlocks,e.value))return null;switch(e.value){case"raw":return this.parseRaw();case"verbatim":return this.parseRaw("verbatim");case"if":case"ifAsync":return this.parseIf();case"for":case"asyncEach":case"asyncAll":return this.parseFor();case"block":return this.parseBlock();case"extends":return this.parseExtends();case"include":return this.parseInclude();case"set":return this.parseSet();case"macro":return this.parseMacro();case"call":return this.parseCall();case"import":return this.parseImport();case"from":return this.parseFrom();case"filter":return this.parseFilterStatement();case"switch":return this.parseSwitch();default:if(this.extensions.length)for(var t=0;t<this.extensions.length;t++){var n=this.extensions[t];if(-1!==o.indexOf(n.tags||[],e.value))return n.parse(this,r,a)}this.fail("unknown block tag: "+e.value,e.lineno,e.colno)}},c.parseRaw=function(e){for(var t="end"+(e=e||"raw"),n=new RegExp("([\\s\\S]*?){%\\s*("+e+"|"+t+")\\s*(?=%})%}"),i=1,a="",s=null,o=this.advanceAfterBlockEnd();(s=this.tokens._extractRegex(n))&&i>0;){var c=s[0],l=s[1],u=s[2];u===e?i+=1:u===t&&(i-=1),0===i?(a+=l,this.tokens.backN(c.length-l.length)):a+=c}return new r.Output(o.lineno,o.colno,[new r.TemplateData(o.lineno,o.colno,a)])},c.parsePostfix=function(e){for(var t,n=this.peekToken();n;){if(n.type===a.TOKEN_LEFT_PAREN)e=new r.FunCall(n.lineno,n.colno,e,this.parseSignature());else if(n.type===a.TOKEN_LEFT_BRACKET)(t=this.parseAggregate()).children.length>1&&this.fail("invalid index"),e=new r.LookupVal(n.lineno,n.colno,e,t.children[0]);else{if(n.type!==a.TOKEN_OPERATOR||"."!==n.value)break;this.nextToken();var i=this.nextToken();i.type!==a.TOKEN_SYMBOL&&this.fail("expected name as lookup value, got "+i.value,i.lineno,i.colno),t=new r.Literal(i.lineno,i.colno,i.value),e=new r.LookupVal(n.lineno,n.colno,e,t)}n=this.peekToken()}return e},c.parseExpression=function(){return this.parseInlineIf()},c.parseInlineIf=function(){var e=this.parseOr();if(this.skipSymbol("if")){var t=this.parseOr(),n=e;(e=new r.InlineIf(e.lineno,e.colno)).body=n,e.cond=t,this.skipSymbol("else")?e.else_=this.parseOr():e.else_=null}return e},c.parseOr=function(){for(var e=this.parseAnd();this.skipSymbol("or");){var t=this.parseAnd();e=new r.Or(e.lineno,e.colno,e,t)}return e},c.parseAnd=function(){for(var e=this.parseNot();this.skipSymbol("and");){var t=this.parseNot();e=new r.And(e.lineno,e.colno,e,t)}return e},c.parseNot=function(){var e=this.peekToken();return this.skipSymbol("not")?new r.Not(e.lineno,e.colno,this.parseNot()):this.parseIn()},c.parseIn=function(){for(var e=this.parseIs();;){var t=this.nextToken();if(!t)break;var n=t.type===a.TOKEN_SYMBOL&&"not"===t.value;if(n||this.pushToken(t),!this.skipSymbol("in")){n&&this.pushToken(t);break}var i=this.parseIs();e=new r.In(e.lineno,e.colno,e,i),n&&(e=new r.Not(e.lineno,e.colno,e))}return e},c.parseIs=function(){var e=this.parseCompare();if(this.skipSymbol("is")){var t=this.skipSymbol("not"),n=this.parseCompare();e=new r.Is(e.lineno,e.colno,e,n),t&&(e=new r.Not(e.lineno,e.colno,e))}return e},c.parseCompare=function(){for(var e=["==","===","!=","!==","<",">","<=",">="],t=this.parseConcat(),n=[];;){var i=this.nextToken();if(!i)break;if(-1===e.indexOf(i.value)){this.pushToken(i);break}n.push(new r.CompareOperand(i.lineno,i.colno,this.parseConcat(),i.value))}return n.length?new r.Compare(n[0].lineno,n[0].colno,t,n):t},c.parseConcat=function(){for(var e=this.parseAdd();this.skipValue(a.TOKEN_TILDE,"~");){var t=this.parseAdd();e=new r.Concat(e.lineno,e.colno,e,t)}return e},c.parseAdd=function(){for(var e=this.parseSub();this.skipValue(a.TOKEN_OPERATOR,"+");){var t=this.parseSub();e=new r.Add(e.lineno,e.colno,e,t)}return e},c.parseSub=function(){for(var e=this.parseMul();this.skipValue(a.TOKEN_OPERATOR,"-");){var t=this.parseMul();e=new r.Sub(e.lineno,e.colno,e,t)}return e},c.parseMul=function(){for(var e=this.parseDiv();this.skipValue(a.TOKEN_OPERATOR,"*");){var t=this.parseDiv();e=new r.Mul(e.lineno,e.colno,e,t)}return e},c.parseDiv=function(){for(var e=this.parseFloorDiv();this.skipValue(a.TOKEN_OPERATOR,"/");){var t=this.parseFloorDiv();e=new r.Div(e.lineno,e.colno,e,t)}return e},c.parseFloorDiv=function(){for(var e=this.parseMod();this.skipValue(a.TOKEN_OPERATOR,"//");){var t=this.parseMod();e=new r.FloorDiv(e.lineno,e.colno,e,t)}return e},c.parseMod=function(){for(var e=this.parsePow();this.skipValue(a.TOKEN_OPERATOR,"%");){var t=this.parsePow();e=new r.Mod(e.lineno,e.colno,e,t)}return e},c.parsePow=function(){for(var e=this.parseUnary();this.skipValue(a.TOKEN_OPERATOR,"**");){var t=this.parseUnary();e=new r.Pow(e.lineno,e.colno,e,t)}return e},c.parseUnary=function(e){var t,n=this.peekToken();return t=this.skipValue(a.TOKEN_OPERATOR,"-")?new r.Neg(n.lineno,n.colno,this.parseUnary(!0)):this.skipValue(a.TOKEN_OPERATOR,"+")?new r.Pos(n.lineno,n.colno,this.parseUnary(!0)):this.parsePrimary(),e||(t=this.parseFilter(t)),t},c.parsePrimary=function(e){var t,n=this.nextToken(),i=null;if(n?n.type===a.TOKEN_STRING?t=n.value:n.type===a.TOKEN_INT?t=parseInt(n.value,10):n.type===a.TOKEN_FLOAT?t=parseFloat(n.value):n.type===a.TOKEN_BOOLEAN?"true"===n.value?t=!0:"false"===n.value?t=!1:this.fail("invalid boolean: "+n.value,n.lineno,n.colno):n.type===a.TOKEN_NONE?t=null:n.type===a.TOKEN_REGEX&&(t=new RegExp(n.value.body,n.value.flags)):this.fail("expected expression, got end of file"),void 0!==t?i=new r.Literal(n.lineno,n.colno,t):n.type===a.TOKEN_SYMBOL?i=new r.Symbol(n.lineno,n.colno,n.value):(this.pushToken(n),i=this.parseAggregate()),e||(i=this.parsePostfix(i)),i)return i;throw this.error("unexpected token: "+n.value,n.lineno,n.colno)},c.parseFilterName=function(){for(var e=this.expect(a.TOKEN_SYMBOL),t=e.value;this.skipValue(a.TOKEN_OPERATOR,".");)t+="."+this.expect(a.TOKEN_SYMBOL).value;return new r.Symbol(e.lineno,e.colno,t)},c.parseFilterArgs=function(e){return this.peekToken().type===a.TOKEN_LEFT_PAREN?this.parsePostfix(e).args.children:[]},c.parseFilter=function(e){for(;this.skip(a.TOKEN_PIPE);){var t=this.parseFilterName();e=new r.Filter(t.lineno,t.colno,t,new r.NodeList(t.lineno,t.colno,[e].concat(this.parseFilterArgs(e))))}return e},c.parseFilterStatement=function(){var e=this.peekToken();this.skipSymbol("filter")||this.fail("parseFilterStatement: expected filter");var t=this.parseFilterName(),n=this.parseFilterArgs(t);this.advanceAfterBlockEnd(e.value);var i=new r.Capture(t.lineno,t.colno,this.parseUntilBlocks("endfilter"));this.advanceAfterBlockEnd();var a=new r.Filter(t.lineno,t.colno,t,new r.NodeList(t.lineno,t.colno,[i].concat(n)));return new r.Output(t.lineno,t.colno,[a])},c.parseAggregate=function(){var e,t=this.nextToken();switch(t.type){case a.TOKEN_LEFT_PAREN:e=new r.Group(t.lineno,t.colno);break;case a.TOKEN_LEFT_BRACKET:e=new r.Array(t.lineno,t.colno);break;case a.TOKEN_LEFT_CURLY:e=new r.Dict(t.lineno,t.colno);break;default:return null}for(;;){var n=this.peekToken().type;if(n===a.TOKEN_RIGHT_PAREN||n===a.TOKEN_RIGHT_BRACKET||n===a.TOKEN_RIGHT_CURLY){this.nextToken();break}if(e.children.length>0&&(this.skip(a.TOKEN_COMMA)||this.fail("parseAggregate: expected comma after expression",t.lineno,t.colno)),e instanceof r.Dict){var i=this.parsePrimary();this.skip(a.TOKEN_COLON)||this.fail("parseAggregate: expected colon after dict key",t.lineno,t.colno);var s=this.parseExpression();e.addChild(new r.Pair(i.lineno,i.colno,i,s))}else{var o=this.parseExpression();e.addChild(o)}}return e},c.parseSignature=function(e,t){var n=this.peekToken();if(!t&&n.type!==a.TOKEN_LEFT_PAREN){if(e)return null;this.fail("expected arguments",n.lineno,n.colno)}n.type===a.TOKEN_LEFT_PAREN&&(n=this.nextToken());for(var i=new r.NodeList(n.lineno,n.colno),s=new r.KeywordArgs(n.lineno,n.colno),o=!1;;){if(n=this.peekToken(),!t&&n.type===a.TOKEN_RIGHT_PAREN){this.nextToken();break}if(t&&n.type===a.TOKEN_BLOCK_END)break;if(o&&!this.skip(a.TOKEN_COMMA))this.fail("parseSignature: expected comma after expression",n.lineno,n.colno);else{var c=this.parseExpression();this.skipValue(a.TOKEN_OPERATOR,"=")?s.addChild(new r.Pair(c.lineno,c.colno,c,this.parseExpression())):i.addChild(c)}o=!0}return s.children.length&&i.addChild(s),i},c.parseUntilBlocks=function(){for(var e=this.breakOnBlocks,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];this.breakOnBlocks=n;var a=this.parse();return this.breakOnBlocks=e,a},c.parseNodes=function(){for(var e,t=[];e=this.nextToken();)if(e.type===a.TOKEN_DATA){var n=e.value,i=this.peekToken(),s=i&&i.value;this.dropLeadingWhitespace&&(n=n.replace(/^\s*/,""),this.dropLeadingWhitespace=!1),i&&(i.type===a.TOKEN_BLOCK_START&&"-"===s.charAt(s.length-1)||i.type===a.TOKEN_VARIABLE_START&&"-"===s.charAt(this.tokens.tags.VARIABLE_START.length)||i.type===a.TOKEN_COMMENT&&"-"===s.charAt(this.tokens.tags.COMMENT_START.length))&&(n=n.replace(/\s*$/,"")),t.push(new r.Output(e.lineno,e.colno,[new r.TemplateData(e.lineno,e.colno,n)]))}else if(e.type===a.TOKEN_BLOCK_START){this.dropLeadingWhitespace=!1;var o=this.parseStatement();if(!o)break;t.push(o)}else if(e.type===a.TOKEN_VARIABLE_START){var c=this.parseExpression();this.dropLeadingWhitespace=!1,this.advanceAfterVariableEnd(),t.push(new r.Output(e.lineno,e.colno,[c]))}else e.type===a.TOKEN_COMMENT?this.dropLeadingWhitespace="-"===e.value.charAt(e.value.length-this.tokens.tags.COMMENT_END.length-1):this.fail("Unexpected token at top-level: "+e.type,e.lineno,e.colno);return t},c.parse=function(){return new r.NodeList(0,0,this.parseNodes())},c.parseAsRoot=function(){return new r.Root(0,0,this.parseNodes())},s}(s);e.exports={parse:function(e,t,n){var i=new c(a.lex(e,n));return void 0!==t&&(i.extensions=t),i.parseAsRoot()},Parser:c}},function(e,t,n){var i=n(0),a=" \n\t\r ",r="()[]{}%*-+~/#,:|.<>=!",s="string",o="whitespace",c="data",l="block-start",u="block-end",d="variable-start",h="variable-end",p="comment",m="left-paren",f="right-paren",g="left-bracket",v="right-bracket",_="left-curly",y="right-curly",b="operator",w="comma",x="colon",k="tilde",C="pipe",M="float",E="boolean",S="none",A="symbol",T="regex";function $(e,t,n,i){return{type:e,value:t,lineno:n,colno:i}}var O=function(){function e(e,t){this.str=e,this.index=0,this.len=e.length,this.lineno=0,this.colno=0,this.in_code=!1;var n=(t=t||{}).tags||{};this.tags={BLOCK_START:n.blockStart||"{%",BLOCK_END:n.blockEnd||"%}",VARIABLE_START:n.variableStart||"{{",VARIABLE_END:n.variableEnd||"}}",COMMENT_START:n.commentStart||"{#",COMMENT_END:n.commentEnd||"#}"},this.trimBlocks=!!t.trimBlocks,this.lstripBlocks=!!t.lstripBlocks}var t=e.prototype;return t.nextToken=function(){var e,t=this.lineno,n=this.colno;if(this.in_code){var O=this.current();if(this.isFinished())return null;if('"'===O||"'"===O)return $(s,this._parseString(O),t,n);if(e=this._extract(a))return $(o,e,t,n);if((e=this._extractString(this.tags.BLOCK_END))||(e=this._extractString("-"+this.tags.BLOCK_END)))return this.in_code=!1,this.trimBlocks&&("\n"===(O=this.current())?this.forward():"\r"===O&&(this.forward(),"\n"===(O=this.current())?this.forward():this.back())),$(u,e,t,n);if((e=this._extractString(this.tags.VARIABLE_END))||(e=this._extractString("-"+this.tags.VARIABLE_END)))return this.in_code=!1,$(h,e,t,n);if("r"===O&&"/"===this.str.charAt(this.index+1)){this.forwardN(2);for(var I="";!this.isFinished();){if("/"===this.current()&&"\\"!==this.previous()){this.forward();break}I+=this.current(),this.forward()}for(var L=["g","i","m","y"],j="";!this.isFinished()&&-1!==L.indexOf(this.current());)j+=this.current(),this.forward();return $(T,{body:I,flags:j},t,n)}if(-1!==r.indexOf(O)){this.forward();var z,D=["==","===","!=","!==","<=",">=","//","**"],R=O+this.current();switch(-1!==i.indexOf(D,R)&&(this.forward(),O=R,-1!==i.indexOf(D,R+this.current())&&(O=R+this.current(),this.forward())),O){case"(":z=m;break;case")":z=f;break;case"[":z=g;break;case"]":z=v;break;case"{":z=_;break;case"}":z=y;break;case",":z=w;break;case":":z=x;break;case"~":z=k;break;case"|":z=C;break;default:z=b}return $(z,O,t,n)}if((e=this._extractUntil(a+r)).match(/^[-+]?[0-9]+$/)){if("."===this.current()){this.forward();var N=this._extract("0123456789");return $(M,e+"."+N,t,n)}return $("int",e,t,n)}if(e.match(/^(true|false)$/))return $(E,e,t,n);if("none"===e)return $(S,e,t,n);if("null"===e)return $(S,e,t,n);if(e)return $(A,e,t,n);throw new Error("Unexpected value while parsing: "+e)}var P,F=this.tags.BLOCK_START.charAt(0)+this.tags.VARIABLE_START.charAt(0)+this.tags.COMMENT_START.charAt(0)+this.tags.COMMENT_END.charAt(0);if(this.isFinished())return null;if((e=this._extractString(this.tags.BLOCK_START+"-"))||(e=this._extractString(this.tags.BLOCK_START)))return this.in_code=!0,$(l,e,t,n);if((e=this._extractString(this.tags.VARIABLE_START+"-"))||(e=this._extractString(this.tags.VARIABLE_START)))return this.in_code=!0,$(d,e,t,n);e="";var B=!1;for(this._matches(this.tags.COMMENT_START)&&(B=!0,e=this._extractString(this.tags.COMMENT_START));null!==(P=this._extractUntil(F));){if(e+=P,(this._matches(this.tags.BLOCK_START)||this._matches(this.tags.VARIABLE_START)||this._matches(this.tags.COMMENT_START))&&!B){if(this.lstripBlocks&&this._matches(this.tags.BLOCK_START)&&this.colno>0&&this.colno<=e.length){var V=e.slice(-this.colno);if(/^\s+$/.test(V)&&!(e=e.slice(0,-this.colno)).length)return this.nextToken()}break}if(this._matches(this.tags.COMMENT_END)){if(!B)throw new Error("unexpected end of comment");e+=this._extractString(this.tags.COMMENT_END);break}e+=this.current(),this.forward()}if(null===P&&B)throw new Error("expected end of comment, got end of file");return $(B?p:c,e,t,n)},t._parseString=function(e){this.forward();for(var t="";!this.isFinished()&&this.current()!==e;){var n=this.current();if("\\"===n){switch(this.forward(),this.current()){case"n":t+="\n";break;case"t":t+="\t";break;case"r":t+="\r";break;default:t+=this.current()}this.forward()}else t+=n,this.forward()}return this.forward(),t},t._matches=function(e){return this.index+e.length>this.len?null:this.str.slice(this.index,this.index+e.length)===e},t._extractString=function(e){return this._matches(e)?(this.forwardN(e.length),e):null},t._extractUntil=function(e){return this._extractMatching(!0,e||"")},t._extract=function(e){return this._extractMatching(!1,e)},t._extractMatching=function(e,t){if(this.isFinished())return null;var n=t.indexOf(this.current());if(e&&-1===n||!e&&-1!==n){var i=this.current();this.forward();for(var a=t.indexOf(this.current());(e&&-1===a||!e&&-1!==a)&&!this.isFinished();)i+=this.current(),this.forward(),a=t.indexOf(this.current());return i}return""},t._extractRegex=function(e){var t=this.currentStr().match(e);return t?(this.forwardN(t[0].length),t):null},t.isFinished=function(){return this.index>=this.len},t.forwardN=function(e){for(var t=0;t<e;t++)this.forward()},t.forward=function(){this.index++,"\n"===this.previous()?(this.lineno++,this.colno=0):this.colno++},t.backN=function(e){for(var t=0;t<e;t++)this.back()},t.back=function(){if(this.index--,"\n"===this.current()){this.lineno--;var e=this.src.lastIndexOf("\n",this.index-1);this.colno=-1===e?this.index:this.index-e}else this.colno--},t.current=function(){return this.isFinished()?"":this.str.charAt(this.index)},t.currentStr=function(){return this.isFinished()?"":this.str.substr(this.index)},t.previous=function(){return this.str.charAt(this.index-1)},e}();e.exports={lex:function(e,t){return new O(e,t)},TOKEN_STRING:s,TOKEN_WHITESPACE:o,TOKEN_DATA:c,TOKEN_BLOCK_START:l,TOKEN_BLOCK_END:u,TOKEN_VARIABLE_START:d,TOKEN_VARIABLE_END:h,TOKEN_COMMENT:p,TOKEN_LEFT_PAREN:m,TOKEN_RIGHT_PAREN:f,TOKEN_LEFT_BRACKET:g,TOKEN_RIGHT_BRACKET:v,TOKEN_LEFT_CURLY:_,TOKEN_RIGHT_CURLY:y,TOKEN_OPERATOR:b,TOKEN_COMMA:w,TOKEN_COLON:x,TOKEN_TILDE:k,TOKEN_PIPE:C,TOKEN_INT:"int",TOKEN_FLOAT:M,TOKEN_BOOLEAN:E,TOKEN_NONE:S,TOKEN_SYMBOL:A,TOKEN_SPECIAL:"special",TOKEN_REGEX:T}},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=n(6),r=n(19).PrecompiledLoader,s=function(e){var t,n;function a(t,n){var i;return(i=e.call(this)||this).baseURL=t||".",n=n||{},i.useCache=!!n.useCache,i.async=!!n.async,i}n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n);var r=a.prototype;return r.resolve=function(e,t){throw new Error("relative templates not support in the browser yet")},r.getSource=function(e,t){var n,i=this,a=this.useCache;return this.fetch(this.baseURL+"/"+e,(function(r,s){if(r)if(t)t(r.content);else{if(404!==r.status)throw r.content;n=null}else n={src:s,path:e,noCache:!a},i.emit("load",e,n),t&&t(null,n)})),n},r.fetch=function(e,t){if("undefined"==typeof window)throw new Error("WebLoader can only by used in a browser");var n=new XMLHttpRequest,i=!0;n.onreadystatechange=function(){4===n.readyState&&i&&(i=!1,0===n.status||200===n.status?t(null,n.responseText):t({status:n.status,content:n.responseText}))},e+=(-1===e.indexOf("?")?"?":"&")+"s="+(new Date).getTime(),n.open("GET",e,this.async),n.send()},a}(a);e.exports={WebLoader:s,PrecompiledLoader:r}},function(e,t,n){var i,a=n(0),r=n(7),s=r.Environment,o=r.Template,c=n(6),l=n(10),u=n(23),d=n(5),h=n(8),p=n(9),m=n(2),f=n(3),g=n(25);function v(e,t){var n;return t=t||{},a.isObject(e)&&(t=e,e=null),l.FileSystemLoader?n=new l.FileSystemLoader(e,{watch:t.watch,noCache:t.noCache}):l.WebLoader&&(n=new l.WebLoader(e,{useCache:t.web&&t.web.useCache,async:t.web&&t.web.async})),i=new s(n,t),t&&t.express&&i.express(t.express),i}e.exports={Environment:s,Template:o,Loader:c,FileSystemLoader:l.FileSystemLoader,NodeResolveLoader:l.NodeResolveLoader,PrecompiledLoader:l.PrecompiledLoader,WebLoader:l.WebLoader,compiler:d,parser:h,lexer:p,runtime:m,lib:a,nodes:f,installJinjaCompat:g,configure:v,reset:function(){i=void 0},compile:function(e,t,n,a){return i||v(),new o(e,t,n,a)},render:function(e,t,n){return i||v(),i.render(e,t,n)},renderString:function(e,t,n){return i||v(),i.renderString(e,t,n)},precompile:u?u.precompile:void 0,precompileString:u?u.precompileString:void 0}},function(e,t,n){var i=n(13),a=[],r=[],s=i.makeRequestCallFromTimer((function(){if(r.length)throw r.shift()}));function o(e){var t;(t=a.length?a.pop():new c).task=e,i(t)}function c(){this.task=null}e.exports=o,c.prototype.call=function(){try{this.task.call()}catch(e){o.onerror?o.onerror(e):(r.push(e),s())}finally{this.task=null,a[a.length]=this}}},function(e,t,n){(function(t){function n(e){a.length||i(),a[a.length]=e}e.exports=n;var i,a=[],r=0;function s(){for(;r<a.length;){var e=r;if(r+=1,a[e].call(),r>1024){for(var t=0,n=a.length-r;t<n;t++)a[t]=a[t+r];a.length-=r,r=0}}a.length=0,r=0}var o,c,l,u=void 0!==t?t:self,d=u.MutationObserver||u.WebKitMutationObserver;function h(e){return function(){var t=setTimeout(i,0),n=setInterval(i,50);function i(){clearTimeout(t),clearInterval(n),e()}}}"function"==typeof d?(o=1,c=new d(s),l=document.createTextNode(""),c.observe(l,{characterData:!0}),i=function(){o=-o,l.data=o}):i=h(s),n.requestFlush=i,n.makeRequestCallFromTimer=h}).call(t,n(14))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var i,a,r,s,o;a=function(){var e=Array.prototype.slice.call(arguments);"function"==typeof e[0]&&e[0].apply(null,e.splice(1))},r=function(e){"function"==typeof setImmediate?setImmediate(e):"undefined"!=typeof process&&process.nextTick?process.nextTick(e):setTimeout(e,0)},s=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=function(e,t,n){var i=n?r:a;if(t=t||function(){},!s(e)){var o=new Error("First argument to waterfall must be an array of functions");return t(o)}if(!e.length)return t();var c=function(e){return function(n){if(n)t.apply(null,arguments),t=function(){};else{var a=Array.prototype.slice.call(arguments,1),r=e.next();r?a.push(c(r)):a.push(t),i((function(){e.apply(null,a)}))}}};c(function(e){var t=function(n){var i=function(){return e.length&&e[n].apply(null,arguments),i.next()};return i.next=function(){return n<e.length-1?t(n+1):null},i};return t(0)}(e))()},void 0===(i=function(){return o}.apply(t,[]))||(e.exports=i)},function(e,t,n){var i,a="object"==typeof Reflect?Reflect:null,r=a&&"function"==typeof a.apply?a.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=a&&"function"==typeof a.ownKeys?a.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(n,i){function a(n){e.removeListener(t,r),i(n)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",a),n([].slice.call(arguments))}v(e,t,r,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,n)}(e,a,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var c=10;function l(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function d(e,t,n,i){var a,r,s,o;if(l(n),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]),void 0===s)s=r[t]=n,++e._eventsCount;else if("function"==typeof s?s=r[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(a=u(e))>0&&s.length>a&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,o=c,console&&console.warn&&console.warn(o)}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},a=h.bind(i);return a.listener=n,i.wrapFn=a,a}function m(e,t,n){var i=e._events;if(void 0===i)return[];var a=i[t];return void 0===a?[]:"function"==typeof a?n?[a.listener||a]:[a]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(a):g(a,a.length)}function f(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function g(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function v(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function a(r){i.once&&e.removeEventListener(t,a),n(r)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");c=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,a=this._events;if(void 0!==a)i=i&&void 0===a.error;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var o=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw o.context=s,o}var c=a[e];if(void 0===c)return!1;if("function"==typeof c)r(c,this,t);else{var l=c.length,u=g(c,l);for(n=0;n<l;++n)r(u[n],this,t)}return!0},o.prototype.addListener=function(e,t){return d(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return d(this,e,t,!0)},o.prototype.once=function(e,t){return l(t),this.on(e,p(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return l(t),this.prependListener(e,p(this,e,t)),this},o.prototype.removeListener=function(e,t){var n,i,a,r,s;if(l(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,a=r;break}if(a<0)return this;0===a?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,a),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var a,r=Object.keys(n);for(i=0;i<r.length;++i)"removeListener"!==(a=r[i])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},o.prototype.listeners=function(e){return m(this,e,!0)},o.prototype.rawListeners=function(e){return m(this,e,!1)},o.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},o.prototype.listenerCount=f,o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){var i=n(3),a=n(0),r=0;function s(){return"hole_"+r++}function o(e,t){for(var n=null,i=0;i<e.length;i++){var a=t(e[i]);a!==e[i]&&(n||(n=e.slice()),n[i]=a)}return n||e}function c(e,t,n){if(!(e instanceof i.Node))return e;if(!n){var a=t(e);if(a&&a!==e)return a}if(e instanceof i.NodeList){var r=o(e.children,(function(e){return c(e,t,n)}));r!==e.children&&(e=new i[e.typename](e.lineno,e.colno,r))}else if(e instanceof i.CallExtension){var s=c(e.args,t,n),l=o(e.contentArgs,(function(e){return c(e,t,n)}));s===e.args&&l===e.contentArgs||(e=new i[e.typename](e.extName,e.prop,s,l))}else{var u=e.fields.map((function(t){return e[t]})),d=o(u,(function(e){return c(e,t,n)}));d!==u&&(e=new i[e.typename](e.lineno,e.colno),d.forEach((function(t,n){e[e.fields[n]]=t})))}return n&&t(e)||e}function l(e,t){return c(e,t,!0)}function u(e,t,n){var r=[],o=l(n?e[n]:e,(function(e){var n;return e instanceof i.Block?e:((e instanceof i.Filter&&-1!==a.indexOf(t,e.name.value)||e instanceof i.CallExtensionAsync)&&(n=new i.Symbol(e.lineno,e.colno,s()),r.push(new i.FilterAsync(e.lineno,e.colno,e.name,e.args,n))),n)}));return n?e[n]=o:e=o,r.length?(r.push(e),new i.NodeList(e.lineno,e.colno,r)):e}function d(e,t){return function(e){return l(e,(function(e){if(e instanceof i.If||e instanceof i.For){var t=!1;if(c(e,(function(e){if(e instanceof i.FilterAsync||e instanceof i.IfAsync||e instanceof i.AsyncEach||e instanceof i.AsyncAll||e instanceof i.CallExtensionAsync)return t=!0,e})),t){if(e instanceof i.If)return new i.IfAsync(e.lineno,e.colno,e.cond,e.body,e.else_);if(e instanceof i.For&&!(e instanceof i.AsyncAll))return new i.AsyncEach(e.lineno,e.colno,e.arr,e.name,e.body,e.else_)}}}))}(function(e){return c(e,(function(e){if(e instanceof i.Block){var t=!1,n=s();e.body=c(e.body,(function(e){if(e instanceof i.FunCall&&"super"===e.name.value)return t=!0,new i.Symbol(e.lineno,e.colno,n)})),t&&e.body.children.unshift(new i.Super(0,0,e.name,new i.Symbol(0,0,n)))}}))}(function(e,t){return l(e,(function(e){return e instanceof i.Output?u(e,t):e instanceof i.Set?u(e,t,"value"):e instanceof i.For?u(e,t,"arr"):e instanceof i.If?u(e,t,"cond"):e instanceof i.CallExtension?u(e,t,"args"):void 0}))}(e,t)))}e.exports={transform:function(e,t){return d(e,t||[])}}},function(e,t,n){var i=n(0),a=n(2);function r(e,t){return null==e||!1===e?t:e}function s(e){return e!=e}function o(e){var t=(e=r(e,"")).toLowerCase();return a.copySafeness(e,t.charAt(0).toUpperCase()+t.slice(1))}function c(e){if(i.isString(e))return e.split("");if(i.isObject(e))return i._entries(e||{}).map((function(e){return{key:e[0],value:e[1]}}));if(i.isArray(e))return e;throw new i.TemplateError("list filter: type not iterable")}function l(e){return function(t,n,a){void 0===n&&(n="truthy");var r=this,s=r.env.getTest(n);return i.toArray(t).filter((function(t){return s.call(r,t,a)===e}))}}function u(e){return a.copySafeness(e,e.replace(/^\s*|\s*$/g,""))}(t=e.exports={}).abs=Math.abs,t.batch=function(e,t,n){var i,a=[],r=[];for(i=0;i<e.length;i++)i%t==0&&r.length&&(a.push(r),r=[]),r.push(e[i]);if(r.length){if(n)for(i=r.length;i<t;i++)r.push(n);a.push(r)}return a},t.capitalize=o,t.center=function(e,t){if(t=t||80,(e=r(e,"")).length>=t)return e;var n=t-e.length,s=i.repeat(" ",n/2-n%2),o=i.repeat(" ",n/2);return a.copySafeness(e,s+e+o)},t.default=function(e,t,n){return n?e||t:void 0!==e?e:t},t.dictsort=function(e,t,n){if(!i.isObject(e))throw new i.TemplateError("dictsort filter: val must be an object");var a,r=[];for(var s in e)r.push([s,e[s]]);if(void 0===n||"key"===n)a=0;else{if("value"!==n)throw new i.TemplateError("dictsort filter: You can only sort by either key or value");a=1}return r.sort((function(e,n){var r=e[a],s=n[a];return t||(i.isString(r)&&(r=r.toUpperCase()),i.isString(s)&&(s=s.toUpperCase())),r>s?1:r===s?0:-1})),r},t.dump=function(e,t){return JSON.stringify(e,null,t)},t.escape=function(e){return e instanceof a.SafeString?e:(e=null==e?"":e,a.markSafe(i.escape(e.toString())))},t.safe=function(e){return e instanceof a.SafeString?e:(e=null==e?"":e,a.markSafe(e.toString()))},t.first=function(e){return e[0]},t.forceescape=function(e){return e=null==e?"":e,a.markSafe(i.escape(e.toString()))},t.groupby=function(e,t){return i.groupBy(e,t,this.env.opts.throwOnUndefined)},t.indent=function(e,t,n){if(""===(e=r(e,"")))return"";t=t||4;var s=e.split("\n"),o=i.repeat(" ",t),c=s.map((function(e,t){return 0!==t||n?""+o+e:e})).join("\n");return a.copySafeness(e,c)},t.join=function(e,t,n){return t=t||"",n&&(e=i.map(e,(function(e){return e[n]}))),e.join(t)},t.last=function(e){return e[e.length-1]},t.length=function(e){var t=r(e,"");return void 0!==t?"function"==typeof Map&&t instanceof Map||"function"==typeof Set&&t instanceof Set?t.size:!i.isObject(t)||t instanceof a.SafeString?t.length:i.keys(t).length:0},t.list=c,t.lower=function(e){return(e=r(e,"")).toLowerCase()},t.nl2br=function(e){return null==e?"":a.copySafeness(e,e.replace(/\r\n|\n/g,"<br />\n"))},t.random=function(e){return e[Math.floor(Math.random()*e.length)]},t.reject=l(!1),t.rejectattr=function(e,t){return e.filter((function(e){return!e[t]}))},t.select=l(!0),t.selectattr=function(e,t){return e.filter((function(e){return!!e[t]}))},t.replace=function(e,t,n,i){var r=e;if(t instanceof RegExp)return e.replace(t,n);void 0===i&&(i=-1);var s="";if("number"==typeof t)t=""+t;else if("string"!=typeof t)return e;if("number"==typeof e&&(e=""+e),"string"!=typeof e&&!(e instanceof a.SafeString))return e;if(""===t)return s=n+e.split("").join(n)+n,a.copySafeness(e,s);var o=e.indexOf(t);if(0===i||-1===o)return e;for(var c=0,l=0;o>-1&&(-1===i||l<i);)s+=e.substring(c,o)+n,c=o+t.length,l++,o=e.indexOf(t,c);return c<e.length&&(s+=e.substring(c)),a.copySafeness(r,s)},t.reverse=function(e){var t;return t=i.isString(e)?c(e):i.map(e,(function(e){return e})),t.reverse(),i.isString(e)?a.copySafeness(e,t.join("")):t},t.round=function(e,t,n){t=t||0;var i=Math.pow(10,t);return("ceil"===n?Math.ceil:"floor"===n?Math.floor:Math.round)(e*i)/i},t.slice=function(e,t,n){for(var i=Math.floor(e.length/t),a=e.length%t,r=[],s=0,o=0;o<t;o++){var c=s+o*i;o<a&&s++;var l=s+(o+1)*i,u=e.slice(c,l);n&&o>=a&&u.push(n),r.push(u)}return r},t.sum=function(e,t,n){return void 0===n&&(n=0),t&&(e=i.map(e,(function(e){return e[t]}))),n+e.reduce((function(e,t){return e+t}),0)},t.sort=a.makeMacro(["value","reverse","case_sensitive","attribute"],[],(function(e,t,n,a){var r=this,s=i.map(e,(function(e){return e})),o=i.getAttrGetter(a);return s.sort((function(e,s){var c=a?o(e):e,l=a?o(s):s;if(r.env.opts.throwOnUndefined&&a&&(void 0===c||void 0===l))throw new TypeError('sort: attribute "'+a+'" resolved to undefined');return!n&&i.isString(c)&&i.isString(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c<l?t?1:-1:c>l?t?-1:1:0})),s})),t.string=function(e){return a.copySafeness(e,e)},t.striptags=function(e,t){var n=u((e=r(e,"")).replace(/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,"")),i="";return i=t?n.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,"\n").replace(/\n\n\n+/g,"\n\n"):n.replace(/\s+/gi," "),a.copySafeness(e,i)},t.title=function(e){var t=(e=r(e,"")).split(" ").map((function(e){return o(e)}));return a.copySafeness(e,t.join(" "))},t.trim=u,t.truncate=function(e,t,n,i){var s=e;if(t=t||255,(e=r(e,"")).length<=t)return e;if(n)e=e.substring(0,t);else{var o=e.lastIndexOf(" ",t);-1===o&&(o=t),e=e.substring(0,o)}return e+=null!=i?i:"...",a.copySafeness(s,e)},t.upper=function(e){return(e=r(e,"")).toUpperCase()},t.urlencode=function(e){var t=encodeURIComponent;return i.isString(e)?t(e):(i.isArray(e)?e:i._entries(e)).map((function(e){var n=e[0],i=e[1];return t(n)+"="+t(i)})).join("&")};var d=/^(?:\(|<|&lt;)?(.*?)(?:\.|,|\)|\n|&gt;)?$/,h=/^[\w.!#$%&'*+\-\/=?\^`{|}~]+@[a-z\d\-]+(\.[a-z\d\-]+)+$/i,p=/^https?:\/\/.*$/,m=/^www\./,f=/\.(?:org|net|com)(?:\:|\/|$)/;t.urlize=function(e,t,n){s(t)&&(t=1/0);var i=!0===n?' rel="nofollow"':"";return e.split(/(\s+)/).filter((function(e){return e&&e.length})).map((function(e){var n=e.match(d),a=n?n[1]:e,r=a.substr(0,t);return p.test(a)?'<a href="'+a+'"'+i+">"+r+"</a>":m.test(a)?'<a href="http://'+a+'"'+i+">"+r+"</a>":h.test(a)?'<a href="mailto:'+a+'">'+a+"</a>":f.test(a)?'<a href="http://'+a+'"'+i+">"+r+"</a>":e})).join("")},t.wordcount=function(e){var t=(e=r(e,""))?e.match(/\w+/g):null;return t?t.length:null},t.float=function(e,t){var n=parseFloat(e);return s(n)?t:n};var g=a.makeMacro(["value","default","base"],[],(function(e,t,n){void 0===n&&(n=10);var i=parseInt(e,n);return s(i)?t:i}));t.int=g,t.d=t.default,t.e=t.escape},function(e,t,n){function i(e,t){return i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},i(e,t)}var a=function(e){var t,n;function a(t){var n;return(n=e.call(this)||this).precompiled=t||{},n}return n=e,(t=a).prototype=Object.create(n.prototype),t.prototype.constructor=t,i(t,n),a.prototype.getSource=function(e){return this.precompiled[e]?{src:{type:"code",obj:this.precompiled[e]},path:e}:null},a}(n(6));e.exports={PrecompiledLoader:a}},function(e,t,n){var i=n(2).SafeString;t.callable=function(e){return"function"==typeof e},t.defined=function(e){return void 0!==e},t.divisibleby=function(e,t){return e%t==0},t.escaped=function(e){return e instanceof i},t.equalto=function(e,t){return e===t},t.eq=t.equalto,t.sameas=t.equalto,t.even=function(e){return e%2==0},t.falsy=function(e){return!e},t.ge=function(e,t){return e>=t},t.greaterthan=function(e,t){return e>t},t.gt=t.greaterthan,t.le=function(e,t){return e<=t},t.lessthan=function(e,t){return e<t},t.lt=t.lessthan,t.lower=function(e){return e.toLowerCase()===e},t.ne=function(e,t){return e!==t},t.null=function(e){return null===e},t.number=function(e){return"number"==typeof e},t.odd=function(e){return e%2==1},t.string=function(e){return"string"==typeof e},t.truthy=function(e){return!!e},t.undefined=function(e){return void 0===e},t.upper=function(e){return e.toUpperCase()===e},t.iterable=function(e){return"undefined"!=typeof Symbol?!!e[Symbol.iterator]:Array.isArray(e)||"string"==typeof e},t.mapping=function(e){var t=null!=e&&"object"==typeof e&&!Array.isArray(e);return Set?t&&!(e instanceof Set):t}},function(e,t,n){e.exports=function(){return{range:function(e,t,n){void 0===t?(t=e,e=0,n=1):n||(n=1);var i=[];if(n>0)for(var a=e;a<t;a+=n)i.push(a);else for(var r=e;r>t;r+=n)i.push(r);return i},cycler:function(){return e=Array.prototype.slice.call(arguments),t=-1,{current:null,reset:function(){t=-1,this.current=null},next:function(){return++t>=e.length&&(t=0),this.current=e[t],this.current}};var e,t},joiner:function(e){return function(e){e=e||",";var t=!0;return function(){var n=t?"":e;return t=!1,n}}(e)}}}},function(e,t,n){var i=n(4);e.exports=function(e,t){function n(e,t){if(this.name=e,this.path=e,this.defaultEngine=t.defaultEngine,this.ext=i.extname(e),!this.ext&&!this.defaultEngine)throw new Error("No default engine was specified and no extension was provided.");this.ext||(this.name+=this.ext=("."!==this.defaultEngine[0]?".":"")+this.defaultEngine)}return n.prototype.render=function(t,n){e.render(this.name,t,n)},t.set("view",n),t.set("nunjucksEnv",e),e}},function(e,t,n){var i=n(4),a=n(4),r=n(0)._prettifyError,s=n(5),o=n(7).Environment,c=n(24);function l(e,t){return!!Array.isArray(t)&&t.some((function(t){return e.match(t)}))}function u(e,t){(t=t||{}).isString=!0;var n=t.env||new o([]),i=t.wrapper||c;if(!t.name)throw new Error('the "name" option is required when compiling a string');return i([d(e,t.name,n)],t)}function d(e,t,n){var i,a=(n=n||new o([])).asyncFilters,c=n.extensionsList;t=t.replace(/\\/g,"/");try{i=s.compile(e,a,c,t,n.opts)}catch(e){throw r(t,!1,e)}return{name:t,template:i}}e.exports={precompile:function(e,t){var n=(t=t||{}).env||new o([]),r=t.wrapper||c;if(t.isString)return u(e,t);var s=i.existsSync(e)&&i.statSync(e),h=[],p=[];if(s.isFile())h.push(d(i.readFileSync(e,"utf-8"),t.name||e,n));else if(s.isDirectory()){!function n(r){i.readdirSync(r).forEach((function(s){var o=a.join(r,s),c=o.substr(a.join(e,"/").length),u=i.statSync(o);u&&u.isDirectory()?l(c+="/",t.exclude)||n(o):l(c,t.include)&&p.push(o)}))}(e);for(var m=0;m<p.length;m++){var f=p[m].replace(a.join(e,"/"),"");try{h.push(d(i.readFileSync(p[m],"utf-8"),f,n))}catch(e){if(!t.force)throw e;console.error(e)}}}return r(h,t)},precompileString:u}},function(e,t,n){e.exports=function(e,t){var n="";t=t||{};for(var i=0;i<e.length;i++){var a=JSON.stringify(e[i].name);n+="(function() {(window.nunjucksPrecompiled = window.nunjucksPrecompiled || {})["+a+"] = (function() {\n"+e[i].template+"\n})();\n",t.asFunction&&(n+="return function(ctx, cb) { return nunjucks.render("+a+", ctx, cb); }\n"),n+="})();\n"}return n}},function(e,t,n){e.exports=function(){var e,t,n=this.runtime,i=this.lib,a=this.compiler.Compiler,r=this.parser.Parser,s=this.nodes,o=this.lexer,c=n.contextOrFrameLookup,l=n.memberLookup;function u(e){return{index:e.index,lineno:e.lineno,colno:e.colno}}if(a&&(e=a.prototype.assertType),r&&(t=r.prototype.parseAggregate),n.contextOrFrameLookup=function(e,t,n){var i=c.apply(this,arguments);if(void 0!==i)return i;switch(n){case"True":return!0;case"False":return!1;case"None":return null;default:return}},s&&a&&r){var d=s.Node.extend("Slice",{fields:["start","stop","step"],init:function(e,t,n,i,a){n=n||new s.Literal(e,t,null),i=i||new s.Literal(e,t,null),a=a||new s.Literal(e,t,1),this.parent(e,t,n,i,a)}});a.prototype.assertType=function(t){t instanceof d||e.apply(this,arguments)},a.prototype.compileSlice=function(e,t){this._emit("("),this._compileExpression(e.start,t),this._emit("),("),this._compileExpression(e.stop,t),this._emit("),("),this._compileExpression(e.step,t),this._emit(")")},r.prototype.parseAggregate=function(){var e=this,n=u(this.tokens);n.colno--,n.index--;try{return t.apply(this)}catch(t){var a=u(this.tokens),r=function(){return i._assign(e.tokens,a),t};i._assign(this.tokens,n),this.peeked=!1;var c=this.peekToken();if(c.type!==o.TOKEN_LEFT_BRACKET)throw r();this.nextToken();for(var l=new d(c.lineno,c.colno),h=!1,p=0;p<=l.fields.length&&!this.skip(o.TOKEN_RIGHT_BRACKET);p++){if(p===l.fields.length){if(!h)break;this.fail("parseSlice: too many slice components",c.lineno,c.colno)}this.skip(o.TOKEN_COLON)?h=!0:(l[l.fields[p]]=this.parseExpression(),h=this.skip(o.TOKEN_COLON)||h)}if(!h)throw r();return new s.Array(c.lineno,c.colno,[l])}}}function h(e,t,i,a){e=e||[],null===t&&(t=a<0?e.length-1:0),null===i?i=a<0?-1:e.length:i<0&&(i+=e.length),t<0&&(t+=e.length);for(var r=[],s=t;!(s<0||s>e.length||a>0&&s>=i||a<0&&s<=i);s+=a)r.push(n.memberLookup(e,s));return r}function p(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var m={pop:function(e){if(void 0===e)return this.pop();if(e>=this.length||e<0)throw new Error("KeyError");return this.splice(e,1)},append:function(e){return this.push(e)},remove:function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return this.splice(t,1);throw new Error("ValueError")},count:function(e){for(var t=0,n=0;n<this.length;n++)this[n]===e&&t++;return t},index:function(e){var t;if(-1===(t=this.indexOf(e)))throw new Error("ValueError");return t},find:function(e){return this.indexOf(e)},insert:function(e,t){return this.splice(e,0,t)}},f={items:function(){return i._entries(this)},values:function(){return i._values(this)},keys:function(){return i.keys(this)},get:function(e,t){var n=this[e];return void 0===n&&(n=t),n},has_key:function(e){return p(this,e)},pop:function(e,t){var n=this[e];if(void 0===n&&void 0!==t)n=t;else{if(void 0===n)throw new Error("KeyError");delete this[e]}return n},popitem:function(){var e=i.keys(this);if(!e.length)throw new Error("KeyError");var t=e[0],n=this[t];return delete this[t],[t,n]},setdefault:function(e,t){return void 0===t&&(t=null),e in this||(this[e]=t),this[e]},update:function(e){return i._assign(this,e),null}};return f.iteritems=f.items,f.itervalues=f.values,f.iterkeys=f.keys,n.memberLookup=function(e,t,n){return 4===arguments.length?h.apply(this,arguments):(e=e||{},i.isArray(e)&&p(m,t)?m[t].bind(e):i.isObject(e)&&p(f,t)?f[t].bind(e):l.apply(this,arguments))},function(){n.contextOrFrameLookup=c,n.memberLookup=l,a&&(a.prototype.assertType=e),r&&(r.prototype.parseAggregate=t)}}}])};var rx=bv(ax.exports=ix());function sx(e,t){try{if(t){if(e.entities[t]){if(e.entities[t].area_id)return e.entities[t].area_id;t=e.entities[t].device_id??t}if(e.devices[t])return e.devices[t].area_id;for(const n in e.areas)if(e.areas[n].name==t)return n}return}catch{return}}function ox(e,t){try{if(t){let n=t;if(e.entities[t]&&(n=e.entities[t].area_id??n,t=e.entities[t].device_id??t),e.devices[t]&&(n=e.devices[t].area_id??n),e.areas[n])return e.areas[n].name}return}catch{return}}function cx(e,t){try{const n=[];if(t){const i=lx(e,t);for(const t of i)for(const i in e.entities)e.entities[i].device_id==t&&n.push(i);n.sort()}return n}catch{return[]}}function lx(e,t){try{const n=[];if(t){if(!(t in e.areas))for(const n in e.areas)if(e.areas[n].name==t){t=n;break}for(const i in e.devices)e.devices[i].area_id==t&&n.push(i);n.sort()}return n}catch{return[]}}function ux(e,t){return!!Array.isArray(e)&&e?.includes(t)}function dx(e,t,n,i){"object"!=typeof n||Array.isArray(n)||(i=n.with_unit??i,n=n.rounded??void 0);try{const a=e.states[t];let r=a?.state;if(i&&null==n&&(n=!0),n&&!isNaN(a?.state)){const n=e.entities[t]?.display_precision??0;r=Number(r).toPrecision(n)}return i&&a?.attributes?.unit_of_measurement&&(r=`${r} ${a?.attributes?.unit_of_measurement}`),r}catch{return}}function hx(e,t,n){try{return e.states[t].attributes[n]}catch{return}}function px(e,t){try{const n=dx(e,t);return!![!1,0,-0,""].includes(n)||Boolean(n)}catch{return!1}}function mx(e){const t={};for(const n in e.states){const[i,a]=n.split(".");t[i]=t[i]??{},t[i][a]=e.states[n]}return t}function fx(e,t){try{const n=[];if(t)for(const i in e.entities)e.entities[i].device_id==t&&n.push(i);return n}catch{return[]}}function gx(e,t,n){try{return e.devices[t]?.[n]??hx(e,t,n)}catch{return}}function vx(e,t){try{if(t){if(e.entities[t])return e.entities[t].device_id;for(const n in e.devices){const i=e.devices[n];if(i.name==t||i.name_by_user==t)return n}}return}catch{return}}function _x(e,t,n=!1){if(e[0]==t[0]&&e[1]==t[1])return 0;const i=1/298.257223563,a=6356752.314245,r=Math.atan((1-i)*Math.tan(e[0]*Math.PI/180)),s=Math.atan((1-i)*Math.tan(t[0]*Math.PI/180));let o=(t[1]-e[1])*Math.PI/180,c=o;const l=Math.sin(r),u=Math.cos(r),d=Math.sin(s),h=Math.cos(s);let p=0,m=0,f=0,g=0,v=0;for(let e=0;e<200;e++){const t=Math.sin(c),n=Math.cos(c);if(m=Math.sqrt((h*t)**2+(u*d-l*h*n)**2),0==m)return 0;g=l*d+u*h*n,v=Math.atan2(m,g);const a=u*h*t/m;p=1-a**2,f=0!=p?g-2*l*d/p:0;const r=i/16*p*(4+i*(4-3*p)),s=c;if(c=o+(1-r)*i*a*(v+r*m*(f+r*g*(2*f**2-1))),Math.abs(c-s)<1e-12)break;if(199==e)return null}const _=272331606109.84375*p/a**2,y=_/1024*(256+_*(_*(74-47*_)-128));let b=a*(1+_/16384*(4096+_*(_*(320-175*_)-768)))*(v-y*m*(f+y/4*(g*(2*f**2-1)-y/6*f*(4*m**2-3)*(4*f**2-3))))/1e3;return n&&(b*=.621371),b}function yx(e,...t){function n(t){if(t.startsWith("zone."))return e.states[t].attributes.persons??[];let n=Object.keys(e.states).filter((e=>e==t||e.split(".")[0]==t));if("zone"==t){let t=[];for(const i of n)t.push(...e.states[i].attributes.persons??[]);n=Array.from(new Set(t))}return n}let i,a;if(1==t.length)i=[e.states["zone.home"].attributes.latitude,e.states["zone.home"].attributes.longitude],a=0;else if("number"==typeof t[0]){if("number"!=typeof t[1]||2==t.length)return null;i=[t[0],t[1]],a=2}else if("object"==typeof t[0]){if(Array.isArray(t[0])||!t[0].attributes)return null;i=[t[0].attributes.latitude,t[0].attributes.longitude],a=1}else{if("string"!=typeof t[0])return null;i=[e.states[t[0]].attributes.latitude,e.states[t[0]].attributes.longitude],a=1}let r=[];for(let e=a;e<t.length;e++)if("object"==typeof t[e]){let i=[];if(Array.isArray(t[e]))i=t[e];else if(t[e].entity_id)"zone"==t[e].entity_id.split(".")[0]?r.push(...t[e].attributes.persons):r.push(t[e]);else{const n=Object.keys(t[e]);if(t[e][n[0]].entity_id)i=n.map((n=>t[e][n].entity_id));else for(const a of n)i.push(...Object.keys(t[e][a]).map((n=>t[e][a][n].entity_id)))}for(const e of i)r.push(...n(e))}else"string"==typeof t[e]&&r.push(...n(t[e]));r=Array.from(new Set(r));let s=null,o=1/0;for(const t of r){let n;n="string"==typeof t?e.states[t]:t;const a=n.attributes.latitude,r=n.attributes.longitude;if(null!=a&&null!=r){const e=_x(i,[a,r])??1/0;e<=o&&(s=n,o=e)}}return s}function bx(e,t){try{let n=t;if(e.entities[t]&&(n=e.entities[t].area_id??n,t=e.entities[t].device_id??t),t){if(e.devices[t]&&(n=e.devices[t].area_id??n),e.areas[n])return e.areas[n].floor_id;for(const n in e.areas)if(e.areas[n].name==t)return e.areas[n].floor_id}return}catch{return}}function wx(e,t){if(e.floors[t])return e.floors[t].name;const n=bx(e,t);return n?e.floors[n].name:void 0}function xx(e,t){try{const n=[];if(t){let i;if(e.floors[t])i=t;else for(const n in e.floors)if(e.floors[n].name==t){i=n;break}if(!i)return[];for(const t in e.areas)e.areas[t].floor_id==i&&n.push(t)}return n}catch{return[]}}function kx(e,...t){const n=[];for(let i of t.flat(1/0))if("string"==typeof i&&(i=e.states[i]),i)if(Array.isArray(i.attributes?.entity_id))n.push(...kx(e,...i.attributes?.entity_id));else if(i?.attributes?.persons)n.push(...kx(e,...i.attributes.persons));else if(i.entity_id)n.push(i);else{const t=Object.values(i);if(t[0]?.entity_id)n.push(...t);else for(const i of t){const t=Object.values(i);for(const i of t)i?.attributes?.persons?n.push(...kx(e,...i.attributes.persons)):n.push(i)}}return n.filter(((e,t,n)=>t==n.findIndex((t=>t.entity_id==e.entity_id)))).sort(((e,t)=>e.entity_id.localeCompare(t.entity_id)))}function Cx(e,t,n,i,a){if("object"!=typeof n||Array.isArray(n)||(a=n.if_none??a,i=n.if_false??i,n=n.if_true??void 0),a){const n=RM(e,t);if([void 0,null,"undefined","null","None"].includes(n))return a}return RM(e,`\n\t\t{% if ${t} %}\n\t\t${n??!0}\n\t\t{% else %}\n\t\t${i??!1}\n\t\t{% endif %}\n\t`)}const Mx={};function Ex(e,t){try{return t?e.entities[t]?.labels??e.devices[t]?.labels??e.areas[t]?.labels??[]:Object.keys(Mx)}catch{return[]}}function Sx(e){for(const t in Mx)if(Mx[t].name==e)return t}function Ax(e){return Mx[e]?.name}function Tx(e,t){try{const n=[];let i;if(t){if(i=Mx[t]?t:Sx(t),!i)return[];for(const t in e.areas)(e.areas[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function $x(e,t){try{const n=[];if(t){let i;if(i=Mx[t]?t:Sx(t),!i)return[];for(const t in e.devices)(e.devices[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function Ox(e,t){try{const n=[];if(t){let i;if(i=Mx[t]?t:Sx(t),!i)return[];for(const t in e.entities)(e.entities[t].labels??[]).includes(i)&&n.push(t);n.sort()}return n}catch{return[]}}function Ix(e){return e.toString()}function Lx(e){if(e.toString().includes("NaN"))throw Error("Result returned NaN.")}function jx(e){return e!=1/0&&!isNaN(e)}function zx(e,t){if("number"==typeof e)return 0!=e;if("boolean"==typeof e)return e;if(e=e.toLowerCase(),["true","yes","on","enable","1"].includes(e))return!0;if(["false","no","off","disable","0"].includes(e))return!1;if(t)return t;throw Error("Invalid input")}function Dx(e,t=Math.E,n){try{const n=Math.log(e)/Math.log(t);return Lx(n.toString()),n}catch(e){if(n)return n;throw e}}function Rx(e,t){try{const t=Math.sin(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Nx(e,t){try{const t=Math.cos(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Px(e,t){try{const t=Math.tan(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Fx(e,t){try{const t=Math.asin(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Bx(e,t){try{const t=Math.acos(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Vx(e,t){try{const t=Math.atan(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function Ux(e,t,n){try{const n=Math.atan2(e,t);return Lx(n.toString()),n}catch(e){if(n)return n;throw e}}function Hx(e,t){try{const t=Math.sqrt(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function qx(...e){return Math.max(...e.flat(1/0))}function Wx(...e){return Math.min(...e.flat(1/0))}function Zx(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");return e.reduce(((e,t)=>e+t))/e.length}catch(e){if(t)return t;throw e}}function Kx(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");if(!e.length)throw Error("Empty array provided");e=e.sort(((e,t)=>e-t));const t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}catch(e){if(t)return t;throw e}}function Yx(e,t){try{if((e=e.flat(1/0)).some((e=>isNaN(e))))throw Error("Non-numeric values provided");if(!e.length)throw Error("Empty array provided");const t={};for(const n of e)t[n]||(t[n]=0),t[n]++;let n=e[0],i=0;for(const e in t)t[e]>i&&(n=Number(e),i=t[e]);return n}catch(e){if(t)return t;throw e}}const Qx=Math.E,Gx=Math.PI,Xx=2*Math.PI,Jx=1/0;function ek(e,t,n){try{return e.formatEntityState(e.states[t],n)}catch{return n??e.states[t]?.state??void 0}}function tk(e,t,n){try{return e.formatEntityAttributeName(e.states[t],n)}catch{return n??e.states[t]?.attributes?.[n]??void 0}}function nk(e,t,n,i){try{return e.formatEntityAttributeValue(e.states[t],n,i)}catch{return i??e.states[t]?.attributes?.[n]??void 0}}const ik=new Date,ak=new Date;function rk(e,t,n,i){function a(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return a.floor=t=>(e(t=new Date(+t)),t),a.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),a.round=e=>{const t=a(e),n=a.ceil(e);return e-t<n-e?t:n},a.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),a.range=(n,i,r)=>{const s=[];if(n=a.ceil(n),r=null==r?1:Math.floor(r),!(n<i&&r>0))return s;let o;do{s.push(o=new Date(+n)),t(n,r),e(n)}while(o<n&&n<i);return s},a.filter=n=>rk((t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)}),((e,i)=>{if(e>=e)if(i<0)for(;++i<=0;)for(;t(e,-1),!n(e););else for(;--i>=0;)for(;t(e,1),!n(e););})),n&&(a.count=(t,i)=>(ik.setTime(+t),ak.setTime(+i),e(ik),e(ak),Math.floor(n(ik,ak))),a.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?a.filter(i?t=>i(t)%e==0:t=>a.count(0,t)%e==0):a:null)),a}const sk=6e4,ok=864e5,ck=6048e5,lk=rk((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sk)/ok),(e=>e.getDate()-1));lk.range;const uk=rk((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/ok),(e=>e.getUTCDate()-1));uk.range;const dk=rk((e=>{e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+t)}),((e,t)=>(t-e)/ok),(e=>Math.floor(e/ok)));function hk(e){return rk((t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),((e,t)=>{e.setDate(e.getDate()+7*t)}),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sk)/ck))}dk.range;const pk=hk(0),mk=hk(1),fk=hk(2),gk=hk(3),vk=hk(4),_k=hk(5),yk=hk(6);function bk(e){return rk((t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)}),((e,t)=>(t-e)/ck))}pk.range,mk.range,fk.range,gk.range,vk.range,_k.range,yk.range;const wk=bk(0),xk=bk(1),kk=bk(2),Ck=bk(3),Mk=bk(4),Ek=bk(5),Sk=bk(6);wk.range,xk.range,kk.range,Ck.range,Mk.range,Ek.range,Sk.range;const Ak=rk((e=>{e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,t)=>{e.setFullYear(e.getFullYear()+t)}),((e,t)=>t.getFullYear()-e.getFullYear()),(e=>e.getFullYear()));Ak.every=e=>isFinite(e=Math.floor(e))&&e>0?rk((t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,n)=>{t.setFullYear(t.getFullYear()+n*e)})):null,Ak.range;const Tk=rk((e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)}),((e,t)=>t.getUTCFullYear()-e.getUTCFullYear()),(e=>e.getUTCFullYear()));function $k(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Ok(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Ik(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}Tk.every=e=>isFinite(e=Math.floor(e))&&e>0?rk((t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)})):null,Tk.range;var Lk,jk,zk,Dk,Rk,Nk={"-":"",_:" ",0:"0"},Pk=/^\s*\d+/,Fk=/^%/,Bk=/[\\^$*+?|[\]().{}]/g;function Vk(e,t,n){var i=e<0?"-":"",a=(i?-e:e)+"",r=a.length;return i+(r<n?new Array(n-r+1).join(t)+a:a)}function Uk(e){return e.replace(Bk,"\\$&")}function Hk(e){return new RegExp("^(?:"+e.map(Uk).join("|")+")","i")}function qk(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function Wk(e,t,n){var i=Pk.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function Zk(e,t,n){var i=Pk.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function Kk(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function Yk(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function Qk(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function Gk(e,t,n){var i=Pk.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function Xk(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function Jk(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function eC(e,t,n){var i=Pk.exec(t.slice(n,n+1));return i?(e.q=3*i[0]-3,n+i[0].length):-1}function tC(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function nC(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function iC(e,t,n){var i=Pk.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function aC(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function rC(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function sC(e,t,n){var i=Pk.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function oC(e,t,n){var i=Pk.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function cC(e,t,n){var i=Pk.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function lC(e,t,n){var i=Fk.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function uC(e,t,n){var i=Pk.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function dC(e,t,n){var i=Pk.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function hC(e,t){return Vk(e.getDate(),t,2)}function pC(e,t){return Vk(e.getHours(),t,2)}function mC(e,t){return Vk(e.getHours()%12||12,t,2)}function fC(e,t){return Vk(1+lk.count(Ak(e),e),t,3)}function gC(e,t){return Vk(e.getMilliseconds(),t,3)}function vC(e,t){return gC(e,t)+"000"}function _C(e,t){return Vk(e.getMonth()+1,t,2)}function yC(e,t){return Vk(e.getMinutes(),t,2)}function bC(e,t){return Vk(e.getSeconds(),t,2)}function wC(e){var t=e.getDay();return 0===t?7:t}function xC(e,t){return Vk(pk.count(Ak(e)-1,e),t,2)}function kC(e){var t=e.getDay();return t>=4||0===t?vk(e):vk.ceil(e)}function CC(e,t){return e=kC(e),Vk(vk.count(Ak(e),e)+(4===Ak(e).getDay()),t,2)}function MC(e){return e.getDay()}function EC(e,t){return Vk(mk.count(Ak(e)-1,e),t,2)}function SC(e,t){return Vk(e.getFullYear()%100,t,2)}function AC(e,t){return Vk((e=kC(e)).getFullYear()%100,t,2)}function TC(e,t){return Vk(e.getFullYear()%1e4,t,4)}function $C(e,t){var n=e.getDay();return Vk((e=n>=4||0===n?vk(e):vk.ceil(e)).getFullYear()%1e4,t,4)}function OC(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Vk(t/60|0,"0",2)+Vk(t%60,"0",2)}function IC(e,t){return Vk(e.getUTCDate(),t,2)}function LC(e,t){return Vk(e.getUTCHours(),t,2)}function jC(e,t){return Vk(e.getUTCHours()%12||12,t,2)}function zC(e,t){return Vk(1+uk.count(Tk(e),e),t,3)}function DC(e,t){return Vk(e.getUTCMilliseconds(),t,3)}function RC(e,t){return DC(e,t)+"000"}function NC(e,t){return Vk(e.getUTCMonth()+1,t,2)}function PC(e,t){return Vk(e.getUTCMinutes(),t,2)}function FC(e,t){return Vk(e.getUTCSeconds(),t,2)}function BC(e){var t=e.getUTCDay();return 0===t?7:t}function VC(e,t){return Vk(wk.count(Tk(e)-1,e),t,2)}function UC(e){var t=e.getUTCDay();return t>=4||0===t?Mk(e):Mk.ceil(e)}function HC(e,t){return e=UC(e),Vk(Mk.count(Tk(e),e)+(4===Tk(e).getUTCDay()),t,2)}function qC(e){return e.getUTCDay()}function WC(e,t){return Vk(xk.count(Tk(e)-1,e),t,2)}function ZC(e,t){return Vk(e.getUTCFullYear()%100,t,2)}function KC(e,t){return Vk((e=UC(e)).getUTCFullYear()%100,t,2)}function YC(e,t){return Vk(e.getUTCFullYear()%1e4,t,4)}function QC(e,t){var n=e.getUTCDay();return Vk((e=n>=4||0===n?Mk(e):Mk.ceil(e)).getUTCFullYear()%1e4,t,4)}function GC(){return"+0000"}function XC(){return"%"}function JC(e){return+e}function eM(e){return Math.floor(+e/1e3)}Lk=function(e){var t=e.dateTime,n=e.date,i=e.time,a=e.periods,r=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,l=Hk(a),u=qk(a),d=Hk(r),h=qk(r),p=Hk(s),m=qk(s),f=Hk(o),g=qk(o),v=Hk(c),_=qk(c),y={a:function(e){return s[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return o[e.getMonth()]},c:null,d:hC,e:hC,f:vC,g:AC,G:$C,H:pC,I:mC,j:fC,L:gC,m:_C,M:yC,p:function(e){return a[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:JC,s:eM,S:bC,u:wC,U:xC,V:CC,w:MC,W:EC,x:null,X:null,y:SC,Y:TC,Z:OC,"%":XC},b={a:function(e){return s[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return o[e.getUTCMonth()]},c:null,d:IC,e:IC,f:RC,g:KC,G:QC,H:LC,I:jC,j:zC,L:DC,m:NC,M:PC,p:function(e){return a[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:JC,s:eM,S:FC,u:BC,U:VC,V:HC,w:qC,W:WC,x:null,X:null,y:ZC,Y:YC,Z:GC,"%":XC},w={a:function(e,t,n){var i=p.exec(t.slice(n));return i?(e.w=m.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(e,t,n){var i=d.exec(t.slice(n));return i?(e.w=h.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(e,t,n){var i=v.exec(t.slice(n));return i?(e.m=_.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(e,t,n){var i=f.exec(t.slice(n));return i?(e.m=g.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(e,n,i){return C(e,t,n,i)},d:nC,e:nC,f:cC,g:Xk,G:Gk,H:aC,I:aC,j:iC,L:oC,m:tC,M:rC,p:function(e,t,n){var i=l.exec(t.slice(n));return i?(e.p=u.get(i[0].toLowerCase()),n+i[0].length):-1},q:eC,Q:uC,s:dC,S:sC,u:Zk,U:Kk,V:Yk,w:Wk,W:Qk,x:function(e,t,i){return C(e,n,t,i)},X:function(e,t,n){return C(e,i,t,n)},y:Xk,Y:Gk,Z:Jk,"%":lC};function x(e,t){return function(n){var i,a,r,s=[],o=-1,c=0,l=e.length;for(n instanceof Date||(n=new Date(+n));++o<l;)37===e.charCodeAt(o)&&(s.push(e.slice(c,o)),null!=(a=Nk[i=e.charAt(++o)])?i=e.charAt(++o):a="e"===i?" ":"0",(r=t[i])&&(i=r(n,a)),s.push(i),c=o+1);return s.push(e.slice(c,o)),s.join("")}}function k(e,t){return function(n){var i,a,r=Ik(1900,void 0,1);if(C(r,e,n+="",0)!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(t&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(a=(i=Ok(Ik(r.y,0,1))).getUTCDay(),i=a>4||0===a?xk.ceil(i):xk(i),i=uk.offset(i,7*(r.V-1)),r.y=i.getUTCFullYear(),r.m=i.getUTCMonth(),r.d=i.getUTCDate()+(r.w+6)%7):(a=(i=$k(Ik(r.y,0,1))).getDay(),i=a>4||0===a?mk.ceil(i):mk(i),i=lk.offset(i,7*(r.V-1)),r.y=i.getFullYear(),r.m=i.getMonth(),r.d=i.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),a="Z"in r?Ok(Ik(r.y,0,1)).getUTCDay():$k(Ik(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(a+5)%7:r.w+7*r.U-(a+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Ok(r)):$k(r)}}function C(e,t,n,i){for(var a,r,s=0,o=t.length,c=n.length;s<o;){if(i>=c)return-1;if(37===(a=t.charCodeAt(s++))){if(a=t.charAt(s++),!(r=w[a in Nk?t.charAt(s++):a])||(i=r(e,n,i))<0)return-1}else if(a!=n.charCodeAt(i++))return-1}return i}return y.x=x(n,y),y.X=x(i,y),y.c=x(t,y),b.x=x(n,b),b.X=x(i,b),b.c=x(t,b),{format:function(e){var t=x(e+="",y);return t.toString=function(){return e},t},parse:function(e){var t=k(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=x(e+="",b);return t.toString=function(){return e},t},utcParse:function(e){var t=k(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),jk=Lk.format,zk=Lk.parse,Dk=Lk.utcFormat,Rk=Lk.utcParse;var tM="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||Dk(tM);var nM=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:Rk(tM),iM=nM;const aM=["weeks","days","hours","minutes","seconds","milliseconds"],rM={weeks:604800,days:86400,hours:3600,minutes:60,seconds:1,milliseconds:.001};function sM(e){return"object"==typeof e&&!Array.isArray(e)}class oM{constructor(e=0,t=0,n=0,i=0,a=0,r=0){this.days=0,this.seconds=0,this.milliseconds=0;let s={days:e,seconds:t,milliseconds:n,minutes:i,hours:a,weeks:r};sM(e)&&(delete s.days,Object.assign(s,e));let o=0;if(aM.forEach((e=>{o+=(s[e]??0)*rM[e]})),o<this.minSeconds||o>this.maxSeconds)throw RangeError("value out of range, must have magnitude less than 999999999 days");if(o.toString().includes(".")){const e=o.toString();this.milliseconds=Math.trunc(parseFloat(`0.${e.split(".")[1]}`)/rM.milliseconds),e.startsWith("-")&&(this.milliseconds*=-1),o=Math.trunc(o)}this.days=Math.trunc(o/rM.days),this.days=this.days||0,this.seconds=o-this.days*rM.days,this.seconds=this.seconds||0}total_seconds(){return this.days*rM.days+this.seconds+this.milliseconds*rM.milliseconds}valueOf(){return this.total_seconds()}toString(){return`${0!=this.days?`${this.days} day${Math.abs(this.days)>1?"s,":","}`:""} ${Dk("%-H:%M:%S"+(this.milliseconds?".%f":""))(new Date(1e3*this.valueOf()))}`.trim()}static get min(){return new oM(-1e8)}get minSeconds(){return-864e10}static get max(){return new oM(1e8)}get maxSeconds(){return 864e10}static get resolution(){return new oM({milliseconds:1})}}class cM{constructor(e=0,t=0,n=0,i=0){this.hour=0,this.minute=0,this.second=0,this.millisecond=0;let a={hour:e,minute:t,second:n,millisecond:i};sM(e)&&(delete a.hour,Object.assign(a,e));for(const e in a)if(!Number.isInteger(a[e]))throw TypeError("'float' object cannot be interpreted as an integer");if((a.hour??0)<0||(a.hour??0)>23)throw RangeError("hour must be in 0..23");if((a.minute??0)<0||(a.minute??0)>59)throw RangeError("minute must be in 0..59");if((a.second??0)<0||(a.second??0)>59)throw RangeError("second must be in 0..59");if((a.millisecond??0)<0||(a.millisecond??0)>999)throw RangeError("millisecond must be in 0..999");Object.assign(this,a)}replace(e=this.hour,t=this.minute,n=this.second,i=this.millisecond){let a={hour:e,minute:t,second:n,millisecond:i};return sM(e)&&(delete a.hour,Object.assign(a,e)),new cM(a.hour??this.hour,a.minute??this.minute,a.second??this.second,a.millisecond??this.millisecond)}isoformat(e="auto"){let t;switch(e){case"hours":t="%H";break;case"minutes":t="%H:%M";break;case"seconds":t="%H:%M:%S";break;case"milliseconds":t="%H:%M:%S.%f";break;default:t="%H:%M:%S"+(this.millisecond?".%f":"")}return this.strftime(t)}valueOf(){return this.hour*rM.hours+this.minute*rM.minutes+this.second*rM.seconds+this.millisecond*rM.milliseconds}toString(){return this.isoformat()}strftime(e){return Dk(e)(this.jsDate)}get jsDate(){return new Date(1e3*this.valueOf())}static get min(){return new cM(0,0,0,0)}static get max(){return new cM(23,59,59,999)}static get resolution(){return oM.resolution}static fromisoformat(e){const t=iM(`1970-01-01T${e}`);if(t)return new cM(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());throw SyntaxError("Unable to parse date string")}}const lM=100,uM=9999,dM=36160,hM=3652059,pM=["year","month","day","hour","minute","second","millisecond"];class mM{constructor(e,t,n,i=0,a=0,r=0,s=0,o=!1){this.year=1970,this.month=1,this.day=1,this.hour=0,this.minute=0,this.second=0,this.millisecond=0,this.utc=!1;const c={year:e,month:t,day:n,hour:i,minute:a,second:r,millisecond:s,utc:o};if(sM(e)&&(delete c.year,Object.assign(c,e)),!c.year||!c.month||!c.day)throw SyntaxError("Missing required argument year, month, or day");for(const e in c)if(pM.includes(e)&&!Number.isInteger(c[e]))throw TypeError(`Argument ${e} value ${c[e]} is not an integer`);if(c.year<lM||c.year>uM)throw RangeError(`year ${c.year} is out of range`);if(c.month<1||c.month>12)throw RangeError(`month ${c.month} is out of range`);if(c.day<1||c.day>new Date(c.year,c.month,0).getDate())throw RangeError(`day ${n} is out of range for month`);if((c.hour??0)<0||(c.hour??0)>23)throw RangeError("hour must be in 0..23");if((c.minute??0)<0||(c.minute??0)>59)throw RangeError("minute must be in 0..59");if((c.second??0)<0||(c.second??0)>59)throw RangeError("second must be in 0..59");if((c.millisecond??0)<0||(c.millisecond??0)>999)throw RangeError("millisecond must be in 0..999");Object.assign(this,c)}date(){return new fM(this.year,this.month,this.day)}time(){return new cM(this.hour,this.minute,this.second,this.millisecond)}replace(e=this.year,t=this.month,n=this.day,i=this.hour,a=this.minute,r=this.second,s=this.millisecond){const o={year:e,month:t,day:n,hour:i,minute:a,second:r,millisecond:s};return sM(e)&&(delete o.year,Object.assign(o,e)),new mM({year:o.year??this.year,month:o.month??this.month,day:o.day??this.day,hour:o.hour??this.hour,minute:o.minute??this.minute,second:o.second??this.second,millisecond:o.millisecond??this.millisecond})}toordinal(){return this.date().toordinal()}timestamp(){let e;return e=this.utc?Date.UTC(this.year,this.month-1,this.day||1,this.hour||0,this.minute||0,this.second||0,this.millisecond||0):this.jsDate.getTime(),e/1e3}weekday(){return this.date().weekday()}isoweekday(){return this.weekday()+1}isocalendar(){const[e,t,n]=Dk("%G-%V-%u")(this.jsDate).split("-");return[Number(e),Number(t),Number(n)]}isoformat(e="T",t="auto"){const n={sep:e,timespec:t};let i;switch(sM(e)&&(delete n.sep,Object.assign(n,e),n.sep=n.sep??"T"),n.timespec){case"hours":i=`%Y-%m-%d${n.sep}%H`;break;case"minutes":i=`%Y-%m-%d${n.sep}%H:%M`;break;case"seconds":i=`%Y-%m-%d${n.sep}%H:%M:%S`;break;case"milliseconds":i=`%Y-%m-%d${n.sep}%H:%M:%S.%f`;break;default:i=`%Y-%m-%d${n.sep}%H:%M:%S${this.millisecond?".%f":""}`}return this.strftime(i)}valueOf(){return this.timestamp()}toString(){return this.isoformat(" ")}ctime(){return jk("%a %b %-e %H:%M:%S %Y")(this.jsDate)}strftime(e){return this.utc?Dk(e)(this.jsDate):jk(e)(this.jsDate)}get jsDate(){return this.utc?new Date(1e3*this.valueOf()):new Date(this.year,this.month-1,this.day||1,this.hour||0,this.minute||0,this.second||0,this.millisecond||0)}static get min(){return new mM(lM,1,1)}static get max(){return new mM(uM,12,31,23,59,59,999)}static get resolution(){return oM.resolution}static today(){return mM.now()}static now(){return mM.fromjsdate(new Date)}static utcnow(){return mM.utcfromjsdate(new Date)}static fromtimestamp(e){const t=new Date(1e3*e);return mM.fromjsdate(t)}static utcfromtimestamp(e){const t=new Date(1e3*e);return mM.utcfromjsdate(t)}static fromjsdate(e){return new mM({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),millisecond:e.getMilliseconds()})}static utcfromjsdate(e){return new mM({year:e.getUTCFullYear(),month:e.getUTCMonth()+1,day:e.getUTCDate(),hour:e.getUTCHours(),minute:e.getUTCMinutes(),second:e.getUTCSeconds(),millisecond:e.getUTCMilliseconds(),utc:!0})}static fromordinal(e){if(e<dM||e>hM)throw RangeError(`ordinal ${e} is out of range`);return mM.fromtimestamp(fM.min.valueOf()+new oM({days:e-dM}).valueOf())}static combine(e,t){return new mM({year:e.year,month:e.month,day:e.day,hour:t.hour,minute:t.minute,second:t.second,millisecond:t.millisecond})}static fromisoformat(e){const t=iM(e);if(t)return mM.fromjsdate(t);throw SyntaxError("Unable to parse date string")}static fromisocalendar(e,t,n){return mM.strptime(`${e}-${t}-${n}`,"%G-%V-%u")}static strptime(e,t,n=!1){const i=(n?Rk:zk)(t)(e);if(!i)throw Error(`'${e}' does not match format '${t}'`);return n?mM.utcfromjsdate(i):mM.fromjsdate(i)}}class fM{constructor(e,t,n){if(this.year=1970,this.month=1,this.day=1,!Number.isInteger(e)||e<lM||e>uM)throw RangeError(`year ${e} is out of range`);if(!Number.isInteger(t)||t<1||t>12)throw RangeError(`month ${t} is out of range`);if(!Number.isInteger(n)||n<1||n>new Date(e,t,0).getDate())throw RangeError(`day ${n} is out of range for month`);Object.assign(this,{year:e,month:t,day:n})}replace(e=this.year,t=this.month,n=this.day){const i={year:e,month:t,day:n};return sM(e)&&(delete i.year,Object.assign(i,e)),new fM(i.year??this.year,i.month??this.month,i.day??this.day)}toordinal(){return Math.trunc((this.valueOf()+new oM({days:719163}).total_seconds())/rM.days)}weekday(){return(this.jsDate.getDay()+6)%7}isoweekday(){return this.weekday()+1}isocalendar(){const[e,t,n]=Dk("%G-%V-%u")(this.jsDate).split("-");return[Number(e),Number(t),Number(n)]}isoformat(){return Dk("%Y-%m-%d")(this.jsDate)}valueOf(){return this.jsDate.getTime()/1e3}toString(){return this.isoformat()}ctime(){return jk("%a %b %-e 00:00:00 %Y")(this.jsDate)}strftime(e){return jk(e)(this.jsDate)}get jsDate(){return new Date(this.year,this.month-1,this.day)}static get min(){return new fM(lM,1,1)}static get max(){return new fM(uM,12,31)}static get resolution(){return new oM({days:1})}static today(){const e=mM.now();return new fM(e.year,e.month,e.day)}static fromtimestamp(e){const t=mM.fromtimestamp(e);return new fM(t.year,t.month,t.day)}static fromordinal(e){if(e<dM||e>hM)throw RangeError(`ordinal ${e} is out of range`);return fM.fromtimestamp(fM.min.valueOf()+new oM({days:e-dM}).valueOf())}static fromisoformat(e){const t=iM(e);if(t)return new fM(t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate());throw SyntaxError("Unable to parse date string")}static fromisocalendar(e,t,n){const i=mM.strptime(`${e}-${t}-${n}`,"%G-%V-%u");return new fM(Number(i.year),Number(i.month),Number(i.day))}}const gM=(...e)=>new oM(...e);gM.min=oM.min,gM.max=oM.max,gM.resolution=oM.resolution;const vM=(...e)=>new fM(...e);vM.min=fM.min,vM.max=fM.max,vM.resolution=fM.resolution,vM.today=fM.today,vM.fromtimestamp=fM.fromtimestamp,vM.fromordinal=fM.fromordinal,vM.fromisoformat=fM.fromisoformat,vM.fromisocalendar=fM.fromisocalendar;const _M=(...e)=>new mM(...e);_M.min=mM.min,_M.max=mM.max,_M.resolution=mM.resolution,_M.today=mM.today,_M.now=mM.now,_M.utcnow=mM.utcnow,_M.fromtimestamp=mM.fromtimestamp,_M.utcfromtimestamp=mM.utcfromtimestamp,_M.fromjsdate=mM.fromjsdate,_M.utcfromjsdate=mM.utcfromjsdate,_M.fromordinal=mM.fromordinal,_M.combine=mM.combine,_M.fromisoformat=mM.fromisoformat,_M.fromisocalendar=mM.fromisocalendar,_M.strptime=mM.strptime;const yM=(...e)=>new cM(...e);yM.min=cM.min,yM.max=cM.max,yM.resolution=cM.resolution,yM.fromisoformat=cM.fromisoformat;const bM={MINYEAR:lM,MAXYEAR:uM,MINYEAR_ORDINAL:dM,MAXYEAR_ORDINAL:hM,timedelta:gM,date:vM,datetime:_M,time:yM};function wM(){return bM.datetime.now()}function xM(e="00:00"){const[t,n,i,a]=e.split(":"),r=bM.datetime.now(),s=bM.datetime(r.year,r.month,r.day,Number(t??0),Number(n??0),Number(i??0),Number(a??0));return Lx(s.toString()),s}function kM(e,t=void 0,n=!0){"object"!=typeof t||Array.isArray(t)||(n=t.utc??n,t=t.fallback??void 0);try{let t;if("string"==typeof e)if(/[^\d]/g.test(e)){e=e.replace(/T/g," ");const i=["%Y-%m-%d %H:%M:%S.%f%Z","%Y-%m-%d %H:%M:%S.%f","%Y-%m-%d %H:%M:%S%Z","%Y-%m-%d %H:%M:%S"];for(const a of i)try{t=bM.datetime.strptime(e,a,n);break}catch{}t||(e=parseFloat(e))}else e=parseFloat(e);else t="number"==typeof e?n?bM.datetime.utcfromtimestamp(e):bM.datetime.fromtimestamp(e):e instanceof fM?bM.datetime(e.year,e.month,e.day):e;return Lx((t??"NaN").toString()),t}catch(e){if(t)return t;throw e}}function CM(e,t){try{let t;return"string"==typeof e?(e.includes(" ")||e.includes("T")||(e+=" 00:00:00"),t=Date.parse(e)/1e3):t="number"==typeof e?bM.datetime.utcfromtimestamp(e).jsDate.getTime()/1e3:e.jsDate.getTime()/1e3,Lx(t.toString()),t}catch(e){if(t)return t;throw e}}function MM(e){return bM.datetime.fromjsdate(bM.datetime(e).jsDate)}function EM(e,t=1,n=!1){if(!(e instanceof mM))return e;let i=wM().valueOf()-MM(e).valueOf();if(n&&(i*=-1),i<=0)return e;(0==t||t>6)&&(t=6);const a={year:31536e3,month:2592e3,day:86400,hour:3600,minute:60,second:1},r=Object.keys(a);let s="",o=!1;for(let e=0;e<t;e++){let n=i/a[r[e]];n=e==t-1?Math.round(n):Math.floor(n),(o||n>0)&&(o=!0,s+=` ${n} ${r[e]}${1!=n?"s":""}`,i-=n*a[r[e]])}return s.trim()}function SM(e,t=1){return EM(e,t)}function AM(e,t=1){return EM(e,t,!0)}const TM={states:dx,state_attr:hx,has_value:px,state_translated:ek,attr_name_translated:tk,attr_value_translated:nk,expand:kx,device_entities:fx,device_attr:gx,device_id:vx,floor_id:bx,floor_name:wx,floor_areas:xx,area_id:sx,area_name:ox,area_entities:cx,area_devices:lx,labels:Ex,label_areas:Tx,label_devices:$x,label_entities:Ox,iif:Cx,closest:yx},$M={label_id:Sx,label_name:Ax,today_at:xM,as_datetime:kM,as_timestamp:CM,as_local:MM,time_since:SM,time_until:AM,timestamp_local:function(e,t){try{const t=bM.datetime.fromtimestamp(e).strftime("%Y-%m-%dT%H:%M:%S%Z");return Lx(t),t}catch(e){if(t)return t;throw e}},timestamp_utc:function(e,t){try{const t=bM.datetime.utcfromtimestamp(e).strftime("%Y-%m-%dT%H:%M:%S%Z");return Lx(t),t}catch(e){if(t)return t;throw e}},timestamp_custom:function(e,t,n=!0,i=void 0){"object"!=typeof n||Array.isArray(n)||(i=n.fallback??i,n=n.local??!0);try{const i=(n?bM.datetime.fromtimestamp(e):bM.datetime.utcfromtimestamp(e)).strftime(t);return Lx(i),i}catch(e){if(i)return i;throw e}},to_json:function(e,t=!1,n=!1,i=!1){"object"!=typeof t||Array.isArray(t)||(i=t.sort_keys??i,n=t.pretty_print??n,t=t.ensure_ascii??!1),i&&(e=Object.keys(e).sort().reduce(((t,n)=>(t[n]=e[n],t)),{}));let a=JSON.stringify(e,void 0,n?2:void 0);return t&&(a=a.replace(/[\u007F-\uFFFF]/g,(e=>`\\u'${("0000"+e.charCodeAt(0).toString(16)).substring(-4)}`))),a},from_json:function(e){return JSON.parse(e)},closest:yx,contains:ux,is_number:jx,bool:zx,log:Dx,sin:Rx,cos:Nx,tan:Px,asin:Fx,acos:Bx,atan:Vx,atan2:Ux,sqrt:Hx,max:qx,min:Wx,average:Zx,median:Kx,statistical_mode:Yx,bitwise_and:function(e,t){return e&t},bitwise_or:function(e,t){return e|t},bitwise_xor:function(e,t){return e^t},bitwise_not:function(e){return~e},ord:function(e){if(1==e.length)return e.codePointAt(0);throw Error("Expected a character, but received a string")},multiply:function(e,t){return Number(e)*Number(t)},add:function(e,t){return Number(e)+Number(t)},regex_replace:function(e,t="",n=""){return e.replace(new RegExp(t,"g"),n)},regex_findall:function(e,t=""){return e.match(new RegExp(t,"g"))??[]},regex_findall_index:function(e,t="",n=0){return(e.match(new RegExp(t,"g"))??[])[n]},str:Ix};const OM={states:dx,is_state:function(e,t,n){try{const i=dx(e,t);return Array.isArray(n)?n.includes(i):i==n}catch{return!1}},state_attr:hx,is_state_attr:function(e,t,n,i){try{return hx(e,t,n)==i}catch{return!1}},has_value:px,state_translated:ek,attr_name_translated:tk,attr_value_translated:nk,expand:kx,is_hidden_entity:function(e,t){try{return e.entities[t].hidden??!1}catch{return!1}},device_entities:fx,device_attr:gx,is_device_attr:function(e,t,n,i){try{return null!=i&&gx(e,t,n)==i}catch{return!1}},device_id:vx,floors:function(e){return Object.keys(e.floors)},floor_id:bx,floor_name:wx,floor_areas:xx,areas:function(e){try{return Object.keys(e.areas)}catch{return[]}},area_id:sx,area_name:ox,area_entities:cx,area_devices:lx,integration_entities:function(e,t){try{const n=[];if(t){for(const i in e.entities)e.entities[i].platform==t&&n.push(i);n.sort()}return n}catch{return[]}},labels:Ex,label_areas:Tx,label_devices:$x,label_entities:Ox,iif:Cx,distance:function(e,...t){try{let n,i,a,r,s=0;if("string"==typeof t[0])n=e.states[t[0]].attributes.latitude,a=e.states[t[0]].attributes.longitude,s=1;else if("object"!=typeof t[0]||Array.isArray(t[0])){if("number"!=typeof t[0])return null;if("number"!=typeof t[1])throw Error("Latitude provided but not longitude 1");n=t[0],a=t[1],s=2}else n=t[0].attributes.latitude,a=t[0].attributes.longitude,s=1;if("string"==typeof t[s])i=e.states[t[s]].attributes.latitude,r=e.states[t[s]].attributes.longitude;else if("object"!=typeof t[s]||Array.isArray(t[s]))if("number"==typeof t[s]){if("number"!=typeof t[s+1])throw Error("Latitude provided but not longitude 2");i=t[s],r=t[s+1]}else i=e.states["zone.home"].attributes.latitude,r=e.states["zone.home"].attributes.longitude;else i=t[s].attributes.latitude,r=t[s].attributes.longitude;return _x([n,a],[i,r],"mi"==e.config.unit_system.length)}catch{return null}},closest:yx},IM={label_id:Sx,label_name:Ax,now:wM,utcnow:function(){return bM.datetime.utcnow()},today_at:xM,as_datetime:kM,as_timestamp:CM,as_local:MM,strptime:function(e,t,n=void 0,i=!1){"object"!=typeof n||Array.isArray(n)||n instanceof mM||n instanceof fM||(i=n.utc??i,n=n.fallback??void 0);try{t=t.replace(/%z/g,"%Z");const n=bM.datetime.strptime(e,t,i);return Lx(n.toString()),n}catch(e){if(n)return n;throw e}},time_since:SM,time_until:AM,as_timedelta:function(e){try{let t;if(e.includes(":")||e.includes(" ")||/^\d*\.?\d*$/.test(e)){let n,i;e.includes(" ")?e.includes("days")?[n,i]=e.split(" days "):[n,i]=e.split(" "):(n=0,i=e);const[a,r,s]=i.split(":").reverse();t=bM.timedelta(Number(n),Number(a.replace(",",".")??0),0,Number(r??0),Number(s??0))}else{if(!e.startsWith("P"))return null;{const n=e.replace(/P|T/g,"").match(/(\d*?)[A-Z]/g);if(!n)return null;const i={};for(const e of n){const t=e.match(/^(\d*)/),n=e.match(/[A-Z]$/);t&&n&&(i[n[0]]=parseFloat(t[0]))}t=bM.timedelta(i.D,i.S,0,i.M,i.H,i.W)}}return Lx(t.toString()),t}catch{return null}},float:function(e,t){try{const t=parseFloat(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}},is_number:jx,int:function(e,t){try{const t=parseInt(e);return Lx(t.toString()),t}catch(e){if(t)return t;throw e}},bool:zx,log:Dx,sin:Rx,cos:Nx,tan:Px,asin:Fx,acos:Bx,atan:Vx,atan2:Ux,sqrt:Hx,max:qx,min:Wx,average:Zx,median:Kx,statistical_mode:Yx,set:function(...e){return new Set(e.flat(1/0))},list:function(...e){return e.map((e=>Array.from(e))).flat(1/0)},zip:function(...e){if(e.length>1)return e[0].map(((t,n)=>{const i=[t];for(let t=1;t<e.length;t++)i.push(e[t][n]);return i}));{e=e[0];const t=[];for(let n=0;n<e.length;n++)for(let i=0;i<e[n].length;i++)t[i]||t.push([]),t[i].push(e[n][i]);return t}},match_media:function(e){return window.matchMedia(e).matches},str:Ix},LM={e:Qx,pi:Gx,tau:Xx,inf:Jx};const jM={list:function(e){return Array.isArray(e)},set:function(e){return e instanceof Set},datetime:function(e){return e instanceof mM},string_like:function(e){return"string"==typeof e||e instanceof Buffer||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof ArrayBuffer},contains:ux,match:function(e,t){return new RegExp(`^${t}`).test(e)},search:function(e,t){return new RegExp(t,"g").test(e)},test:function(e,t){return new RegExp(t).test(e)}};let zM;rx.installJinjaCompat();const DM=function(e){for(const t in jM)e.addTest(t,(function(...e){return jM[t](...e)}));return e}(function(e){for(const t in $M)e.addFilter(t,(function(...e){return $M[t](...e)}));for(const t in TM)e.addFilter(t,(function(...e){return TM[t](zM,...e)}));return e}(function(e){for(const t in IM)e.addGlobal(t,(function(...e){return IM[t](...e)}));for(const t in OM)e.addGlobal(t,(function(...e){return OM[t](zM,...e)}));for(const t in LM)e.addGlobal(t,LM[t]);return e.addGlobal("dt",bM),e.addGlobal("date",fM),e.addGlobal("time",cM),e.addGlobal("datetime",mM),e.addGlobal("timedelta",oM),e}(new rx.Environment)));function RM(e,t,n){return zM||async function(e){if(e.connection){const t=await e.connection.sendMessagePromise({type:"config/label_registry/list"});t.sort(((e,t)=>e.name.localeCompare(t.name)));for(const e of t)Mx[e.label_id]=e}}(e),zM=e,"string"==typeof t&&(t.includes("{{")&&t.includes("}}")||t.includes("{%")&&t.includes("%}"))?(t=DM.renderString(structuredClone(t),{hass:e,_states:mx(e),...n}).trim(),[void 0,null,"undefined","null","None"].includes(t)?"":"true"==t.toLowerCase()||"false"!=t.toLowerCase()&&t):t}class NM{constructor(){this.renderRecursively=(e,t,n)=>this._renderTemplateRecursively(e,t,this._conditionStateToTemplateContext(n?.conditionState,n?.triggerData))}_conditionStateToTemplateContext(e,t){if(!e?.camera&&!e?.view&&!t)return;const n={...e?.camera&&{camera:e.camera},...e?.view&&{view:e.view},...t&&{trigger:t}};return{acc:n,advanced_camera_card:n}}_renderTemplateRecursively(e,t,n){if("string"==typeof t)return RM(e,t,n);if(Array.isArray(t))return t.map((t=>this._renderTemplateRecursively(e,t,n)));if("object"==typeof t&&null!==t){const i={};for(const a in t)i[a]=this._renderTemplateRecursively(e,t[a],n);return i}return t}}class PM{constructor(e){this._triggeredCameras=new Map,this._triggeredCameraTimers=new Map,this._throttledTriggerAction=by(this._triggerAction.bind(this),1e3,{trailing:!0}),this._api=e}getTriggeredCameraIDs(){return new Set(this._triggeredCameras.keys())}isTriggered(){return!!this._triggeredCameras.size}getMostRecentlyTriggeredCameraID(){const e=j_([...this._triggeredCameras.entries()],(e=>e[1].getTime()),"desc");return e.length?e[0][0]:null}async handleCameraEvent(e){const t=this._api.getConfigManager().getConfig()?.view.triggers,n=this._api.getViewManager().getView()?.camera;if(!t||!n)return;const i=this._api.getCameraManager().getStore().getAllDependentCameras(n);t.filter_selected_camera&&!i.has(e.cameraID)||("end"!==e.type?(this._triggeredCameras.set(e.cameraID,new Date),this._setConditionStateIfNecessary(),await this._throttledTriggerAction(e)):this._startUntriggerTimer(e.cameraID))}_hasAllowableInteractionStateForAction(){const e=this._api.getConfigManager().getConfig()?.view.triggers,t=this._api.getInteractionManager().hasInteraction();return!!e&&("all"===e.actions.interaction_mode||"active"===e.actions.interaction_mode&&t||"inactive"===e.actions.interaction_mode&&!t)}async _triggerAction(e){const t=this._api.getConfigManager().getConfig()?.view.triggers.actions.trigger,n=this._api.getConfigManager().getConfig()?.view.default;("high"!==e.fidelity||e.snapshot||e.clip||"live"===t||"default"===t&&"live"===n)&&(this._hasAllowableInteractionStateForAction()&&("update"===t?await this._api.getViewManager().setViewByParametersWithNewQuery({queryExecutorOptions:{useCache:!1}}):"live"===t?await this._api.getViewManager().setViewByParametersWithNewQuery({params:{view:"live",camera:e.cameraID}}):"default"===t?await this._api.getViewManager().setViewDefaultWithNewQuery({params:{camera:e.cameraID}}):"high"===e.fidelity&&"media"===t&&await this._api.getViewManager().setViewByParametersWithNewQuery({params:{view:e.clip?"clip":"snapshot",camera:e.cameraID}})),this._api.getCardElementManager().update())}_setConditionStateIfNecessary(){const e=new Set(this._triggeredCameras.keys()),t=e.size?e:void 0;this._api.getConditionStateManager().setState({triggered:t})}async _untriggerAction(e){const t=this._api.getConfigManager().getConfig()?.view.triggers.actions.untrigger;"default"===t&&this._hasAllowableInteractionStateForAction()&&await this._api.getViewManager().setViewDefaultWithNewQuery(),this._triggeredCameras.delete(e),this._deleteTimer(e),this._setConditionStateIfNecessary(),this._api.getCardElementManager().update()}_startUntriggerTimer(e){this._deleteTimer(e);const t=new Tg;this._triggeredCameraTimers.set(e,t),t.start(
/* istanbul ignore next: the case of config being null here cannot be
           reached, as there's no way to have the untrigger call happen without
           a config. -- @preserve */
this._api.getConfigManager().getConfig()?.view.triggers.untrigger_seconds??0,(async()=>{await this._untriggerAction(e)}))}_deleteTimer(e){this._triggeredCameraTimers.get(e)?.stop(),this._triggeredCameraTimers.delete(e)}}class FM{constructor(e){this._queries=null,e&&(this._queries=e)}clone(){return _v(this)}getQueries(){return this._queries}setQueries(e){return this._queries=e,this}getQueryCameraIDs(){if(!this._queries)return null;const e=new Set;return this._queries.forEach((t=>[...t.cameraIDs].forEach((t=>e.add(t))))),e}setQueryCameraIDs(e){if(!this._queries)return this;const t=[];return this._queries.forEach((n=>t.push({...n,cameraIDs:tg(e)}))),this._queries=wy(t,V_),this}hasQueriesForCameraIDs(e){for(const t of e)if(!this._queries?.some((e=>e.cameraIDs.has(t))))return!1;return!0}}class BM extends FM{convertToClipsQueries(){for(const e of this._queries??[])delete e.hasSnapshot,e.hasClip=!0;return this}}class VM extends FM{}class UM{static areEventQueries(e){return e instanceof BM}static areRecordingQueries(e){return e instanceof VM}static areClipsQueries(e){return this.areEventQueries(e)&&!!e?.getQueries()?.every((e=>e.hasClip))}static areSnapshotQueries(e){return this.areEventQueries(e)&&!!e?.getQueries()?.every((e=>e.hasSnapshot))}static getQueriesType(e){return this.areEventQueries(e)?"event":this.areRecordingQueries(e)?"recording":null}static getMediaType(e){return this.areClipsQueries(e)?"clips":this.areSnapshotQueries(e)?"snapshots":this.areRecordingQueries(e)?"recordings":null}}const HM=(e,t,n)=>{const i={anyCapabilities:["clips","snapshots","recordings"]};switch(t){case"image":case"diagnostics":return e.getStore().getCameraIDs();case"live":case"clip":case"clips":case"snapshot":case"snapshots":case"recording":case"recordings":const a="clip"===t?"clips":"snapshot"===t?"snapshots":"recording"===t?"recordings":t;return n?e.getStore().getAllDependentCameras(n,a):e.getStore().getCameraIDsWithCapability(a);case"timeline":return e.getStore().getCameraIDsWithCapability(i);case"media":return n?e.getStore().getAllDependentCameras(n,i):e.getStore().getCameraIDsWithCapability(i)}},qM=(e,t)=>vy({},e,t);class WM{constructor(e){this.view=e.view,this.camera=e.camera,this.query=e.query??null,this.queryResults=e.queryResults??null,this.context=e.context??null,this.displayMode=e.displayMode??null}clone(){return new WM({view:this.view,camera:this.camera,query:this.query?.clone()??null,queryResults:this.queryResults?.clone()??null,context:this.context,displayMode:this.displayMode})}evolve(e){return new WM({view:void 0!==e.view?e.view:this.view,camera:void 0!==e.camera?e.camera:this.camera,query:void 0!==e.query?e.query:this.query?.clone()??null,queryResults:void 0!==e.queryResults?e.queryResults:this.queryResults?.clone()??null,context:void 0!==e.context?e.context:this.context,displayMode:void 0!==e.displayMode?e.displayMode:this.displayMode})}mergeInContext(e){return this.context=qM(this.context,e),this}removeContext(e){return this.context&&delete this.context[e],this}removeContextProperty(e,t){const n=this.context?.[e];return n&&delete n[t],this}is(e){return this.view==e}isGalleryView(){return["clips","snapshots","recordings"].includes(this.view)}isAnyMediaView(){return this.isViewerView()||this.is("live")||this.is("image")}isViewerView(){return["media","clip","snapshot","recording"].includes(this.view)}supportsMultipleDisplayModes(){return this.isViewerView()||this.is("live")}getDefaultMediaType(){return["clip","clips"].includes(this.view)?"clips":["snapshot","snapshots"].includes(this.view)?"snapshots":["recording","recordings"].includes(this.view)?"recordings":null}isGrid(){return"grid"===this.displayMode}}const ZM=(e,t)=>{t?.forEach((t=>t.modify(e)))};class KM extends Lo{}class YM extends Lo{}class QM{constructor(e){this._api=e}getViewDefault(e){const t=this._api.getConfigManager().getConfig();if(!t)return null;let n=null;const i=e?.params?.view??t.view.default;if(e?.params?.camera)n=e.params.camera;else{const a=[...HM(this._api.getCameraManager(),i)];if(!a.length)return null;if(e?.baseView?.camera&&t.view.default_cycle_camera){const t=a.indexOf(e.baseView.camera);n=a[t+1>=a.length?0:t+1]}else n=a[0]}return this.getViewByParameters({params:{...e?.params,view:i,camera:n},baseView:e?.baseView})}getViewByParameters(e){const t=this._api.getConfigManager().getConfig();if(!t)return null;let n=e?.params?.camera??e?.baseView?.camera??null,i=e?.params?.view??e?.baseView?.view??t.view.default;const a=this._api.getCameraManager().getStore().getCameraIDs();if(!n||!a.has(n)){n=HM(this._api.getCameraManager(),i).keys().next().value??null}if(!n){const e=[...this._api.getCameraManager().getStore().getCameras()].reduce(((e,[t,n])=>{const i=n.getCapabilities()?.getRawCapabilities();return i&&(e[t]=i),e}),{});throw new KM(Kv("error.no_supported_cameras"),{view:i,cameras_capabilities:e})}if(!this.isViewSupportedByCamera(n,i)){if(!e?.failSafe||!this.isViewSupportedByCamera(n,Qo)){const e=this._api.getCameraManager().getStore().getCamera(n)?.getCapabilities()?.getRawCapabilities();throw new YM(Kv("error.no_supported_camera"),{view:i,camera:n,...e&&{camera_capabilities:e}})}i=Qo}const r=this._getDefaultDisplayModeForView(i,t),s=(i!==e?.baseView?.view?r:null)??e?.params?.displayMode??e?.baseView?.displayMode??r??"single",o={...e?.params,view:i,camera:n,displayMode:s},c=e?.baseView?e.baseView.evolve(o):new WM(o);return ZM(c,e?.modifiers),c}isViewSupportedByCamera(e,t){return!!HM(this._api.getCameraManager(),t,e).size}_getDefaultDisplayModeForView(e,t){let n=null;switch(e){case"media":case"clip":case"recording":case"snapshot":n=t.media_viewer.display?.mode??null;break;case"live":n=t.live.display?.mode??null}return n}}class GM{constructor(e,t){this._key=e,this._property=t}modify(e){e.removeContextProperty(this._key,this._property)}}class XM{constructor(e){this._query=e?.query,this._queryResults=e?.queryResults}modify(e){void 0!==this._query&&(e.query=this._query),void 0!==this._queryResults&&(e.queryResults=this._queryResults)}}const JM=(e,t,n)=>{let i;for(const[a,r]of e.entries()){const e=r.getStartTime(),s=r.getUsableEndTime();if(r.includesTime(t)&&e&&s){const t=s.getTime()-e.getTime();(!i||n&&i.cameraID!==n&&r.getCameraID()===n||t>i.duration&&(!n||i.cameraID!==n||r.getCameraID()===n))&&(i={index:a,duration:t,cameraID:r.getCameraID()})}}return i?i.index:null};class eE{constructor(e){this._results=e?.results??[],this._selectedIndex=this._getInitialSelectedIndex(e)}_getInitialSelectedIndex(e){return null!=e?.selectedIndex?e.selectedIndex:e?.results&&e.results.length?e?.selectApproach&&"last"!==e?.selectApproach?0:e.results.length-1:null}clone(){return new eE({results:this._results,selectedIndex:this._selectedIndex})}getResults(){return this._results}getSelectedIndex(){return this._selectedIndex}getResultsCount(){return this.getResults().length}hasResults(){return 0!==this.getResultsCount()}getResult(e){return void 0===e?null:this._results[e]}getSelectedResult(){const e=this.getSelectedIndex();return null!==e?this.getResult(e):null}hasSelectedResult(){return null!==this.getSelectedResult()}resetSelectedResult(){this._selectedIndex=null}selectIndex(e){(null===e||e>=0&&e<this._results.length)&&(this._selectedIndex=e)}selectResultIfFound(e){for(const[t,n]of this._results.entries())if(e(n)){this.selectIndex(t);break}}selectBestResult(e){const t=e(this._results);null!==t&&this.selectIndex(t)}}class tE{constructor(e){this._resultsTimestamp=null,this._cameras=new Map,this._resultsTimestamp=new Date,this._main=new eE(e),this._buildByCameraSlices(e?.selectApproach)}_buildByCameraSlices(e){const t=new Map;for(const e of this._main.getResults()){const n=e.getCameraID(),i=t.get(n)??[];i.push(e),t.set(n,i)}for(const[n,i]of t.entries())this._cameras.set(n,new eE({results:i,selectApproach:e}))}clone(){const e=new tE;e._resultsTimestamp=this._resultsTimestamp,e._main=this._main.clone();for(const[t,n]of this._cameras.entries())e._cameras.set(t,n.clone());return e}isSupersetOf(e){const t=new Set(this._main.getResults()?.map((e=>e.getID()))),n=new Set(e._main.getResults()?.map((e=>e.getID())));return!(!t.size||!n.size||t.has(null)||n.has(null))&&((e,t)=>{for(const n of t)if(!e.has(n))return!1;return!0})(t,n)}getCameraIDs(){return new Set(this._cameras.keys())}getSlice(e){return e?this._cameras.get(e)??null:this._main}getResults(e){return this.getSlice(e)?.getResults()??null}getResultsCount(e){return this.getSlice(e)?.getResultsCount()??0}hasResults(e){return 0!==this.getSlice(e)?.getResultsCount()}getResult(e,t){return this.getSlice(t)?.getResult(e)??null}getSelectedIndex(e){return this.getSlice(e)?.getSelectedIndex()??null}getSelectedResult(e){return this.getSlice(e)?.getSelectedResult()??null}getMultipleSelectedResults(e){const t=[];if(!e||e.main){const e=this.getSelectedResult();e&&t.push(e)}const n=this._getCameraIDsFromCriteria(e);for(const e of n??[]){const n=this.getSelectedResult(e);n&&t.push(n)}return t}hasSelectedResult(e){return this.getSlice(e)?.hasSelectedResult()??!1}resetSelectedResult(e){return this.getSlice(e)?.resetSelectedResult(),this}getResultsTimestamp(){return this._resultsTimestamp}selectIndex(e,t){return this.getSlice(t)?.selectIndex(e),t||this.demoteMainSelectionToCameraSelection(),this}demoteMainSelectionToCameraSelection(){const e=this.getSelectedResult();if(e){const t=e.getCameraID();this.resetSelectedResult(t),this.selectResultIfFound((t=>t===e),{cameraID:t})}return this}promoteCameraSelectionToMainSelection(e){const t=this.getSelectedResult(e);return this.resetSelectedResult(),this.selectResultIfFound((e=>e===t)),this}_getCameraIDsFromCriteria(e){return e?.allCameras?this.getCameraIDs():e?.cameraID?new Set([e.cameraID]):null}selectResultIfFound(e,t){t&&!t?.main||(this._main.selectResultIfFound(e),this.demoteMainSelectionToCameraSelection());const n=this._getCameraIDsFromCriteria(t);for(const t of n??[])this.getSlice(t)?.selectResultIfFound(e);return this}selectBestResult(e,t){t&&!t.main||(this._main.selectBestResult(e),this.demoteMainSelectionToCameraSelection());const n=this._getCameraIDsFromCriteria(t);for(const t of n??[])this.getSlice(t)?.selectBestResult(e);return this}}class nE{constructor(e){this._api=e}async executeDefaultEventQuery(e){const t=e?.eventsMediaType&&"all"!==e?.eventsMediaType?e.eventsMediaType:{anyCapabilities:["clips","snapshots"]},n=this._api.getCameraManager(),i=e?.cameraID?n.getStore().getAllDependentCameras(e.cameraID,t):n.getStore().getCameraIDsWithCapability(t);if(!i.size)return null;const a=n.generateDefaultEventQueries(i,{limit:this._getChunkLimit(),..."clips"===e?.eventsMediaType&&{hasClip:!0},..."snapshots"===e?.eventsMediaType&&{hasSnapshot:!0}});if(!a)return null;const r=new BM(a),s=await this.execute(r,e?.executorOptions);return s?{query:r,queryResults:s}:null}async executeDefaultRecordingQuery(e){const t=this._api.getCameraManager(),n=e?.cameraID?t.getStore().getAllDependentCameras(e.cameraID,"recordings"):t.getStore().getCameraIDsWithCapability("recordings");if(!n.size)return null;const i=t.generateDefaultRecordingQueries(n,{limit:this._getChunkLimit()});if(!i)return null;const a=new VM(i),r=await this.execute(a,e?.executorOptions);return r?{query:a,queryResults:r}:null}async execute(e,t){const n=e.getQueries();if(!n)return null;const i=await this._api.getCameraManager().executeMediaQueries(n,{useCache:t?.useCache});if(!i)return null;const a=new tE({results:i});return t?.rejectResults?.(a)?null:(t?.selectResult?.id?a.selectBestResult((e=>e.findIndex((e=>e.getID()===t.selectResult?.id)))):t?.selectResult?.func?a.selectResultIfFound(t.selectResult.func):t?.selectResult?.time&&a.selectBestResult((e=>JM(e,t.selectResult?.time?.time,t.selectResult?.time?.favorCameraID))),a)}_getChunkLimit(){const e=this._api.getConfigManager().getCardWideConfig();return e?.performance?.features.media_chunk_size??50}}class iE{constructor(e,t){this._api=e,this._executor=t??new nE(e)}async getExistingQueryModifiers(e,t){return e.query?[new XM({queryResults:await this._executor.execute(e.query,t)})]:[]}async getNewQueryModifiers(e,t){return await this._executeNewQuery(e,{useCache:!1,...t})}async _executeNewQuery(e,t){const n=this._api.getConfigManager().getConfig();if(!n)return null;const i=e?.getDefaultMediaType(),a=[],r=async n=>{
/* istanbul ignore if: this path cannot be reached -- @preserve */
if(!n)return[];const i="recordings"===n?await this._executor.executeDefaultRecordingQuery({...!e.isGrid()&&{cameraID:e.camera},executorOptions:t}):"clips"===n||"snapshots"===n||"all"===n?await this._executor.executeDefaultEventQuery({...!e.isGrid()&&{cameraID:e.camera},eventsMediaType:n,executorOptions:t}):/* istanbul ignore next -- @preserve */
null;return i?[new XM(i)]:[]};switch(e.view){case"live":"none"!==n.live.controls.thumbnails.mode&&a.push(...await r("recordings"===n.live.controls.thumbnails.media_type?"recordings":n.live.controls.thumbnails.events_media_type));break;case"media":a.push(...await r("clips"));break;case"clip":case"clips":case"snapshot":case"snapshots":case"recording":case"recordings":a.push(...await r(i))}return a.push(...this._getTimelineWindowViewModifier(e)),a.push(...this._getSeekTimeModifier(t?.selectResult?.time?.time)),a}_getTimelineWindowViewModifier(e){if(e.is("live")){const e=new Date,t=this._api.getConfigManager().getConfig()?.live;
/* istanbul ignore if: this if branch cannot be reached as if the config is
               empty this function is never called -- @preserve */
return t?[new hb({timeline:{window:{start:th(e,{seconds:t.controls.timeline.window_seconds}),end:e}}})]:[]}return[new GM("timeline","window")]}_getSeekTimeModifier(e){return e?[new hb({mediaViewer:{seek:e}})]:[new GM("mediaViewer","seek")]}}class aE{constructor(e,t){this._view=null,this._epoch=this._createEpoch(),this._loadingIndex=1,this.setViewDefault=e=>this._setViewGeneric(this._viewFactory.getViewDefault.bind(this._viewFactory),e),this.setViewByParameters=e=>this._setViewGeneric(this._viewFactory.getViewByParameters.bind(this._viewFactory),e),this.setViewDefaultWithNewQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewDefault.bind(this._viewFactory),this._viewQueryExecutor.getNewQueryModifiers.bind(this._viewQueryExecutor),e),this.setViewByParametersWithNewQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewByParameters.bind(this._viewFactory),this._viewQueryExecutor.getNewQueryModifiers.bind(this._viewQueryExecutor),e),this.setViewByParametersWithExistingQuery=async e=>await this._setViewThenModifyAsync(this._viewFactory.getViewByParameters.bind(this._viewFactory),this._viewQueryExecutor.getExistingQueryModifiers.bind(this._viewQueryExecutor),e),this.initialize=async()=>(this._api.getQueryStringManager().hasViewRelatedActionsToRun()||this.setViewDefaultWithNewQuery({failSafe:!0}),!0),this._api=e,this._viewFactory=t?.viewFactory??new QM(e),this._viewQueryExecutor=t?.viewQueryExecutor??new iE(e)}getEpoch(){return this._epoch}_createEpoch(e){return{manager:this,...e&&{oldView:e}}}getView(){return this._view}hasView(){return!!this.getView()}reset(){this._view&&this._setView(null)}_setViewGeneric(e,t){let n=null;try{n=e({baseView:this._view,...t})}catch(e){this._api.getMessageManager().setErrorIfHigherPriority(e)}n&&this._setView(n)}_markViewLoadingQuery(e,t){return e.mergeInContext({loading:{query:t}})}_markViewAsNotLoadingQuery(e){return e.removeContextProperty("loading","query")}async _setViewThenModifyAsync(e,t,n){let i=null;try{i=e({baseView:this._view,...n,params:{query:null,queryResults:null,...n?.params}})}catch(e){this._api.getMessageManager().setErrorIfHigherPriority(e)}if(!i)return;if(this._view&&this._shouldAdoptQueryAndResults(i))return i.query=this._view.query,i.queryResults=this._view.queryResults,this._markViewAsNotLoadingQuery(i),void this._setView(i);const a=this._loadingIndex++;this._markViewLoadingQuery(i,a),this._setView(i);let r=null,s=null;try{r=await t(i,n?.queryExecutorOptions)}catch(e){s=e}if(this._view&&this.hasMajorMediaChange(this._view,i))return void(this._view.context?.loading?.query===a&&this._setView(this._markViewAsNotLoadingQuery(this._view.clone())));if(s)return void this._api.getMessageManager().setErrorIfHigherPriority(s);
/* istanbul ignore if: the if path cannot be reached as the view is set
        above -- @preserve */if(!this._view)return;const o=this._view.clone();this._view.context?.loading?.query===a&&this._markViewAsNotLoadingQuery(o),ZM(o,r),this._setView(o)}_shouldAdoptQueryAndResults(e){const t=this._view?.isViewerView()&&e?.isGalleryView(),n=e?.getDefaultMediaType(),i=UM.getMediaType(this._view?.query)===n;return!!t&&i}setViewWithMergedContext(e){if(this._view)return this._setView(this._view?.clone().mergeInContext(e))}isViewSupportedByCamera(e,t){return!!HM(this._api.getCameraManager(),t,e).size}hasMajorMediaChange(e,t){const n=t??this._view;return!!e!=!!n||e?.view!==n?.view||e?.camera!==n?.camera||"live"===n?.view&&e&&Uy(e)!==Uy(n)||"live"!==n?.view&&e?.queryResults!==n?.queryResults}_setView(e){const t=this._view;Qv(this._api.getConfigManager().getCardWideConfig(),"Advanced Camera Card view change: ",e),this._view=e,this._epoch=this._createEpoch(t),this.hasMajorMediaChange(t)&&this._api.getMediaLoadedInfoManager().clear(),t?.view!==e?.view&&this._api.getCardElementManager().scrollReset(),this._api.getMessageManager().reset(),this._api.getStyleManager().setExpandedMode(),this._api.getConditionStateManager()?.setState({view:e?.view,camera:e?.camera,displayMode:e?.displayMode??void 0}),this._api.getCardElementManager().update()}}class rE{constructor(e,t,n){this._conditionStateManager=new xy,this._deviceRegistryManager=new My(new ky((e=>e.id))),this._entityRegistryManager=new Ay(new ky((e=>e.entity_id))),this._resolvedMediaCache=new $y,this._actionsManager=new Ib(this,new NM),this._automationsManager=new jb(this),this._cameraManager=new uy(this),this._cameraURLManager=new zb(this),this._configManager=new bw(this),this._defaultManager=new ww(this),this._downloadManager=new Mw(this),this._expandManager=new Ew(this),this._fullscreenManager=new Dw(this),this._hassManager=new Nw(this),this._initializationManager=new Yb(this),this._interactionManager=new Pw(this),this._keyboardStateManager=new Fw(this),this._mediaLoadedInfoManager=new Kw(this),this._mediaPlayerManager=new Qw(this),this._messageManager=new Xw(this),this._microphoneManager=new Jw(this),this._queryStringManager=new ex(this),this._statusBarItemManager=new tx(this),this._styleManager=new nx(this),this._triggersManager=new PM(this),this._viewManager=new aE(this),e.addController(this),this._cardElementManager=new Qb(this,e,t,n)}getActionsManager(){return this._actionsManager}getAutomationsManager(){return this._automationsManager}getCameraManager(){return this._cameraManager}createCameraManager(){this._cameraManager=new uy(this)}getCameraURLManager(){return this._cameraURLManager}getCardElementManager(){return this._cardElementManager}getConditionStateManager(){return this._conditionStateManager}static async getConfigElement(){return await import("./editor-52764b24.js"),document.createElement("advanced-camera-card-editor")}getConfigManager(){return this._configManager}getDefaultManager(){return this._defaultManager}getDeviceRegistryManager(){return this._deviceRegistryManager}getDownloadManager(){return this._downloadManager}getEntityRegistryManager(){return this._entityRegistryManager}getExpandManager(){return this._expandManager}getFullscreenManager(){return this._fullscreenManager}getHASSManager(){return this._hassManager}getInitializationManager(){return this._initializationManager}getInteractionManager(){return this._interactionManager}getKeyboardStateManager(){return this._keyboardStateManager}getMediaLoadedInfoManager(){return this._mediaLoadedInfoManager}getMediaPlayerManager(){return this._mediaPlayerManager}getMessageManager(){return this._messageManager}getMicrophoneManager(){return this._microphoneManager}createMicrophoneManager(){this._microphoneManager=new Jw(this)}getQueryStringManager(){return this._queryStringManager}getResolvedMediaCache(){return this._resolvedMediaCache}getStatusBarItemManager(){return this._statusBarItemManager}static getStubConfig(e){return{cameras:[{camera_entity:e.find((e=>e.startsWith("camera.")))??"camera.demo"}]}}getStyleManager(){return this._styleManager}getTriggersManager(){return this._triggersManager}getViewManager(){return this._viewManager}hostConnected(){this.getCardElementManager().elementConnected()}hostDisconnected(){this.getCardElementManager().elementDisconnected()}}class sE{constructor(){this._dynamicMenuButtons=[]}addDynamicMenuButton(e){this._dynamicMenuButtons.includes(e)||this._dynamicMenuButtons.push(e)}removeDynamicMenuButton(e){this._dynamicMenuButtons=this._dynamicMenuButtons.filter((t=>t!=e))}calculateButtons(e,t,n,i){return[this._getIrisButton(t),this._getCamerasButton(t,n,i?.view),this._getSubstreamsButton(t,n,i?.view),this._getLiveButton(t,i?.view,i?.viewManager),this._getClipsButton(t,i?.view,i?.viewManager),this._getSnapshotsButton(t,i?.view,i?.viewManager),this._getRecordingsButton(t,i?.view,i?.viewManager),this._getImageButton(t,i?.view,i?.viewManager),this._getTimelineButton(t,i?.view,i?.viewManager),this._getDownloadButton(t,n,i?.view),this._getCameraUIButton(t,i?.showCameraUIButton),this._getMicrophoneButton(t,i?.microphoneManager,i?.currentMediaLoadedInfo),this._getExpandButton(t,i?.inExpandedMode),this._getFullscreenButton(t,i?.fullscreenManager),this._getCastButton(e,t,n,i?.view,i?.mediaPlayerController),this._getPlayPauseButton(t,i?.currentMediaLoadedInfo),this._getMuteUnmuteButton(t,i?.currentMediaLoadedInfo),this._getScreenshotButton(t,i?.currentMediaLoadedInfo),this._getDisplayModeButton(t,n,i?.view),this._getPTZControlsButton(t,n,i?.view),this._getPTZHomeButton(t,n,i?.view),...this._dynamicMenuButtons.map((e=>({style:this._getStyleFromActions(t,e,i),...e})))].filter(mg)}_getIrisButton(e){return{icon:"iris",...e.menu.buttons.iris,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.iris"),permanent:!0,tap_action:"hidden"===e.menu?.style?xg("menu_toggle"):xg("default"),hold_action:xg("diagnostics")}}_getCamerasButton(e,t,n){const i=t.getStore().getCameraIDsWithCapability("menu");if(i.size>1){const a=Array.from(i,(e=>{const i=kg("camera_select",e),a=t.getCameraMetadata(e);return{enabled:!0,icon:a?.icon.icon,entity:a?.icon.entity,state_color:!0,title:a?.title,selected:n?.camera===e,...i&&{tap_action:i}}}));return{icon:"mdi:video-switch",...e.menu.buttons.cameras,type:"custom:advanced-camera-card-menu-submenu",title:Kv("config.menu.buttons.cameras"),items:a}}return null}_getSubstreamsButton(e,t,n){if(!n)return null;const i=t.getStore().getAllDependentCameras(n.camera,"substream");if(i.size&&n.is("live")){const a=[...i].filter((e=>e!==n.camera)),r=[n.camera,...a],s=Uy(n);if(2===r.length)return{icon:"mdi:video-input-component",style:s!==n.camera?this._getEmphasizedStyle():{},title:Kv("config.menu.buttons.substreams"),...e.menu.buttons.substreams,type:"custom:advanced-camera-card-menu-icon",tap_action:xg(Hy(n)?"live_substream_off":"live_substream_on")};if(r.length>2){const i=Array.from(r,(e=>{const n=kg("live_substream_select",e),i=t.getCameraMetadata(e)??void 0;return{enabled:!0,icon:i?.icon.icon,entity:i?.icon.entity,state_color:!0,title:i?.title,selected:s===e,...n&&{tap_action:n}}}));return{icon:"mdi:video-input-component",title:Kv("config.menu.buttons.substreams"),style:s!==n.camera?this._getEmphasizedStyle():{},...e.menu.buttons.substreams,type:"custom:advanced-camera-card-menu-submenu",items:i}}}return null}_getLiveButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"live")?{icon:"mdi:cctv",...e.menu.buttons.live,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.live"),style:t.is("live")?this._getEmphasizedStyle():{},tap_action:xg("live")}:null}_getClipsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"clips")?{icon:"mdi:filmstrip",...e.menu.buttons.clips,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.clips"),style:t?.is("clips")?this._getEmphasizedStyle():{},tap_action:xg("clips"),hold_action:xg("clip")}:null}_getSnapshotsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"snapshots")?{icon:"mdi:camera",...e.menu.buttons.snapshots,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.snapshots"),style:t?.is("snapshots")?this._getEmphasizedStyle():{},tap_action:xg("snapshots"),hold_action:xg("snapshot")}:null}_getRecordingsButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"recordings")?{icon:"mdi:album",...e.menu.buttons.recordings,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.recordings"),style:t.is("recordings")?this._getEmphasizedStyle():{},tap_action:xg("recordings"),hold_action:xg("recording")}:null}_getImageButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"image")?{icon:"mdi:image",...e.menu.buttons.image,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.image"),style:t?.is("image")?this._getEmphasizedStyle():{},tap_action:xg("image")}:null}_getTimelineButton(e,t,n){return t&&n?.isViewSupportedByCamera(t.camera,"timeline")?{icon:"mdi:chart-gantt",...e.menu.buttons.timeline,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.view.views.timeline"),style:t.is("timeline")?this._getEmphasizedStyle():{},tap_action:xg("timeline")}:null}_getDownloadButton(e,t,n){const i=n?.queryResults?.getSelectedResult(),a=i?t?.getMediaCapabilities(i):null;return n?.isViewerView()&&a?.canDownload&&!Db()?{icon:"mdi:download",...e.menu.buttons.download,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.download"),tap_action:xg("download")}:null}_getCameraUIButton(e,t){return t?{icon:"mdi:web",...e.menu.buttons.camera_ui,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.camera_ui"),tap_action:xg("camera_ui")}:null}_getMicrophoneButton(e,t,n){if(t&&n?.capabilities?.supports2WayAudio){const n=t.isForbidden()||!t.isSupported(),i=t.isMuted(),a=e.menu.buttons.microphone.type;return{icon:n?"mdi:microphone-message-off":i?"mdi:microphone-off":"mdi:microphone",...e.menu.buttons.microphone,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.microphone"),style:n||i?{}:this._getEmphasizedStyle(!0),...!n&&"momentary"===a&&{start_tap_action:xg("microphone_unmute"),end_tap_action:xg("microphone_mute")},...!n&&"toggle"===a&&{tap_action:xg(i?"microphone_unmute":"microphone_mute")}}}return null}_getExpandButton(e,t){return{icon:t?"mdi:arrow-collapse-all":"mdi:arrow-expand-all",...e.menu.buttons.expand,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.expand"),tap_action:xg("expand"),style:t?this._getEmphasizedStyle():{}}}_getFullscreenButton(e,t){const n=t?.isInFullscreen();return t?.isSupported()?{icon:n?"mdi:fullscreen-exit":"mdi:fullscreen",...e.menu.buttons.fullscreen,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.fullscreen"),tap_action:xg("fullscreen"),style:n?this._getEmphasizedStyle():{}}:null}_getCastButton(e,t,n,i,a){if(!i)return null;const r=n.getStore().getCameraConfig(i.camera);if(a?.hasMediaPlayers()&&(i.isViewerView()||i.is("live")&&r?.camera_entity)){const n=a.getMediaPlayers().map((t=>{const n=Fb(e,t)||t,i=e.states[t],a=Cg(t,"play"),r=Cg(t,"stop"),s=!i||"unavailable"===i.state;return{enabled:!0,selected:!1,entity:t,state_color:!1,title:n,disabled:s,...!s&&a&&{tap_action:a},...!s&&r&&{hold_action:r}}}));return{icon:"mdi:cast",...t.menu.buttons.media_player,type:"custom:advanced-camera-card-menu-submenu",title:Kv("config.menu.buttons.media_player"),items:n}}return null}_getPlayPauseButton(e,t){if(t&&t.player&&t.capabilities?.supportsPause){const n=t.player.isPaused();return{icon:n?"mdi:play":"mdi:pause",...e.menu.buttons.play,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.play"),tap_action:xg(n?"play":"pause")}}return null}_getMuteUnmuteButton(e,t){if(t&&t.player&&t?.capabilities?.hasAudio){const n=t.player.isMuted();return{icon:n?"mdi:volume-off":"mdi:volume-high",...e.menu.buttons.mute,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.mute"),tap_action:xg(n?"unmute":"mute")}}return null}_getScreenshotButton(e,t){return t&&t.player?{icon:"mdi:monitor-screenshot",...e.menu.buttons.screenshot,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.screenshot"),tap_action:xg("screenshot")}:null}_getDisplayModeButton(e,t,n){const i=n?HM(t,n.view):null;if(n?.supportsMultipleDisplayModes()&&i&&i.size>1){const t=n.isGrid();return{icon:t?"mdi:grid-off":"mdi:grid",...e.menu.buttons.display_mode,style:t?this._getEmphasizedStyle():{},type:"custom:advanced-camera-card-menu-icon",title:Kv(t?"display_modes.single":"display_modes.grid"),tap_action:(a=t?"single":"grid",{action:"fire-dom-event",advanced_camera_card_action:"display_mode_select",display_mode:a,...r?.cardID&&{card_id:r.cardID}})}}var a,r;return null}_getPTZControlsButton(e,t,n){const i=n?.is("live")?e.live.controls.ptz:n?.isViewerView()?e.media_viewer.controls.ptz:null;if(!n||!i)return null;const a=tb(n,{cameraManager:t});if(a){const t=void 0!==n.context?.ptzControls?.enabled?n.context.ptzControls.enabled:"on"===i.mode||"auto"===i.mode&&"ptz"===a.type;return{icon:"mdi:pan",...e.menu.buttons.ptz_controls,style:t?this._getEmphasizedStyle():{},type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.ptz_controls"),tap_action:(r=!t,{action:"fire-dom-event",advanced_camera_card_action:"ptz_controls",enabled:r,...s?.cardID&&{card_id:s.cardID}})}}var r,s;return null}_getPTZHomeButton(e,t,n){const i=n?tb(n,{cameraManager:t}):null;return!i||(("digital"===i.type&&n?.context?.zoom?.[i.targetID]?.observed?.isDefault)??1)?null:{icon:"mdi:home",...e.menu.buttons.ptz_home,type:"custom:advanced-camera-card-menu-icon",title:Kv("config.menu.buttons.ptz_home"),tap_action:Mg({targetID:i.targetID})}}_getEmphasizedStyle(e){return e?{animation:"pulse 3s infinite",color:"var(--advanced-camera-card-menu-button-critical-color)"}:{color:"var(--advanced-camera-card-menu-button-active-color)"}}_getStyleFromActions(e,t,n){for(const i of[t.tap_action,t.double_tap_action,t.hold_action,t.start_tap_action,t.end_tap_action]){const t=Array.isArray(i)?i:[i];for(const i of t){if(!i||"fire-dom-event"!==i.action||!("advanced_camera_card_action"in i))continue;const t=i;if(Yo.some((e=>e===t.advanced_camera_card_action&&n?.view?.is(t.advanced_camera_card_action)))||"default"===t.advanced_camera_card_action&&n?.view?.is(e.view.default)||"fullscreen"===t.advanced_camera_card_action&&n?.fullscreenManager?.isInFullscreen()||"camera_select"===t.advanced_camera_card_action&&n?.view?.camera===t.camera)return this._getEmphasizedStyle()}}return{}}}class oE extends Event{constructor(e){super("advanced-camera-card:condition-state-manager:get",e)}}const cE=(e,t)=>{t instanceof Error&&Gf(e,"message",{message:t.message,type:"error",...t instanceof Lo&&{context:t.context}})};let lE=class extends oe{constructor(){super(...arguments),this._root=null}createRenderRoot(){return this}_createRoot(){const e=customElements.get("hui-conditional-element");if(!e||!this.hass)throw new Error(Kv("error.could_not_render_elements"));const t=new e;t.hass=this.hass;const n={type:"conditional",conditions:[],elements:this.elements};try{t.setConfig(n)}catch(e){throw ig(e,console.error),new Lo(Kv("error.invalid_elements_config"))}return t}willUpdate(e){try{!this.elements||this._root&&!e.has("elements")||(this._root=this._createRoot())}catch(e){return cE(this,e)}}render(){return H`${this._root||""}`}updated(){this.hass&&this._root&&(this._root.hass=this.hass)}};e([he({attribute:!1})],lE.prototype,"elements",void 0),e([he({attribute:!1})],lE.prototype,"hass",void 0),lE=e([le("advanced-camera-card-elements-core")],lE);let uE=class extends oe{constructor(){super(...arguments),this._menuRemoveHandler=e=>{Gf(this,"menu:remove",e.detail)},this._statusBarRemoveHandler=e=>{Gf(this,"status-bar:remove",e.detail)},this._menuAddHandler=e=>{const t=e.composedPath();t.length&&this._addHandler(t[0],"advanced-camera-card:menu:remove",this._menuRemoveHandler)},this._statusBarAddHandler=e=>{const t=e.composedPath();t.length&&this._addHandler(t[0],"advanced-camera-card:status-bar:add",this._statusBarRemoveHandler)}}_addHandler(e,t,n){e.removeEventListener(t,n),e.addEventListener(t,n)}connectedCallback(){super.connectedCallback(),this.addEventListener("advanced-camera-card:menu:add",this._menuAddHandler),this.addEventListener("advanced-camera-card:status-bar:add",this._statusBarAddHandler)}disconnectedCallback(){this.removeEventListener("advanced-camera-card:menu:add",this._menuAddHandler),this.addEventListener("advanced-camera-card:status-bar:add",this._statusBarAddHandler),super.disconnectedCallback()}render(){return H`<advanced-camera-card-elements-core
      .hass=${this.hass}
      .elements=${this.elements}
    >
    </advanced-camera-card-elements-core>`}static get styles(){return s(":host {\n  position: absolute;\n  inset: 0;\n  overflow: hidden;\n  pointer-events: none;\n}\n\n.element {\n  position: absolute;\n  transform: translate(-50%, -50%);\n  pointer-events: auto;\n}\n\nhui-error-card.element {\n  inset: 0px;\n  transform: unset;\n}")}};e([he({attribute:!1})],uE.prototype,"hass",void 0),e([he({attribute:!1})],uE.prototype,"elements",void 0),uE=e([le("advanced-camera-card-elements")],uE);let dE=class extends oe{constructor(){super(...arguments),this._conditionManager=null}setConfig(e){this._config=e,this._createConditionManager()}createRenderRoot(){return this}connectedCallback(){super.connectedCallback(),this.className="",this._createConditionManager()}disconnectedCallback(){this._conditionManager?.destroy()}_createConditionManager(){const e=function(e){const t=new oE({bubbles:!0,composed:!0});return e.dispatchEvent(t),t.conditionStateManager??null}(this);this._config&&e&&(this._conditionManager?.destroy(),this._conditionManager=new Lb(this._config.conditions,e),this._conditionManager.addListener((()=>this.requestUpdate())))}render(){if(this._conditionManager?.getEvaluation()?.result)return H` <advanced-camera-card-elements-core
        .hass=${this.hass}
        .elements=${this._config?.elements}
      >
      </advanced-camera-card-elements-core>`}};e([he({attribute:!1,hasChanged:()=>!0})],dE.prototype,"hass",void 0),dE=e([le("advanced-camera-card-conditional")],dE);class hE extends oe{constructor(e){super(),this._config=null,this._eventCategory=e}setConfig(e){this._config=e}connectedCallback(){super.connectedCallback(),this._config&&Gf(this,`${this._eventCategory}:add`,this._config)}disconnectedCallback(){this._config&&Gf(this,`${this._eventCategory}:remove`,this._config),super.disconnectedCallback()}}e([pe()],hE.prototype,"_config",void 0);class pE extends hE{constructor(){super("menu")}}let mE=class extends pE{};mE=e([le("advanced-camera-card-menu-icon")],mE);let fE=class extends pE{};fE=e([le("advanced-camera-card-menu-state-icon")],fE);let gE=class extends pE{};gE=e([le("advanced-camera-card-menu-submenu")],gE);let vE=class extends pE{};vE=e([le("advanced-camera-card-menu-submenu-select")],vE);class _E extends hE{constructor(){super("status-bar")}}let yE=class extends _E{};yE=e([le("advanced-camera-card-status-bar-icon")],yE);let bE=class extends _E{};bE=e([le("advanced-camera-card-status-bar-image")],bE);let wE=class extends _E{};wE=e([le("advanced-camera-card-status-bar-string")],wE);var xE="Fri, 14 Feb 2025 15:24:30 GMT",kE="7fb710d",CE="Fri, 14 Feb 2025 07:23:19 -0800";const ME=yi.object({domain:yi.string(),version:yi.string().optional()}).passthrough(),EE="hass_web_proxy",SE=(e,t)=>`/api/${EE}/v${t??0}/?url=${encodeURIComponent(e)}`,AE=(e,t,n="media")=>(e=>e.config.components.includes(EE))(e)&&!!t[n];async function TE(e,t,n){await e.callService(EE,"create_proxied_url",{url_pattern:t,...n&&{url_id:n.urlID,ssl_verification:n.sslVerification,ssl_ciphers:n.sslCiphers,open_limit:n.openLimit,ttl:n.ttl,allow_unauthenticated:n.allowUnauthenticated}})}const $E=async(e,t)=>{let n=null;if(t)try{n=await(async(e,t)=>await z_(e,ME,{type:"manifest/get",integration:t}))(t,e)}catch(e){}return{detected:!!n,...n?.version&&{version:n.version}}};class OE{getCustomIcon(e){switch(e?.icon){case"frigate":return'<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4.876 22.744c.087.692.812 1.163.379 1.271-.433.109-2.327-3.436-2.76-4.952-.433-1.515-.677-3.22-.569-4.194.109-.974 5.71-2.49 5.71-2.895 0-.406-1.813-.028-1.894-.352-.081-.325 1.37-.13 1.759-.65.609-.811 1.38-.676 1.867-1.11.487-.432 1.082-2.083 1.19-2.786.109-.704-1.082-1.516-1.407-2.057-.324-.541.704-.92 3.194-1.948C14.835 2.042 22.735-.231 22.844.04c.108.27-2.598 1.407-4.492 2.11-1.894.704-4.98 2.057-4.98 2.436s.163.677.055 1.543c-.108.866-.121 1.27-.325 1.84-.135.379-.27 1.272 0 2.083.217.65.92 1.137 1.245 1.245.27.018 1.017.043 1.84 0 1.028-.054 2.49.054 2.49.325 0 .27-2.22.108-2.22.487s2.274-.054 2.22.325c-.054.378-1.895.216-2.869.216-.78 0-1.93-.036-2.435-.216l-.108.378c-.18 0-.558.109-.948.109-.487 0-.514.162-1.407.162s-.622-.054-1.434-.108c-.812-.054-3.842 2.273-4.384 3.03-.54.758-.216 2.598-.216 3.437 0 .754-.108 2.436 0 3.302z" fill="#000" style="fill:#fff;fill-opacity:1;stroke:none;stroke-width:.1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/></svg>';case"motioneye":return'<svg xml:space="preserve" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><defs><linearGradient id="d"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:#585858;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="b"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:gray;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="a"><stop style="stop-color:#4aa3e0;stop-opacity:1" offset="0"/><stop style="stop-color:#3096db;stop-opacity:1" offset="1"/></linearGradient><linearGradient id="c"><stop style="stop-color:#fff;stop-opacity:1" offset="0"/><stop style="stop-color:#585858;stop-opacity:1" offset="1"/></linearGradient><linearGradient xlink:href="#a" id="i" x1="26.602" y1="43.035" x2="26.602" y2="29.466" gradientUnits="userSpaceOnUse" gradientTransform="matrix(.96429 0 0 .96429 .914 .914)"/><linearGradient xlink:href="#b" id="e" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><linearGradient xlink:href="#c" id="f" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><linearGradient xlink:href="#d" id="g" gradientUnits="userSpaceOnUse" x1="26.446" y1="47.518" x2="26.446" y2="3.818"/><filter style="color-interpolation-filters:sRGB" id="h" x="-.02" y="-.14" width="1.041" height="1.208"><feFlood flood-opacity=".588" flood-color="#000" result="flood"/><feComposite in="flood" in2="SourceGraphic" operator="in" result="composite1"/><feGaussianBlur in="composite1" stdDeviation=".2" result="blur"/><feOffset dy="-.5" result="offset"/><feComposite in="SourceGraphic" in2="offset" result="composite2"/></filter></defs><path d="M8.935 40.515C5.365 36.547 3.2 31.358 3.2 25.6c0-12.371 10.029-22.4 22.4-22.4C37.971 3.2 48 13.229 48 25.6c0 5.737-2.161 10.952-5.708 14.915-1.696-.623-3.388-1.349-5.061-2.288a7.777 7.777 0 0 0 5.6-7.458c0-4.26-3.47-7.754-7.754-7.754-3.634 0-6.69 2.51-7.539 5.87h-3.876a7.784 7.784 0 0 0-7.539-5.87c-4.284 0-7.78 3.494-7.78 7.754 0 3.561 2.456 6.586 5.76 7.485-1.675.912-3.404 1.62-5.168 2.261zM25.6 26.462c.533-1.982 1.102-3.948 3.446-5.17L25.6 16.123l-3.446 5.17c2.053 1.454 3 3.237 3.446 5.169z" style="fill:url(#e);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path d="M16.123 33.354a2.585 2.585 0 1 1 0-5.17 2.585 2.585 0 0 1 0 5.17z" style="fill:url(#f);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path d="M35.077 33.354a2.585 2.585 0 1 1 0-5.17 2.585 2.585 0 0 1 0 5.17z" style="fill:url(#g);fill-opacity:1;stroke:none;filter:url(#filter4327)" transform="matrix(.49239 0 0 -.49239 -.605 24.564)"/><path style="fill:#d9d9d9;fill-opacity:1;stroke:none;filter:url(#h)" d="M25.6 47.2c-4.374 0-8.437-1.4-11.838-3.635 3.677-.394 7.305-1.343 11.423-3.375 4.166 2.123 8.434 3.01 12.28 3.453A21.465 21.465 0 0 1 25.6 47.2Z" transform="matrix(.51063 0 0 -.51063 -1.072 25.031)"/><path style="fill:url(#i);fill-opacity:1;stroke:none;filter:url(#filter4315)" d="M39.723 42.553c-4.329-.029-10.243-2.156-14.538-4.12-4.516 1.631-9.15 4.216-14.383 4.094a20.537 20.537 0 0 1-1.039-.052l-4.101-.337 3.894-1.299c5.342-1.74 10.04-2.85 14.175-10.026h3.738c4.12 7.134 9.06 8.325 14.15 10.026l3.842 1.247-3.998.389c-.545.052-1.121.082-1.74.078z" transform="matrix(.51063 0 0 -.51063 -1.072 25.031)"/></svg>';case"reolink":return'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path style="fill:#fff;stroke-width:.0393282;fill-opacity:1" d="M17.037 23.965a1.724 1.724 0 0 1-.711-.285c-.13-.086-1.782-1.727-4.108-4.078-2.14-2.164-3.998-4.02-4.128-4.123a3.023 3.023 0 0 0-1.591-.677c-.185-.021-1.42-.039-2.745-.039H1.345l.007-7.394V-.025h6.204c3.98 0 6.36.015 6.637.041a7.269 7.269 0 0 1 5.579 3.501c.686 1.131 1.02 2.278 1.067 3.655.063 1.885-.574 3.66-1.831 5.1a7.592 7.592 0 0 1-2.93 2.025l-.319.118-1.951-1.98-1.951-1.979 1.046-.023c.576-.013 1.1-.037 1.165-.053.596-.151.95-.314 1.322-.611a3.05 3.05 0 0 0 1.138-2.067c.168-1.506-.771-2.87-2.263-3.29l-.315-.089-4.152-.012-4.159-.013V10.437h1.419c1.627.001 1.779.02 2.31.28.31.152.39.22 1.082.915 3.027 3.043 12.194 12.309 12.205 12.337.016.044-5.365.04-5.618-.004z"/></svg>';case"iris":return'<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><g style="fill-opacity:.05;fill:#fff;stroke-width:1.0015748;stroke-dasharray:none"><path d="m13.73 15-3.9 6.76a9.984 9.984 0 0 0 8.49-2.01l-3.66-6.35M2.46 15c.92 2.92 3.15 5.26 5.99 6.34L12.12 15m-3.58-3-3.9-6.75A9.855 9.855 0 0 0 2 12c0 .68.07 1.35.2 2h7.49m12.11-4h-7.49l.29.5 4.76 8.25A9.93 9.93 0 0 0 22 12c0-.69-.07-1.36-.2-2m-.26-1c-.92-2.93-3.15-5.26-5.99-6.34L11.88 9M9.4 10.5l4.77-8.26C13.47 2.09 12.75 2 12 2c-2.4 0-4.6.84-6.32 2.25l3.66 6.35z" style="fill-opacity:1;fill:#fff;opacity:1;stroke-width:1.0015748;stroke-dasharray:none"/></g></svg>';default:return null}}createStateObjectForStateBadge(e,t){return e.states[t]?{...e.states[t],attributes:{...e.states[t].attributes,entity_picture:void 0,entity_picture_local:void 0}}:null}}let IE=class extends oe{constructor(){super(...arguments),this.allowOverrideNonActiveStyles=!1,this._controller=new OE,this._svg=null}willUpdate(e){if(e.has("icon")){const e=this._controller.getCustomIcon(this.icon);if(e){const t=document.createElement("svg");t.innerHTML=e,this._svg=t}else this._svg=null}}render(){if(this._svg)return H`${this._svg}`;if(this.hass&&this.icon?.entity){const e=this._controller.createStateObjectForStateBadge(this.hass,this.icon.entity);if(e)return H`<state-badge
          .color="${this.style.color??void 0}"
          .stateColor=${this.icon.stateColor??!0}
          .hass=${this.hass}
          .stateObj=${e}
          .overrideIcon=${this.icon.icon}
        ></state-badge>`}return this.icon?.icon?H`<ha-icon icon="${this.icon.icon}"></ha-icon>`:this.icon?.fallback?H`<ha-icon icon="${this.icon.fallback}"></ha-icon>`:H``}static get styles(){return s(":host {\n  display: inline-block;\n  width: var(--mdc-icon-size, 24px);\n  height: var(--mdc-icon-size, 24px);\n  --ha-icon-display: block;\n}\n\nha-icon,\nstate-badge,\nsvg {\n  display: block;\n  height: 100%;\n  width: 100%;\n  box-sizing: border-box;\n}\n\nsvg path {\n  fill: currentColor !important;\n}\n\n:host([allow-override-non-active-styles]) state-badge {\n  --state-inactive-color: inherit;\n  --state-unavailable-color: inherit;\n}")}};e([he({attribute:!1})],IE.prototype,"hass",void 0),e([he({attribute:!1})],IE.prototype,"icon",void 0),e([he({attribute:"allow-override-non-active-styles",type:Boolean})],IE.prototype,"allowOverrideNonActiveStyles",void 0),IE=e([le("advanced-camera-card-icon")],IE);let LE=class extends oe{render(){return H`<advanced-camera-card-icon
        .icon=${{icon:"iris"}}
      ></advanced-camera-card-icon
      ><span>${"7.1.0"}</span>`}static get styles(){return s(":host {\n  width: intrinsic;\n  height: intrinsic;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  pointer-events: none;\n  background-color: var(--advanced-camera-card-loading-background-color);\n  color: var(--advanced-camera-card-loading-foreground-color);\n  transition: opacity 1.5s ease-in;\n  opacity: 1;\n}\n\n:host([loaded]) {\n  opacity: 0;\n}\n\nadvanced-camera-card-icon {\n  margin-bottom: 20px;\n  height: 25%;\n  width: auto;\n  animation: rotate 8s linear infinite;\n}\n\n@keyframes rotate {\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n}\nspan {\n  font-size: x-large;\n}")}};LE=e([le("advanced-camera-card-loading")],LE);const jE=(e,t)=>{Gf(e,"action:execution-request",t)};class zE{constructor(e){this._config=null,this._buttons=[],this._expanded=!1,this._host=e}setMenuConfig(e){this._config=e,this._host.style.setProperty("--advanced-camera-card-menu-button-size",`${e.button_size}px`),this._host.setAttribute("data-style",e.style),this._host.setAttribute("data-position",e.position),this._host.setAttribute("data-alignment",e.alignment),this._sortButtons(),this._host.requestUpdate()}getMenuConfig(){return this._config}isExpanded(){return this._expanded}setButtons(e){this._buttons=e,this._sortButtons(),this._host.requestUpdate()}getButtons(e){const t=e=>!this._isHidingMenu()||this._expanded||!!e.permanent;return this._buttons.filter((n=>(e=>!1!==e.enabled)(n)&&(t=>t.alignment===e||"matching"===e&&!t.alignment)(n)&&t(n)))}setExpanded(e){this._expanded=e,pg(this._host,e,"expanded"),this._host.requestUpdate()}toggleExpanded(){this.setExpanded(!this._expanded)}actionHandler(e,t){if(e.stopPropagation(),e.detail.config&&(t=e.detail.config),!t)return;const n=e.detail.action,i=Eg(n,t);if(!i)return;const a=eg(i);let r=!1;const s=a.filter((e=>mg(e)&&!this._isUnknownActionMenuToggleAction(e)));if(s.length!=a.length&&(r=!0),s.length&&jE(this._host,{action:a,config:t}),this._isHidingMenu())if(r)this.setExpanded(!this._expanded);else{const e=Eg("hold",t),i=Eg("double_tap",t),a=Eg("tap",t),r=Eg("end_tap",t);"end_tap"!==n&&("start_tap"!==n||e||i||a||r)&&("end_tap"===n||r)||this.setExpanded(!1)}}_sortButtons(){this._buttons=j_(this._buttons,(e=>(e.priority??0)+(this._isHidingMenu()&&e.permanent?Zo:0)),["desc"])}_isHidingMenu(){return"hidden"===this._config?.style}_isUnknownActionMenuToggleAction(e){const t=wg(e);return!!t&&"menu_toggle"==t.advanced_camera_card_action}}const DE=(e,t,n)=>{const i=e.states[t],a=n?.state?n.state:i?i.state:null;if(!a)return null;const r=Ye(t),s=i?i.attributes:null;return n?.entity?.translation_key&&e.localize(`component.${n.entity.platform}.entity.${r}.${n.entity.translation_key}.state.${a}`)||s?.device_class&&e.localize(`component.${r}.state.${s.device_class}.${a}`)||e.localize(`component.${r}.state._.${a}`)||a};let RE=class extends oe{_renderItem(e){if(!this.hass)return;const t=e.title??Fb(this.hass,e.entity),n=ze(e.style||{});return H`
      <mwc-list-item
        graphic=${_e(e.icon||e.entity?"icon":void 0)}
        ?twoline=${!!e.subtitle}
        ?selected=${e.selected}
        ?activated=${e.selected}
        ?disabled=${!1===e.enabled}
        aria-label="${t??""}"
        @action=${t=>{t.detail.config=e}}
        .actionHandler=${Ig({hasHold:Sg(e.hold_action),hasDoubleClick:Sg(e.double_tap_action)})}
      >
        <span style="${n}">${t??""}</span>
        ${e.subtitle?H`<span slot="secondary" style="${n}">${e.subtitle}</span>`:""}
        <advanced-camera-card-icon
          slot="graphic"
          .hass=${this.hass}
          .icon=${{icon:e.icon,entity:e.entity}}
          style="${n}"
        ></advanced-camera-card-icon>
      </mwc-list-item>
    `}render(){if(!this.submenu)return H``;const e=this.submenu.items,t=ze(this.submenu.style||{});return H`
      <ha-button-menu
        corner=${"BOTTOM_LEFT"}
        @closed=${e=>e.stopPropagation()}
        @click=${e=>Ag(e)}
      >
        <ha-icon-button
          style="${t}"
          slot="trigger"
          .label=${this.submenu.title||""}
          .actionHandler=${Ig({allowPropagation:!0,hasHold:Sg(this.submenu.hold_action),hasDoubleClick:Sg(this.submenu.double_tap_action)})}
        >
          <advanced-camera-card-icon
            ?allow-override-non-active-styles=${!0}
            style="${t}"
            .hass=${this.hass}
            .icon=${"string"==typeof this.submenu.icon?{icon:this.submenu.icon}:this.submenu.icon}
          ></advanced-camera-card-icon>
        </ha-icon-button>
        ${e.map(this._renderItem.bind(this))}
      </ha-button-menu>
    `}static get styles(){return s("ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  pointer-events: auto;\n}\n\nmwc-list-item {\n  z-index: 20;\n}\n\nha-icon-button {\n  --state-unavailable-color: var(--advanced-camera-card-button-color);\n  --state-inactive-color: var(--advanced-camera-card-button-color);\n  color: var(--advanced-camera-card-menu-button-inactive-color);\n  background-color: var(--advanced-camera-card-menu-button-background);\n}")}};e([he({attribute:!1})],RE.prototype,"hass",void 0),e([he({attribute:!1})],RE.prototype,"submenu",void 0),RE=e([le("advanced-camera-card-submenu")],RE);let NE=class extends oe{shouldUpdate(e){const t=e.get("hass");return!e.has("hass")||!t||!this.submenuSelect||Pb(this.hass,t,[this.submenuSelect.entity])}async _refreshOptionTitles(){if(!this.hass||!this.submenuSelect)return;const e=this.submenuSelect.entity,t=this.hass.states[e],n=t?.attributes?.options,i=await(this.entityRegistryManager?.getEntity(this.hass,e))??null,a={};for(const t of n){const n=DE(this.hass,e,{...i&&{entity:i},state:t});n&&(a[t]=n)}this._optionTitles=a}willUpdate(){if(!this.submenuSelect||!this.hass)return;this._optionTitles||this._refreshOptionTitles();const e=this.submenuSelect.entity,t=this.hass.states[e],n=t?.attributes?.options;if(!t||!n)return;const i=Fb(this.hass,e),a={...i&&{title:i},...this.submenuSelect,icon:{icon:this.submenuSelect.icon,entity:e,fallback:"mdi:format-list-bulleted"},type:"custom:advanced-camera-card-menu-submenu",items:[]};delete a.options;const r=a.items;for(const i of n){const n=this._optionTitles?.[i]??i;r.push({state_color:!0,selected:t.state===i,enabled:!0,title:n||i,...(e.startsWith("select.")||e.startsWith("input_select."))&&{tap_action:{action:"perform-action",perform_action:e.startsWith("select.")?"select.select_option":"input_select.select_option",target:{entity_id:e},data:{option:i}}},...this.submenuSelect.options&&this.submenuSelect.options[i]})}this._generatedSubmenu=a}render(){return H` <advanced-camera-card-submenu
      .hass=${this.hass}
      .submenu=${this._generatedSubmenu}
    ></advanced-camera-card-submenu>`}};e([he({attribute:!1})],NE.prototype,"hass",void 0),e([he({attribute:!1})],NE.prototype,"submenuSelect",void 0),e([he({attribute:!1})],NE.prototype,"entityRegistryManager",void 0),e([pe()],NE.prototype,"_optionTitles",void 0),NE=e([le("advanced-camera-card-submenu-select")],NE);let PE=class extends oe{constructor(){super(...arguments),this._controller=new zE(this)}set menuConfig(e){this._controller.setMenuConfig(e)}set buttons(e){this._controller.setButtons(e)}set expanded(e){this._controller.setExpanded(e)}toggleMenu(){this._controller.toggleExpanded()}_renderButton(e){if(!this.hass)return;if("custom:advanced-camera-card-menu-submenu"===e.type)return H` <advanced-camera-card-submenu
        .hass=${this.hass}
        .submenu=${e}
        @action=${e=>this._controller.actionHandler(e)}
      >
      </advanced-camera-card-submenu>`;if("custom:advanced-camera-card-menu-submenu-select"===e.type)return H` <advanced-camera-card-submenu-select
        .hass=${this.hass}
        .submenuSelect=${e}
        .entityRegistryManager=${this.entityRegistryManager}
        @action=${e=>this._controller.actionHandler(e)}
      >
      </advanced-camera-card-submenu-select>`;const t=this.hass&&"custom:advanced-camera-card-menu-state-icon"===e.type&&!e.title?Fb(this.hass,e.entity):e.title;return H` <ha-icon-button
      .actionHandler=${Ig({hasHold:Sg(e.hold_action),hasDoubleClick:Sg(e.double_tap_action)})}
      .label=${t??""}
      @action=${t=>this._controller.actionHandler(t,e)}
    >
      <advanced-camera-card-icon
        ?allow-override-non-active-styles=${!0}
        style="${ze(e.style||{})}"
        .hass=${this.hass}
        .icon=${{icon:e.icon,entity:e.entity,stateColor:e.state_color,fallback:"mdi:gesture-tap-button"}}
      ></advanced-camera-card-icon>
    </ha-icon-button>`}_renderPerInstanceStyle(){const e=this._controller.getMenuConfig();if(!e)return;const t=e.position,n=e.style,i=e.alignment,a=e=>`\n        var(--advanced-camera-card-menu-override-${e},\n        var(--advanced-camera-card-menu-position-${t}-alignment-${i}-style-${n}-${e},\n        var(--advanced-camera-card-menu-position-${t}-alignment-${i}-${e},\n        var(--advanced-camera-card-menu-position-${t}-${e},\n        var(--advanced-camera-card-menu-style-${n}-${e},\n        var(--advanced-camera-card-menu-alignment-${i}-${e},\n        var(--advanced-camera-card-menu-${e})))))))`;return H`<style>
      :host(${`[data-position='${t}'][data-style='${n}'][data-alignment='${i}']`+("hidden"===n?"[expanded]":"")}) {
        background: ${a("background")};

        ha-icon-button {
          color: ${a("button-inactive-color")};
          background: ${a("button-background")};
        }
      }
    </style>`}render(){const e=this._controller.getMenuConfig(),t=e?.style;if(!e||"none"===t)return;const n=this._controller.getButtons("matching"),i=this._controller.getButtons("opposing");return H` ${this._renderPerInstanceStyle()}
      <div
        class="matching"
        style="${ze({flex:String(n.length)})}"
      >
        ${n.map((e=>this._renderButton(e)))}
      </div>
      <div
        class="opposing"
        style="${ze({flex:String(i.length)})}"
      >
        ${i.map((e=>this._renderButton(e)))}
      </div>`}static get styles(){return s('ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  --advanced-camera-card-menu-button-size: 40px;\n  --mdc-icon-button-size: var(--advanced-camera-card-menu-button-size);\n  --mdc-icon-size: calc(var(--mdc-icon-button-size) / 2);\n  pointer-events: auto;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  overflow: visible;\n}\n\n:host([data-style=outside]) {\n  width: 100%;\n}\n\n/*******************************************************\n * Non-hover styles should not interact with the pointer\n *******************************************************/\n:host(:not([data-style*=hover])) {\n  pointer-events: none;\n}\n\n/***********************************\n * Aligned divs: matching & opposing\n ***********************************/\ndiv.matching,\ndiv.opposing {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: row;\n  align-items: flex-start;\n  min-width: 0px;\n  min-height: 0px;\n}\n\ndiv.matching {\n  justify-content: flex-start;\n}\n\ndiv.opposing {\n  justify-content: flex-end;\n}\n\n/********************************************************\n * Hack: Ensure host & div expand for column flex layouts\n ********************************************************/\n:host(:not([data-style=outside])[data-position=left]) {\n  writing-mode: vertical-lr;\n}\n\n:host(:not([data-style=outside])[data-position=right]) {\n  writing-mode: vertical-rl;\n}\n\n:host(:not([data-style=outside])[data-style=overlay][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style=overlay][data-position=right]) div > *,\n:host(:not([data-style=outside])[data-style*=hover][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style*=hover][data-position=right]) div > *,\n:host(:not([data-style=outside])[data-style=hidden][data-position=left]) div > *,\n:host(:not([data-style=outside])[data-style=hidden][data-position=right]) div > * {\n  writing-mode: horizontal-tb;\n}\n\n/**********************\n * "Reverse" alignments\n **********************/\n:host(:not([data-style=outside])[data-position=left][data-alignment=bottom]),\n:host(:not([data-style=outside])[data-position=right][data-alignment=bottom]),\n:host([data-position=top][data-alignment=right]),\n:host([data-position=bottom][data-alignment=right]),\n:host(:not([data-style=outside])[data-position=left][data-alignment=bottom]) div,\n:host(:not([data-style=outside])[data-position=right][data-alignment=bottom]) div,\n:host([data-position=top][data-alignment=right]) div,\n:host([data-position=bottom][data-alignment=right]) div {\n  flex-direction: row-reverse;\n}\n\n/****************************\n * Wrap upwards on the bottom\n ****************************/\n:host(:not([data-style=outside])[data-position=bottom]) div {\n  flex-wrap: wrap-reverse;\n}\n\n/********************************************\n * Positioning for absolute based menu styles\n ********************************************/\n:host([data-style=overlay][data-position=top]),\n:host([data-style=overlay][data-position=bottom]),\n:host([data-style*=hover][data-position=top]),\n:host([data-style*=hover][data-position=bottom]),\n:host([data-style=hidden][data-position=top]),\n:host([data-style=hidden][data-position=bottom]) {\n  width: 100%;\n  height: auto;\n}\n\n:host([data-style=overlay][data-position=left]),\n:host([data-style=overlay][data-position=right]),\n:host([data-style*=hover][data-position=left]),\n:host([data-style*=hover][data-position=right]),\n:host([data-style=hidden][data-position=left]),\n:host([data-style=hidden][data-position=right]) {\n  width: auto;\n  height: 100%;\n}\n\n/************\n * Menu theme\n ************/\n:host([data-style=hidden]:not([expanded])) ha-icon-button {\n  background: var(--advanced-camera-card-menu-background);\n}\n\n:host ha-icon-button {\n  --state-unavailable-color: var(--advanced-camera-card-button-color);\n  --state-inactive-color: var(--advanced-camera-card-button-color);\n}')}};
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */
function FE(e){return null==e}e([he({attribute:!1})],PE.prototype,"entityRegistryManager",void 0),e([he({attribute:!1})],PE.prototype,"hass",void 0),PE=e([le("advanced-camera-card-menu")],PE);var BE=function(e,t){var n,i="";for(n=0;n<t;n+=1)i+=e;return i},VE={isNothing:FE,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:FE(e)?[]:[e]},repeat:BE,isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,i,a,r;if(t)for(n=0,i=(r=Object.keys(t)).length;n<i;n+=1)e[a=r[n]]=t[a];return e}};function UE(e,t){var n="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),i+" "+n):i}function HE(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=UE(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}HE.prototype=Object.create(Error.prototype),HE.prototype.constructor=HE,HE.prototype.toString=function(e){return this.name+": "+UE(this,e)};var qE=HE;function WE(e,t,n,i,a){var r="",s="",o=Math.floor(a/2)-1;return i-t>o&&(t=i-o+(r=" ... ").length),n-i>o&&(n=i+o-(s=" ...").length),{str:r+e.slice(t,n).replace(/\t/g,"→")+s,pos:i-t+r.length}}function ZE(e,t){return VE.repeat(" ",t-e.length)+e}var KE=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,i=/\r?\n|\r|\0/g,a=[0],r=[],s=-1;n=i.exec(e.buffer);)r.push(n.index),a.push(n.index+n[0].length),e.position<=n.index&&s<0&&(s=a.length-2);s<0&&(s=a.length-1);var o,c,l="",u=Math.min(e.line+t.linesAfter,r.length).toString().length,d=t.maxLength-(t.indent+u+3);for(o=1;o<=t.linesBefore&&!(s-o<0);o++)c=WE(e.buffer,a[s-o],r[s-o],e.position-(a[s]-a[s-o]),d),l=VE.repeat(" ",t.indent)+ZE((e.line-o+1).toString(),u)+" | "+c.str+"\n"+l;for(c=WE(e.buffer,a[s],r[s],e.position,d),l+=VE.repeat(" ",t.indent)+ZE((e.line+1).toString(),u)+" | "+c.str+"\n",l+=VE.repeat("-",t.indent+u+3+c.pos)+"^\n",o=1;o<=t.linesAfter&&!(s+o>=r.length);o++)c=WE(e.buffer,a[s+o],r[s+o],e.position-(a[s]-a[s+o]),d),l+=VE.repeat(" ",t.indent)+ZE((e.line+o+1).toString(),u)+" | "+c.str+"\n";return l.replace(/\n$/,"")},YE=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],QE=["scalar","sequence","mapping"];var GE=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===YE.indexOf(t))throw new qE('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===QE.indexOf(this.kind))throw new qE('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function XE(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,i){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=i)})),n[t]=e})),n}function JE(e){return this.extend(e)}JE.prototype.extend=function(e){var t=[],n=[];if(e instanceof GE)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new qE("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof GE))throw new qE("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new qE("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new qE("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof GE))throw new qE("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var i=Object.create(JE.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=XE(i,"implicit"),i.compiledExplicit=XE(i,"explicit"),i.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return n}(i.compiledImplicit,i.compiledExplicit),i};var eS=JE,tS=new GE("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),nS=new GE("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),iS=new GE("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),aS=new eS({explicit:[tS,nS,iS]});var rS=new GE("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var sS=new GE("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function oS(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}function cS(e){return 48<=e&&e<=55}function lS(e){return 48<=e&&e<=57}var uS=new GE("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n=e.length,i=0,a=!1;if(!n)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===n)return!0;if("b"===(t=e[++i])){for(i++;i<n;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;a=!0}return a&&"_"!==t}if("x"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!oS(e.charCodeAt(i)))return!1;a=!0}return a&&"_"!==t}if("o"===t){for(i++;i<n;i++)if("_"!==(t=e[i])){if(!cS(e.charCodeAt(i)))return!1;a=!0}return a&&"_"!==t}}if("_"===t)return!1;for(;i<n;i++)if("_"!==(t=e[i])){if(!lS(e.charCodeAt(i)))return!1;a=!0}return!(!a||"_"===t)},construct:function(e){var t,n=e,i=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(i=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return i*parseInt(n.slice(2),2);if("x"===n[1])return i*parseInt(n.slice(2),16);if("o"===n[1])return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!VE.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),dS=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var hS=/^[-+]?[0-9]+e/;var pS=new GE("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!dS.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||VE.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(VE.isNegativeZero(e))return"-0.0";return n=e.toString(10),hS.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),mS=aS.extend({implicit:[rS,sS,uS,pS]}),fS=mS,gS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),vS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var _S=new GE("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==gS.exec(e)||null!==vS.exec(e))},construct:function(e){var t,n,i,a,r,s,o,c,l=0,u=null;if(null===(t=gS.exec(e))&&(t=vS.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],i=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,i,a));if(r=+t[4],s=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),c=new Date(Date.UTC(n,i,a,r,s,o,l)),u&&c.setTime(c.getTime()-u),c},instanceOf:Date,represent:function(e){return e.toISOString()}});var yS=new GE("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),bS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var wS=new GE("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=0,a=e.length,r=bS;for(n=0;n<a;n++)if(!((t=r.indexOf(e.charAt(n)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){var t,n,i=e.replace(/[\r\n=]/g,""),a=i.length,r=bS,s=0,o=[];for(t=0;t<a;t++)t%4==0&&t&&(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)),s=s<<6|r.indexOf(i.charAt(t));return 0===(n=a%4*6)?(o.push(s>>16&255),o.push(s>>8&255),o.push(255&s)):18===n?(o.push(s>>10&255),o.push(s>>2&255)):12===n&&o.push(s>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,i="",a=0,r=e.length,s=bS;for(t=0;t<r;t++)t%3==0&&t&&(i+=s[a>>18&63],i+=s[a>>12&63],i+=s[a>>6&63],i+=s[63&a]),a=(a<<8)+e[t];return 0===(n=r%3)?(i+=s[a>>18&63],i+=s[a>>12&63],i+=s[a>>6&63],i+=s[63&a]):2===n?(i+=s[a>>10&63],i+=s[a>>4&63],i+=s[a<<2&63],i+=s[64]):1===n&&(i+=s[a>>2&63],i+=s[a<<4&63],i+=s[64],i+=s[64]),i}}),xS=Object.prototype.hasOwnProperty,kS=Object.prototype.toString;var CS=new GE("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,a,r,s=[],o=e;for(t=0,n=o.length;t<n;t+=1){if(i=o[t],r=!1,"[object Object]"!==kS.call(i))return!1;for(a in i)if(xS.call(i,a)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==s.indexOf(a))return!1;s.push(a)}return!0},construct:function(e){return null!==e?e:[]}}),MS=Object.prototype.toString;var ES=new GE("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,a,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1){if(i=s[t],"[object Object]"!==MS.call(i))return!1;if(1!==(a=Object.keys(i)).length)return!1;r[t]=[a[0],i[a[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,i,a,r,s=e;for(r=new Array(s.length),t=0,n=s.length;t<n;t+=1)i=s[t],a=Object.keys(i),r[t]=[a[0],i[a[0]]];return r}}),SS=Object.prototype.hasOwnProperty;var AS=new GE("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(SS.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),TS=fS.extend({implicit:[_S,yS],explicit:[wS,CS,ES,AS]}),$S=Object.prototype.hasOwnProperty,OS=1,IS=2,LS=3,jS=4,zS=1,DS=2,RS=3,NS=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,PS=/[\x85\u2028\u2029]/,FS=/[,\[\]\{\}]/,BS=/^(?:!|!!|![a-z\-]+!)$/i,VS=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function US(e){return Object.prototype.toString.call(e)}function HS(e){return 10===e||13===e}function qS(e){return 9===e||32===e}function WS(e){return 9===e||32===e||10===e||13===e}function ZS(e){return 44===e||91===e||93===e||123===e||125===e}function KS(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function YS(e){return 120===e?2:117===e?4:85===e?8:0}function QS(e){return 48<=e&&e<=57?e-48:-1}function GS(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function XS(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var JS=new Array(256),eA=new Array(256),tA=0;tA<256;tA++)JS[tA]=GS(tA)?1:0,eA[tA]=GS(tA);function nA(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||TS,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function iA(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=KE(n),new qE(t,n)}function aA(e,t){throw iA(e,t)}function rA(e,t){e.onWarning&&e.onWarning.call(null,iA(e,t))}var sA={YAML:function(e,t,n){var i,a,r;null!==e.version&&aA(e,"duplication of %YAML directive"),1!==n.length&&aA(e,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&aA(e,"ill-formed argument of the YAML directive"),a=parseInt(i[1],10),r=parseInt(i[2],10),1!==a&&aA(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=r<2,1!==r&&2!==r&&rA(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var i,a;2!==n.length&&aA(e,"TAG directive accepts exactly two arguments"),i=n[0],a=n[1],BS.test(i)||aA(e,"ill-formed tag handle (first argument) of the TAG directive"),$S.call(e.tagMap,i)&&aA(e,'there is a previously declared suffix for "'+i+'" tag handle'),VS.test(a)||aA(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch(t){aA(e,"tag prefix is malformed: "+a)}e.tagMap[i]=a}};function oA(e,t,n,i){var a,r,s,o;if(t<n){if(o=e.input.slice(t,n),i)for(a=0,r=o.length;a<r;a+=1)9===(s=o.charCodeAt(a))||32<=s&&s<=1114111||aA(e,"expected valid JSON character");else NS.test(o)&&aA(e,"the stream contains non-printable characters");e.result+=o}}function cA(e,t,n,i){var a,r,s,o;for(VE.isObject(n)||aA(e,"cannot merge mappings; the provided source object is unacceptable"),s=0,o=(a=Object.keys(n)).length;s<o;s+=1)r=a[s],$S.call(t,r)||(t[r]=n[r],i[r]=!0)}function lA(e,t,n,i,a,r,s,o,c){var l,u;if(Array.isArray(a))for(l=0,u=(a=Array.prototype.slice.call(a)).length;l<u;l+=1)Array.isArray(a[l])&&aA(e,"nested arrays are not supported inside keys"),"object"==typeof a&&"[object Object]"===US(a[l])&&(a[l]="[object Object]");if("object"==typeof a&&"[object Object]"===US(a)&&(a="[object Object]"),a=String(a),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(r))for(l=0,u=r.length;l<u;l+=1)cA(e,t,r[l],n);else cA(e,t,r,n);else e.json||$S.call(n,a)||!$S.call(t,a)||(e.line=s||e.line,e.lineStart=o||e.lineStart,e.position=c||e.position,aA(e,"duplicated mapping key")),"__proto__"===a?Object.defineProperty(t,a,{configurable:!0,enumerable:!0,writable:!0,value:r}):t[a]=r,delete n[a];return t}function uA(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):aA(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function dA(e,t,n){for(var i=0,a=e.input.charCodeAt(e.position);0!==a;){for(;qS(a);)9===a&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),a=e.input.charCodeAt(++e.position);if(t&&35===a)do{a=e.input.charCodeAt(++e.position)}while(10!==a&&13!==a&&0!==a);if(!HS(a))break;for(uA(e),a=e.input.charCodeAt(e.position),i++,e.lineIndent=0;32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position)}return-1!==n&&0!==i&&e.lineIndent<n&&rA(e,"deficient indentation"),i}function hA(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!WS(t)))}function pA(e,t){1===t?e.result+=" ":t>1&&(e.result+=VE.repeat("\n",t-1))}function mA(e,t){var n,i,a=e.tag,r=e.anchor,s=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),i=e.input.charCodeAt(e.position);0!==i&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,aA(e,"tab characters must not be used in indentation")),45===i)&&WS(e.input.charCodeAt(e.position+1));)if(o=!0,e.position++,dA(e,!0,-1)&&e.lineIndent<=t)s.push(null),i=e.input.charCodeAt(e.position);else if(n=e.line,vA(e,t,LS,!1,!0),s.push(e.result),dA(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==i)aA(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!o&&(e.tag=a,e.anchor=r,e.kind="sequence",e.result=s,!0)}function fA(e){var t,n,i,a,r=!1,s=!1;if(33!==(a=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&aA(e,"duplication of a tag property"),60===(a=e.input.charCodeAt(++e.position))?(r=!0,a=e.input.charCodeAt(++e.position)):33===a?(s=!0,n="!!",a=e.input.charCodeAt(++e.position)):n="!",t=e.position,r){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&62!==a);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):aA(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!WS(a);)33===a&&(s?aA(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),BS.test(n)||aA(e,"named tag handle cannot contain such characters"),s=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),FS.test(i)&&aA(e,"tag suffix cannot contain flow indicator characters")}i&&!VS.test(i)&&aA(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch(t){aA(e,"tag name is malformed: "+i)}return r?e.tag=i:$S.call(e.tagMap,n)?e.tag=e.tagMap[n]+i:"!"===n?e.tag="!"+i:"!!"===n?e.tag="tag:yaml.org,2002:"+i:aA(e,'undeclared tag handle "'+n+'"'),!0}function gA(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&aA(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!WS(n)&&!ZS(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&aA(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function vA(e,t,n,i,a){var r,s,o,c,l,u,d,h,p,m=1,f=!1,g=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,r=s=o=jS===n||LS===n,i&&dA(e,!0,-1)&&(f=!0,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)),1===m)for(;fA(e)||gA(e);)dA(e,!0,-1)?(f=!0,o=r,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)):o=!1;if(o&&(o=f||a),1!==m&&jS!==n||(h=OS===n||IS===n?t:t+1,p=e.position-e.lineStart,1===m?o&&(mA(e,p)||function(e,t,n){var i,a,r,s,o,c,l,u=e.tag,d=e.anchor,h={},p=Object.create(null),m=null,f=null,g=null,v=!1,_=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=h),l=e.input.charCodeAt(e.position);0!==l;){if(v||-1===e.firstTabInLine||(e.position=e.firstTabInLine,aA(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),r=e.line,63!==l&&58!==l||!WS(i)){if(s=e.line,o=e.lineStart,c=e.position,!vA(e,n,IS,!1,!0))break;if(e.line===r){for(l=e.input.charCodeAt(e.position);qS(l);)l=e.input.charCodeAt(++e.position);if(58===l)WS(l=e.input.charCodeAt(++e.position))||aA(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(lA(e,h,p,m,f,null,s,o,c),m=f=g=null),_=!0,v=!1,a=!1,m=e.tag,f=e.result;else{if(!_)return e.tag=u,e.anchor=d,!0;aA(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!_)return e.tag=u,e.anchor=d,!0;aA(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===l?(v&&(lA(e,h,p,m,f,null,s,o,c),m=f=g=null),_=!0,v=!0,a=!0):v?(v=!1,a=!0):aA(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,l=i;if((e.line===r||e.lineIndent>t)&&(v&&(s=e.line,o=e.lineStart,c=e.position),vA(e,t,jS,!0,a)&&(v?f=e.result:g=e.result),v||(lA(e,h,p,m,f,g,s,o,c),m=f=g=null),dA(e,!0,-1),l=e.input.charCodeAt(e.position)),(e.line===r||e.lineIndent>t)&&0!==l)aA(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&lA(e,h,p,m,f,null,s,o,c),_&&(e.tag=u,e.anchor=d,e.kind="mapping",e.result=h),_}(e,p,h))||function(e,t){var n,i,a,r,s,o,c,l,u,d,h,p,m=!0,f=e.tag,g=e.anchor,v=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))s=93,l=!1,r=[];else{if(123!==p)return!1;s=125,l=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),p=e.input.charCodeAt(++e.position);0!==p;){if(dA(e,!0,t),(p=e.input.charCodeAt(e.position))===s)return e.position++,e.tag=f,e.anchor=g,e.kind=l?"mapping":"sequence",e.result=r,!0;m?44===p&&aA(e,"expected the node content, but found ','"):aA(e,"missed comma between flow collection entries"),h=null,o=c=!1,63===p&&WS(e.input.charCodeAt(e.position+1))&&(o=c=!0,e.position++,dA(e,!0,t)),n=e.line,i=e.lineStart,a=e.position,vA(e,t,OS,!1,!0),d=e.tag,u=e.result,dA(e,!0,t),p=e.input.charCodeAt(e.position),!c&&e.line!==n||58!==p||(o=!0,p=e.input.charCodeAt(++e.position),dA(e,!0,t),vA(e,t,OS,!1,!0),h=e.result),l?lA(e,r,v,d,u,h,n,i,a):o?r.push(lA(e,null,v,d,u,h,n,i,a)):r.push(u),dA(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(m=!0,p=e.input.charCodeAt(++e.position)):m=!1}aA(e,"unexpected end of the stream within a flow collection")}(e,h)?g=!0:(s&&function(e,t){var n,i,a,r,s=zS,o=!1,c=!1,l=t,u=0,d=!1;if(124===(r=e.input.charCodeAt(e.position)))i=!1;else{if(62!==r)return!1;i=!0}for(e.kind="scalar",e.result="";0!==r;)if(43===(r=e.input.charCodeAt(++e.position))||45===r)zS===s?s=43===r?RS:DS:aA(e,"repeat of a chomping mode identifier");else{if(!((a=QS(r))>=0))break;0===a?aA(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?aA(e,"repeat of an indentation width identifier"):(l=t+a-1,c=!0)}if(qS(r)){do{r=e.input.charCodeAt(++e.position)}while(qS(r));if(35===r)do{r=e.input.charCodeAt(++e.position)}while(!HS(r)&&0!==r)}for(;0!==r;){for(uA(e),e.lineIndent=0,r=e.input.charCodeAt(e.position);(!c||e.lineIndent<l)&&32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>l&&(l=e.lineIndent),HS(r))u++;else{if(e.lineIndent<l){s===RS?e.result+=VE.repeat("\n",o?1+u:u):s===zS&&o&&(e.result+="\n");break}for(i?qS(r)?(d=!0,e.result+=VE.repeat("\n",o?1+u:u)):d?(d=!1,e.result+=VE.repeat("\n",u+1)):0===u?o&&(e.result+=" "):e.result+=VE.repeat("\n",u):e.result+=VE.repeat("\n",o?1+u:u),o=!0,c=!0,u=0,n=e.position;!HS(r)&&0!==r;)r=e.input.charCodeAt(++e.position);oA(e,n,e.position,!1)}}return!0}(e,h)||function(e,t){var n,i,a;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,i=a=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(oA(e,i,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;i=e.position,e.position++,a=e.position}else HS(n)?(oA(e,i,a,!0),pA(e,dA(e,!1,t)),i=a=e.position):e.position===e.lineStart&&hA(e)?aA(e,"unexpected end of the document within a single quoted scalar"):(e.position++,a=e.position);aA(e,"unexpected end of the stream within a single quoted scalar")}(e,h)||function(e,t){var n,i,a,r,s,o;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return oA(e,n,e.position,!0),e.position++,!0;if(92===o){if(oA(e,n,e.position,!0),HS(o=e.input.charCodeAt(++e.position)))dA(e,!1,t);else if(o<256&&JS[o])e.result+=eA[o],e.position++;else if((s=YS(o))>0){for(a=s,r=0;a>0;a--)(s=KS(o=e.input.charCodeAt(++e.position)))>=0?r=(r<<4)+s:aA(e,"expected hexadecimal character");e.result+=XS(r),e.position++}else aA(e,"unknown escape sequence");n=i=e.position}else HS(o)?(oA(e,n,i,!0),pA(e,dA(e,!1,t)),n=i=e.position):e.position===e.lineStart&&hA(e)?aA(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position)}aA(e,"unexpected end of the stream within a double quoted scalar")}(e,h)?g=!0:!function(e){var t,n,i;if(42!==(i=e.input.charCodeAt(e.position)))return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!WS(i)&&!ZS(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&aA(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),$S.call(e.anchorMap,n)||aA(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],dA(e,!0,-1),!0}(e)?function(e,t,n){var i,a,r,s,o,c,l,u,d=e.kind,h=e.result;if(WS(u=e.input.charCodeAt(e.position))||ZS(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(WS(i=e.input.charCodeAt(e.position+1))||n&&ZS(i)))return!1;for(e.kind="scalar",e.result="",a=r=e.position,s=!1;0!==u;){if(58===u){if(WS(i=e.input.charCodeAt(e.position+1))||n&&ZS(i))break}else if(35===u){if(WS(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&hA(e)||n&&ZS(u))break;if(HS(u)){if(o=e.line,c=e.lineStart,l=e.lineIndent,dA(e,!1,-1),e.lineIndent>=t){s=!0,u=e.input.charCodeAt(e.position);continue}e.position=r,e.line=o,e.lineStart=c,e.lineIndent=l;break}}s&&(oA(e,a,r,!1),pA(e,e.line-o),a=r=e.position,s=!1),qS(u)||(r=e.position+1),u=e.input.charCodeAt(++e.position)}return oA(e,a,r,!1),!!e.result||(e.kind=d,e.result=h,!1)}(e,h,OS===n)&&(g=!0,null===e.tag&&(e.tag="?")):(g=!0,null===e.tag&&null===e.anchor||aA(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===m&&(g=o&&mA(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&aA(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,l=e.implicitTypes.length;c<l;c+=1)if((d=e.implicitTypes[c]).resolve(e.result)){e.result=d.construct(e.result),e.tag=d.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if($S.call(e.typeMap[e.kind||"fallback"],e.tag))d=e.typeMap[e.kind||"fallback"][e.tag];else for(d=null,c=0,l=(u=e.typeMap.multi[e.kind||"fallback"]).length;c<l;c+=1)if(e.tag.slice(0,u[c].tag.length)===u[c].tag){d=u[c];break}d||aA(e,"unknown tag !<"+e.tag+">"),null!==e.result&&d.kind!==e.kind&&aA(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+d.kind+'", not "'+e.kind+'"'),d.resolve(e.result,e.tag)?(e.result=d.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):aA(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||g}function _A(e){var t,n,i,a,r=e.position,s=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(a=e.input.charCodeAt(e.position))&&(dA(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==a));){for(s=!0,a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!WS(a);)a=e.input.charCodeAt(++e.position);for(i=[],(n=e.input.slice(t,e.position)).length<1&&aA(e,"directive name must not be less than one character in length");0!==a;){for(;qS(a);)a=e.input.charCodeAt(++e.position);if(35===a){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&!HS(a));break}if(HS(a))break;for(t=e.position;0!==a&&!WS(a);)a=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}0!==a&&uA(e),$S.call(sA,n)?sA[n](e,n,i):rA(e,'unknown document directive "'+n+'"')}dA(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,dA(e,!0,-1)):s&&aA(e,"directives end mark is expected"),vA(e,e.lineIndent-1,jS,!1,!0),dA(e,!0,-1),e.checkLineBreaks&&PS.test(e.input.slice(r,e.position))&&rA(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&hA(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,dA(e,!0,-1)):e.position<e.length-1&&aA(e,"end of the stream or a document separator is expected")}function yA(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new nA(e,t),i=e.indexOf("\0");for(-1!==i&&(n.position=i,aA(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)_A(n);return n.documents}var bA={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var i=yA(e,n);if("function"!=typeof t)return i;for(var a=0,r=i.length;a<r;a+=1)t(i[a])},load:function(e,t){var n=yA(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new qE("expected a single document in the stream, but found more")}}},wA=Object.prototype.toString,xA=Object.prototype.hasOwnProperty,kA=65279,CA=9,MA=10,EA=13,SA=32,AA=33,TA=34,$A=35,OA=37,IA=38,LA=39,jA=42,zA=44,DA=45,RA=58,NA=61,PA=62,FA=63,BA=64,VA=91,UA=93,HA=96,qA=123,WA=124,ZA=125,KA={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},YA=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],QA=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function GA(e){var t,n,i;if(t=e.toString(16).toUpperCase(),e<=255)n="x",i=2;else if(e<=65535)n="u",i=4;else{if(!(e<=4294967295))throw new qE("code point within a string may not be greater than 0xFFFFFFFF");n="U",i=8}return"\\"+n+VE.repeat("0",i-t.length)+t}var XA=1,JA=2;function eT(e){this.schema=e.schema||TS,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=VE.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,i,a,r,s,o,c;if(null===t)return{};for(n={},a=0,r=(i=Object.keys(t)).length;a<r;a+=1)s=i[a],o=String(t[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(c=e.compiledTypeMap.fallback[s])&&xA.call(c.styleAliases,o)&&(o=c.styleAliases[o]),n[s]=o;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?JA:XA,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function tT(e,t){for(var n,i=VE.repeat(" ",t),a=0,r=-1,s="",o=e.length;a<o;)-1===(r=e.indexOf("\n",a))?(n=e.slice(a),a=o):(n=e.slice(a,r+1),a=r+1),n.length&&"\n"!==n&&(s+=i),s+=n;return s}function nT(e,t){return"\n"+VE.repeat(" ",e.indent*t)}function iT(e){return e===SA||e===CA}function aT(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==kA||65536<=e&&e<=1114111}function rT(e){return aT(e)&&e!==kA&&e!==EA&&e!==MA}function sT(e,t,n){var i=rT(e),a=i&&!iT(e);return(n?i:i&&e!==zA&&e!==VA&&e!==UA&&e!==qA&&e!==ZA)&&e!==$A&&!(t===RA&&!a)||rT(t)&&!iT(t)&&e===$A||t===RA&&a}function oT(e,t){var n,i=e.charCodeAt(t);return i>=55296&&i<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(i-55296)+n-56320+65536:i}function cT(e){return/^\n* /.test(e)}var lT=1,uT=2,dT=3,hT=4,pT=5;function mT(e,t,n,i,a,r,s,o){var c,l=0,u=null,d=!1,h=!1,p=-1!==i,m=-1,f=function(e){return aT(e)&&e!==kA&&!iT(e)&&e!==DA&&e!==FA&&e!==RA&&e!==zA&&e!==VA&&e!==UA&&e!==qA&&e!==ZA&&e!==$A&&e!==IA&&e!==jA&&e!==AA&&e!==WA&&e!==NA&&e!==PA&&e!==LA&&e!==TA&&e!==OA&&e!==BA&&e!==HA}(oT(e,0))&&function(e){return!iT(e)&&e!==RA}(oT(e,e.length-1));if(t||s)for(c=0;c<e.length;l>=65536?c+=2:c++){if(!aT(l=oT(e,c)))return pT;f=f&&sT(l,u,o),u=l}else{for(c=0;c<e.length;l>=65536?c+=2:c++){if((l=oT(e,c))===MA)d=!0,p&&(h=h||c-m-1>i&&" "!==e[m+1],m=c);else if(!aT(l))return pT;f=f&&sT(l,u,o),u=l}h=h||p&&c-m-1>i&&" "!==e[m+1]}return d||h?n>9&&cT(e)?pT:s?r===JA?pT:uT:h?hT:dT:!f||s||a(e)?r===JA?pT:uT:lT}function fT(e,t,n,i,a){e.dump=function(){if(0===t.length)return e.quotingType===JA?'""':"''";if(!e.noCompatMode&&(-1!==YA.indexOf(t)||QA.test(t)))return e.quotingType===JA?'"'+t+'"':"'"+t+"'";var r=e.indent*Math.max(1,n),s=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-r),o=i||e.flowLevel>-1&&n>=e.flowLevel;switch(mT(t,o,e.indent,s,(function(t){return function(e,t){var n,i;for(n=0,i=e.implicitTypes.length;n<i;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!i,a)){case lT:return t;case uT:return"'"+t.replace(/'/g,"''")+"'";case dT:return"|"+gT(t,e.indent)+vT(tT(t,r));case hT:return">"+gT(t,e.indent)+vT(tT(function(e,t){var n,i,a=/(\n+)([^\n]*)/g,r=(o=e.indexOf("\n"),o=-1!==o?o:e.length,a.lastIndex=o,_T(e.slice(0,o),t)),s="\n"===e[0]||" "===e[0];var o;for(;i=a.exec(e);){var c=i[1],l=i[2];n=" "===l[0],r+=c+(s||n||""===l?"":"\n")+_T(l,t),s=n}return r}(t,s),r));case pT:return'"'+function(e){for(var t,n="",i=0,a=0;a<e.length;i>=65536?a+=2:a++)i=oT(e,a),!(t=KA[i])&&aT(i)?(n+=e[a],i>=65536&&(n+=e[a+1])):n+=t||GA(i);return n}(t)+'"';default:throw new qE("impossible error: invalid scalar style")}}()}function gT(e,t){var n=cT(e)?String(t):"",i="\n"===e[e.length-1];return n+(i&&("\n"===e[e.length-2]||"\n"===e)?"+":i?"":"-")+"\n"}function vT(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function _T(e,t){if(""===e||" "===e[0])return e;for(var n,i,a=/ [^ ]/g,r=0,s=0,o=0,c="";n=a.exec(e);)(o=n.index)-r>t&&(i=s>r?s:o,c+="\n"+e.slice(r,i),r=i+1),s=o;return c+="\n",e.length-r>t&&s>r?c+=e.slice(r,s)+"\n"+e.slice(s+1):c+=e.slice(r),c.slice(1)}function yT(e,t,n,i){var a,r,s,o="",c=e.tag;for(a=0,r=n.length;a<r;a+=1)s=n[a],e.replacer&&(s=e.replacer.call(n,String(a),s)),(wT(e,t+1,s,!0,!0,!1,!0)||void 0===s&&wT(e,t+1,null,!0,!0,!1,!0))&&(i&&""===o||(o+=nT(e,t)),e.dump&&MA===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=c,e.dump=o||"[]"}function bT(e,t,n){var i,a,r,s,o,c;for(r=0,s=(a=n?e.explicitTypes:e.implicitTypes).length;r<s;r+=1)if(((o=a[r]).instanceOf||o.predicate)&&(!o.instanceOf||"object"==typeof t&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(c=e.styleMap[o.tag]||o.defaultStyle,"[object Function]"===wA.call(o.represent))i=o.represent(t,c);else{if(!xA.call(o.represent,c))throw new qE("!<"+o.tag+'> tag resolver accepts not "'+c+'" style');i=o.represent[c](t,c)}e.dump=i}return!0}return!1}function wT(e,t,n,i,a,r,s){e.tag=null,e.dump=n,bT(e,n,!1)||bT(e,n,!0);var o,c=wA.call(e.dump),l=i;i&&(i=e.flowLevel<0||e.flowLevel>t);var u,d,h="[object Object]"===c||"[object Array]"===c;if(h&&(d=-1!==(u=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||d||2!==e.indent&&t>0)&&(a=!1),d&&e.usedDuplicates[u])e.dump="*ref_"+u;else{if(h&&d&&!e.usedDuplicates[u]&&(e.usedDuplicates[u]=!0),"[object Object]"===c)i&&0!==Object.keys(e.dump).length?(!function(e,t,n,i){var a,r,s,o,c,l,u="",d=e.tag,h=Object.keys(n);if(!0===e.sortKeys)h.sort();else if("function"==typeof e.sortKeys)h.sort(e.sortKeys);else if(e.sortKeys)throw new qE("sortKeys must be a boolean or a function");for(a=0,r=h.length;a<r;a+=1)l="",i&&""===u||(l+=nT(e,t)),o=n[s=h[a]],e.replacer&&(o=e.replacer.call(n,s,o)),wT(e,t+1,s,!0,!0,!0)&&((c=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&MA===e.dump.charCodeAt(0)?l+="?":l+="? "),l+=e.dump,c&&(l+=nT(e,t)),wT(e,t+1,o,!0,c)&&(e.dump&&MA===e.dump.charCodeAt(0)?l+=":":l+=": ",u+=l+=e.dump));e.tag=d,e.dump=u||"{}"}(e,t,e.dump,a),d&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,n){var i,a,r,s,o,c="",l=e.tag,u=Object.keys(n);for(i=0,a=u.length;i<a;i+=1)o="",""!==c&&(o+=", "),e.condenseFlow&&(o+='"'),s=n[r=u[i]],e.replacer&&(s=e.replacer.call(n,r,s)),wT(e,t,r,!1,!1)&&(e.dump.length>1024&&(o+="? "),o+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),wT(e,t,s,!1,!1)&&(c+=o+=e.dump));e.tag=l,e.dump="{"+c+"}"}(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else if("[object Array]"===c)i&&0!==e.dump.length?(e.noArrayIndent&&!s&&t>0?yT(e,t-1,e.dump,a):yT(e,t,e.dump,a),d&&(e.dump="&ref_"+u+e.dump)):(!function(e,t,n){var i,a,r,s="",o=e.tag;for(i=0,a=n.length;i<a;i+=1)r=n[i],e.replacer&&(r=e.replacer.call(n,String(i),r)),(wT(e,t,r,!1,!1)||void 0===r&&wT(e,t,null,!1,!1))&&(""!==s&&(s+=","+(e.condenseFlow?"":" ")),s+=e.dump);e.tag=o,e.dump="["+s+"]"}(e,t,e.dump),d&&(e.dump="&ref_"+u+" "+e.dump));else{if("[object String]"!==c){if("[object Undefined]"===c)return!1;if(e.skipInvalid)return!1;throw new qE("unacceptable kind of an object to dump "+c)}"?"!==e.tag&&fT(e,e.dump,t,r,l)}null!==e.tag&&"?"!==e.tag&&(o=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),o="!"===e.tag[0]?"!"+o:"tag:yaml.org,2002:"===o.slice(0,18)?"!!"+o.slice(18):"!<"+o+">",e.dump=o+" "+e.dump)}return!0}function xT(e,t){var n,i,a=[],r=[];for(kT(e,a,r),n=0,i=r.length;n<i;n+=1)t.duplicates.push(a[r[n]]);t.usedDuplicates=new Array(i)}function kT(e,t,n){var i,a,r;if(null!==e&&"object"==typeof e)if(-1!==(a=t.indexOf(e)))-1===n.indexOf(a)&&n.push(a);else if(t.push(e),Array.isArray(e))for(a=0,r=e.length;a<r;a+=1)kT(e[a],t,n);else for(a=0,r=(i=Object.keys(e)).length;a<r;a+=1)kT(e[i[a]],t,n)}function CT(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var MT={Type:GE,Schema:eS,FAILSAFE_SCHEMA:aS,JSON_SCHEMA:mS,CORE_SCHEMA:fS,DEFAULT_SCHEMA:TS,load:bA.load,loadAll:bA.loadAll,dump:{dump:function(e,t){var n=new eT(t=t||{});n.noRefs||xT(e,n);var i=e;return n.replacer&&(i=n.replacer.call({"":i},"",i)),wT(n,0,i,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:qE,types:{binary:wS,float:pS,map:iS,null:rS,pairs:ES,set:AS,timestamp:_S,bool:sS,int:uS,merge:yS,omap:CS,seq:nS,str:tS},safeLoad:CT("safeLoad","load"),safeLoadAll:CT("safeLoadAll","loadAll"),safeDump:CT("safeDump","dump")};class ET{getMessageString(e){return e.message+(e.context&&"string"==typeof e.context?": "+e.context:"")}getIcon(e){return e.icon?e.icon:"error"===e.type?"mdi:alert-circle":"mdi:information-outline"}shouldShowTroubleshootingURL(e){return"error"===e.type}getTroubleshootingURL(e){return e.troubleshootingURL??bi}getContextStrings(e){return Array.isArray(e.context)?e.context.map((e=>MT.dump(e))):"object"==typeof e.context?[MT.dump(e.context)]:"string"==typeof e.context?[e.context]:[]}}var ST='.dotdotdot:after {\n  animation: dots 2s linear infinite;\n  content: "";\n  display: inline-block;\n  width: 3em;\n}\n@keyframes dots {\n  0%, 20% {\n    content: ".";\n  }\n  40% {\n    content: "..";\n  }\n  60% {\n    content: "...";\n  }\n  90%, 100% {\n    content: "";\n  }\n}\n\n:host {\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  user-select: text;\n  -webkit-user-select: text;\n}\n\n:host(:not([overlay])) {\n  height: 100%;\n  width: 100%;\n  background: var(--advanced-camera-card-message-background);\n  color: var(--advanced-camera-card-message-color);\n}\n\n:host([overlay]) {\n  position: absolute;\n  inset: 5%;\n  background: var(--advanced-camera-card-message-overlay-background);\n  color: var(--advanced-camera-card-message-overlay-color);\n}\n\ndiv.wrapper {\n  height: 100%;\n}\n\ndiv.message {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  box-sizing: border-box;\n  height: 100%;\n}\n\ndiv.message.padded {\n  padding: 20px;\n}\n\ndiv.message div.contents {\n  display: flex;\n  flex-direction: column;\n  padding: 10px;\n  margin-top: auto;\n  margin-bottom: auto;\n  min-width: 0;\n}\n\ndiv.message div.icon {\n  padding: 10px;\n}\n\n.vertical {\n  flex-direction: column;\n}\n\na {\n  word-break: break-word;\n}\n\n:host(:not([overlay])) a {\n  color: var(--advanced-camera-card-message-color);\n}\n\n:host([overlay]) a {\n  color: var(--advanced-camera-card-message-overlay-color);\n}\n\n.message pre {\n  margin-top: 20px;\n  overflow-x: auto;\n  border: 1px dotted var(--advanced-camera-card-divider-color);\n  padding: 1em;\n}';function AT(e,t){return H` <advanced-camera-card-message
    .message=${e}
    ?overlay=${!!t?.overlay}
  ></advanced-camera-card-message>`}let TT=class extends oe{constructor(){super(...arguments),this.overlay=!1,this._controller=new ET}render(){if(!this.message)return;const e=H`
      ${this._controller.getMessageString(this.message)}
      ${this._controller.shouldShowTroubleshootingURL(this.message)?H`.
            <a href="${this._controller.getTroubleshootingURL(this.message)}"
              >${Kv("error.troubleshooting")}</a
            >`:""}
    `,t=this._controller.getIcon(this.message),n={dotdotdot:!!this.message?.dotdotdot};return H` <div class="wrapper">
      <div class="message padded">
        <div class="icon">
          <advanced-camera-card-icon
            .icon="${{icon:t}}"
          ></advanced-camera-card-icon>
        </div>
        <div class="contents">
          <span class="${ve(n)}">${e}</span>
          ${this._controller.getContextStrings(this.message).map((e=>H`<pre>${e}</pre>`))}
        </div>
      </div>
    </div>`}static get styles(){return s(ST)}};e([he({attribute:!1})],TT.prototype,"message",void 0),e([he({attribute:!0,type:Boolean})],TT.prototype,"overlay",void 0),TT=e([le("advanced-camera-card-message")],TT);let $T=class extends oe{render(){return H`
      <slot name="top"></slot>
      <slot name="left"></slot>
      <slot name="right"></slot>
      <slot name="bottom"></slot>
    `}static get styles(){return s("ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  pointer-events: none;\n}\n\nslot {\n  position: absolute;\n  display: flex;\n}\n\n/***************\n * Slot position\n ***************/\nslot[name=top] {\n  top: 0px;\n}\n\nslot[name=bottom] {\n  bottom: 0px;\n}\n\nslot[name=left] {\n  left: 0px;\n}\n\nslot[name=right] {\n  right: 0px;\n}\n\n/***********\n * Slot size\n ***********/\nslot[name=top],\nslot[name=bottom] {\n  width: 100%;\n  flex-direction: column;\n}\n\nslot[name=left],\nslot[name=right] {\n  height: 100%;\n  flex-direction: row;\n}\n\nslot[name=top],\nslot[name=left] {\n  justify-content: flex-start;\n}\n\nslot[name=bottom],\nslot[name=right] {\n  justify-content: flex-end;\n}\n\n/*******************************\n * Match rounded corners to card\n *******************************/\n::slotted([slot=top]:first-child),\n::slotted([slot=left]:first-child) {\n  border-top-left-radius: var(--ha-card-border-radius, 4px);\n}\n\n::slotted([slot=top]:first-child),\n::slotted([slot=right]:first-child) {\n  border-top-right-radius: var(--ha-card-border-radius, 4px);\n}\n\n::slotted([slot=bottom]:last-child),\n::slotted([slot=left]:last-child) {\n  border-bottom-left-radius: var(--ha-card-border-radius, 4px);\n}\n\n::slotted([slot=bottom]:last-child),\n::slotted([slot=right]:last-child) {\n  border-bottom-right-radius: var(--ha-card-border-radius, 4px);\n}")}};$T=e([le("advanced-camera-card-overlay")],$T);class OT{constructor(e){this._config=null,this._popupTimer=new Tg,this._items=[],this._host=e}getRenderItems(){return this._items}setItems(e){const t=e.filter((e=>!!e.exclusive)),n=j_(t.length?t:e,(e=>e.priority??50),"desc"),i=this._getSufficientValues(this._items),a=this._getSufficientValues(n);this._items=n,"popup"!==this._config?.style||V_(i,a)||(this._show(),this._popupTimer.start(this._config.popup_seconds,(()=>this._hide()))),this._host.requestUpdate()}setConfig(e){this._config=e,this._host.style.setProperty("--advanced-camera-card-status-bar-height",`${e.height}px`),this._host.setAttribute("data-style",e.style),this._host.setAttribute("data-position",e.position),"popup"!==this._config?.style&&this._show(),this._host.requestUpdate()}getConfig(){return this._config}shouldRender(){return this._items.some((e=>!1!==e.enabled&&e.sufficient))}actionHandler(e,t){e.stopPropagation();const n=Eg(e.detail.action,t);n&&jE(this._host,{action:eg(n),config:t})}_getSufficientValue(e){
/* istanbul ignore else: cannot happen -- @preserve */
return"custom:advanced-camera-card-status-bar-icon"===e.type?e.icon:"custom:advanced-camera-card-status-bar-string"===e.type?e.string:"custom:advanced-camera-card-status-bar-image"===e.type?e.image:null}_getSufficientValues(e){return e.filter((e=>!1!==e.enabled&&e.sufficient)).map((e=>this._getSufficientValue(e)))}_show(){pg(this._host,!1,"hide")}_hide(){pg(this._host,!0,"hide")}}let IT=class extends oe{constructor(){super(...arguments),this._controller=new OT(this)}willUpdate(e){e.has("config")&&this.config&&this._controller.setConfig(this.config),e.has("items")&&this._controller.setItems(this.items??[])}_renderPerInstanceStyle(){const e=this._controller.getConfig();if(!e)return;const t=e.position,n=e.style,i=e=>`\n        var(--advanced-camera-card-status-bar-override-${e},\n        var(--advanced-camera-card-status-bar-position-${t}-style-${n}-${e},\n        var(--advanced-camera-card-status-bar-position-${t}-${e},\n        var(--advanced-camera-card-status-bar-style-${n}-${e},\n        var(--advanced-camera-card-status-bar-${e})))))`;return H`<style>
      :host(${`[data-position='${t}'][data-style='${n}']`}) {
        color: ${i("color")};
        background: ${i("background")};
      }
    </style>`}render(){if(this._controller.shouldRender())return H`
      ${this._renderPerInstanceStyle()}
      <div class="status">
        ${this._controller.getRenderItems().map((e=>{if(!1===e.enabled)return;const t=ve({item:!0,expand:!!e.expand,action:!!Object.keys(e.actions??{}).length}),n=Ig({hasHold:Sg(e.actions?.hold_action),hasDoubleClick:Sg(e.actions?.double_tap_action)});return"custom:advanced-camera-card-status-bar-string"===e.type?H`<div
              .actionHandler=${n}
              class="${t}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            >
              ${e.string}
            </div>`:"custom:advanced-camera-card-status-bar-icon"===e.type?H`<advanced-camera-card-icon
              .actionHandler=${n}
              .icon=${{icon:e.icon}}
              class="${t}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            ></advanced-camera-card-icon>`:"custom:advanced-camera-card-status-bar-image"===e.type?H`<img
              .actionHandler=${n}
              class="${t}"
              src="${e.image}"
              @action=${t=>this._controller.actionHandler(t,e.actions)}
            />`:void 0}))}
      </div>
    `}static get styles(){return s("ha-icon-button {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  border-radius: 50%;\n  padding: 0px;\n  margin: 3px;\n  --ha-icon-display: block;\n  /* Buttons can always be clicked */\n  pointer-events: auto;\n}\n\n:host {\n  --mdc-icon-size: calc(var(--advanced-camera-card-status-bar-height) / 2);\n  display: block;\n  width: 100%;\n  pointer-events: auto;\n  opacity: 1;\n  transition: opacity 1s;\n}\n\n/*******************************************************\n * Non-hover styles should not interact with the pointer\n *******************************************************/\n:host(:not([data-style*=hover])) {\n  pointer-events: none;\n}\n\n/**********************\n * Popup style behavior\n **********************/\n:host([data-style=popup][hide]) {\n  opacity: 0;\n}\n\n/*********************\n * Status bar contents\n *********************/\n.status {\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  overflow: hidden;\n  width: 100%;\n  height: var(--advanced-camera-card-status-bar-height);\n}\n\n.item {\n  display: inline-block;\n  margin: 3px 5px;\n  align-content: center;\n}\n\n.item:first-child {\n  margin-left: 10px;\n}\n\n.item:last-child {\n  margin-right: 10px;\n}\n\n.item.expand {\n  flex: 1;\n}\n\n.item.action {\n  cursor: pointer;\n}\n\nimg.item,\nadvanced-camera-card-icon.item {\n  display: block;\n  height: var(--mdc-icon-size, 24px);\n  width: auto;\n}\n\n/************************\n * Status bar theme hooks\n ************************/")}};e([he({attribute:!1})],IT.prototype,"items",void 0),e([he({attribute:!1})],IT.prototype,"config",void 0),IT=e([le("advanced-camera-card-status-bar")],IT);function LT(e){return"number"==typeof e}function jT(e){return"string"==typeof e}function zT(e){return"boolean"==typeof e}function DT(e){return"[object Object]"===Object.prototype.toString.call(e)}function RT(e){return Math.abs(e)}function NT(e){return Math.sign(e)}function PT(e,t){return RT(e-t)}function FT(e){return qT(e).map(Number)}function BT(e){return e[VT(e)]}function VT(e){return Math.max(0,e.length-1)}function UT(e,t){return t===VT(e)}function HT(e,t=0){return Array.from(Array(e),((e,n)=>t+n))}function qT(e){return Object.keys(e)}function WT(e,t){return[e,t].reduce(((e,t)=>(qT(t).forEach((n=>{const i=e[n],a=t[n],r=DT(i)&&DT(a);e[n]=r?WT(i,a):a})),e)),{})}function ZT(e,t){return void 0!==t.MouseEvent&&e instanceof t.MouseEvent}function KT(){let e=[];const t={add:function(n,i,a,r={passive:!0}){let s;if("addEventListener"in n)n.addEventListener(i,a,r),s=()=>n.removeEventListener(i,a,r);else{const e=n;e.addListener(a),s=()=>e.removeListener(a)}return e.push(s),t},clear:function(){e=e.filter((e=>e()))}};return t}function YT(e,t,n,i){const a=KT(),r=1e3/60;let s=null,o=0,c=0;function l(e){if(!c)return;s||(s=e);const a=e-s;for(s=e,o+=a;o>=r;)n(r),o-=r;i(o/r),c&&t.requestAnimationFrame(l)}function u(){t.cancelAnimationFrame(c),s=null,o=0,c=0}return{init:function(){a.add(e,"visibilitychange",(()=>{e.hidden&&(s=null,o=0)}))},destroy:function(){u(),a.clear()},start:function(){c||(c=t.requestAnimationFrame(l))},stop:u,update:()=>n(r),render:i}}function QT(e=0,t=0){const n=RT(e-t);function i(t){return t<e}function a(e){return e>t}function r(e){return i(e)||a(e)}const s={length:n,max:t,min:e,constrain:function(n){return r(n)?i(n)?e:t:n},reachedAny:r,reachedMax:a,reachedMin:i,removeOffset:function(e){return n?e-n*Math.ceil((e-t)/n):e}};return s}function GT(e,t,n){const{constrain:i}=QT(0,e),a=e+1;let r=s(t);function s(e){return n?RT((a+e)%a):i(e)}function o(){return r}function c(){return GT(e,o(),n)}const l={get:o,set:function(e){return r=s(e),l},add:function(e){return c().set(o()+e)},clone:c};return l}function XT(e,t,n,i,a,r,s,o,c,l,u,d,h,p,m,f,g,v,_){const{cross:y,direction:b}=e,w=["INPUT","SELECT","TEXTAREA"],x={passive:!1},k=KT(),C=KT(),M=QT(50,225).constrain(p.measure(20)),E={mouse:300,touch:400},S={mouse:500,touch:600},A=m?43:25;let T=!1,$=0,O=0,I=!1,L=!1,j=!1,z=!1;function D(e){if(!ZT(e,i)&&e.touches.length>=2)return R(e);const t=r.readPoint(e),n=r.readPoint(e,y),s=PT(t,$),c=PT(n,O);if(!L&&!z){if(!e.cancelable)return R(e);if(L=s>c,!L)return R(e)}const u=r.pointerMove(e);s>f&&(j=!0),l.useFriction(.3).useDuration(.75),o.start(),a.add(b(u)),e.preventDefault()}function R(e){const t=u.byDistance(0,!1).index!==d.get(),n=r.pointerUp(e)*(m?S:E)[z?"mouse":"touch"],i=function(e,t){const n=d.add(-1*NT(e)),i=u.byDistance(e,!m).distance;return m||RT(e)<M?i:g&&t?.5*i:u.byIndex(n.get(),0).distance}(b(n),t),a=function(e,t){if(0===e||0===t)return 0;if(RT(e)<=RT(t))return 0;const n=PT(RT(e),RT(t));return RT(n/e)}(n,i),s=A-10*a,o=v+a/50;L=!1,I=!1,C.clear(),l.useDuration(s).useFriction(o),c.distance(i,!m),z=!1,h.emit("pointerUp")}function N(e){j&&(e.stopPropagation(),e.preventDefault(),j=!1)}return{init:function(e){if(!_)return;function o(o){(zT(_)||_(e,o))&&function(e){const o=ZT(e,i);if(z=o,j=m&&o&&!e.buttons&&T,T=PT(a.get(),s.get())>=2,o&&0!==e.button)return;if(function(e){const t=e.nodeName||"";return w.includes(t)}(e.target))return;I=!0,r.pointerDown(e),l.useFriction(0).useDuration(0),a.set(s),function(){const e=z?n:t;C.add(e,"touchmove",D,x).add(e,"touchend",R).add(e,"mousemove",D,x).add(e,"mouseup",R)}(),$=r.readPoint(e),O=r.readPoint(e,y),h.emit("pointerDown")}(o)}const c=t;k.add(c,"dragstart",(e=>e.preventDefault()),x).add(c,"touchmove",(()=>{}),x).add(c,"touchend",(()=>{})).add(c,"touchstart",o).add(c,"mousedown",o).add(c,"touchcancel",R).add(c,"contextmenu",R).add(c,"click",N,!0)},destroy:function(){k.clear(),C.clear()},pointerDown:function(){return I}}}function JT(e,t){let n,i;function a(e){return e.timeStamp}function r(n,i){const a="client"+("x"===(i||e.scroll)?"X":"Y");return(ZT(n,t)?n:n.touches[0])[a]}return{pointerDown:function(e){return n=e,i=e,r(e)},pointerMove:function(e){const t=r(e)-r(i),s=a(e)-a(n)>170;return i=e,s&&(n=e),t},pointerUp:function(e){if(!n||!i)return 0;const t=r(i)-r(n),s=a(e)-a(n),o=a(e)-a(i)>170,c=t/s;return s&&!o&&RT(c)>.1?c:0},readPoint:r}}function e$(e,t,n,i,a,r,s){const o=[e].concat(i);let c,l,u=[],d=!1;function h(e){return a.measureSize(s.measure(e))}return{init:function(a){r&&(l=h(e),u=i.map(h),c=new ResizeObserver((n=>{(zT(r)||r(a,n))&&function(n){for(const r of n){if(d)return;const n=r.target===e,s=i.indexOf(r.target),o=n?l:u[s];if(RT(h(n?e:i[s])-o)>=.5){a.reInit(),t.emit("resize");break}}}(n)})),n.requestAnimationFrame((()=>{o.forEach((e=>c.observe(e)))})))},destroy:function(){d=!0,c&&c.disconnect()}}}function t$(e,t,n,i,a){const r=a.measure(10),s=a.measure(50),o=QT(.1,.99);let c=!1;function l(){return!c&&(!!e.reachedAny(n.get())&&!!e.reachedAny(t.get()))}return{shouldConstrain:l,constrain:function(a){if(!l())return;const c=e.reachedMin(t.get())?"min":"max",u=RT(e[c]-t.get()),d=n.get()-t.get(),h=o.constrain(u/s);n.subtract(d*h),!a&&RT(d)<r&&(n.set(e.constrain(n.get())),i.useDuration(25).useBaseFriction())},toggleActive:function(e){c=!e}}}function n$(e,t,n,i){const a=t.min+.1,r=t.max+.1,{reachedMin:s,reachedMax:o}=QT(a,r);const c={loop:function(t){if(!function(e){return 1===e?o(n.get()):-1===e&&s(n.get())}(t))return;const a=e*(-1*t);i.forEach((e=>e.add(a)))}};return c}function i$(e,t,n,i,a){const{reachedAny:r,removeOffset:s,constrain:o}=i;function c(e){return e.concat().sort(((e,t)=>RT(e)-RT(t)))[0]}function l(t,i){const a=[t,t+n,t-n];if(!e)return t;if(!i)return c(a);const r=a.filter((e=>NT(e)===i));return r.length?c(r):BT(a)-n}const u={byDistance:function(n,i){const c=a.get()+n,{index:u,distance:d}=function(n){const i=e?s(n):o(n),a=t.map(((e,t)=>({diff:l(e-i,0),index:t}))).sort(((e,t)=>RT(e.diff)-RT(t.diff))),{index:r}=a[0];return{index:r,distance:i}}(c),h=!e&&r(c);return!i||h?{index:u,distance:n}:{index:u,distance:n+l(t[u]-d,0)}},byIndex:function(e,n){return{index:e,distance:l(t[e]-a.get(),n)}},shortcut:l};return u}function a$(e,t,n,i,a,r,s,o){const c={passive:!0,capture:!0};let l=0;function u(e){"Tab"===e.code&&(l=(new Date).getTime())}return{init:function(d){o&&(r.add(document,"keydown",u,!1),t.forEach(((t,u)=>{r.add(t,"focus",(t=>{(zT(o)||o(d,t))&&function(t){if((new Date).getTime()-l>10)return;s.emit("slideFocusStart"),e.scrollLeft=0;const r=n.findIndex((e=>e.includes(t)));LT(r)&&(a.useDuration(0),i.index(r,0),s.emit("slideFocus"))}(u)}),c)})))}}}function r$(e){let t=e;function n(e){return LT(e)?e:e.get()}const i={get:function(){return t},set:function(e){t=n(e)},add:function(e){t+=n(e)},subtract:function(e){t-=n(e)}};return i}function s$(e,t){const n="x"===e.scroll?function(e){return`translate3d(${e}px,0px,0px)`}:function(e){return`translate3d(0px,${e}px,0px)`},i=t.style;let a=!1;return{clear:function(){a||(i.transform="",t.getAttribute("style")||t.removeAttribute("style"))},to:function(t){a||(i.transform=n(e.direction(t)))},toggleActive:function(e){a=!e}}}function o$(e,t,n,i,a,r,s,o,c){const l=.5,u=FT(a),d=FT(a).reverse(),h=function(){const e=s[0];return f(m(d,e),n,!1)}().concat(function(){const e=t-s[0]-1;return f(m(u,e),-n,!0)}());function p(e,t){return e.reduce(((e,t)=>e-a[t]),t)}function m(e,t){return e.reduce(((e,n)=>p(e,t)>0?e.concat([n]):e),[])}function f(a,s,u){const d=function(e){return r.map(((n,a)=>({start:n-i[a]+l+e,end:n+t-l+e})))}(s);return a.map((t=>{const i=u?0:-n,a=u?n:0,r=u?"end":"start",s=d[t][r];return{index:t,loopPoint:s,slideLocation:r$(-1),translate:s$(e,c[t]),target:()=>o.get()>s?i:a}}))}const g={canLoop:function(){return h.every((({index:e})=>{const n=u.filter((t=>t!==e));return p(n,t)<=.1}))},clear:function(){h.forEach((e=>e.translate.clear()))},loop:function(){h.forEach((e=>{const{target:t,translate:n,slideLocation:i}=e,a=t();a!==i.get()&&(n.to(a),i.set(a))}))},loopPoints:h};return g}function c$(e,t,n){let i,a=!1;return{init:function(r){n&&(i=new MutationObserver((e=>{a||(zT(n)||n(r,e))&&function(e){for(const n of e)if("childList"===n.type){r.reInit(),t.emit("slidesChanged");break}}(e)})),i.observe(e,{childList:!0}))},destroy:function(){i&&i.disconnect(),a=!0}}}function l$(e,t,n,i){const a={};let r,s=null,o=null,c=!1;const l={init:function(){r=new IntersectionObserver((e=>{c||(e.forEach((e=>{const n=t.indexOf(e.target);a[n]=e})),s=null,o=null,n.emit("slidesInView"))}),{root:e.parentElement,threshold:i}),t.forEach((e=>r.observe(e)))},destroy:function(){r&&r.disconnect(),c=!0},get:function(e=!0){if(e&&s)return s;if(!e&&o)return o;const t=function(e){return qT(a).reduce(((t,n)=>{const i=parseInt(n),{isIntersecting:r}=a[i];return(e&&r||!e&&!r)&&t.push(i),t}),[])}(e);return e&&(s=t),e||(o=t),t}};return l}function u$(e,t,n,i,a,r,s,o,c){const{startEdge:l,endEdge:u,direction:d}=e,h=LT(n);const p={groupSlides:function(e){return h?function(e,t){return FT(e).filter((e=>e%t==0)).map((n=>e.slice(n,n+t)))}(e,n):function(e){return e.length?FT(e).reduce(((n,h,p)=>{const m=BT(n)||0,f=0===m,g=h===VT(e),v=a[l]-r[m][l],_=a[l]-r[h][u],y=!i&&f?d(s):0,b=RT(_-(!i&&g?d(o):0)-(v+y));return p&&b>t+c&&n.push(h),g&&n.push(e.length),n}),[]).map(((t,n,i)=>{const a=Math.max(i[n-1]||0);return e.slice(a,t)})):[]}(e)}};return p}function d$(e,t,n,i,a,r,s){const{align:o,axis:c,direction:l,startIndex:u,loop:d,duration:h,dragFree:p,dragThreshold:m,inViewThreshold:f,slidesToScroll:g,skipSnaps:v,containScroll:_,watchResize:y,watchSlides:b,watchDrag:w,watchFocus:x}=r,k={measure:function(e){const{offsetTop:t,offsetLeft:n,offsetWidth:i,offsetHeight:a}=e;return{top:t,right:n+i,bottom:t+a,left:n,width:i,height:a}}},C=k.measure(t),M=n.map(k.measure),E=function(e,t){const n="rtl"===t,i="y"===e,a=!i&&n?-1:1,r={scroll:i?"y":"x",cross:i?"x":"y",startEdge:i?"top":n?"right":"left",endEdge:i?"bottom":n?"left":"right",measureSize:function(e){const{height:t,width:n}=e;return i?t:n},direction:function(e){return e*a}};return r}(c,l),S=E.measureSize(C),A=function(e){const t={measure:function(t){return e*(t/100)}};return t}(S),T=function(e,t){const n={start:function(){return 0},center:function(e){return i(e)/2},end:i};function i(e){return t-e}const a={measure:function(i,a){return jT(e)?n[e](i):e(t,i,a)}};return a}(o,S),$=!d&&!!_,O=d||!!_,{slideSizes:I,slideSizesWithGaps:L,startGap:j,endGap:z}=function(e,t,n,i,a,r){const{measureSize:s,startEdge:o,endEdge:c}=e,l=n[0]&&a,u=function(){if(!l)return 0;const e=n[0];return RT(t[o]-e[o])}(),d=function(){if(!l)return 0;const e=r.getComputedStyle(BT(i));return parseFloat(e.getPropertyValue(`margin-${c}`))}(),h=n.map(s),p=n.map(((e,t,n)=>{const i=!t,a=UT(n,t);return i?h[t]+u:a?h[t]+d:n[t+1][o]-e[o]})).map(RT);return{slideSizes:h,slideSizesWithGaps:p,startGap:u,endGap:d}}(E,C,M,n,O,a),D=u$(E,S,g,d,C,M,j,z,2),{snaps:R,snapsAligned:N}=function(e,t,n,i,a){const{startEdge:r,endEdge:s}=e,{groupSlides:o}=a,c=o(i).map((e=>BT(e)[s]-e[0][r])).map(RT).map(t.measure),l=i.map((e=>n[r]-e[r])).map((e=>-RT(e))),u=o(l).map((e=>e[0])).map(((e,t)=>e+c[t]));return{snaps:l,snapsAligned:u}}(E,T,C,M,D),P=-BT(R)+BT(L),{snapsContained:F,scrollContainLimit:B}=function(e,t,n,i,a){const r=QT(-t+e,0),s=n.map(((e,t)=>{const{min:i,max:a}=r,s=r.constrain(e),o=!t,c=UT(n,t);return o?a:c||l(i,s)?i:l(a,s)?a:s})).map((e=>parseFloat(e.toFixed(3)))),o=function(){const e=s[0],t=BT(s);return QT(s.lastIndexOf(e),s.indexOf(t)+1)}(),c=function(){if(t<=e+a)return[r.max];if("keepSnaps"===i)return s;const{min:n,max:c}=o;return s.slice(n,c)}();function l(e,t){return PT(e,t)<1}return{snapsContained:c,scrollContainLimit:o}}(S,P,N,_,2),V=$?F:N,{limit:U}=function(e,t,n){const i=t[0];return{limit:QT(n?i-e:BT(t),i)}}(P,V,d),H=GT(VT(V),u,d),q=H.clone(),W=FT(n),Z=YT(i,a,(e=>(({dragHandler:e,scrollBody:t,scrollBounds:n,options:{loop:i}},a)=>{i||n.constrain(e.pointerDown()),t.seek(a)})(oe,e)),(e=>(({scrollBody:e,translate:t,location:n,offsetLocation:i,scrollLooper:a,slideLooper:r,dragHandler:s,animation:o,eventHandler:c,scrollBounds:l,options:{loop:u}},d)=>{const h=e.settled(),p=!l.shouldConstrain(),m=u?h:h&&p;m&&!s.pointerDown()&&(o.stop(),c.emit("settle")),m||c.emit("scroll");const f=n.get()*d+Q.get()*(1-d);i.set(f),u&&(a.loop(e.direction()),r.loop()),t.to(i.get())})(oe,e))),K=V[H.get()],Y=r$(K),Q=r$(K),G=r$(K),X=r$(K),J=function(e,t,n,i,a,r){let s=0,o=0,c=a,l=r,u=e.get(),d=0;function h(e){return c=e,m}function p(e){return l=e,m}const m={direction:function(){return o},duration:function(){return c},velocity:function(){return s},seek:function(t){const a=t/1e3,r=c*a,h=i.get()-e.get();let p=0;return c?(n.set(e),s+=h/r,s*=l,u+=s,e.add(s*a),p=u-d):(s=0,n.set(i),e.set(i),p=h),o=NT(p),d=u,m},settled:function(){return RT(i.get()-t.get())<.001},useBaseFriction:function(){return p(r)},useBaseDuration:function(){return h(a)},useFriction:p,useDuration:h};return m}(Y,G,Q,X,h,.68),ee=i$(d,V,P,U,X),te=function(e,t,n,i,a,r,s){function o(a){const o=a.distance,c=a.index!==t.get();r.add(o),o&&(i.duration()?e.start():(e.update(),e.render(1),e.update())),c&&(n.set(t.get()),t.set(a.index),s.emit("select"))}const c={distance:function(e,t){o(a.byDistance(e,t))},index:function(e,n){const i=t.clone().set(e);o(a.byIndex(i.get(),n))}};return c}(Z,H,q,J,ee,X,s),ne=function(e){const{max:t,length:n}=e,i={get:function(e){return n?(e-t)/-n:0}};return i}(U),ie=KT(),ae=l$(t,n,s,f),{slideRegistry:re}=function(e,t,n,i,a,r){const{groupSlides:s}=a,{min:o,max:c}=i;return{slideRegistry:function(){const i=s(r),a=!e||"keepSnaps"===t;return 1===n.length?[r]:a?i:i.slice(o,c).map(((e,t,n)=>{const i=!t,a=UT(n,t);return i?HT(BT(n[0])+1):a?HT(VT(r)-BT(n)[0]+1,BT(n)[0]):e}))}()}}($,_,V,B,D,W),se=a$(e,n,re,te,J,ie,s,x),oe={ownerDocument:i,ownerWindow:a,eventHandler:s,containerRect:C,slideRects:M,animation:Z,axis:E,dragHandler:XT(E,e,i,a,X,JT(E,a),Y,Z,te,J,ee,H,s,A,p,m,v,.68,w),eventStore:ie,percentOfView:A,index:H,indexPrevious:q,limit:U,location:Y,offsetLocation:G,previousLocation:Q,options:r,resizeHandler:e$(t,s,a,n,E,y,k),scrollBody:J,scrollBounds:t$(U,G,X,J,A),scrollLooper:n$(P,U,G,[Y,G,Q,X]),scrollProgress:ne,scrollSnapList:V.map(ne.get),scrollSnaps:V,scrollTarget:ee,scrollTo:te,slideLooper:o$(E,S,P,I,L,R,V,G,n),slideFocus:se,slidesHandler:c$(t,s,b),slidesInView:ae,slideIndexes:W,slideRegistry:re,slidesToScroll:D,target:X,translate:s$(E,t)};return oe}const h$={align:"center",axis:"x",container:null,slides:null,containScroll:"trimSnaps",direction:"ltr",slidesToScroll:1,inViewThreshold:0,breakpoints:{},dragFree:!1,dragThreshold:10,loop:!1,skipSnaps:!1,duration:25,startIndex:0,active:!0,watchDrag:!0,watchResize:!0,watchSlides:!0,watchFocus:!0};function p$(e){function t(e,t){return WT(e,t||{})}const n={mergeOptions:t,optionsAtMedia:function(n){const i=n.breakpoints||{},a=qT(i).filter((t=>e.matchMedia(t).matches)).map((e=>i[e])).reduce(((e,n)=>t(e,n)),{});return t(n,a)},optionsMediaQueries:function(t){return t.map((e=>qT(e.breakpoints||{}))).reduce(((e,t)=>e.concat(t)),[]).map(e.matchMedia)}};return n}function m$(e,t,n){const i=e.ownerDocument,a=i.defaultView,r=p$(a),s=function(e){let t=[];const n={init:function(n,i){return t=i.filter((({options:t})=>!1!==e.optionsAtMedia(t).active)),t.forEach((t=>t.init(n,e))),i.reduce(((e,t)=>Object.assign(e,{[t.name]:t})),{})},destroy:function(){t=t.filter((e=>e.destroy()))}};return n}(r),o=KT(),c=function(){let e,t={};function n(e){return t[e]||[]}const i={init:function(t){e=t},emit:function(t){return n(t).forEach((n=>n(e,t))),i},off:function(e,a){return t[e]=n(e).filter((e=>e!==a)),i},on:function(e,a){return t[e]=n(e).concat([a]),i},clear:function(){t={}}};return i}(),{mergeOptions:l,optionsAtMedia:u,optionsMediaQueries:d}=r,{on:h,off:p,emit:m}=c,f=E;let g,v,_,y,b=!1,w=l(h$,m$.globalOptions),x=l(w),k=[];function C(t){const n=d$(e,_,y,i,a,t,c);if(t.loop&&!n.slideLooper.canLoop()){return C(Object.assign({},t,{loop:!1}))}return n}function M(t,n){b||(w=l(w,t),x=u(w),k=n||k,function(){const{container:t,slides:n}=x,i=jT(t)?e.querySelector(t):t;_=i||e.children[0];const a=jT(n)?_.querySelectorAll(n):n;y=[].slice.call(a||_.children)}(),g=C(x),d([w,...k.map((({options:e})=>e))]).forEach((e=>o.add(e,"change",E))),x.active&&(g.translate.to(g.location.get()),g.animation.init(),g.slidesInView.init(),g.slideFocus.init($),g.eventHandler.init($),g.resizeHandler.init($),g.slidesHandler.init($),g.options.loop&&g.slideLooper.loop(),_.offsetParent&&y.length&&g.dragHandler.init($),v=s.init($,k)))}function E(e,t){const n=T();S(),M(l({startIndex:n},e),t),c.emit("reInit")}function S(){g.dragHandler.destroy(),g.eventStore.clear(),g.translate.clear(),g.slideLooper.clear(),g.resizeHandler.destroy(),g.slidesHandler.destroy(),g.slidesInView.destroy(),g.animation.destroy(),s.destroy(),o.clear()}function A(e,t,n){x.active&&!b&&(g.scrollBody.useBaseFriction().useDuration(!0===t?0:x.duration),g.scrollTo.index(e,n||0))}function T(){return g.index.get()}const $={canScrollNext:function(){return g.index.add(1).get()!==T()},canScrollPrev:function(){return g.index.add(-1).get()!==T()},containerNode:function(){return _},internalEngine:function(){return g},destroy:function(){b||(b=!0,o.clear(),S(),c.emit("destroy"),c.clear())},off:p,on:h,emit:m,plugins:function(){return v},previousScrollSnap:function(){return g.indexPrevious.get()},reInit:f,rootNode:function(){return e},scrollNext:function(e){A(g.index.add(1).get(),e,-1)},scrollPrev:function(e){A(g.index.add(-1).get(),e,1)},scrollProgress:function(){return g.scrollProgress.get(g.location.get())},scrollSnapList:function(){return g.scrollSnapList},scrollTo:A,selectedScrollSnap:T,slideNodes:function(){return y},slidesInView:function(){return g.slidesInView.get()},slidesNotInView:function(){return g.slidesInView.get(!1)}};return M(t,n),setTimeout((()=>c.emit("init")),0),$}function f$(){return f$=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},f$.apply(this,arguments)}m$.globalOptions=void 0;var g$=function(e,t){return void 0===t&&(t=.996),e*t/(1-t)};function v$(e,t){if(e.length!==t.length)throw new Error("vectors must be same length");return e.map((function(e,n){return e+t[n]}))}function _$(e){return Math.max.apply(Math,e.map(Math.abs))}function y$(e){return Object.freeze(e),Object.values(e).forEach((function(e){null===e||"object"!=typeof e||Object.isFrozen(e)||y$(e)})),e}var b$=[1,18,"undefined"!=typeof window&&window.innerHeight||800];var w$=[-1,-1,-1];var x$=function(e){return f$({},e,{axisDelta:e.axisDelta.map((function(e){return function(e,t,n){return Math.min(Math.max(t,e),n)}(e,-700,700)}))})},k$=.6,C$=.96,M$=2,E$=5,S$=y$({preventWheelAction:!0,reverseSign:[!0,!0,!1]}),A$=400;function T$(){return{isStarted:!1,isStartPublished:!1,isMomentum:!1,startTime:0,lastAbsDelta:1/0,axisMovement:[0,0,0],axisVelocity:[0,0,0],accelerationFactors:[],scrollPoints:[],scrollPointsToMerge:[],willEndTimeout:A$}}function $$(e){void 0===e&&(e={});var t,n,i,a=function(){var e={};function t(t,n){e[t]=(e[t]||[]).filter((function(e){return e!==n}))}return y$({on:function(n,i){return e[n]=(e[n]||[]).concat(i),function(){return t(n,i)}},off:t,dispatch:function(t,n){t in e&&e[t].forEach((function(e){return e(n)}))}})}(),r=a.on,s=a.off,o=a.dispatch,c=S$,l=T$(),u=!1,d=function(e){Array.isArray(e)?e.forEach((function(e){return m(e)})):m(e)},h=function(e){return void 0===e&&(e={}),Object.values(e).some((function(e){return null==e}))?c:c=y$(f$({},S$,c,e))},p=function(e){var i=f$({event:t,isStart:!1,isEnding:!1,isMomentumCancel:!1,isMomentum:l.isMomentum,axisDelta:[0,0,0],axisVelocity:l.axisVelocity,axisMovement:l.axisMovement,get axisMovementProjection(){return v$(i.axisMovement,i.axisVelocity.map((function(e){return g$(e)})))}},e);o("wheel",f$({},i,{previous:n})),n=i},m=function(e){var n=x$(function(e,t){if(!t)return e;var n=!0===t?w$:t.map((function(e){return e?-1:1}));return f$({},e,{axisDelta:e.axisDelta.map((function(e,t){return e*n[t]}))})}(function(e){var t=e.deltaX*b$[e.deltaMode],n=e.deltaY*b$[e.deltaMode],i=(e.deltaZ||0)*b$[e.deltaMode];return{timeStamp:e.timeStamp,axisDelta:[t,n,i]}}(e),c.reverseSign)),i=n.axisDelta,a=n.timeStamp,r=_$(i);e.preventDefault&&function(e,t){var n=c.preventWheelAction,i=t[0],a=t[1],r=t[2];if("boolean"==typeof n)return n;switch(n){case"x":return Math.abs(i)>=e;case"y":return Math.abs(a)>=e;case"z":return Math.abs(r)>=e;default:return!1}}(r,i)&&e.preventDefault(),l.isStarted?l.isMomentum&&r>Math.max(2,2*l.lastAbsDelta)&&(C(!0),x()):x(),0===r&&Object.is&&Object.is(e.deltaX,-0)?u=!0:(t=e,l.axisMovement=v$(l.axisMovement,i),l.lastAbsDelta=r,l.scrollPointsToMerge.push({axisDelta:i,timeStamp:a}),f(),p({axisDelta:i,isStart:!l.isStartPublished}),l.isStartPublished=!0,k())},f=function(){var e;l.scrollPointsToMerge.length===M$?(l.scrollPoints.unshift({axisDeltaSum:l.scrollPointsToMerge.map((function(e){return e.axisDelta})).reduce(v$),timeStamp:(e=l.scrollPointsToMerge.map((function(e){return e.timeStamp})),e.reduce((function(e,t){return e+t}))/e.length)}),v(),l.scrollPointsToMerge.length=0,l.scrollPoints.length=1,l.isMomentum||b()):l.isStartPublished||g()},g=function(){var e;l.axisVelocity=(e=l.scrollPointsToMerge,e[e.length-1]).axisDelta.map((function(e){return e/l.willEndTimeout}))},v=function(){var e=l.scrollPoints,t=e[0],n=e[1];if(n&&t){var i=t.timeStamp-n.timeStamp;if(!(i<=0)){var a=t.axisDeltaSum.map((function(e){return e/i})),r=a.map((function(e,t){return e/(l.axisVelocity[t]||1)}));l.axisVelocity=a,l.accelerationFactors.push(r),_(i)}}},_=function(e){var t=10*Math.ceil(e/10)*1.2;l.isMomentum||(t=Math.max(100,2*t)),l.willEndTimeout=Math.min(1e3,Math.round(t))},y=function(e){return 0===e||e<=C$&&e>=k$},b=function(){if(l.accelerationFactors.length>=E$){if(u&&(u=!1,_$(l.axisVelocity)>=.2))return void w();var e=l.accelerationFactors.slice(-1*E$);e.every((function(e){var t=!!e.reduce((function(e,t){return e&&e<1&&e===t?1:0})),n=e.filter(y).length===e.length;return t||n}))&&w(),l.accelerationFactors=e}},w=function(){l.isMomentum=!0},x=function(){(l=T$()).isStarted=!0,l.startTime=Date.now(),n=void 0,u=!1},k=function(){clearTimeout(i),i=setTimeout(C,l.willEndTimeout)},C=function(e){void 0===e&&(e=!1),l.isStarted&&(l.isMomentum&&e?p({isEnding:!0,isMomentumCancel:!0}):p({isEnding:!0}),l.isMomentum=!1,l.isStarted=!1)},M=function(e){var t=[],n=function(n){n.removeEventListener("wheel",e),t=t.filter((function(e){return e!==n}))};return y$({observe:function(i){return i.addEventListener("wheel",e,{passive:!1}),t.push(i),function(){return n(i)}},unobserve:n,disconnect:function(){t.forEach(n)}})}(d),E=M.observe,S=M.unobserve,A=M.disconnect;return h(e),y$({on:r,off:s,observe:E,unobserve:S,disconnect:A,feedWheel:d,updateOptions:h})}var O$={active:!0,breakpoints:{},wheelDraggingClass:"is-wheel-dragging",forceWheelAxis:void 0,target:void 0};function I$(e){var t;void 0===e&&(e={});var n=function(){};var i={name:"wheelGestures",options:e,init:function(i,a){var r,s,o=a.mergeOptions,c=a.optionsAtMedia,l=o(O$,I$.globalOptions),u=o(l,e);t=c(u);var d,h=i.internalEngine(),p=null!=(r=t.target)?r:i.containerNode().parentNode,m=null!=(s=t.forceWheelAxis)?s:h.options.axis,f=$$({preventWheelAction:m,reverseSign:[!0,!0,!1]}),g=f.observe(p),v=f.on("wheel",(function(e){var i=e.axisDelta,a=i[0],r=i[1],s="x"===m?a:r,o="x"===m?r:a,c=e.isMomentum&&e.previous&&!e.previous.isMomentum,l=e.isEnding&&!e.isMomentum||c;Math.abs(s)>Math.abs(o)&&!_&&!e.isMomentum&&function(e){try{x(d=new MouseEvent("mousedown",e.event))}catch(e){return n()}_=!0,document.documentElement.addEventListener("mousemove",b,!0),document.documentElement.addEventListener("mouseup",b,!0),void document.documentElement.addEventListener("mousedown",b,!0),t.wheelDraggingClass&&p.classList.add(t.wheelDraggingClass)}(e);if(!_)return;l?function(e){_=!1,x(w("mouseup",e)),y(),t.wheelDraggingClass&&p.classList.remove(t.wheelDraggingClass)}(e):x(w("mousemove",e))})),_=!1;function y(){document.documentElement.removeEventListener("mousemove",b,!0),document.documentElement.removeEventListener("mouseup",b,!0),document.documentElement.removeEventListener("mousedown",b,!0)}function b(e){_&&e.isTrusted&&e.stopImmediatePropagation()}function w(e,t){var n,i;if(m===h.options.axis){var a=t.axisMovement;n=a[0],i=a[1]}else{var r=t.axisMovement;i=r[0],n=r[1]}if(!h.options.skipSnaps&&!h.options.dragFree){var s=h.containerRect.width,o=h.containerRect.height;n=n<0?Math.max(n,-s):Math.min(n,s),i=i<0?Math.max(i,-o):Math.min(i,o)}return new MouseEvent(e,{clientX:d.clientX+n,clientY:d.clientY+i,screenX:d.screenX+n,screenY:d.screenY+i,movementX:n,movementY:i,button:0,bubbles:!0,cancelable:!0,composed:!0})}function x(e){i.containerNode().dispatchEvent(e)}n=function(){g(),v(),y()}},destroy:function(){return n()}};return i}I$.globalOptions=void 0;class L${constructor(e,t,n){this._mutationObserver=new MutationObserver(((e,t)=>this._refreshCarouselContents())),this._refreshCarouselContents=()=>{const e=gg(this._parent);!V_(this._carousel.slideNodes(),e)&&(this._carousel.destroy(),this._carousel=this._createCarousel(e))},this._root=e,this._parent=t,this._direction=n?.direction??"horizontal",this._transitionEffect=n?.transitionEffect??"slide",this._startIndex=n?.startIndex??0,this._dragFree=n?.dragFree??!1,this._loop=n?.loop??!1,this._draggable=n?.dragEnabled??!0,this._plugins=n?.plugins??[],this._textDirection=n?.textDirection??"ltr",this._carousel=this._createCarousel(gg(this._parent)),t instanceof HTMLSlotElement&&t.addEventListener("slotchange",this._refreshCarouselContents),this._mutationObserver.observe(this._parent,{childList:!0})}destroy(){this._parent instanceof HTMLSlotElement&&this._parent.removeEventListener("slotchange",this._refreshCarouselContents),this._mutationObserver.disconnect(),this._carousel.destroy()}getSlide(e){return this._carousel.slideNodes()[e]??null}getSelectedSlide(){return this.getSlide(this.getSelectedIndex())}getSelectedIndex(){return this._carousel.selectedScrollSnap()}selectSlide(e){this._carousel.scrollTo(e,"none"===this._transitionEffect);const t=this.getSlide(e);t&&Gf(this._parent,"carousel:force-select",{index:e,element:t})}_createCarousel(e){const t=m$(this._root,{slides:e,axis:"horizontal"===this._direction?"x":"y",duration:20,startIndex:this._startIndex,dragFree:this._dragFree,loop:this._loop,containScroll:"trimSnaps",watchSlides:!1,watchResize:!0,watchDrag:this._draggable,direction:this._textDirection},[...this._plugins,...e.length>1?[I$({forceWheelAxis:"y"})]:[]]),n=()=>{const e=(()=>{const e=t.selectedScrollSnap(),n=t.slideNodes()[e]??null;return n?{index:e,element:n}:null})();e&&Gf(this._parent,"carousel:select",e)};return t.on("select",(()=>n())),t}}const j$=e=>"rtl"===getComputedStyle(e).direction?"rtl":"ltr";let z$=class extends oe{constructor(){super(...arguments),this.direction="horizontal",this.dragEnabled=!0,this.selected=0,this._refParent=Te(),this._refRoot=Te(),this._carousel=null}connectedCallback(){super.connectedCallback(),this.requestUpdate()}disconnectedCallback(){this._carousel?.destroy(),this._carousel=null,super.disconnectedCallback()}willUpdate(e){e.has("direction")&&this.setAttribute("direction",this.direction);["direction","dragEnabled","dragFree","loop","plugins","transitionEffect"].some((t=>e.has(t)))&&(this._carousel?.destroy(),this._carousel=null)}render(){return H` <div class="embla">
      <slot name="left"></slot>
      <div ${Ie(this._refRoot)} class="embla__viewport">
        <div class="embla__container">
          <slot ${Ie(this._refParent)}></slot>
        </div>
      </div>
      <slot name="right"></slot>
    </div>`}updated(e){!this._carousel&&this._refRoot.value&&this._refParent.value?this._carousel=new L$(this._refRoot.value,this._refParent.value,{direction:this.direction,dragEnabled:this.dragEnabled,dragFree:this.dragFree,startIndex:this.selected,transitionEffect:this.transitionEffect,loop:this.loop,plugins:this.plugins,textDirection:j$(this)}):e.has("selected")&&this._carousel?.selectSlide(this.selected)}static get styles(){return s(":host {\n  display: block;\n  height: 100%;\n  width: 100%;\n  position: relative;\n}\n\n.embla {\n  width: 100%;\n  height: 100%;\n  margin-left: auto;\n  margin-right: auto;\n}\n\n.embla__container {\n  display: flex;\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  -webkit-touch-callout: none;\n  -khtml-user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n\n:host([direction=vertical]) .embla__container {\n  flex-direction: column;\n}\n\n:host([direction=horizontal]) .embla__container {\n  flex-direction: row;\n}\n\n.embla__viewport {\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.embla__viewport.is-draggable {\n  cursor: move;\n  cursor: grab;\n}\n\n.embla__viewport.is-dragging {\n  cursor: grabbing;\n}\n\n:host([direction=vertical]) ::slotted(.embla__slide) {\n  margin-bottom: 5px;\n}\n\n:host([direction=horizontal]) ::slotted(.embla__slide) {\n  margin-right: 5px;\n}")}};e([he({attribute:!0,reflect:!0})],z$.prototype,"direction",void 0),e([he({attribute:!0})],z$.prototype,"transitionEffect",void 0),e([he({attribute:!1})],z$.prototype,"loop",void 0),e([he({attribute:!1})],z$.prototype,"dragFree",void 0),e([he({attribute:!1})],z$.prototype,"dragEnabled",void 0),e([he({attribute:!1})],z$.prototype,"plugins",void 0),e([he({attribute:!1})],z$.prototype,"selected",void 0),z$=e([le("advanced-camera-card-carousel")],z$);
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const D$=window,R$=D$.ShadowRoot&&(void 0===D$.ShadyCSS||D$.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,N$=Symbol(),P$=new WeakMap;let F$=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==N$)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(R$&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=P$.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&P$.set(t,e))}return e}toString(){return this.cssText}};const B$=(e,t)=>{R$?e.adoptedStyleSheets=t.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):t.forEach((t=>{const n=document.createElement("style"),i=D$.litNonce;void 0!==i&&n.setAttribute("nonce",i),n.textContent=t.cssText,e.appendChild(n)}))},V$=R$?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return(e=>new F$("string"==typeof e?e:e+"",void 0,N$))(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var U$;const H$=window,q$=H$.trustedTypes,W$=q$?q$.emptyScript:"",Z$=H$.reactiveElementPolyfillSupport,K$={toAttribute(e,t){switch(t){case Boolean:e=e?W$:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},Y$=(e,t)=>t!==e&&(t==t||e==e),Q$={attribute:!0,type:String,converter:K$,reflect:!1,hasChanged:Y$},G$="finalized";class X$ extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this._$Eu()}static addInitializer(e){var t;this.finalize(),(null!==(t=this.h)&&void 0!==t?t:this.h=[]).push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const i=this._$Ep(n,t);void 0!==i&&(this._$Ev.set(i,n),e.push(i))})),e}static createProperty(e,t=Q$){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,i=this.getPropertyDescriptor(e,n,t);void 0!==i&&Object.defineProperty(this.prototype,e,i)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(i){const a=this[e];this[t]=i,this.requestUpdate(e,a,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||Q$}static finalize(){if(this.hasOwnProperty(G$))return!1;this[G$]=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),void 0!==e.h&&(this.h=[...e.h]),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(V$(e))}else void 0!==e&&t.push(V$(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}_$Eu(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var e;const t=null!==(e=this.shadowRoot)&&void 0!==e?e:this.attachShadow(this.constructor.shadowRootOptions);return B$(t,this.constructor.elementStyles),t}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=Q$){var i;const a=this.constructor._$Ep(e,n);if(void 0!==a&&!0===n.reflect){const r=(void 0!==(null===(i=n.converter)||void 0===i?void 0:i.toAttribute)?n.converter:K$).toAttribute(t,n.type);this._$El=e,null==r?this.removeAttribute(a):this.setAttribute(a,r),this._$El=null}}_$AK(e,t){var n;const i=this.constructor,a=i._$Ev.get(e);if(void 0!==a&&this._$El!==a){const e=i.getPropertyOptions(a),r="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:K$;this._$El=a,this[a]=r.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let i=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||Y$)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):i=!1),!this.isUpdatePending&&i&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}X$[G$]=!0,X$.elementProperties=new Map,X$.elementStyles=[],X$.shadowRootOptions={mode:"open"},null==Z$||Z$({ReactiveElement:X$}),(null!==(U$=H$.reactiveElementVersions)&&void 0!==U$?U$:H$.reactiveElementVersions=[]).push("1.6.3");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const J$=0,eO=Symbol();let tO=class{constructor(e,t,n){this.o=0,this.status=0,this.autoRun=!0,this.i=e,this.i.addController(this);const i="object"==typeof t?t:{task:t,args:n};this.t=i.task,this.h=i.args,void 0!==i.autoRun&&(this.autoRun=i.autoRun),this.taskComplete=new Promise(((e,t)=>{this.l=e,this.u=t}))}hostUpdated(){this.performTask()}async performTask(){var e;const t=null===(e=this.h)||void 0===e?void 0:e.call(this);this.shouldRun(t)&&this.run(t)}shouldRun(e){return this.autoRun&&this.v(e)}async run(e){var t;let n,i;null!=e||(e=null===(t=this.h)||void 0===t?void 0:t.call(this)),2!==this.status&&3!==this.status||(this.taskComplete=new Promise(((e,t)=>{this.l=e,this.u=t}))),this.status=1,this._=void 0,this.m=void 0,this.i.requestUpdate();const a=++this.o;try{n=await this.t(e)}catch(e){i=e}this.o===a&&(n===eO?this.status=0:(void 0===i?(this.status=2,this.l(n)):(this.status=3,this.u(i)),this.m=n,this._=i),this.i.requestUpdate())}get value(){return this.m}get error(){return this._}render(e){var t,n,i,a;switch(this.status){case 0:return null===(t=e.initial)||void 0===t?void 0:t.call(e);case 1:return null===(n=e.pending)||void 0===n?void 0:n.call(e);case 2:return null===(i=e.complete)||void 0===i?void 0:i.call(e,this.value);case 3:return null===(a=e.error)||void 0===a?void 0:a.call(e,this.error);default:this.status}}v(e){const t=this.T;return this.T=e,Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.some(((e,n)=>Y$(e,t[n]))):e!==t}};class nO{constructor(e){this._keys=e}modify(e){this._keys.forEach((t=>e.removeContext(t)))}}var iO=":host {\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  margin-left: 5px;\n  padding: 5px;\n  color: var(--advanced-camera-card-thumbnail-text-color);\n  overflow: hidden;\n  column-gap: 5%;\n}\n\ndiv.title {\n  font-size: 1.2rem;\n  font-weight: bold;\n}\n\ndiv.details {\n  flex: 1;\n  justify-content: center;\n  display: flex;\n  flex-direction: column;\n  flex-wrap: wrap;\n  --mdc-icon-size: 16px;\n  min-height: 0px;\n}\n\ndiv.details div {\n  display: flex;\n  align-items: center;\n}\n\ndiv.details div * {\n  margin: 0px 3px;\n}";function aO(e){return H`
    <advanced-camera-card-progress-indicator
      class="${ve(e?.classes??{})}"
      .size=${e?.size}
      ${e?.componentRef?Ie(e.componentRef):""}
      .message=${e?.message||""}
      .animated=${e?.cardWideConfig?.performance?.features.animated_progress_indicator??!0}
    >
    </advanced-camera-card-progress-indicator>
  `}let rO=class extends oe{constructor(){super(...arguments),this.message="",this.animated=!1,this.size="large"}render(){return H` <div class="message vertical">
      ${this.animated?H`<ha-circular-progress indeterminate size="${this.size}">
          </ha-circular-progress>`:H`<advanced-camera-card-icon
            .icon=${{icon:"mdi:timer-sand"}}
          ></advanced-camera-card-icon>`}
      ${this.message?H`<span>${this.message}</span>`:H``}
    </div>`}static get styles(){return s(ST)}};e([he({attribute:!1})],rO.prototype,"message",void 0),e([he({attribute:!1})],rO.prototype,"animated",void 0),e([he({attribute:!1})],rO.prototype,"size",void 0),rO=e([le("advanced-camera-card-progress-indicator")],rO);const sO=(e,t,n)=>{const i={...n?.cardWideConfig&&{cardWideConfig:n.cardWideConfig}};return H` ${e.render({initial:()=>n?.inProgressFunc?.()??aO(i),pending:()=>n?.inProgressFunc?.()??aO(i),error:e=>{ig(e),n?.errorFunc&&n.errorFunc(e)},complete:t})}`},oO=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,cO=(e,t,n,i=!0)=>new tO(e,{args:()=>[!!t(),n()],task:async([e,n])=>{const i=t();return e&&i&&n?(async(e,t)=>e&&t?t.startsWith("data:")||t.match(oO)?t:new Promise(((n,i)=>{e?e.fetchWithAuth(t).then((e=>e.blob())).then((e=>{const t=new FileReader;t.onload=()=>{const e=t.result;n("string"==typeof e?e:null)},t.onerror=e=>i(e),t.readAsDataURL(e)})).catch((e=>i(e))):i()})):null)(i,n):null},autoRun:i}),lO=300;let uO=class extends oe{constructor(){super(),this._thumbnailError=!1,this._intersectionObserver=new IntersectionObserver(this._intersectionHandler.bind(this))}connectedCallback(){this._intersectionObserver.observe(this),super.connectedCallback()}disconnectedCallback(){super.disconnectedCallback(),this._intersectionObserver.disconnect()}willUpdate(e){e.has("thumbnail")&&(this._embedThumbnailTask=cO(this,(()=>this.hass),(()=>this.thumbnail),!1),this._intersectionObserver.unobserve(this),this._intersectionObserver.observe(this))}_intersectionHandler(e){this._embedThumbnailTask?.status===J$&&e.some((e=>e.isIntersecting))&&this._embedThumbnailTask?.run()}render(){const e=H`<advanced-camera-card-icon
      .icon=${{icon:"mdi:image-off"}}
      title=${Kv("thumbnail.no_thumbnail")}
    ></advanced-camera-card-icon> `;return!this._embedThumbnailTask||this._thumbnailError?e:H`${this.thumbnail?sO(this._embedThumbnailTask,(e=>e?H`<img src="${e}" />`:H``),{inProgressFunc:()=>e,errorFunc:()=>{this._thumbnailError=!0}}):e} `}static get styles(){return s(":host {\n  display: block;\n  overflow: hidden;\n  aspect-ratio: 1/1;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\nimg {\n  display: block;\n}\n\nimg,\nadvanced-camera-card-icon {\n  display: inline-block;\n  vertical-align: top;\n  margin: 0;\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  width: var(--advanced-camera-card-thumbnail-size);\n  max-height: 100%;\n  aspect-ratio: 1/1;\n  object-fit: cover;\n}\n\nadvanced-camera-card-icon {\n  --mdc-icon-size: 50%;\n  color: var(--primary-text-color);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  border: 1px solid rgba(255, 255, 255, 0.3);\n  box-sizing: border-box;\n  opacity: 0.2;\n}")}};e([he({attribute:!1})],uO.prototype,"thumbnail",void 0),e([he({attribute:!1})],uO.prototype,"hass",void 0),e([pe()],uO.prototype,"_thumbnailError",void 0),uO=e([le("advanced-camera-card-thumbnail-feature-thumbnail")],uO);let dO=class extends oe{render(){if(this.date)return H`
      ${this.cameraMetadata?.engineIcon?H`<advanced-camera-card-icon
            class="background"
            .icon=${{icon:this.cameraMetadata.engineIcon}}
          ></advanced-camera-card-icon>`:""}
      <div class="content">
        <div class="title">${Jd(this.date,"HH:mm")}</div>
        <div class="subtitle">${Jd(this.date,"MMM do")}</div>
        ${this.showCameraTitle&&this.cameraMetadata?.title?H`<div class="camera">${this.cameraMetadata.title}</div>`:H``}
      </div>
    `}static get styles(){return s(":host {\n  display: block;\n  max-width: var(--advanced-camera-card-thumbnail-size);\n  max-height: var(--advanced-camera-card-thumbnail-size);\n  aspect-ratio: 1/1;\n  border: 1px solid var(--secondary-color);\n  background-color: var(--secondary-background-color);\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  overflow: hidden;\n  padding: 10px;\n  box-sizing: border-box;\n  position: relative;\n}\n\nadvanced-camera-card-icon.background {\n  display: block;\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  inset: 0;\n  padding: 10%;\n  box-sizing: border-box;\n  pointer-events: none;\n  opacity: 0.1;\n}\n\ndiv.content {\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  color: var(--primary-text-color);\n}\n\ndiv {\n  text-align: center;\n}\n\ndiv.title {\n  font-size: 1.5rem;\n}\n\ndiv.camera {\n  font-size: 0.7em;\n}")}};e([he({attribute:!1})],dO.prototype,"date",void 0),e([he({attribute:!1})],dO.prototype,"cameraMetadata",void 0),e([he({attribute:!1})],dO.prototype,"showCameraTitle",void 0),dO=e([le("advanced-camera-card-thumbnail-feature-text")],dO);let hO=class extends oe{render(){if(!this.media)return;const e=this.media.getScore(),t=e?(100*e).toFixed(2)+"%":null,n=this.media.getStartTime(),i=n?rg(n):null,a=this.media.getEndTime(),r=n&&a?cg(n,a):null,s=this.media.inProgress()?Kv("event.in_progress"):null,o=Xf(this.media.getWhat()?.join(", "))??null,c=Xf(this.media.getWhere()?.join(", "))??null,l=Xf(this.media.getTags()?.join(", "))??null,u=o||l?(o??"")+(o&&l?": ":"")+(l??""):null,d=this.seek?Jd(this.seek,"HH:mm:ss"):null;return H`
      ${u?H` <div class="title">
            <span title=${u}>${u}</span>
            ${t?H`<span title="${t}">${t}</span>`:""}
          </div>`:""}
      <div class="details">
        ${i?H` <div>
                <advanced-camera-card-icon
                  title=${Kv("event.start")}
                  .icon=${{icon:"mdi:calendar-clock-outline"}}
                ></advanced-camera-card-icon>
                <span title="${i}">${i}</span>
              </div>
              ${r||s?H` <div>
                    <advanced-camera-card-icon
                      title=${Kv("event.duration")}
                      .icon=${{icon:"mdi:clock-outline"}}
                    ></advanced-camera-card-icon>
                    ${r?H`<span title="${r}">${r}</span>`:""}
                    ${s?H`<span title="${s}">${s}</span>`:""}
                  </div>`:""}`:""}
        ${this.cameraTitle?H` <div>
              <advanced-camera-card-icon
                title=${Kv("event.camera")}
                .icon=${{icon:"mdi:cctv"}}
              ></advanced-camera-card-icon>
              <span title="${this.cameraTitle}">${this.cameraTitle}</span>
            </div>`:""}
        ${c?H` <div>
              <advanced-camera-card-icon
                title=${Kv("event.where")}
                .icon=${{icon:"mdi:map-marker-outline"}}
              ></advanced-camera-card-icon>
              <span title="${c}">${c}</span>
            </div>`:H``}
        ${l?H` <div>
              <advanced-camera-card-icon
                title=${Kv("event.tag")}
                .icon=${{icon:"mdi:tag"}}
              ></advanced-camera-card-icon>
              <span title="${l}">${l}</span>
            </div>`:H``}
        ${d?H` <div>
              <advanced-camera-card-icon
                title=${Kv("event.seek")}
                .icon=${{icon:"mdi:clock-fast"}}
              ></advanced-camera-card-icon>
              <span title="${d}">${d}</span>
            </div>`:H``}
      </div>
    `}static get styles(){return s(iO)}};e([he({attribute:!1})],hO.prototype,"media",void 0),e([he({attribute:!1})],hO.prototype,"seek",void 0),e([he({attribute:!1})],hO.prototype,"cameraTitle",void 0),hO=e([le("advanced-camera-card-thumbnail-details-event")],hO);let pO=class extends oe{render(){if(!this.media)return;const e=this.media.getStartTime(),t=e?rg(e):null,n=this.media.getEndTime(),i=e&&n?cg(e,n):null,a=this.media.inProgress()?Kv("recording.in_progress"):null,r=this.seek?Jd(this.seek,"HH:mm:ss"):null,s=this.media.getEventCount();return H`
      ${this.cameraTitle?H` <div class="title">
            <span title="${this.cameraTitle}">${this.cameraTitle}</span>
          </div>`:""}
      <div class="details">
        ${t?H` <div>
                <advanced-camera-card-icon
                  title=${Kv("recording.start")}
                  .icon=${{icon:"mdi:calendar-clock-outline"}}
                ></advanced-camera-card-icon>
                <span title="${t}">${t}</span>
              </div>
              ${i||a?H` <div>
                    <advanced-camera-card-icon
                      title=${Kv("recording.duration")}
                      .icon=${{icon:"mdi:clock-outline"}}
                    ></advanced-camera-card-icon>
                    ${i?H`<span title="${i}">${i}</span>`:""}
                    ${a?H`<span title="${a}">${a}</span>`:""}
                  </div>`:""}`:""}
        ${r?H` <div>
              <advanced-camera-card-icon
                title=${Kv("event.seek")}
                .icon=${{icon:"mdi:clock-fast"}}
              ></advanced-camera-card-icon>
              <span title="${r}">${r}</span>
            </div>`:H``}
        ${null!==s?H`<div>
              <advanced-camera-card-icon
                title=${Kv("recording.events")}
                .icon=${{icon:"mdi:shield-alert"}}
              ></advanced-camera-card-icon>
              <span title="${s}">${s}</span>
            </div>`:""}
      </div>
    `}static get styles(){return s(iO)}};e([he({attribute:!1})],pO.prototype,"media",void 0),e([he({attribute:!1})],pO.prototype,"seek",void 0),e([he({attribute:!1})],pO.prototype,"cameraTitle",void 0),pO=e([le("advanced-camera-card-thumbnail-details-recording")],pO);let mO=class extends oe{constructor(){super(...arguments),this.details=!1,this.show_favorite_control=!1,this.show_timeline_control=!1,this.show_download_control=!1}render(){if(!this.media||!this.cameraManager||!this.hass)return;const e=this.media.getThumbnail(),t=this.media.getTitle()??"",n={star:!0,starred:!!this.media?.isFavorite()},i=this.show_timeline_control&&(!Yw.isRecording(this.media)||this.media.getStartTime()&&this.media.getEndTime()),a=this.cameraManager?.getMediaCapabilities(this.media),r=this.show_favorite_control&&this.media&&this.hass&&a?.canFavorite,s=this.show_download_control&&this.hass&&this.media.getID()&&a?.canDownload,o=this.cameraManager.getCameraMetadata(this.media.getCameraID());return H`
      ${Yw.isEvent(this.media)&&e?H`<advanced-camera-card-thumbnail-feature-thumbnail
            aria-label="${t??""}"
            title=${t}
            .hass=${this.hass}
            .date=${this.media.getStartTime()??void 0}
            .thumbnail=${e??void 0}
          ></advanced-camera-card-thumbnail-feature-thumbnail>`:Yw.isEvent(this.media)||Yw.isRecording(this.media)?H`<advanced-camera-card-thumbnail-feature-text
              aria-label="${t??""}"
              title="${t??""}"
              .cameraMetadata=${o}
              .showCameraTitle=${!this.details}
              .date=${this.media.getStartTime()??void 0}
            ></advanced-camera-card-thumbnail-feature-text>`:H``}
      ${r?H` <advanced-camera-card-icon
            class="${ve(n)}"
            title=${Kv("thumbnail.retain_indefinitely")}
            .icon=${{icon:this.media.isFavorite()?"mdi:star":"mdi:star-outline"}}
            @click=${async e=>{if(Ag(e),this.hass&&this.media){try{await(this.cameraManager?.favoriteMedia(this.media,!this.media?.isFavorite()))}catch(e){return void ig(e)}this.requestUpdate()}}}
          /></advanced-camera-card-icon>`:""}
      ${this.details&&Yw.isEvent(this.media)?H`<advanced-camera-card-thumbnail-details-event
            .media=${this.media??void 0}
            .cameraTitle=${o?.title}
            .seek=${this.seek}
          ></advanced-camera-card-thumbnail-details-event>`:this.details&&Yw.isRecording(this.media)?H`<advanced-camera-card-thumbnail-details-recording
              .media=${this.media??void 0}
              .cameraTitle=${o?.title}
              .seek=${this.seek}
            ></advanced-camera-card-thumbnail-details-recording>`:H``}
      ${i?H`<advanced-camera-card-icon
            class="timeline"
            .icon=${{icon:"mdi:target"}}
            title=${Kv("thumbnail.timeline")}
            @click=${e=>{Ag(e),this.viewManagerEpoch&&this.media&&this.viewManagerEpoch.manager.setViewByParameters({params:{view:"timeline",queryResults:this.viewManagerEpoch?.manager.getView()?.queryResults?.clone().selectResultIfFound((e=>e===this.media))},modifiers:[new nO(["timeline"])]})}}
          ></advanced-camera-card-icon>`:""}
      ${s?H` <advanced-camera-card-icon
            class="download"
            .icon=${{icon:"mdi:download"}}
            title=${Kv("thumbnail.download")}
            @click=${async e=>{if(Ag(e),this.hass&&this.cameraManager&&this.media)try{await kw(this.hass,this.cameraManager,this.media)}catch(e){cE(this,e)}}}
          ></advanced-camera-card-icon>`:""}
    `}static get styles(){return s(":host {\n  display: flex;\n  flex-direction: row;\n  box-sizing: border-box;\n  position: relative;\n  overflow: hidden;\n  transition: transform 0.2s linear;\n}\n\n:host(:not([details])) {\n  aspect-ratio: 1/1;\n}\n\n:host([details]) {\n  border: 1px solid var(--advanced-camera-card-thumbnail-border-color);\n  border-radius: var(--advanced-camera-card-css-border-radius, var(--ha-card-border-radius, 4px));\n  padding: 2px;\n  background-color: var(--advanced-camera-card-thumbnail-background);\n}\n\n:host(:hover) {\n  transform: scale(1.04);\n}\n\nadvanced-camera-card-icon {\n  position: absolute;\n  border-radius: 50%;\n  color: var(--advanced-camera-card-thumbnail-icon-color);\n  cursor: pointer;\n  transition: opacity 0.2s ease-in-out, color 0.2s ease-in-out;\n}\n\nadvanced-camera-card-icon:hover {\n  opacity: 1;\n}\n\nadvanced-camera-card-icon.star {\n  top: 3px;\n  left: 3px;\n}\n\nadvanced-camera-card-icon.star.starred {\n  color: var(--advanced-camera-card-thumbnail-icon-favorite-color);\n}\n\nadvanced-camera-card-icon.timeline {\n  top: 3px;\n  right: 3px;\n}\n\nadvanced-camera-card-icon.download {\n  right: 3px;\n  bottom: 3px;\n}\n\nadvanced-camera-card-thumbnail-details-event,\nadvanced-camera-card-thumbnail-details-recording {\n  flex: 1;\n}")}};e([he({attribute:!1})],mO.prototype,"cameraManager",void 0),e([he({attribute:!1})],mO.prototype,"media",void 0),e([he({attribute:!0,type:Boolean})],mO.prototype,"details",void 0),e([he({attribute:!0,type:Boolean})],mO.prototype,"show_favorite_control",void 0),e([he({attribute:!0,type:Boolean})],mO.prototype,"show_timeline_control",void 0),e([he({attribute:!0,type:Boolean})],mO.prototype,"show_download_control",void 0),e([he({attribute:!1})],mO.prototype,"seek",void 0),mO=e([le("advanced-camera-card-thumbnail")],mO);let fO=class extends oe{constructor(){super(...arguments),this.fadeThumbnails=!1,this._thumbnailSlides=[]}willUpdate(e){if(e.has("config")){this.config?.size&&this.style.setProperty("--advanced-camera-card-thumbnail-size",`${this.config.size}px`);const e=this._getDirection();e?this.setAttribute("direction",e):this.removeAttribute("direction")}["cameraManager","config","transitionEffect","viewManagerEpoch"].some((t=>e.has(t)))&&(this._thumbnailSlides=this._renderSlides()),e.has("viewManagerEpoch")&&this.style.setProperty("--advanced-camera-card-carousel-thumbnail-opacity",this.fadeThumbnails&&null!==this._getSelectedSlide()?"0.4":"1.0")}_getSelectedSlide(){return this.viewManagerEpoch?.manager.getView()?.queryResults?.getSelectedIndex()??null}_renderSlides(){const e=[],t=this.viewManagerEpoch?.manager.getView(),n=t?.context?.mediaViewer?.seek,i=this._getSelectedSlide();for(const a of t?.queryResults?.getResults()??[]){const t=e.length,r={embla__slide:!0,"slide-selected":i===t};e.push(H` <advanced-camera-card-thumbnail
          class="${ve(r)}"
          .cameraManager=${this.cameraManager}
          .hass=${this.hass}
          .media=${a}
          .viewManagerEpoch=${this.viewManagerEpoch}
          .seek=${n&&a.includesTime(n)?n:void 0}
          ?details=${!!this.config?.show_details}
          ?show_favorite_control=${this.config?.show_favorite_control}
          ?show_timeline_control=${this.config?.show_timeline_control}
          ?show_download_control=${this.config?.show_download_control}
          @click=${e=>{const n=this.viewManagerEpoch?.manager.getView();n&&n.queryResults&&Gf(this,"thumbnail-carousel:tap",{queryResults:n.queryResults.clone().selectIndex(t)}),Ag(e)}}
        >
        </advanced-camera-card-thumbnail>`)}return e}_getDirection(){return"left"===this.config?.mode||"right"===this.config?.mode?"vertical":"above"===this.config?.mode||"below"===this.config?.mode?"horizontal":null}render(){const e=this._getDirection();if(this._thumbnailSlides.length&&this.config&&e)return H`<advanced-camera-card-carousel
      direction=${e}
      .selected=${this._getSelectedSlide()??0}
      .dragFree=${!0}
    >
      ${this._thumbnailSlides}
    </advanced-camera-card-carousel>`}static get styles(){return s(":host {\n  --advanced-camera-card-thumbnail-size-max: 300px;\n  --advanced-camera-card-thumbnail-details-width: calc(\n    var(--advanced-camera-card-thumbnail-size) + 200px\n  );\n}\n\n:host {\n  display: block;\n  width: 100%;\n  height: 100%;\n  background-color: var(--advanced-camera-card-thumbnail-background);\n  --advanced-camera-card-carousel-thumbnail-opacity: 1;\n}\n\n:host([direction=vertical]) {\n  height: 100%;\n}\n\n:host([direction=horizontal]) {\n  height: auto;\n}\n\n.embla__slide {\n  flex: 0 0 auto;\n  opacity: var(--advanced-camera-card-carousel-thumbnail-opacity);\n}\n\n.embla__slide.slide-selected {\n  opacity: 1;\n}\n\nadvanced-camera-card-thumbnail {\n  width: var(--advanced-camera-card-thumbnail-size);\n  height: var(--advanced-camera-card-thumbnail-size);\n  max-width: 100%;\n}\n\nadvanced-camera-card-thumbnail[details] {\n  width: var(--advanced-camera-card-thumbnail-details-width);\n}")}};e([he({attribute:!1})],fO.prototype,"hass",void 0),e([he({attribute:!1})],fO.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1})],fO.prototype,"cameraManager",void 0),e([he({attribute:!1})],fO.prototype,"config",void 0),e([he({attribute:!1})],fO.prototype,"fadeThumbnails",void 0),fO=e([le("advanced-camera-card-thumbnail-carousel")],fO);var gO=":host {\n  width: 100%;\n  height: 100%;\n  display: block;\n}";const vO=document.createElement("template");vO.innerHTML='<style>\n:host {\n  background-color: #ffffff;\n  width: 350px;\n  max-width: 75vw;\n\n  visibility: hidden;\n  transition: visibility 0.5s;\n}\n\n:host([open]) {\n  visibility: visible;\n}\n\n::slotted(div) {\n  box-sizing: border-box;\n}\n\n#d {\n  position: fixed;\n  z-index: 99;\n  background-color: inherit;\n  -webkit-overflow-scrolling: touch;\n  overflow: auto;\n  overscroll-behavior: contain;\n  backdrop-filter: var(--side-drawer-backdrop-filter, none);\n\n  top: 0;\n  bottom: 0;\n  left: 0;\n  height: 100%;\n  box-sizing: border-box;\n  transform: translateX(-100%);\n  transition: var(\n    --side-drawer-transition,\n    transform 0.25s ease-out\n  );\n  width: inherit;\n  max-width: inherit;\n  border-top-right-radius: inherit;\n  border-bottom-right-radius: inherit;\n}\n\n:host([open]) #d {\n  transform: none;\n  box-shadow: 0px 0px 25px 0px rgba(0, 0, 0, 0.5);\n}\n\n#fs {\n  position: fixed;\n  z-index: 98;\n  background-color: #000000;\n  backdrop-filter: var(--side-drawer-backdrop-filter, none);\n\n  top: 0;\n  bottom: 0;\n  right: -30px; /* hide scrollbar until overscroll bug is fixed */\n  height: 100vh;\n  transition: var(\n    --side-drawer-overlay-transition,\n    opacity linear 0.25s\n  );\n  width: calc(\n    100vw + 30px\n  ); /* put back to just 100vw once overscroll bug fixed */\n  opacity: 0;\n  visibility: hidden;\n\n  overflow: auto;\n  overscroll-behavior: contain;\n}\n\n:host([open]) #fs {\n  opacity: var(--side-drawer-overlay-opacity, 0.7);\n  visibility: visible;\n}\n\n/*\n   * Workaround for bug https://bugs.chromium.org/p/chromium/issues/detail?id=813094\n   * Once bug is fixed and in the wild we can remove this element and make #if overflow:hidden\n   * and set "right: 0; width: 100vw" for #fs\n   */\n#ifs {\n  height: calc(100vh + 1px);\n}\n</style>\n<div id="d"><slot></slot></div>\n<div id="fs"><div id="ifs"></div></div>\n';class _O extends HTMLElement{constructor(){super();const e=this.attachShadow({mode:"open"});e.appendChild(vO.content.cloneNode(!0)),this._freeSpaceDiv=e.getElementById("fs")}connectedCallback(){this._freeSpaceDiv&&this._freeSpaceDiv.addEventListener("click",this.handleFreeSpaceDivClick),this.upgradeProperty("open")}disconnectedCallback(){document.removeEventListener("keyup",this.handleKeyUp)}upgradeProperty(e){if(this.hasOwnProperty(e)){let t=this[e];delete this[e],this[e]=t}}handleKeyUp=e=>{if(!e.altKey&&"Escape"===e.key)e.preventDefault(),this.open=!1};get open(){return this.hasAttribute("open")}set open(e){e?this.hasAttribute("open")||this.setAttribute("open",""):this.hasAttribute("open")&&this.removeAttribute("open")}static get observedAttributes(){return["open"]}attributeChangedCallback(e,t,n){"open"===e&&(this.open?(this.setAttribute("tabindex","0"),this.setAttribute("aria-disabled","false"),this.focus({preventScroll:!0}),document.addEventListener("keyup",this.handleKeyUp),this.dispatchEvent(new CustomEvent("open",{bubbles:!0}))):(this.setAttribute("tabindex","-1"),this.setAttribute("aria-disabled","true"),document.removeEventListener("keyup",this.handleKeyUp),this.dispatchEvent(new CustomEvent("close",{bubbles:!0}))))}handleFreeSpaceDivClick=()=>{this.open=!1}}customElements.define("side-drawer",_O);let yO=class extends oe{constructor(){super(...arguments),this.location="left",this.control=!0,this.open=!1,this.empty=!0,this._refDrawer=Te(),this._refSlot=Te(),this._resizeObserver=new ResizeObserver((()=>this._hideDrawerIfNecessary())),this._isHoverableDevice=ag()}firstUpdated(e){super.firstUpdated(e);const t=document.createElement("style");t.innerHTML=":host {\n  width: unset;\n}\n\n#fs {\n  display: none;\n  width: 100%;\n  inset: 0;\n}\n\n#d,\n#fs {\n  height: 100%;\n  position: absolute;\n}\n\n#d {\n  overflow: visible;\n  max-width: 90%;\n  z-index: 10;\n}\n\n:host([location=right]) #d {\n  left: unset;\n  right: 0;\n  transform: translateX(100%);\n}\n\n:host([location=right][open]) #d {\n  transform: none;\n  box-shadow: var(--advanced-camera-card-css-box-shadow, 0px 0px 25px 0px black);\n}\n\n#ifs {\n  height: 100%;\n}",this._refDrawer.value?.shadowRoot?.appendChild(t)}_slotChanged(){const e=this._refSlot.value?gg(this._refSlot.value):[];this._resizeObserver.disconnect();for(const t of e)this._resizeObserver.observe(t);this._hideDrawerIfNecessary()}_hideDrawerIfNecessary(){if(!this._refDrawer.value)return;const e=this._refSlot.value?gg(this._refSlot.value):null;this.empty=!e||!e.length||e.every((e=>{const t=e.getBoundingClientRect();return!t.width||!t.height}))}render(){return H`
      <side-drawer
        ${Ie(this._refDrawer)}
        location="${this.location}"
        ?open=${this.open}
        @mouseleave=${()=>{this.open&&(this.open=!1)}}
      >
        ${this.control?H`
              <div
                class="control-surround"
                @click=${e=>{Ag(e),this.open=!this.open}}
              >
                <advanced-camera-card-icon
                  class="control"
                  .icon="${{icon:this.open?this.icons?.open??"mdi:menu-open":this.icons?.closed??"mdi:menu"}}"
                  @mouseenter=${()=>{this._isHoverableDevice&&!this.open&&(this.open=!0)}}
                >
                </advanced-camera-card-icon>
              </div>
            `:""}
        <slot ${Ie(this._refSlot)} @slotchange=${()=>this._slotChanged()}></slot>
      </side-drawer>
    `}static get styles(){return s("side-drawer {\n  background-color: var(--card-background-color);\n}\n\ndiv.control-surround {\n  position: absolute;\n  bottom: 50%;\n  transform: translateY(50%);\n  z-index: 0;\n  padding-top: 20px;\n  padding-bottom: 20px;\n}\n\n:host([location=left]) div.control-surround {\n  padding-right: 12px;\n  left: 100%;\n}\n\n:host([location=right]) div.control-surround {\n  padding-left: 12px;\n  right: 100%;\n}\n\n:host([empty]),\n:host([empty]) > * {\n  visibility: hidden;\n}\n\n:host(:not([empty])),\n:host(:not([empty])) > * {\n  visibility: visible;\n}\n\nadvanced-camera-card-icon.control {\n  color: var(--advanced-camera-card-button-color);\n  background-color: var(--advanced-camera-card-button-background);\n  pointer-events: all;\n  --mdc-icon-size: 20px;\n  padding-top: 20px;\n  padding-bottom: 20px;\n  transition: opacity 0.5s ease;\n}\n\n:host([open]) advanced-camera-card-icon.control,\nadvanced-camera-card-icon.control:hover {\n  opacity: 1;\n}\n\n:host([location=left]) advanced-camera-card-icon.control {\n  border-top-right-radius: 20px;\n  border-bottom-right-radius: 20px;\n}\n\n:host([location=right]) advanced-camera-card-icon.control {\n  border-top-left-radius: 20px;\n  border-bottom-left-radius: 20px;\n}")}};e([he({attribute:!0,reflect:!0})],yO.prototype,"location",void 0),e([he({attribute:!0,reflect:!0,type:Boolean})],yO.prototype,"control",void 0),e([he({type:Boolean,reflect:!0,attribute:!0})],yO.prototype,"open",void 0),e([he({attribute:!1})],yO.prototype,"icons",void 0),e([he({type:Boolean,reflect:!0,attribute:!0})],yO.prototype,"empty",void 0),yO=e([le("advanced-camera-card-drawer")],yO);let bO=class extends oe{constructor(){super(...arguments),this._refDrawerLeft=Te(),this._refDrawerRight=Te(),this._boundDrawerHandler=this._drawerHandler.bind(this)}connectedCallback(){super.connectedCallback(),this.addEventListener("advanced-camera-card:drawer:open",this._boundDrawerHandler),this.addEventListener("advanced-camera-card:drawer:close",this._boundDrawerHandler)}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("advanced-camera-card:drawer:open",this._boundDrawerHandler),this.removeEventListener("advanced-camera-card:drawer:close",this._boundDrawerHandler)}_drawerHandler(e){const t=e.detail.drawer,n=e.type.endsWith(":open");"left"===t&&this._refDrawerLeft.value?this._refDrawerLeft.value.open=n:"right"===t&&this._refDrawerRight.value&&(this._refDrawerRight.value.open=n)}render(){return H` <slot name="above"></slot>
      <slot></slot>
      <advanced-camera-card-drawer
        ${Ie(this._refDrawerLeft)}
        location="left"
        .icons=${this.drawerIcons?.left}
      >
        <slot name="left"></slot>
      </advanced-camera-card-drawer>
      <advanced-camera-card-drawer
        ${Ie(this._refDrawerRight)}
        location="right"
        .icons=${this.drawerIcons?.right}
      >
        <slot name="right"></slot>
      </advanced-camera-card-drawer>
      <slot name="below"></slot>`}static get styles(){return s(":host {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  position: relative;\n  overflow: hidden;\n}\n\n::slotted(:not([slot])) {\n  flex: 1;\n  min-height: 0px;\n}")}};e([he({attribute:!1})],bO.prototype,"drawerIcons",void 0),bO=e([le("advanced-camera-card-surround-basic")],bO);let wO=class extends oe{_hasDrawer(){return!!this.thumbnailConfig&&["left","right"].includes(this.thumbnailConfig.mode)}willUpdate(e){this.timelineConfig?.mode&&"none"!==this.timelineConfig.mode&&import("./timeline-core-b785bd1e.js");const t=this.viewManagerEpoch?.manager.getView();e.has("viewManagerEpoch")&&(this.viewManagerEpoch?.manager.hasMajorMediaChange(this.viewManagerEpoch?.oldView)||this.viewManagerEpoch?.oldView?.displayMode!==t?.displayMode)&&(this._cameraIDsForTimeline=this._getCameraIDsForTimeline()??void 0)}_getCameraIDsForTimeline(){const e=this.viewManagerEpoch?.manager.getView();if(!e||!this.cameraManager)return null;if(e.is("live")){const t={anyCapabilities:["clips","snapshots","recordings"]};return e.supportsMultipleDisplayModes()&&e.isGrid()?this.cameraManager.getStore().getCameraIDsWithCapability(t):this.cameraManager.getStore().getAllDependentCameras(e.camera,t)}return e.isViewerView()?e.query?.getQueryCameraIDs()??null:null}render(){const e=this.viewManagerEpoch?.manager.getView();if(!this.hass||!e)return;const t=(e,t)=>{this.thumbnailConfig&&this._hasDrawer()&&Gf(e.composedPath()[0],"drawer:"+t,{drawer:this.thumbnailConfig.mode})};return H` <advanced-camera-card-surround-basic
      @advanced-camera-card:thumbnails:open=${e=>t(e,"open")}
      @advanced-camera-card:thumbnails:close=${e=>t(e,"close")}
    >
      ${this.thumbnailConfig&&"none"!==this.thumbnailConfig.mode?H` <advanced-camera-card-thumbnail-carousel
            slot=${this.thumbnailConfig.mode}
            .hass=${this.hass}
            .config=${this.thumbnailConfig}
            .cameraManager=${this.cameraManager}
            .fadeThumbnails=${e.isViewerView()}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .selected=${e.queryResults?.getSelectedIndex()??void 0}
            @advanced-camera-card:thumbnail-carousel:tap=${e=>{const n=e.detail.queryResults.getSelectedResult();n&&(this.viewManagerEpoch?.manager.setViewByParameters({params:{view:"media",queryResults:e.detail.queryResults,...n.getCameraID()&&{camera:n.getCameraID()}},modifiers:[new nO(["timeline","mediaViewer"])]}),t(e,"close"))}}
          >
          </advanced-camera-card-thumbnail-carousel>`:""}
      ${this.timelineConfig&&"none"!==this.timelineConfig.mode?H` <advanced-camera-card-timeline-core
            slot=${this.timelineConfig.mode}
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .itemClickAction=${e.isViewerView()||!this.thumbnailConfig||"none"===this.thumbnailConfig?.mode?"play":"select"}
            .cameraIDs=${this._cameraIDsForTimeline}
            .mini=${!0}
            .timelineConfig=${this.timelineConfig}
            .thumbnailConfig=${this.thumbnailConfig}
            .cameraManager=${this.cameraManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-timeline-core>`:""}
      <slot></slot>
    </advanced-camera-card-surround-basic>`}static get styles(){return s(gO)}};e([he({attribute:!1})],wO.prototype,"hass",void 0),e([he({attribute:!1})],wO.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1,hasChanged:ng})],wO.prototype,"thumbnailConfig",void 0),e([he({attribute:!1,hasChanged:ng})],wO.prototype,"timelineConfig",void 0),e([he({attribute:!1})],wO.prototype,"cameraManager",void 0),e([he({attribute:!1})],wO.prototype,"cardWideConfig",void 0),wO=e([le("advanced-camera-card-surround")],wO);
/**
 * @license
 * Copyright 2021 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
class xO{constructor(e){this.Y=e}disconnect(){this.Y=void 0}reconnect(e){this.Y=e}deref(){return this.Y}}class kO{constructor(){this.Z=void 0,this.q=void 0}get(){return this.Z}pause(){this.Z??=new Promise((e=>this.q=e))}resume(){this.q?.(),this.Z=this.q=void 0}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const CO=e=>!(e=>null===e||"object"!=typeof e&&"function"!=typeof e)(e)&&"function"==typeof e.then,MO=1073741823;const EO=fe(class extends Ae{constructor(){super(...arguments),this._$Cwt=MO,this._$Cbt=[],this._$CK=new xO(this),this._$CX=new kO}render(...e){return e.find((e=>!CO(e)))??q}update(e,t){const n=this._$Cbt;let i=n.length;this._$Cbt=t;const a=this._$CK,r=this._$CX;this.isConnected||this.disconnected();for(let e=0;e<t.length&&!(e>this._$Cwt);e++){const s=t[e];if(!CO(s))return this._$Cwt=e,s;e<i&&s===n[e]||(this._$Cwt=MO,i=0,Promise.resolve(s).then((async e=>{for(;r.get();)await r.get();const t=a.deref();if(void 0!==t){const n=t._$Cbt.indexOf(s);n>-1&&n<t._$Cwt&&(t._$Cwt=n,t.setValue(e))}})))}return q}disconnected(){this._$CK.disconnect(),this._$CX.pause()}reconnected(){this._$CK.reconnect(this),this._$CX.resume()}});let SO=class extends oe{async _renderDiagnostics(){const e=await(async(e,t,n)=>{const i=e&&t?await t.getMatchingDevices(e,(e=>"Frigate"===e.manufacturer)):[],a=new Map;return i?.forEach((e=>{e.config_entries.forEach((t=>{e.model&&a.set(t,e.model)}))})),{card_version:"7.1.0",browser:navigator.userAgent,date:new Date,lang:Zv(),timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,git:{hash:kE,build_date:xE,commit_date:CE},...e&&{ha_version:e.config.version},custom_integrations:{frigate:{...await $E("frigate",e),...a.size&&{devices:Object.fromEntries(a)}},hass_web_proxy:await $E(EE,e)},...n&&{config:n}}})(this.hass,this.deviceRegistryManager,this.rawConfig);return AT({message:Kv("error.diagnostics"),icon:"mdi:cogs",context:e})}render(){return H`${EO(this._renderDiagnostics(),AT({message:Kv("error.fetching_diagnostics"),dotdotdot:!0,icon:"mdi:cogs"}))}`}static get styles(){return s(gO)}};e([he({attribute:!1})],SO.prototype,"deviceRegistryManager",void 0),e([he({attribute:!1})],SO.prototype,"rawConfig",void 0),SO=e([le("advanced-camera-card-diagnostics")],SO);let AO=class extends oe{willUpdate(e){if(e.has("viewManagerEpoch")||e.has("config")){const e=this.viewManagerEpoch?.manager.getView();(e?.is("live")||this._shouldLivePreload())&&import("./index-e103fb36.js"),e?.isGalleryView()?import("./gallery-4e5e066e.js"):e?.isViewerView()?import("./index-471d6511.js"):e?.is("image")?import("./image-7c64c836.js"):e?.is("timeline")&&import("./timeline-2350768e.js")}e.has("hide")&&(this.hide?this.setAttribute("hidden",""):this.removeAttribute("hidden"))}_shouldLivePreload(){const e=this.viewManagerEpoch?.manager.getView();return!!this.config?.live.preload&&!e?.is("diagnostics")}render(){if(!this.hass||!this.config||!this.cardWideConfig)return H``;const e=this.viewManagerEpoch?.manager.getView(),t={hidden:this._shouldLivePreload()&&!e?.is("live")},n={hidden:!!this.hide},i=e?.is("live")?this.config.live.controls.thumbnails:e?.isViewerView()?this.config.media_viewer.controls.thumbnails:e?.is("timeline")?this.config.timeline.controls.thumbnails:void 0,a=e?.is("live")?this.config.live.controls.timeline:e?.isViewerView()?this.config.media_viewer.controls.timeline:void 0,r=e?this.cameraManager?.getStore().getCameraConfig(e.camera)??null:null;return H` <advanced-camera-card-surround
      class="${ve(n)}"
      .hass=${this.hass}
      .viewManagerEpoch=${this.viewManagerEpoch}
      .thumbnailConfig=${this.hide?void 0:i}
      .timelineConfig=${this.hide?void 0:a}
      .cameraManager=${this.cameraManager}
      .cardWideConfig=${this.cardWideConfig}
    >
      ${!this.hide&&e?.is("image")&&r?H` <advanced-camera-card-image
            .imageConfig=${this.config.image}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .hass=${this.hass}
            .cameraConfig=${r}
            .cameraManager=${this.cameraManager}
          >
          </advanced-camera-card-image>`:""}
      ${!this.hide&&e?.isGalleryView()?H` <advanced-camera-card-gallery
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .galleryConfig=${this.config.media_gallery}
            .cameraManager=${this.cameraManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-gallery>`:""}
      ${!this.hide&&e?.isViewerView()?H`
            <advanced-camera-card-viewer
              .hass=${this.hass}
              .viewManagerEpoch=${this.viewManagerEpoch}
              .viewerConfig=${this.config.media_viewer}
              .resolvedMediaCache=${this.resolvedMediaCache}
              .cameraManager=${this.cameraManager}
              .cardWideConfig=${this.cardWideConfig}
            >
            </advanced-camera-card-viewer>
          `:""}
      ${!this.hide&&e?.is("timeline")?H` <advanced-camera-card-timeline
            .hass=${this.hass}
            .viewManagerEpoch=${this.viewManagerEpoch}
            .timelineConfig=${this.config.timeline}
            .cameraManager=${this.cameraManager}
            .cardWideConfig=${this.cardWideConfig}
          >
          </advanced-camera-card-timeline>`:""}
      ${!this.hide&&e?.is("diagnostics")?H` <advanced-camera-card-diagnostics
            .hass=${this.hass}
            .rawConfig=${this.rawConfig}
            .deviceRegistryManager=${this.deviceRegistryManager}
          >
          </advanced-camera-card-diagnostics>`:""}
      ${this._shouldLivePreload()||!this.hide&&e?.is("live")?H`
              <advanced-camera-card-live
                .hass=${this.hass}
                .viewManagerEpoch=${this.viewManagerEpoch}
                .liveConfig=${this.config.live}
                .cameraManager=${this.cameraManager}
                .cardWideConfig=${this.cardWideConfig}
                .microphoneState=${this.microphoneState}
                .triggeredCameraIDs=${this.triggeredCameraIDs}
                class="${ve(t)}"
              >
              </advanced-camera-card-live>
            `:""}
    </advanced-camera-card-surround>`}static get styles(){return s(":host {\n  width: 100%;\n  height: 100%;\n  display: block;\n}\n\n:host([hidden]),\n.hidden {\n  display: none;\n}")}};e([he({attribute:!1})],AO.prototype,"hass",void 0),e([he({attribute:!1})],AO.prototype,"viewManagerEpoch",void 0),e([he({attribute:!1})],AO.prototype,"cameraManager",void 0),e([he({attribute:!1})],AO.prototype,"config",void 0),e([he({attribute:!1})],AO.prototype,"cardWideConfig",void 0),e([he({attribute:!1})],AO.prototype,"rawConfig",void 0),e([he({attribute:!1})],AO.prototype,"resolvedMediaCache",void 0),e([he({attribute:!1})],AO.prototype,"hide",void 0),e([he({attribute:!1})],AO.prototype,"microphoneState",void 0),e([he({attribute:!1})],AO.prototype,"triggeredCameraIDs",void 0),e([he({attribute:!1})],AO.prototype,"deviceRegistryManager",void 0),AO=e([le("advanced-camera-card-views")],AO);console.info("%c 📷 Advanced Camera Card %c 7.1.0 ","padding: 3px; color: black; background: pink;","padding: 3px; color: black; background: white;"),window.customCards=window.customCards||[],window.customCards.push({type:"advanced-camera-card",name:Kv("common.advanced_camera_card"),description:Kv("common.advanced_camera_card_description"),preview:!0,documentationURL:"https://github.com/dermotduffy/advanced-camera-card"});let TO=class extends oe{constructor(){super(...arguments),this._controller=new rE(this,(()=>this._refMain.value?.scroll({top:0})),(()=>this._refMenu.value?.toggleMenu())),this._menuButtonController=new sE,this._refMenu=Te(),this._refOverlay=Te(),this._refMain=Te(),this._refElements=Te(),this._refViews=Te()}get _config(){return this._controller.getConfigManager().getConfig()}get _hass(){return this._controller.getHASSManager().getHASS()}set hass(e){this._controller.getHASSManager().setHASS(e),this._refMenu.value&&(this._refMenu.value.hass=e),this._refElements.value&&(this._refElements.value.hass=e),this._refViews.value&&(this._refViews.value.hass=e)}static async getConfigElement(){return await rE.getConfigElement()}static getStubConfig(e,t){return rE.getStubConfig(t)}setConfig(e){this._controller.getConfigManager().setConfig(e)}shouldUpdate(){return!!this.isConnected&&(this._controller.getMessageManager().hasMessage()||this._controller.getInitializationManager().isInitializedMandatory()||this._controller.getInitializationManager().initializeMandatory(),!0)}_renderMenuStatusContainer(e){if(!this._config)return;const t=this._config.menu.style,n=this._config.menu.position,i=this._config.status_bar.style,a=this._config.status_bar.position;if("none"===t&&"none"===i||"overlay"===e&&"outside"===t&&"outside"===i||"overlay"!==e&&("outside"!==t||n!==e)&&("outside"!==i||a!==e))return;const r=r=>{const s="none"!==t&&("outside"===t&&"outerlay"===r&&n===e||"outside"!==t&&"overlay"===r),o="none"!==i&&("outside"===i&&"outerlay"===r&&a===e||"outside"!==i&&"overlay"===r),c="left"===n||"right"===n||"bottom"===n&&"hidden"===t&&"popup"!==i||"top"===n&&"popup"===i;return H`
        ${s&&c?this._renderMenu(n):""}
        ${o?this._renderStatusBar(a):""}
        ${s&&!c?this._renderMenu(n):""}
      `};return H`
      ${"overlay"===e?H`<advanced-camera-card-overlay
            >${r("overlay")}</advanced-camera-card-overlay
          >`:H`<div class="outerlay" data-position="${e}">
            ${r("outerlay")}
          </div>`}
    `}_renderMenu(e){const t=this._controller.getViewManager().getView();if(this._hass&&this._config)return H`
      <advanced-camera-card-menu
        ${Ie(this._refMenu)}
        slot=${_e(e)}
        .hass=${this._hass}
        .menuConfig=${this._config.menu}
        .buttons=${this._menuButtonController.calculateButtons(this._hass,this._config,this._controller.getCameraManager(),{inExpandedMode:this._controller.getExpandManager().isExpanded(),fullscreenManager:this._controller.getFullscreenManager(),currentMediaLoadedInfo:this._controller.getMediaLoadedInfoManager().get(),showCameraUIButton:this._controller.getCameraURLManager().hasCameraURL(),mediaPlayerController:this._controller.getMediaPlayerManager(),microphoneManager:this._controller.getMicrophoneManager(),view:t,viewManager:this._controller.getViewManager()})}
        .entityRegistryManager=${this._controller.getEntityRegistryManager()}
      ></advanced-camera-card-menu>
    `}_renderStatusBar(e){if(this._config)return H`
      <advanced-camera-card-status-bar
        slot=${_e(e)}
        .items=${this._controller.getStatusBarItemManager().calculateItems({statusConfig:this._config.status_bar,cameraManager:this._controller.getCameraManager(),view:this._controller.getViewManager().getView(),mediaLoadedInfo:this._controller.getMediaLoadedInfoManager().get()})}
        .config=${this._config.status_bar}
      ></advanced-camera-card-status-bar>
    `}updated(){this._controller.getInitializationManager().isInitializedMandatory()&&this._controller.getQueryStringManager().executeIfNecessary()}_renderInDialogIfNecessary(e){return this._controller.getExpandManager().isExpanded()?H` <web-dialog
        open
        center
        @close=${()=>{this._controller.getExpandManager().setExpanded(!1)}}
      >
        ${e}
      </web-dialog>`:e}render(){if(!this._hass)return;const e="outside"===this._config?.menu.style||"outside"===this._config?.status_bar.style,t={main:!0,"curve-top":!e||"top"!==this._config?.menu.position&&"top"!==this._config?.status_bar.position,"curve-bottom":!e||"bottom"!==this._config?.menu.position&&"bottom"!==this._config?.status_bar.position},n=this._controller.getActionsManager().getMergedActions(),i=this._controller.getCameraManager(),a=!1!==this._config?.performance?.features.card_loading_indicator&&!this._controller.getMessageManager().hasMessage();return this._renderInDialogIfNecessary(H` <ha-card
        id="ha-card"
        .actionHandler=${Ig({hasHold:Sg(n.hold_action),hasDoubleClick:Sg(n.double_tap_action)})}
        style="${ze(this._controller.getStyleManager().getAspectRatioStyle())}"
        @advanced-camera-card:message=${e=>this._controller.getMessageManager().setMessageIfHigherPriority(e.detail)}
        @advanced-camera-card:media:loaded=${e=>this._controller.getMediaLoadedInfoManager().set(e.detail)}
        @advanced-camera-card:media:unloaded=${()=>this._controller.getMediaLoadedInfoManager().clear()}
        @advanced-camera-card:media:volumechange=${()=>this.requestUpdate()}
        @advanced-camera-card:media:play=${()=>this.requestUpdate()}
        @advanced-camera-card:media:pause=${()=>this.requestUpdate()}
        @advanced-camera-card:focus=${()=>this.focus()}
      >
        ${a?H`<advanced-camera-card-loading
              ?loaded=${this._controller.getInitializationManager().wasEverInitialized()}
            ></advanced-camera-card-loading>`:""}
        ${this._renderMenuStatusContainer("top")}
        ${this._renderMenuStatusContainer("overlay")}
        <div ${Ie(this._refMain)} class="${ve(t)}">
          <advanced-camera-card-views
            ${Ie(this._refViews)}
            .hass=${this._hass}
            .viewManagerEpoch=${this._controller.getViewManager().getEpoch()}
            .cameraManager=${i}
            .resolvedMediaCache=${this._controller.getResolvedMediaCache()}
            .config=${this._controller.getConfigManager().getConfig()}
            .cardWideConfig=${this._controller.getConfigManager().getCardWideConfig()}
            .rawConfig=${this._controller.getConfigManager().getRawConfig()}
            .configManager=${this._controller.getConfigManager()}
            .hide=${!!this._controller.getMessageManager().hasMessage()}
            .microphoneState=${this._controller.getMicrophoneManager().getState()}
            .triggeredCameraIDs=${this._config?.view.triggers.show_trigger_status?this._controller.getTriggersManager().getTriggeredCameraIDs():void 0}
            .deviceRegistryManager=${this._controller.getDeviceRegistryManager()}
          ></advanced-camera-card-views>
          ${this._controller.getMessageManager().hasMessage()?AT(this._controller.getMessageManager().getMessage()):""}
        </div>
        ${this._renderMenuStatusContainer("bottom")}
        ${this._config?.elements?H` <advanced-camera-card-elements
              ${Ie(this._refElements)}
              .hass=${this._hass}
              .elements=${this._config?.elements}
              @advanced-camera-card:menu:add=${e=>{this._menuButtonController.addDynamicMenuButton(e.detail),this.requestUpdate()}}
              @advanced-camera-card:menu:remove=${e=>{this._menuButtonController.removeDynamicMenuButton(e.detail),this.requestUpdate()}}
              @advanced-camera-card:status-bar:add=${e=>{this._controller.getStatusBarItemManager().addDynamicStatusBarItem(e.detail)}}
              @advanced-camera-card:status-bar:remove=${e=>{this._controller.getStatusBarItemManager().removeDynamicStatusBarItem(e.detail)}}
              @advanced-camera-card:condition-state-manager:get=${e=>{e.conditionStateManager=this._controller.getConditionStateManager()}}
            >
            </advanced-camera-card-elements>`:""}
      </ha-card>`)}static get styles(){return s(':host([themes~=dark]) {\n  --primary-background-color: #111111;\n  --secondary-background-color: #282828;\n  --primary-text-color: #e1e1e1;\n  --divider-color: rgba(225, 225, 225, 0.12);\n  --app-header-background-color: #101e24;\n  --app-header-text-color: #e1e1e1;\n}\n\n:host([themes~=light]) {\n  --primary-background-color: #fafafa;\n  --secondary-background-color: #e5e5e5;\n  --primary-text-color: #212121;\n  --divider-color: rgba(0, 0, 0, 0.12);\n  --app-header-text-color: #ffffff;\n  --app-header-background-color: #03a9f4;\n}\n\n:host([themes~=traditional]) {\n  /*********\n   * General\n   *********/\n  --advanced-camera-card-control-background: black;\n  /******\n   * Menu\n   ******/\n  --advanced-camera-card-menu-button-active-color: var(--primary-color, white);\n  --advanced-camera-card-menu-button-background: rgba(0, 0, 0, 0.6);\n  --advanced-camera-card-menu-position-left-alignment-top-background: linear-gradient(180deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-left-alignment-bottom-background: linear-gradient(0deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-right-alignment-top-background: linear-gradient(180deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-right-alignment-bottom-background: linear-gradient(0deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-left-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-right-background: linear-gradient(270deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-bottom-alignment-left-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-bottom-alignment-right-background: linear-gradient(270deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-menu-position-top-alignment-left-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-top-alignment-right-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-bottom-alignment-left-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-menu-position-bottom-alignment-right-style-outside-background: var(\n    --secondary-background-color\n  );\n  /************\n   * Status bar\n   ************/\n  --advanced-camera-card-status-bar-color: white;\n  --advanced-camera-card-status-bar-position-top-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-status-bar-position-bottom-background: linear-gradient(90deg, var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), var(--advanced-camera-card-menu-background), color-mix(in oklab, var(--advanced-camera-card-menu-background), transparent 100%));\n  --advanced-camera-card-status-bar-position-top-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-status-bar-position-bottom-style-outside-background: var(\n    --secondary-background-color\n  );\n  --advanced-camera-card-status-bar-position-top-style-outside-color: var(\n    --secondary-text-color\n  );\n  --advanced-camera-card-status-bar-position-bottom-style-outside-color: var(\n    --secondary-text-color\n  );\n}\n\n:host {\n  /*********\n   * General\n   *********/\n  --advanced-camera-card-exterior: var(--secondary-background-color, black);\n  --advanced-camera-card-background: var(--primary-background-color, white);\n  --advanced-camera-card-foreground-primary: var(--primary-color, black);\n  --advanced-camera-card-active-color: var(--accent-color, orange);\n  --advanced-camera-card-warning-color: var(--error-color, red);\n  --advanced-camera-card-text-color: var(--primary-text-color);\n  --advanced-camera-card-divider-color: var(--divider-color);\n  --advanced-camera-card-control-background: var(--app-header-background-color);\n  --advanced-camera-card-control-background-transparent: color-mix(\n    in oklab,\n    var(--advanced-camera-card-control-background),\n    transparent 60%\n  );\n  --advanced-camera-card-control-foreground: var(--app-header-text-color);\n  /*********\n   * Buttons\n   *********/\n  --advanced-camera-card-button-color: var(--advanced-camera-card-control-foreground);\n  --advanced-camera-card-button-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  /******\n   * Menu\n   ******/\n  --advanced-camera-card-menu-button-active-color: var(\n    --advanced-camera-card-active-color\n  );\n  --advanced-camera-card-menu-button-inactive-color: var(\n    --advanced-camera-card-button-color\n  );\n  --advanced-camera-card-menu-button-critical-color: var(\n    --error-color,\n    var(--advanced-camera-card-warning-color)\n  );\n  --advanced-camera-card-menu-button-background: color-mix(\n    in oklab,\n    var(--advanced-camera-card-menu-button-inactive-color),\n    transparent 60%\n  );\n  --advanced-camera-card-menu-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-menu-style-outside-background: var(\n    --advanced-camera-card-control-background\n  );\n  --advanced-camera-card-menu-override-background: unset;\n  --advanced-camera-card-menu-override-button-inactive-color: unset;\n  --advanced-camera-card-menu-override-button-background: unset;\n  /************\n   * Status bar\n   ************/\n  --advanced-camera-card-status-bar-override-background: unset;\n  --advanced-camera-card-status-bar-override-color: unset;\n  --advanced-camera-card-status-bar-color: var(\n    --advanced-camera-card-control-foreground\n  );\n  --advanced-camera-card-status-bar-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-status-bar-style-outside-background: var(\n    --advanced-camera-card-control-background\n  );\n  /************\n   * Thumbnails\n   ************/\n  --advanced-camera-card-thumbnail-icon-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-thumbnail-border-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-thumbnail-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-thumbnail-icon-favorite-color: color-mix(\n    in oklab,\n    gold,\n    transparent 25%\n  );\n  --advanced-camera-card-thumbnail-text-color: var(--advanced-camera-card-text-color);\n  /**********\n   * Timeline\n   **********/\n  --advanced-camera-card-timeline-text-color: var(--advanced-camera-card-text-color);\n  --advanced-camera-card-timeline-item-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-timeline-tool-color: var(\n    --advanced-camera-card-foreground-primary\n  );\n  --advanced-camera-card-timeline-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-timeline-background-item-color: color-mix(\n    in oklab,\n    var(--advanced-camera-card-timeline-item-color),\n    transparent 90%\n  );\n  --advanced-camera-card-timeline-divider-color: var(\n    --advanced-camera-card-divider-color\n  );\n  --advanced-camera-card-timeline-target-bar-color: var(\n    --advanced-camera-card-active-color\n  );\n  /*******************\n   * Loading Indicator\n   *******************/\n  --advanced-camera-card-loading-background-color: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-loading-foreground-color: var(\n    --advanced-camera-card-control-foreground\n  );\n  /*********\n   * Message\n   *********/\n  --advanced-camera-card-message-color: var(--advanced-camera-card-text-color);\n  --advanced-camera-card-message-background: var(--advanced-camera-card-background);\n  --advanced-camera-card-message-overlay-background: var(\n    --advanced-camera-card-control-background-transparent\n  );\n  --advanced-camera-card-message-overlay-color: var(\n    --advanced-camera-card-control-foreground\n  );\n}\n\n:host {\n  display: block;\n  position: relative;\n  background-color: var(--card-background-color);\n  border-radius: var(--ha-card-border-radius, 4px);\n  height: var(--advanced-camera-card-height);\n  min-height: 100px;\n  pointer-events: all;\n  --advanced-camera-card-expand-max-height: calc((100vh - (2 * 56px)) * 0.85);\n  --advanced-camera-card-expand-max-width: 85vw;\n  --advanced-camera-card-expand-width: none;\n  --advanced-camera-card-expand-height: none;\n  --advanced-camera-card-expand-aspect-ratio: unset;\n  --advanced-camera-card-height: auto;\n}\n\nadvanced-camera-card-loading {\n  position: absolute;\n  inset: 0;\n  z-index: 1;\n}\n\n:host([dimmable]:not([interaction])) {\n  filter: brightness(75%);\n}\n\n:host([panel]:not([casted])) {\n  height: calc(100vh - var(--kiosk-header-height, var(--header-height)));\n}\n\n:host([panel][casted]) {\n  height: 100%;\n}\n\ndiv.main {\n  position: relative;\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n  margin: auto;\n  display: block;\n  transform: translateZ(0);\n  scrollbar-width: none;\n  -ms-overflow-style: none;\n}\n\n/* Hide scrollbar for Chrome, Safari and Opera */\ndiv.main::-webkit-scrollbar {\n  display: none;\n}\n\ndiv.main.curve-top {\n  border-top-left-radius: var(--ha-card-border-radius, 4px);\n  border-top-right-radius: var(--ha-card-border-radius, 4px);\n}\n\ndiv.main.curve-bottom {\n  border-bottom-left-radius: var(--ha-card-border-radius, 4px);\n  border-bottom-right-radius: var(--ha-card-border-radius, 4px);\n}\n\nha-card {\n  display: flex;\n  flex-direction: column;\n  margin: auto;\n  border: 0px;\n  overflow: visible;\n  width: 100%;\n  height: 100%;\n  position: static;\n  color: var(--secondary-text-color, white);\n}\n\n/************\n * Fullscreen\n *************/\n:host(:fullscreen) #ha-card {\n  border-radius: 0px;\n  box-shadow: none;\n  margin: 0;\n}\n\n:host(:-webkit-full-screen) #ha-card {\n  border-radius: 0px;\n  box-shadow: none;\n  margin: 0;\n}\n\n:host(:fullscreen) div.main,\n:host(:fullscreen) advanced-camera-card-menu {\n  border-radius: 0px;\n}\n\n:host(:-webkit-full-screen) div.main,\n:host(:-webkit-full-screen) advanced-camera-card-menu {\n  border-radius: 0px;\n}\n\n/***************\n * Expanded mode\n ***************/\nweb-dialog {\n  --dialog-padding: 0px;\n  --dialog-container-padding: 0px;\n  --dialog-max-height: var(--advanced-camera-card-expand-max-height);\n  --dialog-max-width: var(--advanced-camera-card-expand-max-width);\n  --dialog-width: var(--advanced-camera-card-expand-width);\n  --dialog-height: var(--advanced-camera-card-expand-height);\n  --dialog-overflow-x: visible;\n  --dialog-overflow-y: visible;\n  max-height: 100vh;\n}\n\nweb-dialog::part(dialog) {\n  aspect-ratio: var(--advanced-camera-card-expand-aspect-ratio);\n  border-radius: 0px;\n  background: transparent;\n}\n\n/*************************************\n * "Outside" style for menu/status bar\n *************************************/\n.outerlay[data-position=top] > *:first-child {\n  border-top-left-radius: var(--ha-card-border-radius, 4px);\n  border-top-right-radius: var(--ha-card-border-radius, 4px);\n}\n\n.outerlay[data-position=bottom] > *:last-child {\n  border-bottom-left-radius: var(--ha-card-border-radius, 4px);\n  border-bottom-right-radius: var(--ha-card-border-radius, 4px);\n}\n\n/*******************\n * Menu hover styles\n *******************/\nadvanced-camera-card-menu {\n  z-index: 2;\n}\n\nadvanced-camera-card-menu[data-style*=hover] {\n  transition: opacity 0.5s ease;\n  opacity: 0;\n}\n\nadvanced-camera-card-menu[data-style*=hover]:hover,\nha-card:hover > advanced-camera-card-overlay > advanced-camera-card-menu[data-style=hover-card] {\n  opacity: 1;\n}\n\n/*************************\n * Status bar hover styles\n *************************/\nadvanced-camera-card-status-bar {\n  z-index: 1;\n}\n\nadvanced-camera-card-status-bar[data-style*=hover] {\n  transition: opacity 0.5s ease;\n  opacity: 0;\n}\n\nadvanced-camera-card-status-bar[data-style*=hover]:hover,\nha-card:hover > advanced-camera-card-overlay > advanced-camera-card-status-bar[data-style=hover-card] {\n  opacity: 1;\n}')}getCardSize(){return 6}};TO=e([le("advanced-camera-card")],TO);let $O=class extends TO{};$O=e([le("frigate-card")],$O);export{qo as $,er as A,tr as B,qa as C,nr as D,ir as E,ar as F,za as G,Da as H,Ra as I,Na as J,Pa as K,Fa as L,Ba as M,Va as N,Ua as O,go as P,io as Q,Zo as R,Ko as S,rc as T,qs as U,Fs as V,Bs as W,Vs as X,Hs as Y,ac as Z,e as _,oe as a,Os as a$,zl as a0,Dl as a1,Yv as a2,tw as a3,Je as a4,nw as a5,$o as a6,Ia as a7,Oa as a8,La as a9,ws as aA,Kr as aB,Yr as aC,Qr as aD,ss as aE,os as aF,ls as aG,us as aH,cs as aI,is as aJ,as as aK,rs as aL,ms as aM,vs as aN,_s as aO,ds as aP,hs as aQ,gs as aR,ps as aS,fs as aT,es as aU,ns as aV,ts as aW,Xr as aX,Jr as aY,Gr as aZ,Ts as a_,ja as aa,Ha as ab,Qa as ac,to as ad,eo as ae,Js as af,no as ag,po as ah,ho as ai,fo as aj,Wo as ak,mo as al,Es as am,ks as an,Is as ao,Cs as ap,Ms as aq,Hr as ar,qr as as,Wr as at,Zr as au,Ss as av,As as aw,ys as ax,xs as ay,bs as az,pe as b,ea as b$,$s as b0,dr as b1,or as b2,lr as b3,ur as b4,cr as b5,sr as b6,pr as b7,mr as b8,fr as b9,Nr as bA,Ds as bB,Ns as bC,js as bD,zs as bE,Rs as bF,Us as bG,Zs as bH,Ks as bI,Qs as bJ,Gs as bK,Ys as bL,Ws as bM,yo as bN,_o as bO,bo as bP,Co as bQ,ko as bR,Mo as bS,Oo as bT,Eo as bU,To as bV,Ao as bW,Jb as bX,Gb as bY,Jf as bZ,Ci as b_,gr as ba,wr as bb,Vr as bc,xr as bd,Cr as be,kr as bf,vr as bg,br as bh,_r as bi,yr as bj,Mr as bk,Er as bl,Sr as bm,Lr as bn,Tr as bo,Or as bp,Ir as bq,$r as br,Ar as bs,Rr as bt,Fr as bu,Br as bv,jr as bw,zr as bx,Pr as by,Dr as bz,ew as c,j$ as c$,Gi as c0,Pi as c1,Fi as c2,ki as c3,Mi as c4,ji as c5,Li as c6,zi as c7,Ii as c8,Qi as c9,ia as cA,sa as cB,oa as cC,ca as cD,la as cE,ua as cF,da as cG,ha as cH,aa as cI,ra as cJ,Ei as cK,Si as cL,ma as cM,pa as cN,ga as cO,fa as cP,Zu as cQ,xi as cR,So as cS,Uw as cT,Te as cU,Hw as cV,vg as cW,AT as cX,Ie as cY,wi as cZ,mb as c_,Wi as ca,Zi as cb,Ki as cc,Yi as cd,_a as ce,va as cf,Di as cg,Ri as ch,Ni as ci,Ui as cj,qi as ck,Bi as cl,Vi as cm,Hi as cn,Xi as co,Ji as cp,na as cq,ta as cr,ba as cs,ya as ct,wa as cu,xa as cv,Ai as cw,Ti as cx,$i as cy,Oi as cz,iw as d,md as d$,Ag as d0,Uy as d1,_e as d2,gO as d3,Ku as d4,ld as d5,c as d6,BM as d7,ty as d8,VM as d9,Ww as dA,Zw as dB,GM as dC,Tg as dD,gy as dE,cO as dF,sO as dG,Eg as dH,jE as dI,Mg as dJ,Ig as dK,Sg as dL,Io as dM,fe as dN,ge as dO,q as dP,bv as dQ,yv as dR,H_ as dS,q_ as dT,Xu as dU,K_ as dV,ag as dW,rg as dX,JM as dY,hb as dZ,qM as d_,wy as da,UM as db,ig as dc,j_ as dd,Jd as de,sg as df,th as dg,ng as dh,Gf as di,by as dj,dg as dk,lO as dl,tE as dm,aO as dn,Cw as dp,Yw as dq,Oy as dr,Hb as ds,qb as dt,AE as du,TE as dv,Rb as dw,SE as dx,Vw as dy,qw as dz,ve as e,mg as e0,Z_ as e1,Qf as e2,yi as e3,ug as e4,z_ as e5,Lo as e6,ay as e7,J_ as e8,e_ as e9,Zd as eA,qd as eB,Vb as eC,ey as eD,gg as eE,me as eF,ye as eG,W as eH,we as eI,Pb as eJ,Bw as eK,ob as eL,cb as eM,lb as eN,bg as eO,db as eP,Hf as eQ,ub as eR,o as eS,EO as eT,tO as eU,t_ as ea,iy as eb,og as ec,lg as ed,ny as ee,Y_ as ef,hg as eg,P_ as eh,N_ as ei,R_ as ej,F_ as ek,rd as el,Yu as em,nd as en,td as eo,id as ep,Md as eq,sd as er,od as es,Ed as et,Cd as eu,Qu as ev,ud as ew,xd as ex,Bd as ey,Wd as ez,gw as f,Bb as g,Xb as h,V_ as i,Fb as j,Xf as k,Kv as l,Ya as m,he as n,Za as o,qu as p,Wa as q,s as r,pg as s,le as t,Ka as u,Ub as v,Ga as w,H as x,Ja as y,Xa as z};
