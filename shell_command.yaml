# SSH to host/weasel as andrew to run shell commands
# SSH key and config shared via Docker volume

nuc_poweroff: ssh nuc 'sudo shutdown -h 2'

nas_poweroff: ssh nuc '/opt/homeassistant/scripts/nas-poweroff.sh'

mount_plex: ssh nuc 'mount /plex; sleep 5; docker restart plex'

umount_plex: ssh nuc 'umount -f /plex; docker stop plex'

copy: ssh -n -f nuc "nohup /opt/homeassistant/scripts/nas-copy.sh > /dev/null 2>&1 &"

commit_pfsense_changes: ssh nuc '/opt/homeassistant/scripts/commit_pfsense_changes.sh'

update_cloudflare_firewall: /config/scripts/update_cloudflare_firewall.sh {{ old }} {{ new }}

# If signal device changes the identity goes to untrusted and messages don't go through to that recipient
trust_signal_identities: ssh nuc '/opt/homeassistant/scripts/trust_signal_identities.sh' 

weasel_shortcut: ssh weasel 'shortcuts run "{{ shortcut }}"'

#sync_cloudflare_records: ssh nuc '/opt/homeassistant/scripts/nginx_proxy_manager_sync.py'